!!!! TODO: Rewrite BIOS etc for use   MCOPY_AVR_RAM, MCOPY_RAM_AVR !!!!!!

4.66 08.05.2023
-------------------------------------------------------------------------------------------------------------
* подправлена посл ESC m #1 #2 .. #n 0x04 CMD - играет мелодию
* сделана поддержка версии с цветом, добавлен clr.inc, clr.def
* в spi.def добавлена макрос FAST_SPI - аналог функции, но вставляется в код
* добавлены посл ESC q # - команда # контроллеру цвета
                 ESC r [SELPRGYBMCW] - команда контроллеру цвета: Scroll, Erase screen, clear Line, 
                                       goto Pattern mode, SELPRGYBMCW - установить цвет
                 ESC s LN CLR - следуюшие LN символов вывести цветом CLR

4.65 03.02.2023
-------------------------------------------------------------------------------------------------------------
* Исправлена ощибка позиционирования курсора в видеорежимах 30/31 строка
+ добавлена посл ESC k # - отправка символа в поток ввода с консоли
+ добавлена посл ESC BS / ESC CS - сохранение экрана в видеобуфер / восстановление из видеобуфера
+ добавлена посл ESC W x0 y0 x1 y1 - задать окно вывода, 
                 ESC y y x - относительное позиционирование курсора
                 ESC w C/F/f/U (/D/L/R) - команды манипуляции с окном (в скобках - не сделано!!!!)
+ команды порта FF:
    33 - запись 8-битного регистра (2 параметра)
    34 - запись 16-битного регистра (3 параметра)
    25 - версия прошивки Low
    26 - версия прошивки Hi
+ LAN: добавлено описание заголовка пакета TCP, сделаны функции отправки TCP пакета, 
    !!! не тестировались
+ добавлена посл ESC m #1 #2 .. #n 0x04 CMD - играет мелодию - не работает

4.63 19.12.2021
-------------------------------------------------------------------------------------------------------------
* Переписана библиотека LAN, разнесены буферы, добавлена обработка PING, формир. исх. запросов PING, ARP
+ добавлена возможность приёма пакетов от любых источников, FF в адресе всегда равно
* Исправлена ошибка работы в режиме 25 строк - не обновлялся video_end, переделано
* везде, кроме attr переделаны ф-ции работы с эканом, сделана работа на реальную ширину экрана
+ Сделан запрет музыки, LST, LAN по настройкам RTC_HW_DISABLE
+ Ф-я БИОС LST сделана по IO-байту DEV_IOBYTE
+ добавлены CRISS ESC-посл. G6, G7, G8, G9
+ добавлена работа с LPT, не проверялось!!!
+ добавлена CRISS ESC-посл. g CH VAL вывода в канал GPIO
* при отстутствии RTC DEV_IOBYTE настроен на LST

4.62 21.11.2021
-------------------------------------------------------------------------------------------------------------
* Доделана работа с мышкой - вкл/выкл по Ctrl-Alt-NumLock
+ Сделано переключение сессий по Ctrl-Alt-F1/F2 пока в тестовом режиме
* Скорректирована загрузка с EEPROM, не проверялось
* Убран флаг HW_FOUND_SDC, проверка везде идёт по SD_TYPE
* Добавлен флаг HW_FOUND_CPD наличия КВУ

4.61 29.10.2021
-------------------------------------------------------------------------------------------------------------
* Исправлена критическая ошибка с зписью на карту
* LST_IOBYTE и SD_IOBYTE объединены в DEV_IOBYTE

4.60 05.10.2021
-------------------------------------------------------------------------------------------------------------
* Исправлена ошибка в CtrlAltDel с сохранением регистров
+ Добавлен старт с предсохранённой конфигурации
+ Добавлен терминал V100, работа только началась, сделана первая версия команду управления курсором
+ добавлена ф-я BIOS_L04_CLRBOL в bios_sc.inc
* При обработке BIOS CONST учитывается состоение буферов PUNCH и т.п.
+ добавлены обработчики функций BDOS 11 (статус консоли) и 6 (ввод/вывод с консоли)
+ сделан файл bdos.def

4.59 26.07.2021
-------------------------------------------------------------------------------------------------------------
* LAN: добавлены скрытые системные функции, бывшие функции 19, 20 сделаны системными
- убрано резервное сохранение буфера 512 байт
* добавлена прямая расбота с UDP_DATA, функция 21 (отправить UDP) переписана
* добавлены ф-ции 19: прочитать данные UDP, 21 - сформировать и отправить ARP-запрос
* макрос EXEC_LAN_CMD сделан глобальным через call lan_cmd, внутренний макрос переименован в _EXEC_LAN_CMD

4.58 03.05.2021
-------------------------------------------------------------------------------------------------------------
* в библиотеку LAN добавлены функции 21 (отправить UDP), 22 (удалить из входящего пакета заголовок UDP)

4.57 25.04.2021
-------------------------------------------------------------------------------------------------------------
* скорректирована таблица перекодировки для Роботрон1715, не сходится с документацией право-лево и верх-низ

4.56 11.04.2021
-------------------------------------------------------------------------------------------------------------
+ начата работа по поддержке CAN
+ добавлен режим совместимости KAYPRO 8 bit
* исправлена ошибка вывода символа TAB

4.55 02.04.2021
-------------------------------------------------------------------------------------------------------------
* добавлено сохранение IO LSD, SD в ПЗУ RTC
* обновлена работа с атрибутами, добавланы некоторые функции в BIOS
* сделаны две переменный постоянных атрибутов: CON_ATTR_XOR и CON_ATTR_OR

4.54 02.04.2021
-------------------------------------------------------------------------------------------------------------
* восстановлена работа, в bios по непонятным причинам не работает crusor_x++, выяснить не удалось, заглушка
* добавлена ф-я HW_LST
* добавлена ф-я BIOS_L_04_CRLF

4.53 27.03.2021
-------------------------------------------------------------------------------------------------------------
* улучшена совместимость Robotron, теперь атрибуты вынесены в VIDEOBUF, добавлены ф-ции ECON_* в bios.inc

4.50 24.02.2021
-------------------------------------------------------------------------------------------------------------
* переписаны все andi, ori в z-опкодах, в флаге всегда ставиится бит 7
* изменены таблицы DAA - ставится бит 7
* изменены таблицы песчёта флага из Z в A - ставится бит 7
+ сделана обработка прерываний
+ добавлен счётчик с тиком 0.01 с (TMR2), доступный программно через SHARVAR TMR_10MS (86)

4.48 22.02.2021
-------------------------------------------------------------------------------------------------------------
+ доавлена ф-я bios #27 \ * для вывода символа из #1..#30, режим КРИСС
+ добавлены функции сетевого интерфейса, 
+ сделаны буферы для CON и PR, работа ввода/вывода переделана через них

4.46 21.02.2021
-------------------------------------------------------------------------------------------------------------
+ добавлены в rtc_ram настройки сервера времени, запрета оборудования, пароля входа в консоль
* расширены настройки блока RTC консоли управления
* в SYSTEM_BEEP добавлена проверка разрешения

4.44 15.02.2021
-------------------------------------------------------------------------------------------------------------
+ добавлена настройка блока RTC_RAM
+ добавлены настройки сетевых параметров из блока RTC_RAM
+ добавлены функции работы с RTC

4.44 15.02.2021
-------------------------------------------------------------------------------------------------------------
+ добавлены функции lan.inc с 1 по 10 (см. описание)

4.42 13.02.2021
-------------------------------------------------------------------------------------------------------------
* переделана структура биос, теперь через флаг платформы
+ сделаны настройки для Robotron 1715
* исправлена ошибка в BIOS_UP
* BIOS_RIGHT переделан на CRT_CHARS
* в режиме КРИСС при выводе символ 255 заменяется на 127 для совместимости

4.41 06.02.2021
-------------------------------------------------------------------------------------------------------------
+ в CtrlAltDel добавлены ф-ции работы с ПЗУ: сохранение и восстановление сессии
+ в CtrlAltDel добавлен выбор платформы - установка HW_FLAG, опции в файле hw_layer.inc

4.40 31.01.2021
-------------------------------------------------------------------------------------------------------------
* исправлены ошибки debug CON
* в BIOS #26 сделан стиранием экрана для совместимости с microbee ?????
* скоррестировн start.inc, автозагрузка при наличии только одной опции, не показывает опции ПЗУ при отсутствии

4.39 30.01.2021
-------------------------------------------------------------------------------------------------------------
+ добавлен блок обработки float, первая версия, работа через порт, cmd=0..32
+ добавлены команды z80 _float_ FL32 работы с 32-битным флоатом

4.38 22.01.2021
-------------------------------------------------------------------------------------------------------------
+ добавлены esc-посл переключения видеорежима и точечных операций
* исправлена ошибка в пересчёте сектора при записи

4.37 21.01.2021
-------------------------------------------------------------------------------------------------------------
+ Сделана системная консоль версия 0.1
* GPIOR1 осовобождён, байт уведомлений перенесён в память
* debug.inc полностью переписан, теперь всё отправляется в uart1
* регистр zzC перенесён на r22, fromram2 на r18 из-за конфликта в start.inc

4.35 19.01.2021
-------------------------------------------------------------------------------------------------------------
* исправлены ошибки в port.inc
+ добавлена начальная инициализация памяти нулями

4.34 18.01.2021
-------------------------------------------------------------------------------------------------------------
* переписана обработка ESC-посл., добавлены новые
* bios 3 ожидает ввода через PC-=2; ret
+ написаны базовые функции контроллера LAN
* немного переписана работа с портами
+ добавлена общая переменная CON_LAST_CHAR - заполняется при запросе символа через BIOS 3

4.32 03/01/2021
-------------------------------------------------------------------------------------------------------------
+ добавлена настройка энергосбережения настройкой PRR0
* переписана структура внтурненней адресации портов
* изменена структура RAM, добавлены внутренние порты (>f4) SVR, VAR, CAN, LAN, SPI, CMD
* SVRAM вынесено в отдельный файл svideo.inc, грузится вместе с pots.inc
+ добавлен макроc stw зеркальный к ldw
* ф-ции BCD_to_HEX HEX_to_BCD перенесены в commons.inc
+ в ports.def добавлены макросы sysportin, sysportout для доступа к регистрам CPD
+ добавлена структура данных 256 байт, доступная через порты ввода/вывода
+ добавлена структура данных 128 байт для универсального доступа к SPI-устройствам

4.31
-------------------------------------------------------------------------------------------------------------
+ добавлена инициализация LAN
* extirq перенесено на 0x07000
* BDOS, BIOS, PORTS перенесено на 0x7200
* WELCOME, TOOLS перенесено на 0x8800
* SD перенесено на 0x9000
* Ethernet перенесено на 0x9400
* DEBUG перенесено на 0xb000
* startup messages перенесено на 0xc000
* sd_cmd перенесено на 0xc200
* HW compatibility layer перенесено на 0xc300
* CtrlAltDel перенесено на 0xc600
* z80 перенесено на 0xd000
