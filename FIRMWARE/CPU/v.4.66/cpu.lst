
AVRASM ver. 2.1.42  cpu.asm Tue Oct 17 17:26:33 2023

cpu.asm(1): Including file 'C:\Program Files (x86)\Atmel\AVR Tools\AvrAssembler2\Appnotes\m1284def.inc'
cpu.asm(3): Including file 'flags.def'
cpu.asm(4): Including file 'macro.def'
cpu.asm(5): Including file 'regs.def'
regs.def(44): warning: Register r28 already defined by the .DEF directive
cpu.asm(5): 'regs.def' included form here
regs.def(45): warning: Register r29 already defined by the .DEF directive
cpu.asm(5): 'regs.def' included form here
regs.def(49): warning: Register r21 already defined by the .DEF directive
cpu.asm(5): 'regs.def' included form here
cpu.asm(6): Including file 'commons.def'
cpu.asm(7): Including file 'bios.def'
cpu.asm(8): Including file 'bdos.def'
cpu.asm(32): Including file 'spi.def'
cpu.asm(33): Including file 'lan.def'
cpu.asm(34): Including file 'lan_local.def'
cpu.asm(35): Including file 'can.def'
cpu.asm(36): Including file 'clr.def'
cpu.asm(94): Including file 'z80.def'
cpu.asm(95): Including file 'ports.def'
cpu.asm(97): Including file 'debug.def'
cpu.asm(123): Including file 'z80/z80_asm_cseg.asm'
cpu.asm(137): Including file 'extirq.inc'
cpu.asm(157): Including file 'bios.inc'
bios.inc(1381): Including file 'bios_sc.inc'
bios.inc(1382): Including file 'bios_attr.inc'
bios.inc(1383): Including file 'bios_esc.inc'
bios.inc(1384): Including file 'bios_mice.inc'
cpu.asm(162): Including file 'bdos.inc'
cpu.asm(167): Including file 'ports.inc'
cpu.asm(180): Including file 'init.inc'
cpu.asm(181): Including file 'z80init.inc'
cpu.asm(186): Including file 'commons.inc'
cpu.asm(191): Including file 'start.inc'
cpu.asm(194): Including file 'start_msg.inc'
cpu.asm(195): Including file 'bios_mice_data.inc'
cpu.asm(196): Including file 'bios_misc_data.inc'
cpu.asm(204): Including file 'sd.inc'
cpu.asm(211): Including file 'lan.inc'
lan.inc(1351): warning: Use of undefined or forward referenced symbol 'LAN3_BUF' in .equ/.set
cpu.asm(211): 'lan.inc' included form here
lan.inc(1405): warning: Use of undefined or forward referenced symbol 'LAN2_BUF' in .equ/.set
cpu.asm(211): 'lan.inc' included form here
cpu.asm(217): Including file 'can.inc'
cpu.asm(222): Including file 'debug.inc'
cpu.asm(223): Including file 'debug_z80.inc'
cpu.asm(228): Including file 'eeprom.inc'
cpu.asm(229): Including file 'rtc.inc'
cpu.asm(234): Including file 'clr.inc'
cpu.asm(244): Including file 'hw_layer.inc'
hw_layer.inc(138): Including file 'hw_0_criss.inc'
hw_layer.inc(139): Including file 'hw_1_r1715.inc'
hw_layer.inc(140): Including file 'hw_2_r1715en.inc'
hw_layer.inc(141): Including file 'hw_3_kaypro.inc'
hw_layer.inc(142): Including file 'hw_4_trs80.inc'
hw_layer.inc(143): Including file 'hw_6_vt100.inc'
cpu.asm(248): Including file 'user_port_fe.inc'
cpu.asm(252): Including file 'float.asm'
float.asm(235): Including file 'flb2.asm'
cpu.asm(260): Including file 'CtrlAltDel.inc'
cpu.asm(269): Including file 'z80/z80_asm_ecseg.asm'
cpu.asm(274): Including file 'z80/z80_asm_pftdata.asm'
cpu.asm(275): Including file 'z80/z80_flagtranslate.asm'
cpu.asm(276): Including file 'z80/z80_daadata.asm'
cpu.asm(282): Including file 'ram.def'
ram.def(204): Including file 'z80/z80_asm_dseg.asm'
                 
                 
                 
                 ;***** Created: 2011-08-25 20:59 ******* Source: ATmega1284.xml **********
                 ;*************************************************************************
                 ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
                 ;* 
                 ;* Number            : AVR000
                 ;* File Name         : "m1284def.inc"
                 ;* Title             : Register/Bit Definitions for the ATmega1284
                 ;* Date              : 2011-08-25
                 ;* Version           : 2.35
                 ;* Support E-mail    : avr@atmel.com
                 ;* Target MCU        : ATmega1284
                 ;* 
                 ;* DESCRIPTION
                 ;* When including this file in the assembly program file, all I/O register 
                 ;* names and I/O register bit names appearing in the data book can be used.
                 ;* In addition, the six registers forming the three data pointers X, Y and 
                 ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
                 ;* SRAM is also defined 
                 ;* 
                 ;* The Register names are represented by their hexadecimal address.
                 ;* 
                 ;* The Register Bit names are represented by their bit number (0-7).
                 ;* 
                 ;* Please observe the difference in using the bit names with instructions
                 ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
                 ;* (skip if bit in register set/cleared). The following example illustrates
                 ;* this:
                 ;* 
                 ;* in    r16,PORTB             ;read PORTB latch
                 ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
                 ;* out   PORTB,r16             ;output to PORTB
                 ;* 
                 ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
                 ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
                 ;* rjmp  TOV0_is_set           ;jump if set
                 ;* ...                         ;otherwise do something else
                 ;*************************************************************************
                 
                 #ifndef _M1284DEF_INC_
                 #define _M1284DEF_INC_
                 
                 
                 #pragma partinc 0
                 
                 ; ***** SPECIFY DEVICE ***************************************************
                 .device ATmega1284
                 #pragma AVRPART ADMIN PART_NAME ATmega1284
                 .equ	SIGNATURE_000	= 0x1e
                 .equ	SIGNATURE_001	= 0x97
                 .equ	SIGNATURE_002	= 0x06
                 
                 #pragma AVRPART CORE CORE_VERSION V2E
                 
                 
                 ; ***** I/O REGISTER DEFINITIONS *****************************************
                 ; NOTE:
                 ; Definitions marked "MEMORY MAPPED"are extended I/O ports
                 ; and cannot be used with IN/OUT instructions
                 .equ	UDR1	= 0xce	; MEMORY MAPPED
                 .equ	UBRR1L	= 0xcc	; MEMORY MAPPED
                 .equ	UBRR1H	= 0xcd	; MEMORY MAPPED
                 .equ	UCSR1C	= 0xca	; MEMORY MAPPED
                 .equ	UCSR1B	= 0xc9	; MEMORY MAPPED
                 .equ	UCSR1A	= 0xc8	; MEMORY MAPPED
                 .equ	UDR0	= 0xc6	; MEMORY MAPPED
                 .equ	UBRR0L	= 0xc4	; MEMORY MAPPED
                 .equ	UBRR0H	= 0xc5	; MEMORY MAPPED
                 .equ	UCSR0C	= 0xc2	; MEMORY MAPPED
                 .equ	UCSR0B	= 0xc1	; MEMORY MAPPED
                 .equ	UCSR0A	= 0xc0	; MEMORY MAPPED
                 .equ	TWAMR	= 0xbd	; MEMORY MAPPED
                 .equ	TWCR	= 0xbc	; MEMORY MAPPED
                 .equ	TWDR	= 0xbb	; MEMORY MAPPED
                 .equ	TWAR	= 0xba	; MEMORY MAPPED
                 .equ	TWSR	= 0xb9	; MEMORY MAPPED
                 .equ	TWBR	= 0xb8	; MEMORY MAPPED
                 .equ	ASSR	= 0xb6	; MEMORY MAPPED
                 .equ	OCR2B	= 0xb4	; MEMORY MAPPED
                 .equ	OCR2A	= 0xb3	; MEMORY MAPPED
                 .equ	TCNT2	= 0xb2	; MEMORY MAPPED
                 .equ	TCCR2B	= 0xb1	; MEMORY MAPPED
                 .equ	TCCR2A	= 0xb0	; MEMORY MAPPED
                 .equ	OCR3BL	= 0x9a	; MEMORY MAPPED
                 .equ	OCR3BH	= 0x9b	; MEMORY MAPPED
                 .equ	OCR3AL	= 0x98	; MEMORY MAPPED
                 .equ	OCR3AH	= 0x99	; MEMORY MAPPED
                 .equ	ICR3L	= 0x96	; MEMORY MAPPED
                 .equ	ICR3H	= 0x97	; MEMORY MAPPED
                 .equ	TCNT3L	= 0x94	; MEMORY MAPPED
                 .equ	TCNT3H	= 0x95	; MEMORY MAPPED
                 .equ	TCCR3C	= 0x92	; MEMORY MAPPED
                 .equ	TCCR3B	= 0x91	; MEMORY MAPPED
                 .equ	TCCR3A	= 0x90	; MEMORY MAPPED
                 .equ	OCR1BL	= 0x8a	; MEMORY MAPPED
                 .equ	OCR1BH	= 0x8b	; MEMORY MAPPED
                 .equ	OCR1AL	= 0x88	; MEMORY MAPPED
                 .equ	OCR1AH	= 0x89	; MEMORY MAPPED
                 .equ	ICR1L	= 0x86	; MEMORY MAPPED
                 .equ	ICR1H	= 0x87	; MEMORY MAPPED
                 .equ	TCNT1L	= 0x84	; MEMORY MAPPED
                 .equ	TCNT1H	= 0x85	; MEMORY MAPPED
                 .equ	TCCR1C	= 0x82	; MEMORY MAPPED
                 .equ	TCCR1B	= 0x81	; MEMORY MAPPED
                 .equ	TCCR1A	= 0x80	; MEMORY MAPPED
                 .equ	DIDR1	= 0x7f	; MEMORY MAPPED
                 .equ	DIDR0	= 0x7e	; MEMORY MAPPED
                 .equ	ADMUX	= 0x7c	; MEMORY MAPPED
                 .equ	ADCSRB	= 0x7b	; MEMORY MAPPED
                 .equ	ADCSRA	= 0x7a	; MEMORY MAPPED
                 .equ	ADCH	= 0x79	; MEMORY MAPPED
                 .equ	ADCL	= 0x78	; MEMORY MAPPED
                 .equ	PCMSK3	= 0x73	; MEMORY MAPPED
                 .equ	TIMSK3	= 0x71	; MEMORY MAPPED
                 .equ	TIMSK2	= 0x70	; MEMORY MAPPED
                 .equ	TIMSK1	= 0x6f	; MEMORY MAPPED
                 .equ	TIMSK0	= 0x6e	; MEMORY MAPPED
                 .equ	PCMSK2	= 0x6d	; MEMORY MAPPED
                 .equ	PCMSK1	= 0x6c	; MEMORY MAPPED
                 .equ	PCMSK0	= 0x6b	; MEMORY MAPPED
                 .equ	EICRA	= 0x69	; MEMORY MAPPED
                 .equ	PCICR	= 0x68	; MEMORY MAPPED
                 .equ	OSCCAL	= 0x66	; MEMORY MAPPED
                 .equ	PRR1	= 0x65	; MEMORY MAPPED
                 .equ	PRR0	= 0x64	; MEMORY MAPPED
                 .equ	CLKPR	= 0x61	; MEMORY MAPPED
                 .equ	WDTCSR	= 0x60	; MEMORY MAPPED
                 .equ	SREG	= 0x3f
                 .equ	SPL	= 0x3d
                 .equ	SPH	= 0x3e
                 .equ	RAMPZ	= 0x3b
                 .equ	SPMCSR	= 0x37
                 .equ	MCUCR	= 0x35
                 .equ	MCUSR	= 0x34
                 .equ	SMCR	= 0x33
                 .equ	OCDR	= 0x31
                 .equ	ACSR	= 0x30
                 .equ	SPDR	= 0x2e
                 .equ	SPSR	= 0x2d
                 .equ	SPCR	= 0x2c
                 .equ	GPIOR2	= 0x2b
                 .equ	GPIOR1	= 0x2a
                 .equ	OCR0B	= 0x28
                 .equ	OCR0A	= 0x27
                 .equ	TCNT0	= 0x26
                 .equ	TCCR0B	= 0x25
                 .equ	TCCR0A	= 0x24
                 .equ	GTCCR	= 0x23
                 .equ	EEARH	= 0x22
                 .equ	EEARL	= 0x21
                 .equ	EEDR	= 0x20
                 .equ	EECR	= 0x1f
                 .equ	GPIOR0	= 0x1e
                 .equ	EIMSK	= 0x1d
                 .equ	EIFR	= 0x1c
                 .equ	PCIFR	= 0x1b
                 .equ	TIFR3	= 0x18
                 .equ	TIFR2	= 0x17
                 .equ	TIFR1	= 0x16
                 .equ	TIFR0	= 0x15
                 .equ	PORTD	= 0x0b
                 .equ	DDRD	= 0x0a
                 .equ	PIND	= 0x09
                 .equ	PORTC	= 0x08
                 .equ	DDRC	= 0x07
                 .equ	PINC	= 0x06
                 .equ	PORTB	= 0x05
                 .equ	DDRB	= 0x04
                 .equ	PINB	= 0x03
                 .equ	PORTA	= 0x02
                 .equ	DDRA	= 0x01
                 .equ	PINA	= 0x00
                 
                 
                 ; ***** BIT DEFINITIONS **************************************************
                 
                 ; ***** ANALOG_COMPARATOR ************
                 ; ADCSRB - ADC Control and Status Register B
                 .equ	ACME	= 6	; Analog Comparator Multiplexer Enable
                 
                 ; ACSR - Analog Comparator Control And Status Register
                 .equ	ACIS0	= 0	; Analog Comparator Interrupt Mode Select bit 0
                 .equ	ACIS1	= 1	; Analog Comparator Interrupt Mode Select bit 1
                 .equ	ACIC	= 2	; Analog Comparator Input Capture Enable
                 .equ	ACIE	= 3	; Analog Comparator Interrupt Enable
                 .equ	ACI	= 4	; Analog Comparator Interrupt Flag
                 .equ	ACO	= 5	; Analog Compare Output
                 .equ	ACBG	= 6	; Analog Comparator Bandgap Select
                 .equ	ACD	= 7	; Analog Comparator Disable
                 
                 ; DIDR1 - Digital Input Disable Register 1
                 .equ	AIN0D	= 0	; AIN0 Digital Input Disable
                 .equ	AIN1D	= 1	; AIN1 Digital Input Disable
                 
                 
                 ; ***** USART0 ***********************
                 ; UDR0 - USART I/O Data Register
                 .equ	UDR0_0	= 0	; USART I/O Data Register bit 0
                 .equ	UDR0_1	= 1	; USART I/O Data Register bit 1
                 .equ	UDR0_2	= 2	; USART I/O Data Register bit 2
                 .equ	UDR0_3	= 3	; USART I/O Data Register bit 3
                 .equ	UDR0_4	= 4	; USART I/O Data Register bit 4
                 .equ	UDR0_5	= 5	; USART I/O Data Register bit 5
                 .equ	UDR0_6	= 6	; USART I/O Data Register bit 6
                 .equ	UDR0_7	= 7	; USART I/O Data Register bit 7
                 
                 ; UCSR0A - USART Control and Status Register A
                 .equ	MPCM0	= 0	; Multi-processor Communication Mode
                 .equ	U2X0	= 1	; Double the USART transmission speed
                 .equ	UPE0	= 2	; Parity Error
                 .equ	DOR0	= 3	; Data overRun
                 .equ	FE0	= 4	; Framing Error
                 .equ	UDRE0	= 5	; USART Data Register Empty
                 .equ	TXC0	= 6	; USART Transmitt Complete
                 .equ	RXC0	= 7	; USART Receive Complete
                 
                 ; UCSR0B - USART Control and Status Register B
                 .equ	TXB80	= 0	; Transmit Data Bit 8
                 .equ	RXB80	= 1	; Receive Data Bit 8
                 .equ	UCSZ02	= 2	; Character Size
                 .equ	TXEN0	= 3	; Transmitter Enable
                 .equ	RXEN0	= 4	; Receiver Enable
                 .equ	UDRIE0	= 5	; USART Data register Empty Interrupt Enable
                 .equ	TXCIE0	= 6	; TX Complete Interrupt Enable
                 .equ	RXCIE0	= 7	; RX Complete Interrupt Enable
                 
                 ; UCSR0C - USART Control and Status Register C
                 .equ	UCPOL0	= 0	; Clock Polarity
                 .equ	UCSZ00	= 1	; Character Size
                 .equ	UCPHA0	= UCSZ00	; For compatibility
                 .equ	UCSZ01	= 2	; Character Size
                 .equ	UDORD0	= UCSZ01	; For compatibility
                 .equ	USBS0	= 3	; Stop Bit Select
                 .equ	UPM00	= 4	; Parity Mode Bit 0
                 .equ	UPM01	= 5	; Parity Mode Bit 1
                 .equ	UMSEL00	= 6	; USART Mode Select
                 .equ	UMSEL0	= UMSEL00	; For compatibility
                 .equ	UMSEL01	= 7	; USART Mode Select
                 .equ	UMSEL1	= UMSEL01	; For compatibility
                 
                 ; UBRR0H - USART Baud Rate Register High Byte
                 .equ	UBRR8	= 0	; USART Baud Rate Register bit 8
                 .equ	UBRR9	= 1	; USART Baud Rate Register bit 9
                 .equ	UBRR10	= 2	; USART Baud Rate Register bit 10
                 .equ	UBRR11	= 3	; USART Baud Rate Register bit 11
                 
                 ; UBRR0L - USART Baud Rate Register Low Byte
                 .equ	_UBRR0	= 0	; USART Baud Rate Register bit 0
                 .equ	_UBRR1	= 1	; USART Baud Rate Register bit 1
                 .equ	UBRR2	= 2	; USART Baud Rate Register bit 2
                 .equ	UBRR3	= 3	; USART Baud Rate Register bit 3
                 .equ	UBRR4	= 4	; USART Baud Rate Register bit 4
                 .equ	UBRR5	= 5	; USART Baud Rate Register bit 5
                 .equ	UBRR6	= 6	; USART Baud Rate Register bit 6
                 .equ	UBRR7	= 7	; USART Baud Rate Register bit 7
                 
                 
                 ; ***** PORTA ************************
                 ; PORTA - Port A Data Register
                 .equ	PORTA0	= 0	; Port A Data Register bit 0
                 .equ	PA0	= 0	; For compatibility
                 .equ	PORTA1	= 1	; Port A Data Register bit 1
                 .equ	PA1	= 1	; For compatibility
                 .equ	PORTA2	= 2	; Port A Data Register bit 2
                 .equ	PA2	= 2	; For compatibility
                 .equ	PORTA3	= 3	; Port A Data Register bit 3
                 .equ	PA3	= 3	; For compatibility
                 .equ	PORTA4	= 4	; Port A Data Register bit 4
                 .equ	PA4	= 4	; For compatibility
                 .equ	PORTA5	= 5	; Port A Data Register bit 5
                 .equ	PA5	= 5	; For compatibility
                 .equ	PORTA6	= 6	; Port A Data Register bit 6
                 .equ	PA6	= 6	; For compatibility
                 .equ	PORTA7	= 7	; Port A Data Register bit 7
                 .equ	PA7	= 7	; For compatibility
                 
                 ; DDRA - Port A Data Direction Register
                 .equ	DDA0	= 0	; Data Direction Register, Port A, bit 0
                 .equ	DDA1	= 1	; Data Direction Register, Port A, bit 1
                 .equ	DDA2	= 2	; Data Direction Register, Port A, bit 2
                 .equ	DDA3	= 3	; Data Direction Register, Port A, bit 3
                 .equ	DDA4	= 4	; Data Direction Register, Port A, bit 4
                 .equ	DDA5	= 5	; Data Direction Register, Port A, bit 5
                 .equ	DDA6	= 6	; Data Direction Register, Port A, bit 6
                 .equ	DDA7	= 7	; Data Direction Register, Port A, bit 7
                 
                 ; PINA - Port A Input Pins
                 .equ	PINA0	= 0	; Input Pins, Port A bit 0
                 .equ	PINA1	= 1	; Input Pins, Port A bit 1
                 .equ	PINA2	= 2	; Input Pins, Port A bit 2
                 .equ	PINA3	= 3	; Input Pins, Port A bit 3
                 .equ	PINA4	= 4	; Input Pins, Port A bit 4
                 .equ	PINA5	= 5	; Input Pins, Port A bit 5
                 .equ	PINA6	= 6	; Input Pins, Port A bit 6
                 .equ	PINA7	= 7	; Input Pins, Port A bit 7
                 
                 
                 ; ***** PORTB ************************
                 ; PORTB - Port B Data Register
                 .equ	PORTB0	= 0	; Port B Data Register bit 0
                 .equ	PB0	= 0	; For compatibility
                 .equ	PORTB1	= 1	; Port B Data Register bit 1
                 .equ	PB1	= 1	; For compatibility
                 .equ	PORTB2	= 2	; Port B Data Register bit 2
                 .equ	PB2	= 2	; For compatibility
                 .equ	PORTB3	= 3	; Port B Data Register bit 3
                 .equ	PB3	= 3	; For compatibility
                 .equ	PORTB4	= 4	; Port B Data Register bit 4
                 .equ	PB4	= 4	; For compatibility
                 .equ	PORTB5	= 5	; Port B Data Register bit 5
                 .equ	PB5	= 5	; For compatibility
                 .equ	PORTB6	= 6	; Port B Data Register bit 6
                 .equ	PB6	= 6	; For compatibility
                 .equ	PORTB7	= 7	; Port B Data Register bit 7
                 .equ	PB7	= 7	; For compatibility
                 
                 ; DDRB - Port B Data Direction Register
                 .equ	DDB0	= 0	; Port B Data Direction Register bit 0
                 .equ	DDB1	= 1	; Port B Data Direction Register bit 1
                 .equ	DDB2	= 2	; Port B Data Direction Register bit 2
                 .equ	DDB3	= 3	; Port B Data Direction Register bit 3
                 .equ	DDB4	= 4	; Port B Data Direction Register bit 4
                 .equ	DDB5	= 5	; Port B Data Direction Register bit 5
                 .equ	DDB6	= 6	; Port B Data Direction Register bit 6
                 .equ	DDB7	= 7	; Port B Data Direction Register bit 7
                 
                 ; PINB - Port B Input Pins
                 .equ	PINB0	= 0	; Port B Input Pins bit 0
                 .equ	PINB1	= 1	; Port B Input Pins bit 1
                 .equ	PINB2	= 2	; Port B Input Pins bit 2
                 .equ	PINB3	= 3	; Port B Input Pins bit 3
                 .equ	PINB4	= 4	; Port B Input Pins bit 4
                 .equ	PINB5	= 5	; Port B Input Pins bit 5
                 .equ	PINB6	= 6	; Port B Input Pins bit 6
                 .equ	PINB7	= 7	; Port B Input Pins bit 7
                 
                 
                 ; ***** PORTC ************************
                 ; PORTC - Port C Data Register
                 .equ	PORTC0	= 0	; Port C Data Register bit 0
                 .equ	PC0	= 0	; For compatibility
                 .equ	PORTC1	= 1	; Port C Data Register bit 1
                 .equ	PC1	= 1	; For compatibility
                 .equ	PORTC2	= 2	; Port C Data Register bit 2
                 .equ	PC2	= 2	; For compatibility
                 .equ	PORTC3	= 3	; Port C Data Register bit 3
                 .equ	PC3	= 3	; For compatibility
                 .equ	PORTC4	= 4	; Port C Data Register bit 4
                 .equ	PC4	= 4	; For compatibility
                 .equ	PORTC5	= 5	; Port C Data Register bit 5
                 .equ	PC5	= 5	; For compatibility
                 .equ	PORTC6	= 6	; Port C Data Register bit 6
                 .equ	PC6	= 6	; For compatibility
                 .equ	PORTC7	= 7	; Port C Data Register bit 7
                 .equ	PC7	= 7	; For compatibility
                 
                 ; DDRC - Port C Data Direction Register
                 .equ	DDC0	= 0	; Port C Data Direction Register bit 0
                 .equ	DDC1	= 1	; Port C Data Direction Register bit 1
                 .equ	DDC2	= 2	; Port C Data Direction Register bit 2
                 .equ	DDC3	= 3	; Port C Data Direction Register bit 3
                 .equ	DDC4	= 4	; Port C Data Direction Register bit 4
                 .equ	DDC5	= 5	; Port C Data Direction Register bit 5
                 .equ	DDC6	= 6	; Port C Data Direction Register bit 6
                 .equ	DDC7	= 7	; Port C Data Direction Register bit 7
                 
                 ; PINC - Port C Input Pins
                 .equ	PINC0	= 0	; Port C Input Pins bit 0
                 .equ	PINC1	= 1	; Port C Input Pins bit 1
                 .equ	PINC2	= 2	; Port C Input Pins bit 2
                 .equ	PINC3	= 3	; Port C Input Pins bit 3
                 .equ	PINC4	= 4	; Port C Input Pins bit 4
                 .equ	PINC5	= 5	; Port C Input Pins bit 5
                 .equ	PINC6	= 6	; Port C Input Pins bit 6
                 .equ	PINC7	= 7	; Port C Input Pins bit 7
                 
                 
                 ; ***** PORTD ************************
                 ; PORTD - Port D Data Register
                 .equ	PORTD0	= 0	; Port D Data Register bit 0
                 .equ	PD0	= 0	; For compatibility
                 .equ	PORTD1	= 1	; Port D Data Register bit 1
                 .equ	PD1	= 1	; For compatibility
                 .equ	PORTD2	= 2	; Port D Data Register bit 2
                 .equ	PD2	= 2	; For compatibility
                 .equ	PORTD3	= 3	; Port D Data Register bit 3
                 .equ	PD3	= 3	; For compatibility
                 .equ	PORTD4	= 4	; Port D Data Register bit 4
                 .equ	PD4	= 4	; For compatibility
                 .equ	PORTD5	= 5	; Port D Data Register bit 5
                 .equ	PD5	= 5	; For compatibility
                 .equ	PORTD6	= 6	; Port D Data Register bit 6
                 .equ	PD6	= 6	; For compatibility
                 .equ	PORTD7	= 7	; Port D Data Register bit 7
                 .equ	PD7	= 7	; For compatibility
                 
                 ; DDRD - Port D Data Direction Register
                 .equ	DDD0	= 0	; Port D Data Direction Register bit 0
                 .equ	DDD1	= 1	; Port D Data Direction Register bit 1
                 .equ	DDD2	= 2	; Port D Data Direction Register bit 2
                 .equ	DDD3	= 3	; Port D Data Direction Register bit 3
                 .equ	DDD4	= 4	; Port D Data Direction Register bit 4
                 .equ	DDD5	= 5	; Port D Data Direction Register bit 5
                 .equ	DDD6	= 6	; Port D Data Direction Register bit 6
                 .equ	DDD7	= 7	; Port D Data Direction Register bit 7
                 
                 ; PIND - Port D Input Pins
                 .equ	PIND0	= 0	; Port D Input Pins bit 0
                 .equ	PIND1	= 1	; Port D Input Pins bit 1
                 .equ	PIND2	= 2	; Port D Input Pins bit 2
                 .equ	PIND3	= 3	; Port D Input Pins bit 3
                 .equ	PIND4	= 4	; Port D Input Pins bit 4
                 .equ	PIND5	= 5	; Port D Input Pins bit 5
                 .equ	PIND6	= 6	; Port D Input Pins bit 6
                 .equ	PIND7	= 7	; Port D Input Pins bit 7
                 
                 
                 ; ***** TIMER_COUNTER_0 **************
                 ; TIMSK0 - Timer/Counter0 Interrupt Mask Register
                 .equ	TOIE0	= 0	; Timer/Counter0 Overflow Interrupt Enable
                 .equ	OCIE0A	= 1	; Timer/Counter0 Output Compare Match A Interrupt Enable
                 .equ	OCIE0B	= 2	; Timer/Counter0 Output Compare Match B Interrupt Enable
                 
                 ; TIFR0 - Timer/Counter0 Interrupt Flag register
                 .equ	TOV0	= 0	; Timer/Counter0 Overflow Flag
                 .equ	OCF0A	= 1	; Timer/Counter0 Output Compare Flag 0A
                 .equ	OCF0B	= 2	; Timer/Counter0 Output Compare Flag 0B
                 
                 ; TCCR0A - Timer/Counter  Control Register A
                 .equ	WGM00	= 0	; Waveform Generation Mode
                 .equ	WGM01	= 1	; Waveform Generation Mode
                 .equ	COM0B0	= 4	; Compare Output Mode, Fast PWm
                 .equ	COM0B1	= 5	; Compare Output Mode, Fast PWm
                 .equ	COM0A0	= 6	; Compare Output Mode, Phase Correct PWM Mode
                 .equ	COM0A1	= 7	; Compare Output Mode, Phase Correct PWM Mode
                 
                 ; TCCR0B - Timer/Counter Control Register B
                 .equ	CS00	= 0	; Clock Select
                 .equ	CS01	= 1	; Clock Select
                 .equ	CS02	= 2	; Clock Select
                 .equ	WGM02	= 3	; 
                 .equ	FOC0B	= 6	; Force Output Compare B
                 .equ	FOC0A	= 7	; Force Output Compare A
                 
                 ; TCNT0 - Timer/Counter0
                 .equ	TCNT0_0	= 0	; 
                 .equ	TCNT0_1	= 1	; 
                 .equ	TCNT0_2	= 2	; 
                 .equ	TCNT0_3	= 3	; 
                 .equ	TCNT0_4	= 4	; 
                 .equ	TCNT0_5	= 5	; 
                 .equ	TCNT0_6	= 6	; 
                 .equ	TCNT0_7	= 7	; 
                 
                 ; OCR0A - Timer/Counter0 Output Compare Register
                 .equ	OCR0A_0	= 0	; 
                 .equ	OCR0A_1	= 1	; 
                 .equ	OCR0A_2	= 2	; 
                 .equ	OCR0A_3	= 3	; 
                 .equ	OCR0A_4	= 4	; 
                 .equ	OCR0A_5	= 5	; 
                 .equ	OCR0A_6	= 6	; 
                 .equ	OCR0A_7	= 7	; 
                 
                 ; OCR0B - Timer/Counter0 Output Compare Register
                 .equ	OCR0B_0	= 0	; 
                 .equ	OCR0B_1	= 1	; 
                 .equ	OCR0B_2	= 2	; 
                 .equ	OCR0B_3	= 3	; 
                 .equ	OCR0B_4	= 4	; 
                 .equ	OCR0B_5	= 5	; 
                 .equ	OCR0B_6	= 6	; 
                 .equ	OCR0B_7	= 7	; 
                 
                 ; GTCCR - General Timer/Counter Control Register
                 .equ	PSRSYNC	= 0	; Prescaler Reset Timer/Counter1 and Timer/Counter0
                 .equ	PSR10	= PSRSYNC	; For compatibility
                 .equ	TSM	= 7	; Timer/Counter Synchronization Mode
                 
                 
                 ; ***** TIMER_COUNTER_1 **************
                 ; TIMSK1 - Timer/Counter1 Interrupt Mask Register
                 .equ	TOIE1	= 0	; Timer/Counter1 Overflow Interrupt Enable
                 .equ	OCIE1A	= 1	; Timer/Counter1 Output Compare A Match Interrupt Enable
                 .equ	OCIE1B	= 2	; Timer/Counter1 Output Compare B Match Interrupt Enable
                 .equ	ICIE1	= 5	; Timer/Counter1 Input Capture Interrupt Enable
                 
                 ; TIFR1 - Timer/Counter Interrupt Flag register
                 .equ	TOV1	= 0	; Timer/Counter1 Overflow Flag
                 .equ	OCF1A	= 1	; Timer/Counter1 Output Compare A Match Flag
                 .equ	OCF1B	= 2	; Timer/Counter1 Output Compare B Match Flag
                 .equ	ICF1	= 5	; Timer/Counter1 Input Capture Flag
                 
                 ; TCCR1A - Timer/Counter1 Control Register A
                 .equ	WGM10	= 0	; Pulse Width Modulator Select Bit 0
                 .equ	PWM10	= WGM10	; For compatibility
                 .equ	WGM11	= 1	; Pulse Width Modulator Select Bit 1
                 .equ	PWM11	= WGM11	; For compatibility
                 .equ	COM1B0	= 4	; Comparet Ouput Mode 1B, bit 0
                 .equ	COM1B1	= 5	; Compare Output Mode 1B, bit 1
                 .equ	COM1A0	= 6	; Comparet Ouput Mode 1A, bit 0
                 .equ	COM1A1	= 7	; Compare Output Mode 1A, bit 1
                 
                 ; TCCR1B - Timer/Counter1 Control Register B
                 .equ	CS10	= 0	; Clock Select bit 0
                 .equ	CS11	= 1	; Clock Select 1 bit 1
                 .equ	CS12	= 2	; Clock Select1 bit 2
                 .equ	WGM12	= 3	; Waveform Generation Mode Bit 2
                 .equ	CTC1	= WGM12	; For compatibility
                 .equ	WGM13	= 4	; Waveform Generation Mode Bit 3
                 .equ	ICES1	= 6	; Input Capture 1 Edge Select
                 .equ	ICNC1	= 7	; Input Capture 1 Noise Canceler
                 
                 ; TCCR1C - Timer/Counter1 Control Register C
                 .equ	FOC1B	= 6	; Force Output Compare for Channel B
                 .equ	FOC1A	= 7	; Force Output Compare for Channel A
                 
                 
                 ; ***** TIMER_COUNTER_2 **************
                 ; TIMSK2 - Timer/Counter Interrupt Mask register
                 .equ	TOIE2	= 0	; Timer/Counter2 Overflow Interrupt Enable
                 .equ	TOIE2A	= TOIE2	; For compatibility
                 .equ	OCIE2A	= 1	; Timer/Counter2 Output Compare Match A Interrupt Enable
                 .equ	OCIE2B	= 2	; Timer/Counter2 Output Compare Match B Interrupt Enable
                 
                 ; TIFR2 - Timer/Counter Interrupt Flag Register
                 .equ	TOV2	= 0	; Timer/Counter2 Overflow Flag
                 .equ	OCF2A	= 1	; Output Compare Flag 2A
                 .equ	OCF2B	= 2	; Output Compare Flag 2B
                 
                 ; TCCR2A - Timer/Counter2 Control Register A
                 .equ	WGM20	= 0	; Waveform Genration Mode
                 .equ	WGM21	= 1	; Waveform Genration Mode
                 .equ	COM2B0	= 4	; Compare Output Mode bit 0
                 .equ	COM2B1	= 5	; Compare Output Mode bit 1
                 .equ	COM2A0	= 6	; Compare Output Mode bit 1
                 .equ	COM2A1	= 7	; Compare Output Mode bit 1
                 
                 ; TCCR2B - Timer/Counter2 Control Register B
                 .equ	CS20	= 0	; Clock Select bit 0
                 .equ	CS21	= 1	; Clock Select bit 1
                 .equ	CS22	= 2	; Clock Select bit 2
                 .equ	WGM22	= 3	; Waveform Generation Mode
                 .equ	FOC2B	= 6	; Force Output Compare B
                 .equ	FOC2A	= 7	; Force Output Compare A
                 
                 ; TCNT2 - Timer/Counter2
                 .equ	TCNT2_0	= 0	; Timer/Counter 2 bit 0
                 .equ	TCNT2_1	= 1	; Timer/Counter 2 bit 1
                 .equ	TCNT2_2	= 2	; Timer/Counter 2 bit 2
                 .equ	TCNT2_3	= 3	; Timer/Counter 2 bit 3
                 .equ	TCNT2_4	= 4	; Timer/Counter 2 bit 4
                 .equ	TCNT2_5	= 5	; Timer/Counter 2 bit 5
                 .equ	TCNT2_6	= 6	; Timer/Counter 2 bit 6
                 .equ	TCNT2_7	= 7	; Timer/Counter 2 bit 7
                 
                 ; OCR2A - Timer/Counter2 Output Compare Register A
                 .equ	OCR2A_0	= 0	; Timer/Counter2 Output Compare Register Bit 0
                 .equ	OCR2A_1	= 1	; Timer/Counter2 Output Compare Register Bit 1
                 .equ	OCR2A_2	= 2	; Timer/Counter2 Output Compare Register Bit 2
                 .equ	OCR2A_3	= 3	; Timer/Counter2 Output Compare Register Bit 3
                 .equ	OCR2A_4	= 4	; Timer/Counter2 Output Compare Register Bit 4
                 .equ	OCR2A_5	= 5	; Timer/Counter2 Output Compare Register Bit 5
                 .equ	OCR2A_6	= 6	; Timer/Counter2 Output Compare Register Bit 6
                 .equ	OCR2A_7	= 7	; Timer/Counter2 Output Compare Register Bit 7
                 
                 ; OCR2B - Timer/Counter2 Output Compare Register B
                 .equ	OCR2B_0	= 0	; Timer/Counter2 Output Compare Register Bit 0
                 .equ	OCR2B_1	= 1	; Timer/Counter2 Output Compare Register Bit 1
                 .equ	OCR2B_2	= 2	; Timer/Counter2 Output Compare Register Bit 2
                 .equ	OCR2B_3	= 3	; Timer/Counter2 Output Compare Register Bit 3
                 .equ	OCR2B_4	= 4	; Timer/Counter2 Output Compare Register Bit 4
                 .equ	OCR2B_5	= 5	; Timer/Counter2 Output Compare Register Bit 5
                 .equ	OCR2B_6	= 6	; Timer/Counter2 Output Compare Register Bit 6
                 .equ	OCR2B_7	= 7	; Timer/Counter2 Output Compare Register Bit 7
                 
                 ; ASSR - Asynchronous Status Register
                 .equ	TCR2BUB	= 0	; Timer/Counter Control Register2 Update Busy
                 .equ	TCR2AUB	= 1	; Timer/Counter Control Register2 Update Busy
                 .equ	OCR2BUB	= 2	; Output Compare Register 2 Update Busy
                 .equ	OCR2AUB	= 3	; Output Compare Register2 Update Busy
                 .equ	TCN2UB	= 4	; Timer/Counter2 Update Busy
                 .equ	AS2	= 5	; Asynchronous Timer/Counter2
                 .equ	EXCLK	= 6	; Enable External Clock Input
                 
                 ; GTCCR - General Timer Counter Control register
                 .equ	PSRASY	= 1	; Prescaler Reset Timer/Counter2
                 .equ	PSR2	= PSRASY	; For compatibility
                 ;.equ	TSM	= 7	; Timer/Counter Synchronization Mode
                 
                 
                 ; ***** TIMER_COUNTER_3 **************
                 ; TIMSK3 - Timer/Counter3 Interrupt Mask Register
                 .equ	TOIE3	= 0	; Timer/Counter3 Overflow Interrupt Enable
                 .equ	OCIE3A	= 1	; Timer/Counter3 Output Compare A Match Interrupt Enable
                 .equ	OCIE3B	= 2	; Timer/Counter3 Output Compare B Match Interrupt Enable
                 .equ	ICIE3	= 5	; Timer/Counter3 Input Capture Interrupt Enable
                 
                 ; TIFR3 - Timer/Counter Interrupt Flag register
                 .equ	TOV3	= 0	; Timer/Counter3 Overflow Flag
                 .equ	OCF3A	= 1	; Timer/Counter3 Output Compare A Match Flag
                 .equ	OCF3B	= 2	; Timer/Counter3 Output Compare B Match Flag
                 .equ	ICF3	= 5	; Timer/Counter3 Input Capture Flag
                 
                 ; TCCR3A - Timer/Counter3 Control Register A
                 .equ	WGM30	= 0	; Pulse Width Modulator Select Bit 0
                 .equ	WGM31	= 1	; Pulse Width Modulator Select Bit 1
                 .equ	COM3B0	= 4	; Comparet Ouput Mode 3B, bit 0
                 .equ	COM3B1	= 5	; Compare Output Mode 3B, bit 1
                 .equ	COM3A0	= 6	; Comparet Ouput Mode 3A, bit 0
                 .equ	COM3A1	= 7	; Compare Output Mode 3A, bit 1
                 
                 ; TCCR3B - Timer/Counter3 Control Register B
                 .equ	CS30	= 0	; Clock Select bit 0
                 .equ	CS31	= 1	; Clock Select 3 bit 1
                 .equ	CS32	= 2	; Clock Select3 bit 2
                 .equ	WGM32	= 3	; Waveform Generation Mode Bit 2
                 .equ	WGM33	= 4	; Waveform Generation Mode Bit 3
                 .equ	ICES3	= 6	; Input Capture 3 Edge Select
                 .equ	ICNC3	= 7	; Input Capture 3 Noise Canceler
                 
                 ; TCCR3C - Timer/Counter3 Control Register C
                 .equ	FOC3B	= 6	; Force Output Compare for Channel B
                 .equ	FOC3A	= 7	; Force Output Compare for Channel A
                 
                 ; OCR3BH - Timer/Counter3 Output Compare Register B High Byte
                 .equ	OCR3AH0	= 0	; Timer/Counter3 Output Compare Register High Byte bit 0
                 .equ	OCR3AH1	= 1	; Timer/Counter3 Output Compare Register High Byte bit 1
                 .equ	OCR3AH2	= 2	; Timer/Counter3 Output Compare Register High Byte bit 2
                 .equ	OCR3AH3	= 3	; Timer/Counter3 Output Compare Register High Byte bit 3
                 .equ	OCR3AH4	= 4	; Timer/Counter3 Output Compare Register High Byte bit 4
                 .equ	OCR3AH5	= 5	; Timer/Counter3 Output Compare Register High Byte bit 5
                 .equ	OCR3AH6	= 6	; Timer/Counter3 Output Compare Register High Byte bit 6
                 .equ	OCR3AH7	= 7	; Timer/Counter3 Output Compare Register High Byte bit 7
                 
                 ; OCR3BL - Timer/Counter3 Output Compare Register B Low Byte
                 .equ	OCR3AL0	= 0	; Timer/Counter3 Output Compare Register Low Byte Bit 0
                 .equ	OCR3AL1	= 1	; Timer/Counter3 Output Compare Register Low Byte Bit 1
                 .equ	OCR3AL2	= 2	; Timer/Counter3 Output Compare Register Low Byte Bit 2
                 .equ	OCR3AL3	= 3	; Timer/Counter3 Output Compare Register Low Byte Bit 3
                 .equ	OCR3AL4	= 4	; Timer/Counter3 Output Compare Register Low Byte Bit 4
                 .equ	OCR3AL5	= 5	; Timer/Counter3 Output Compare Register Low Byte Bit 5
                 .equ	OCR3AL6	= 6	; Timer/Counter3 Output Compare Register Low Byte Bit 6
                 .equ	OCR3AL7	= 7	; Timer/Counter3 Output Compare Register Low Byte Bit 7
                 
                 
                 ; ***** BOOT_LOAD ********************
                 ; SPMCSR - Store Program Memory Control Register
                 .equ	SPMEN	= 0	; Store Program Memory Enable
                 .equ	PGERS	= 1	; Page Erase
                 .equ	PGWRT	= 2	; Page Write
                 .equ	BLBSET	= 3	; Boot Lock Bit Set
                 .equ	RWWSRE	= 4	; Read While Write section read enable
                 .equ	SIGRD	= 5	; Signature Row Read
                 .equ	RWWSB	= 6	; Read While Write Section Busy
                 .equ	SPMIE	= 7	; SPM Interrupt Enable
                 
                 
                 ; ***** EXTERNAL_INTERRUPT ***********
                 ; EICRA - External Interrupt Control Register A
                 .equ	ISC00	= 0	; External Interrupt Sense Control Bit
                 .equ	ISC01	= 1	; External Interrupt Sense Control Bit
                 .equ	ISC10	= 2	; External Interrupt Sense Control Bit
                 .equ	ISC11	= 3	; External Interrupt Sense Control Bit
                 .equ	ISC20	= 4	; External Interrupt Sense Control Bit
                 .equ	ISC21	= 5	; External Interrupt Sense Control Bit
                 
                 ; EIMSK - External Interrupt Mask Register
                 .equ	INT0	= 0	; External Interrupt Request 0 Enable
                 .equ	INT1	= 1	; External Interrupt Request 1 Enable
                 .equ	INT2	= 2	; External Interrupt Request 2 Enable
                 
                 ; EIFR - External Interrupt Flag Register
                 .equ	INTF0	= 0	; External Interrupt Flag 0
                 .equ	INTF1	= 1	; External Interrupt Flag 1
                 .equ	INTF2	= 2	; External Interrupt Flag 2
                 
                 ; PCICR - Pin Change Interrupt Control Register
                 .equ	PCIE0	= 0	; Pin Change Interrupt Enable 0
                 .equ	PCIE1	= 1	; Pin Change Interrupt Enable 1
                 .equ	PCIE2	= 2	; Pin Change Interrupt Enable 2
                 .equ	PCIE3	= 3	; Pin Change Interrupt Enable 3
                 
                 ; PCIFR - Pin Change Interrupt Flag Register
                 .equ	PCIF0	= 0	; Pin Change Interrupt Flag 0
                 .equ	PCIF1	= 1	; Pin Change Interrupt Flag 1
                 .equ	PCIF2	= 2	; Pin Change Interrupt Flag 2
                 .equ	PCIF3	= 3	; Pin Change Interrupt Flag 3
                 
                 ; PCMSK3 - Pin Change Mask Register 3
                 .equ	PCINT24	= 0	; Pin Change Enable Mask 24
                 .equ	PCINT25	= 1	; Pin Change Enable Mask 25
                 .equ	PCINT26	= 2	; Pin Change Enable Mask 26
                 .equ	PCINT27	= 3	; Pin Change Enable Mask 27
                 .equ	PCINT28	= 4	; Pin Change Enable Mask 28
                 .equ	PCINT29	= 5	; Pin Change Enable Mask 29
                 .equ	PCINT30	= 6	; Pin Change Enable Mask 30
                 .equ	PCINT31	= 7	; Pin Change Enable Mask 31
                 
                 ; PCMSK2 - Pin Change Mask Register 2
                 .equ	PCINT16	= 0	; Pin Change Enable Mask 16
                 .equ	PCINT17	= 1	; Pin Change Enable Mask 17
                 .equ	PCINT18	= 2	; Pin Change Enable Mask 18
                 .equ	PCINT19	= 3	; Pin Change Enable Mask 19
                 .equ	PCINT20	= 4	; Pin Change Enable Mask 20
                 .equ	PCINT21	= 5	; Pin Change Enable Mask 21
                 .equ	PCINT22	= 6	; Pin Change Enable Mask 22
                 .equ	PCINT23	= 7	; Pin Change Enable Mask 23
                 
                 ; PCMSK1 - Pin Change Mask Register 1
                 .equ	PCINT8	= 0	; Pin Change Enable Mask 8
                 .equ	PCINT9	= 1	; Pin Change Enable Mask 9
                 .equ	PCINT10	= 2	; Pin Change Enable Mask 10
                 .equ	PCINT11	= 3	; Pin Change Enable Mask 11
                 .equ	PCINT12	= 4	; Pin Change Enable Mask 12
                 .equ	PCINT13	= 5	; Pin Change Enable Mask 13
                 .equ	PCINT14	= 6	; Pin Change Enable Mask 14
                 .equ	PCINT15	= 7	; Pin Change Enable Mask 15
                 
                 ; PCMSK0 - Pin Change Mask Register 0
                 .equ	PCINT0	= 0	; Pin Change Enable Mask 0
                 .equ	PCINT1	= 1	; Pin Change Enable Mask 1
                 .equ	PCINT2	= 2	; Pin Change Enable Mask 2
                 .equ	PCINT3	= 3	; Pin Change Enable Mask 3
                 .equ	PCINT4	= 4	; Pin Change Enable Mask 4
                 .equ	PCINT5	= 5	; Pin Change Enable Mask 5
                 .equ	PCINT6	= 6	; Pin Change Enable Mask 6
                 .equ	PCINT7	= 7	; Pin Change Enable Mask 7
                 
                 
                 ; ***** AD_CONVERTER *****************
                 ; ADMUX - The ADC multiplexer Selection Register
                 .equ	MUX0	= 0	; Analog Channel and Gain Selection Bits
                 .equ	MUX1	= 1	; Analog Channel and Gain Selection Bits
                 .equ	MUX2	= 2	; Analog Channel and Gain Selection Bits
                 .equ	MUX3	= 3	; Analog Channel and Gain Selection Bits
                 .equ	MUX4	= 4	; Analog Channel and Gain Selection Bits
                 .equ	ADLAR	= 5	; Left Adjust Result
                 .equ	REFS0	= 6	; Reference Selection Bit 0
                 .equ	REFS1	= 7	; Reference Selection Bit 1
                 
                 ; ADCSRA - The ADC Control and Status register A
                 .equ	ADPS0	= 0	; ADC  Prescaler Select Bits
                 .equ	ADPS1	= 1	; ADC  Prescaler Select Bits
                 .equ	ADPS2	= 2	; ADC  Prescaler Select Bits
                 .equ	ADIE	= 3	; ADC Interrupt Enable
                 .equ	ADIF	= 4	; ADC Interrupt Flag
                 .equ	ADATE	= 5	; ADC  Auto Trigger Enable
                 .equ	ADSC	= 6	; ADC Start Conversion
                 .equ	ADEN	= 7	; ADC Enable
                 
                 ; ADCSRB - The ADC Control and Status register B
                 .equ	ADTS0	= 0	; ADC Auto Trigger Source bit 0
                 .equ	ADTS1	= 1	; ADC Auto Trigger Source bit 1
                 .equ	ADTS2	= 2	; ADC Auto Trigger Source bit 2
                 ;.equ	ACME	= 6	; 
                 
                 ; ADCH - ADC Data Register High Byte
                 .equ	ADCH0	= 0	; ADC Data Register High Byte Bit 0
                 .equ	ADCH1	= 1	; ADC Data Register High Byte Bit 1
                 .equ	ADCH2	= 2	; ADC Data Register High Byte Bit 2
                 .equ	ADCH3	= 3	; ADC Data Register High Byte Bit 3
                 .equ	ADCH4	= 4	; ADC Data Register High Byte Bit 4
                 .equ	ADCH5	= 5	; ADC Data Register High Byte Bit 5
                 .equ	ADCH6	= 6	; ADC Data Register High Byte Bit 6
                 .equ	ADCH7	= 7	; ADC Data Register High Byte Bit 7
                 
                 ; ADCL - ADC Data Register Low Byte
                 .equ	ADCL0	= 0	; ADC Data Register Low Byte Bit 0
                 .equ	ADCL1	= 1	; ADC Data Register Low Byte Bit 1
                 .equ	ADCL2	= 2	; ADC Data Register Low Byte Bit 2
                 .equ	ADCL3	= 3	; ADC Data Register Low Byte Bit 3
                 .equ	ADCL4	= 4	; ADC Data Register Low Byte Bit 4
                 .equ	ADCL5	= 5	; ADC Data Register Low Byte Bit 5
                 .equ	ADCL6	= 6	; ADC Data Register Low Byte Bit 6
                 .equ	ADCL7	= 7	; ADC Data Register Low Byte Bit 7
                 
                 ; DIDR0 - Digital Input Disable Register
                 .equ	ADC0D	= 0	; 
                 .equ	ADC1D	= 1	; 
                 .equ	ADC2D	= 2	; 
                 .equ	ADC3D	= 3	; 
                 .equ	ADC4D	= 4	; 
                 .equ	ADC5D	= 5	; 
                 .equ	ADC6D	= 6	; 
                 .equ	ADC7D	= 7	; 
                 
                 
                 ; ***** JTAG *************************
                 ; OCDR - On-Chip Debug Related Register in I/O Memory
                 .equ	OCDR0	= 0	; On-Chip Debug Register Bit 0
                 .equ	OCDR1	= 1	; On-Chip Debug Register Bit 1
                 .equ	OCDR2	= 2	; On-Chip Debug Register Bit 2
                 .equ	OCDR3	= 3	; On-Chip Debug Register Bit 3
                 .equ	OCDR4	= 4	; On-Chip Debug Register Bit 4
                 .equ	OCDR5	= 5	; On-Chip Debug Register Bit 5
                 .equ	OCDR6	= 6	; On-Chip Debug Register Bit 6
                 .equ	OCDR7	= 7	; On-Chip Debug Register Bit 7
                 .equ	IDRD	= OCDR7	; For compatibility
                 
                 ; MCUCR - MCU Control Register
                 .equ	JTD	= 7	; JTAG Interface Disable
                 
                 ; MCUSR - MCU Status Register
                 .equ	JTRF	= 4	; JTAG Reset Flag
                 
                 
                 ; ***** EEPROM ***********************
                 ; EEARH - EEPROM Address Register Low Byte
                 .equ	EEAR8	= 0	; EEPROM Read/Write Access Bit 8
                 .equ	EEAR9	= 1	; EEPROM Read/Write Access Bit 9
                 .equ	EEAR10	= 2	; EEPROM Read/Write Access Bit 10
                 .equ	EEAR11	= 3	; EEPROM Read/Write Access Bit 11
                 
                 ; EEARL - EEPROM Address Register Low Byte
                 .equ	EEAR0	= 0	; EEPROM Read/Write Access Bit 0
                 .equ	EEAR1	= 1	; EEPROM Read/Write Access Bit 1
                 .equ	EEAR2	= 2	; EEPROM Read/Write Access Bit 2
                 .equ	EEAR3	= 3	; EEPROM Read/Write Access Bit 3
                 .equ	EEAR4	= 4	; EEPROM Read/Write Access Bit 4
                 .equ	EEAR5	= 5	; EEPROM Read/Write Access Bit 5
                 .equ	EEAR6	= 6	; EEPROM Read/Write Access Bit 6
                 .equ	EEAR7	= 7	; EEPROM Read/Write Access Bit 7
                 
                 ; EEDR - EEPROM Data Register
                 .equ	EEDR0	= 0	; EEPROM Data Register bit 0
                 .equ	EEDR1	= 1	; EEPROM Data Register bit 1
                 .equ	EEDR2	= 2	; EEPROM Data Register bit 2
                 .equ	EEDR3	= 3	; EEPROM Data Register bit 3
                 .equ	EEDR4	= 4	; EEPROM Data Register bit 4
                 .equ	EEDR5	= 5	; EEPROM Data Register bit 5
                 .equ	EEDR6	= 6	; EEPROM Data Register bit 6
                 .equ	EEDR7	= 7	; EEPROM Data Register bit 7
                 
                 ; EECR - EEPROM Control Register
                 .equ	EERE	= 0	; EEPROM Read Enable
                 .equ	EEPE	= 1	; EEPROM Write Enable
                 .equ	EEMPE	= 2	; EEPROM Master Write Enable
                 .equ	EERIE	= 3	; EEPROM Ready Interrupt Enable
                 .equ	EEPM0	= 4	; EEPROM Programming Mode Bit 0
                 .equ	EEPM1	= 5	; EEPROM Programming Mode Bit 1
                 
                 
                 ; ***** TWI **************************
                 ; TWAMR - TWI (Slave) Address Mask Register
                 .equ	TWAM0	= 1	; 
                 .equ	TWAMR0	= TWAM0	; For compatibility
                 .equ	TWAM1	= 2	; 
                 .equ	TWAMR1	= TWAM1	; For compatibility
                 .equ	TWAM2	= 3	; 
                 .equ	TWAMR2	= TWAM2	; For compatibility
                 .equ	TWAM3	= 4	; 
                 .equ	TWAMR3	= TWAM3	; For compatibility
                 .equ	TWAM4	= 5	; 
                 .equ	TWAMR4	= TWAM4	; For compatibility
                 .equ	TWAM5	= 6	; 
                 .equ	TWAMR5	= TWAM5	; For compatibility
                 .equ	TWAM6	= 7	; 
                 .equ	TWAMR6	= TWAM6	; For compatibility
                 
                 ; TWBR - TWI Bit Rate register
                 .equ	TWBR0	= 0	; 
                 .equ	TWBR1	= 1	; 
                 .equ	TWBR2	= 2	; 
                 .equ	TWBR3	= 3	; 
                 .equ	TWBR4	= 4	; 
                 .equ	TWBR5	= 5	; 
                 .equ	TWBR6	= 6	; 
                 .equ	TWBR7	= 7	; 
                 
                 ; TWCR - TWI Control Register
                 .equ	TWIE	= 0	; TWI Interrupt Enable
                 .equ	TWEN	= 2	; TWI Enable Bit
                 .equ	TWWC	= 3	; TWI Write Collition Flag
                 .equ	TWSTO	= 4	; TWI Stop Condition Bit
                 .equ	TWSTA	= 5	; TWI Start Condition Bit
                 .equ	TWEA	= 6	; TWI Enable Acknowledge Bit
                 .equ	TWINT	= 7	; TWI Interrupt Flag
                 
                 ; TWSR - TWI Status Register
                 .equ	TWPS0	= 0	; TWI Prescaler
                 .equ	TWPS1	= 1	; TWI Prescaler
                 .equ	TWS3	= 3	; TWI Status
                 .equ	TWS4	= 4	; TWI Status
                 .equ	TWS5	= 5	; TWI Status
                 .equ	TWS6	= 6	; TWI Status
                 .equ	TWS7	= 7	; TWI Status
                 
                 ; TWDR - TWI Data register
                 .equ	TWD0	= 0	; TWI Data Register Bit 0
                 .equ	TWD1	= 1	; TWI Data Register Bit 1
                 .equ	TWD2	= 2	; TWI Data Register Bit 2
                 .equ	TWD3	= 3	; TWI Data Register Bit 3
                 .equ	TWD4	= 4	; TWI Data Register Bit 4
                 .equ	TWD5	= 5	; TWI Data Register Bit 5
                 .equ	TWD6	= 6	; TWI Data Register Bit 6
                 .equ	TWD7	= 7	; TWI Data Register Bit 7
                 
                 ; TWAR - TWI (Slave) Address register
                 .equ	TWGCE	= 0	; TWI General Call Recognition Enable Bit
                 .equ	TWA0	= 1	; TWI (Slave) Address register Bit 0
                 .equ	TWA1	= 2	; TWI (Slave) Address register Bit 1
                 .equ	TWA2	= 3	; TWI (Slave) Address register Bit 2
                 .equ	TWA3	= 4	; TWI (Slave) Address register Bit 3
                 .equ	TWA4	= 5	; TWI (Slave) Address register Bit 4
                 .equ	TWA5	= 6	; TWI (Slave) Address register Bit 5
                 .equ	TWA6	= 7	; TWI (Slave) Address register Bit 6
                 
                 
                 ; ***** USART1 ***********************
                 ; UDR1 - USART I/O Data Register
                 .equ	UDR1_0	= 0	; USART I/O Data Register bit 0
                 .equ	UDR1_1	= 1	; USART I/O Data Register bit 1
                 .equ	UDR1_2	= 2	; USART I/O Data Register bit 2
                 .equ	UDR1_3	= 3	; USART I/O Data Register bit 3
                 .equ	UDR1_4	= 4	; USART I/O Data Register bit 4
                 .equ	UDR1_5	= 5	; USART I/O Data Register bit 5
                 .equ	UDR1_6	= 6	; USART I/O Data Register bit 6
                 .equ	UDR1_7	= 7	; USART I/O Data Register bit 7
                 
                 ; UCSR1A - USART Control and Status Register A
                 .equ	MPCM1	= 0	; Multi-processor Communication Mode
                 .equ	U2X1	= 1	; Double the USART transmission speed
                 .equ	UPE1	= 2	; Parity Error
                 .equ	DOR1	= 3	; Data overRun
                 .equ	FE1	= 4	; Framing Error
                 .equ	UDRE1	= 5	; USART Data Register Empty
                 .equ	TXC1	= 6	; USART Transmitt Complete
                 .equ	RXC1	= 7	; USART Receive Complete
                 
                 ; UCSR1B - USART Control and Status Register B
                 .equ	TXB81	= 0	; Transmit Data Bit 8
                 .equ	RXB81	= 1	; Receive Data Bit 8
                 .equ	UCSZ12	= 2	; Character Size
                 .equ	TXEN1	= 3	; Transmitter Enable
                 .equ	RXEN1	= 4	; Receiver Enable
                 .equ	UDRIE1	= 5	; USART Data register Empty Interrupt Enable
                 .equ	TXCIE1	= 6	; TX Complete Interrupt Enable
                 .equ	RXCIE1	= 7	; RX Complete Interrupt Enable
                 
                 ; UCSR1C - USART Control and Status Register C
                 .equ	UCPOL1	= 0	; Clock Polarity
                 .equ	UCSZ10	= 1	; Character Size
                 .equ	UCPHA1	= UCSZ10	; For compatibility
                 .equ	UCSZ11	= 2	; Character Size
                 .equ	UDORD1	= UCSZ11	; For compatibility
                 .equ	USBS1	= 3	; Stop Bit Select
                 .equ	UPM10	= 4	; Parity Mode Bit 0
                 .equ	UPM11	= 5	; Parity Mode Bit 1
                 .equ	UMSEL10	= 6	; USART Mode Select
                 .equ	UMSEL11	= 7	; USART Mode Select
                 
                 ; UBRR1H - USART Baud Rate Register High Byte
                 .equ	UBRR_8	= 0	; USART Baud Rate Register bit 8
                 .equ	UBRR_9	= 1	; USART Baud Rate Register bit 9
                 .equ	UBRR_10	= 2	; USART Baud Rate Register bit 10
                 .equ	UBRR_11	= 3	; USART Baud Rate Register bit 11
                 
                 ; UBRR1L - USART Baud Rate Register Low Byte
                 .equ	UBRR_0	= 0	; USART Baud Rate Register bit 0
                 .equ	UBRR_1	= 1	; USART Baud Rate Register bit 1
                 .equ	UBRR_2	= 2	; USART Baud Rate Register bit 2
                 .equ	UBRR_3	= 3	; USART Baud Rate Register bit 3
                 .equ	UBRR_4	= 4	; USART Baud Rate Register bit 4
                 .equ	UBRR_5	= 5	; USART Baud Rate Register bit 5
                 .equ	UBRR_6	= 6	; USART Baud Rate Register bit 6
                 .equ	UBRR_7	= 7	; USART Baud Rate Register bit 7
                 
                 
                 ; ***** SPI **************************
                 ; SPDR - SPI Data Register
                 .equ	SPDR0	= 0	; SPI Data Register bit 0
                 .equ	SPDR1	= 1	; SPI Data Register bit 1
                 .equ	SPDR2	= 2	; SPI Data Register bit 2
                 .equ	SPDR3	= 3	; SPI Data Register bit 3
                 .equ	SPDR4	= 4	; SPI Data Register bit 4
                 .equ	SPDR5	= 5	; SPI Data Register bit 5
                 .equ	SPDR6	= 6	; SPI Data Register bit 6
                 .equ	SPDR7	= 7	; SPI Data Register bit 7
                 
                 ; SPSR - SPI Status Register
                 .equ	SPI2X	= 0	; Double SPI Speed Bit
                 .equ	WCOL	= 6	; Write Collision Flag
                 .equ	SPIF	= 7	; SPI Interrupt Flag
                 
                 ; SPCR - SPI Control Register
                 .equ	SPR0	= 0	; SPI Clock Rate Select 0
                 .equ	SPR1	= 1	; SPI Clock Rate Select 1
                 .equ	CPHA	= 2	; Clock Phase
                 .equ	CPOL	= 3	; Clock polarity
                 .equ	MSTR	= 4	; Master/Slave Select
                 .equ	DORD	= 5	; Data Order
                 .equ	SPE	= 6	; SPI Enable
                 .equ	SPIE	= 7	; SPI Interrupt Enable
                 
                 
                 ; ***** WATCHDOG *********************
                 ; WDTCSR - Watchdog Timer Control Register
                 .equ	WDP0	= 0	; Watch Dog Timer Prescaler bit 0
                 .equ	WDP1	= 1	; Watch Dog Timer Prescaler bit 1
                 .equ	WDP2	= 2	; Watch Dog Timer Prescaler bit 2
                 .equ	WDE	= 3	; Watch Dog Enable
                 .equ	WDCE	= 4	; Watchdog Change Enable
                 .equ	WDP3	= 5	; Watchdog Timer Prescaler Bit 3
                 .equ	WDIE	= 6	; Watchdog Timeout Interrupt Enable
                 .equ	WDIF	= 7	; Watchdog Timeout Interrupt Flag
                 
                 
                 ; ***** CPU **************************
                 ; SREG - Status Register
                 .equ	SREG_C	= 0	; Carry Flag
                 .equ	SREG_Z	= 1	; Zero Flag
                 .equ	SREG_N	= 2	; Negative Flag
                 .equ	SREG_V	= 3	; Two's Complement Overflow Flag
                 .equ	SREG_S	= 4	; Sign Bit
                 .equ	SREG_H	= 5	; Half Carry Flag
                 .equ	SREG_T	= 6	; Bit Copy Storage
                 .equ	SREG_I	= 7	; Global Interrupt Enable
                 
                 ; MCUCR - MCU Control Register
                 .equ	IVCE	= 0	; Interrupt Vector Change Enable
                 .equ	IVSEL	= 1	; Interrupt Vector Select
                 .equ	PUD	= 4	; Pull-up disable
                 ;.equ	JTD	= 7	; JTAG Interface Disable
                 
                 ; MCUSR - MCU Status Register
                 .equ	PORF	= 0	; Power-on reset flag
                 .equ	EXTRF	= 1	; External Reset Flag
                 .equ	BORF	= 2	; Brown-out Reset Flag
                 .equ	WDRF	= 3	; Watchdog Reset Flag
                 ;.equ	JTRF	= 4	; JTAG Reset Flag
                 
                 ; OSCCAL - Oscillator Calibration Value
                 .equ	CAL0	= 0	; Oscillator Calibration Value Bit0
                 .equ	CAL1	= 1	; Oscillator Calibration Value Bit1
                 .equ	CAL2	= 2	; Oscillator Calibration Value Bit2
                 .equ	CAL3	= 3	; Oscillator Calibration Value Bit3
                 .equ	CAL4	= 4	; Oscillator Calibration Value Bit4
                 .equ	CAL5	= 5	; Oscillator Calibration Value Bit5
                 .equ	CAL6	= 6	; Oscillator Calibration Value Bit6
                 .equ	CAL7	= 7	; Oscillator Calibration Value Bit7
                 
                 ; CLKPR - 
                 .equ	CLKPS0	= 0	; 
                 .equ	CLKPS1	= 1	; 
                 .equ	CLKPS2	= 2	; 
                 .equ	CLKPS3	= 3	; 
                 .equ	CLKPCE	= 7	; 
                 
                 ; SMCR - Sleep Mode Control Register
                 .equ	SE	= 0	; Sleep Enable
                 .equ	SM0	= 1	; Sleep Mode Select bit 0
                 .equ	SM1	= 2	; Sleep Mode Select bit 1
                 .equ	SM2	= 3	; Sleep Mode Select bit 2
                 
                 ; RAMPZ - RAM Page Z Select Register
                 .equ	RAMPZ0	= 0	; RAM Page Z Select Register Bit 0
                 
                 ; GPIOR2 - General Purpose IO Register 2
                 .equ	GPIOR20	= 0	; General Purpose IO Register 2 bit 0
                 .equ	GPIOR21	= 1	; General Purpose IO Register 2 bit 1
                 .equ	GPIOR22	= 2	; General Purpose IO Register 2 bit 2
                 .equ	GPIOR23	= 3	; General Purpose IO Register 2 bit 3
                 .equ	GPIOR24	= 4	; General Purpose IO Register 2 bit 4
                 .equ	GPIOR25	= 5	; General Purpose IO Register 2 bit 5
                 .equ	GPIOR26	= 6	; General Purpose IO Register 2 bit 6
                 .equ	GPIOR27	= 7	; General Purpose IO Register 2 bit 7
                 
                 ; GPIOR1 - General Purpose IO Register 1
                 .equ	GPIOR10	= 0	; General Purpose IO Register 1 bit 0
                 .equ	GPIOR11	= 1	; General Purpose IO Register 1 bit 1
                 .equ	GPIOR12	= 2	; General Purpose IO Register 1 bit 2
                 .equ	GPIOR13	= 3	; General Purpose IO Register 1 bit 3
                 .equ	GPIOR14	= 4	; General Purpose IO Register 1 bit 4
                 .equ	GPIOR15	= 5	; General Purpose IO Register 1 bit 5
                 .equ	GPIOR16	= 6	; General Purpose IO Register 1 bit 6
                 .equ	GPIOR17	= 7	; General Purpose IO Register 1 bit 7
                 
                 ; GPIOR0 - General Purpose IO Register 0
                 .equ	GPIOR00	= 0	; General Purpose IO Register 0 bit 0
                 .equ	GPIOR01	= 1	; General Purpose IO Register 0 bit 1
                 .equ	GPIOR02	= 2	; General Purpose IO Register 0 bit 2
                 .equ	GPIOR03	= 3	; General Purpose IO Register 0 bit 3
                 .equ	GPIOR04	= 4	; General Purpose IO Register 0 bit 4
                 .equ	GPIOR05	= 5	; General Purpose IO Register 0 bit 5
                 .equ	GPIOR06	= 6	; General Purpose IO Register 0 bit 6
                 .equ	GPIOR07	= 7	; General Purpose IO Register 0 bit 7
                 
                 ; PRR0 - Power Reduction Register0
                 .equ	PRADC	= 0	; Power Reduction ADC
                 .equ	PRUSART0	= 1	; Power Reduction USART 0
                 .equ	PRSPI	= 2	; Power Reduction Serial Peripheral Interface
                 .equ	PRTIM1	= 3	; Power Reduction Timer/Counter1
                 .equ	PRUSART1	= 4	; Power Reduction USART 1
                 .equ	PRTIM0	= 5	; Power Reduction Timer/Counter0
                 .equ	PRTIM2	= 6	; Power Reduction Timer/Counter2
                 .equ	PRTWI	= 7	; Power Reduction TWI
                 
                 ; PRR1 - Power Reduction Register1
                 .equ	PRTIM3	= 0	; Power Reduction Timer/Counter3
                 
                 
                 
                 ; ***** LOCKSBITS ********************************************************
                 .equ	LB1	= 0	; Lock bit
                 .equ	LB2	= 1	; Lock bit
                 .equ	BLB01	= 2	; Boot Lock bit
                 .equ	BLB02	= 3	; Boot Lock bit
                 .equ	BLB11	= 4	; Boot lock bit
                 .equ	BLB12	= 5	; Boot lock bit
                 
                 
                 ; ***** FUSES ************************************************************
                 ; LOW fuse bits
                 .equ	CKSEL0	= 0	; Select Clock Source
                 .equ	CKSEL1	= 1	; Select Clock Source
                 .equ	CKSEL2	= 2	; Select Clock Source
                 .equ	CKSEL3	= 3	; Select Clock Source
                 .equ	SUT0	= 4	; Select start-up time
                 .equ	SUT1	= 5	; Select start-up time
                 .equ	CKOUT	= 6	; Clock output
                 .equ	CKDIV8	= 7	; Divide clock by 8
                 
                 ; HIGH fuse bits
                 .equ	BOOTRST	= 0	; Select Reset Vector
                 .equ	BOOTSZ0	= 1	; Select Boot Size
                 .equ	BOOTSZ1	= 2	; Select Boot Size
                 .equ	EESAVE	= 3	; EEPROM memory is preserved through chip erase
                 .equ	WDTON	= 4	; Watchdog timer always on
                 .equ	SPIEN	= 5	; Enable Serial programming and Data Downloading
                 .equ	JTAGEN	= 6	; Enable JTAG
                 .equ	OCDEN	= 7	; Enable OCD
                 
                 ; EXTENDED fuse bits
                 .equ	BODLEVEL0	= 0	; Brown-out Detector trigger level
                 .equ	BODLEVEL1	= 1	; Brown-out Detector trigger level
                 .equ	BODLEVEL2	= 2	; Brown-out Detector trigger level
                 
                 
                 
                 ; ***** CPU REGISTER DEFINITIONS *****************************************
                 .def	XH	= r27
                 .def	XL	= r26
                 .def	YH	= r29
                 .def	YL	= r28
                 .def	ZH	= r31
                 .def	ZL	= r30
                 
                 
                 
                 ; ***** DATA MEMORY DECLARATIONS *****************************************
                 .equ	FLASHEND	= 0xffff	; Note: Word address
                 .equ	IOEND	= 0x00ff
                 .equ	SRAM_START	= 0x0100
                 .equ	SRAM_SIZE	= 16384
                 .equ	RAMEND	= 0x40ff
                 .equ	XRAMEND	= 0x0000
                 .equ	E2END	= 0x0fff
                 .equ	EEPROMEND	= 0x0fff
                 .equ	EEADRBITS	= 12
                 #pragma AVRPART MEMORY PROG_FLASH 131072
                 #pragma AVRPART MEMORY EEPROM 4096
                 #pragma AVRPART MEMORY INT_SRAM SIZE 16384
                 #pragma AVRPART MEMORY INT_SRAM START_ADDR 0x100
                 
                 
                 
                 ; ***** BOOTLOADER DECLARATIONS ******************************************
                 .equ	NRWW_START_ADDR	= 0xf000
                 .equ	NRWW_STOP_ADDR	= 0xffff
                 .equ	RWW_START_ADDR	= 0x0
                 .equ	RWW_STOP_ADDR	= 0xefff
                 .equ	PAGESIZE	= 128
                 .equ	FIRSTBOOTSTART	= 0xfe00
                 .equ	SECONDBOOTSTART	= 0xfc00
                 .equ	THIRDBOOTSTART	= 0xf800
                 .equ	FOURTHBOOTSTART	= 0xf000
                 .equ	SMALLBOOTSTART	= FIRSTBOOTSTART
                 .equ	LARGEBOOTSTART	= FOURTHBOOTSTART
                 
                 
                 
                 ; ***** INTERRUPT VECTORS ************************************************
                 .equ	INT0addr	= 0x0002	; External Interrupt Request 0
                 .equ	INT1addr	= 0x0004	; External Interrupt Request 1
                 .equ	INT2addr	= 0x0006	; External Interrupt Request 2
                 .equ	PCI0addr	= 0x0008	; Pin Change Interrupt Request 0
                 .equ	PCI1addr	= 0x000a	; Pin Change Interrupt Request 1
                 .equ	PCI2addr	= 0x000c	; Pin Change Interrupt Request 2
                 .equ	PCI3addr	= 0x000e	; Pin Change Interrupt Request 3
                 .equ	WDTaddr	= 0x0010	; Watchdog Time-out Interrupt
                 .equ	OC2Aaddr	= 0x0012	; Timer/Counter2 Compare Match A
                 .equ	OC2Baddr	= 0x0014	; Timer/Counter2 Compare Match B
                 .equ	OVF2addr	= 0x0016	; Timer/Counter2 Overflow
                 .equ	ICP1addr	= 0x0018	; Timer/Counter1 Capture Event
                 .equ	OC1Aaddr	= 0x001a	; Timer/Counter1 Compare Match A
                 .equ	OC1Baddr	= 0x001c	; Timer/Counter1 Compare Match B
                 .equ	OVF1addr	= 0x001e	; Timer/Counter1 Overflow
                 .equ	OC0Aaddr	= 0x0020	; Timer/Counter0 Compare Match A
                 .equ	OC0Baddr	= 0x0022	; Timer/Counter0 Compare Match B
                 .equ	OVF0addr	= 0x0024	; Timer/Counter0 Overflow
                 .equ	SPIaddr	= 0x0026	; SPI Serial Transfer Complete
                 .equ	URXC0addr	= 0x0028	; USART0, Rx Complete
                 .equ	UDRE0addr	= 0x002a	; USART0 Data register Empty
                 .equ	UTXC0addr	= 0x002c	; USART0, Tx Complete
                 .equ	ACIaddr	= 0x002e	; Analog Comparator
                 .equ	ADCCaddr	= 0x0030	; ADC Conversion Complete
                 .equ	ERDYaddr	= 0x0032	; EEPROM Ready
                 .equ	TWIaddr	= 0x0034	; 2-wire Serial Interface
                 .equ	SPMRaddr	= 0x0036	; Store Program Memory Read
                 .equ	URXC1addr	= 0x0038	; USART1 RX complete
                 .equ	UDRE1addr	= 0x003a	; USART1 Data Register Empty
                 .equ	UTXC1addr	= 0x003c	; USART1 TX complete
                 .equ	ICP3addr	= 0x003e	; Timer/Counter3 Capture Event
                 .equ	OC3Aaddr	= 0x0040	; Timer/Counter3 Compare Match A
                 .equ	OC3Baddr	= 0x0042	; Timer/Counter3 Compare Match B
                 .equ	OVF3addr	= 0x0044	; Timer/Counter3 Overflow
                 
                 .equ	INT_VECTORS_SIZE	= 70	; size in words
                 
                 #endif  /* _M1284DEF_INC_ */
                 
                 ; ***** END OF FILE ******************************************************
                 
                 #include "flags.def"
                 
                 .EQU	HW_FOUND_RAM	= 0
                 .EQU	HW_FOUND_EXT	= 1
                 .EQU	HW_FOUND_IRQ	= 2
                 .EQU	HW_FOUND_RTC	= 3
                 .EQU	HW_FOUND_ROM	= 4
                 .EQU	HW_FOUND_LAN	= 5
                 .EQU	HW_FOUND_CAN	= 6
                 .EQU	HW_FOUND_CPD	= 7
                 
                 ; DEBUG NOTIFY
                 .EQU	NOTIFY_RES	= 0
                 .EQU	NOTIFY_PORT	= 1
                 .EQU	NOTIFY_BDOS	= 2
                 .EQU	NOTIFY_BIOS	= 3
                 .EQU	NOTIFY_SD	= 4
                 .EQU	NOTIFY_CON	= 5
                 .EQU	NOTIFY_IRQ	= 6
                 .EQU	NOTIFY_Z80	= 7
                 
                 ; IOBYTE
                 .EQU	SIO_OUT_CON	= 0
                 .EQU	SIO_OUT_TTY	= 1
                 .EQU	SIO_OUT_LAN	= 2
                 .EQU	SIO_OUT_LST	= 3
                 .EQU	SIO_INP_CON	= 4
                 .EQU	SIO_INP_TTY	= 5
                 .EQU	SIO_INP_LAN	= 6
                 .EQU	SIO_INP_LST	= 7
                 
                 ; CRT_SETTINGS
                 .EQU	CRT_SCROLL_DSBL	= 7	; scroll disable
                 .EQU	CRT_USE_ATTR	= 6	; use attr
                 .EQU	CRT_WRAP_DSBL	= 5	; Disable Line Wrap
                 .EQU	CRT_USE_CLR	= 4	; CLR controller active
                 .EQU	CRT_RESERVED	= 3	; 
                 .EQU	CRT_CODEPAGE2	= 2	; codepage
                 .EQU	CRT_CODEPAGE1	= 1	; codepage
                 .EQU	CRT_CODEPAGE0	= 0	; codepage
                 
                 ; RTC_HW_DISABLED		; disabled hardware
                 .EQU	HW_DSBL_BUZ	= 0
                 .EQU	HW_DSBL_TTY	= 1
                 .EQU	HW_DSBL_LST	= 2
                 .EQU	HW_DSBL_MUS	= 3
                 .EQU	HW_DSBL_ROM	= 4
                 .EQU	HW_DSBL_LAN	= 5
                 .EQU	HW_DSBL_CAN	= 6
                 .EQU	HW_DSBL_SDC	= 7
                 
                 ; RTC_AUTO
                 .EQU	AUTO_CLOCK	= 0	; clock on the screen
                 
                 ;PR_IOBYTE			; punch reader io settings
                 .EQU	PRIO_OUT_CAN	= 0
                 .EQU	PRIO_OUT_TTY	= 1
                 .EQU	PRIO_OUT_LAN	= 2
                 .EQU	PRIO_OUT_LST	= 3
                 .EQU	PRIO_IN_CAN	= 4
                 .EQU	PRIO_IN_TTY	= 5
                 .EQU	PRIO_IN_LAN	= 6
                 .EQU	PRIO_IN_LST	= 7
                 
                 ;CON_IOBYTE			; punch reader io settings
                 .EQU	CON_OUT_CON	= 0
                 .EQU	CON_OUT_TTY	= 1
                 .EQU	CON_OUT_LAN	= 2
                 .EQU	CON_OUT_LST	= 3
                 .EQU	CON_IN_CON	= 4
                 .EQU	CON_IN_TTY	= 5
                 .EQU	CON_IN_LAN	= 6
                 .EQU	CON_IN_LST	= 7
                 
                 .EQU	IRQ1_LAN	= 0
                 
                 ;GPIOR1 - IRQ from CPD
                 .EQU	IRQ_V_KBD 	= 0
                 .EQU	IRQ_V_GPO 	= 1
                 .EQU	IRQ_V_CTC 	= 2
                 .EQU	IRQ_V_MUS 	= 3
                 .EQU	IRQ_V_R1  	= 4
                 .EQU	IRQ_V_R2  	= 5
                 .EQU	IRQ_V_CTX 	= 6
                 .EQU	IRQ_V_CRX 	= 7
                 
                 ; GPIOR0 - CPU IRQ
                 .EQU	IRQ_V_LAN 	= 0
                 .EQU	IRQ_V_CAN 	= 1
                 .EQU	IRQ_V_RTC 	= 2 
                 .EQU	IRQ_V_CPD  	= 3 
                 .EQU	IRQ_V_R4  	= 4 
                 .EQU	IRQ_V_R5  	= 5 
                 .EQU	IRQ_V_DEBUG  	= 5 
                 .EQU	IRQ_V_TTX 	= 6 
                 .EQU	IRQ_V_TRX 	= 7 
                 
                 ; DEV IOBYTE
                 ; LST
                 .EQU	LST_OUT_LPT	= 0
                 .EQU	LST_OUT_TTY	= 1
                 .EQU	LST_OUT_LAN	= 2
                 .EQU	LST_OUT_LST	= 3
                 ; SD 
                 .EQU	SDC_SRC_SDC	= 4
                 .EQU	SDC_SRC_TTY	= 5
                 .EQU	SDC_SRC_LAN	= 6
                 .EQU	SDC_SRC_LST	= 7
                 
                 
                 ; CRT attributes
                 .EQU	CRT_ATTR_REV	= 4
                 .EQU	CRT_ATTR_S0	= 2
                 
                 
                 ; CPD_SYSRQ
                 .EQU	CPD_SYSRQ_MICE	= 6
                 #include "macro.def"
                 
                 .MACRO	_ldi
                 	ldi	temp, @1
                 	mov	@0, temp		
                 .ENDM
                 
                 ;   ( temp)
                 .MACRO	_out
                 	ldi	temp, @1
                 	out	@0, temp		
                 .ENDM
                 
                 ;   ( temp)
                 .MACRO	_outm
                 	ldi	temp, @1
                 	sts	@0, temp		
                 .ENDM
                 
                 ; WORD   ( temp) RL, RH, VAL
                 .MACRO	_outw
                 	_out	@1, high(@2)
                 	_out	@0, low(@2)
                 .ENDM
                 
                 ; WORD   ( temp) RL, RL, VAL
                 .MACRO	_outwm
                 	_outm	@1, high(@2)
                 	_outm	@0, low(@2)
                 .ENDM
                 
                 ; cpi via temp
                 .MACRO	_cpi
                 	ldi	temp, @1
                 	cp	@0, temp
                 .ENDM
                 
                 ; compare, skip if equal via temp	
                 .MACRO _cpse
                 	ldi	temp, @1
                 	cpse	@0, temp
                 .ENDM
                 
                 // compare, skip if equal via temp	
                 .MACRO _ori
                 	ldi	temp, @1
                 	or	@0, temp
                 .ENDM
                 
                 ; compare, skip if equal via temp	
                 .MACRO _andi
                 	ldi	temp, @1
                 	and	@0, temp
                 .ENDM
                 
                 ; push double registor
                 .MACRO	pushw
                 	push	@0H
                 	push	@0L
                 .ENDM
                 
                 ; pop double registor
                 .MACRO	popw
                 	pop	@0L
                 	pop	@0H
                 .ENDM
                 
                 ; decode @0 from @1 data block from rampz=1, rturn to @2 
                 .MACRO	DECODE
                         pushw	Z
                         ldi	ZH, high((@1)*2)
                         mov	ZL, temp
                         ld	@2, Z		; decoded value to return
                         popw	Z
                 .ENDM
                 
                 .MACRO	ldw
                 	lds	@0L, @1
                 	lds	@0H, @1+1
                 .ENDM
                 
                 .MACRO	stw
                 	sts	@0, @1L
                 	sts	@0+1, @1H
                 .ENDM
                 
                 .MACRO	stiw
                 	push	temp
                 	ldi	temp, low(@1)
                 	sts	@0, temp
                 	ldi	temp, high(@1)
                 	sts	@0+1, temp
                 	pop	temp
                 .ENDM
                 
                 .MACRO	ldiw
                 	ldi	@0L, low(@1)
                 	ldi	@0H, high(@1)
                 .ENDM
                 
                 .MACRO	ldiw2
                 	ldi	@0L, low((@1)*2)
                 	ldi	@0H, high((@1)*2)
                 .ENDM
                 
                 
                 .MACRO	ldsw
                 	lds	@0L, low(@1)
                 	lds	@0H, high(@1)
                 .ENDM
                 
                 ;	delay for 3,6,9,12,... cycles
                 .MACRO 	delay3 ; 1=3 2=1+1*3+2
                 	ldi	temp, @0/3		;+1
                 _dlloop:
                 	dec	temp			;+1
                 	brne	_dlloop			;/+2/1
                 .ENDM
                 
                 ; compare value @0 with temp, rjump to @1 
                 .MACRO	tcbe
                 	cpi	temp, @0
                 	brne	_tcbeno
                 	rjmp	@1
                 _tcbeno:
                 .ENDM
                 
                 ; compare value @0 with zzC, rjump to @1 
                 .MACRO	ccbe
                 	cpi	zzC, @0
                 	brne	_ccbeno
                 	rjmp	@1
                 _ccbeno:
                 .ENDM
                 
                 .MACRO	stst
                 	ldi	temp, @1
                 	sts	@0, temp
                 .ENDM
                 
                 .MACRO	ldstt
                 	lds	temp, @1
                 	sts	@0, temp
                 .ENDM
                 
                 .MACRO	ldstt2
                 	ldstt	@0, @1
                 	ldstt	@0+1, @1+1
                 .ENDM
                 
                 .MACRO	stsz
                 	sts	@0, zero
                 .ENDM
                 
                 .MACRO	ststs
                 	push	temp
                 	ldi	temp, @1
                 	sts	@0, temp
                 	pop	temp
                 .ENDM
                 
                 .MACRO	tcbel
                 	cpi	temp, @0
                 	brne	_tcbeno
                 	jmp	@1
                 _tcbeno:
                 .ENDM
                 
                 .MACRO	tcbel0
                 	cpi	FROMRAM0, @0
                 	brne	_tcbeno
                 	jmp	@1
                 _tcbeno:
                 .ENDM
                 
                 .MACRO	ccbel0
                 	cpi	zzC, @0
                 	brne	_ccbeno
                 	jmp	@1
                 _ccbeno:
                 .ENDM
                 
                 
                 ; cp reg (MEM)
                 .MACRO	cpmem
                 	push	r18
                 	lds	r18, @1
                 	cp	@0, r18
                 	pop	r18
                 .ENDM
                 
                 ; cp reg (MEM)
                 .MACRO	cfmem
                 	push	r18
                 	lds	r18, @0
                 	andi	r18, (1<<(@1))
                 	pop	r18
                 .ENDM
                 
                 .MACRO	addw
                 	add	@0L, @1L
                 	adc	@1H, @1H
                 .ENDM
                 
                 .MACRO	cpiw
                 	push	temp
                 	cpi	@0L, low(@1)
                 	ldi	temp, high(@1)
                 	cpc	@0H, temp
                 	pop	temp
                 .ENDM
                 
                 .MACRO	cpw
                 	cp	@0L, @1L
                 	cpc	@0H, @1H
                 .ENDM
                 #include "regs.def"
                 
                 
                 
                 	.DEF	SPIMODE = r0 ; ctrl port SPI mode
                 	.DEF	FF      = r2 ;=0xff
                 	.DEF	RAMOE   = r3 ; ctrl port RAM OE
                 	.DEF	RAMWE   = r4 ; ctrl port RAM WE
                 	.DEF	ZERO    = r5	; =0
                 	.DEF	VIDEORAM= r6 ; =0xf8
                 
                 	.DEF	_sreg   = r7  ; Storing SREG in (HL) commands
                 ;	.DEF	zzA=r8
                 	.DEF	zzA=r17
                 
                 	.DEF	ONE=r9				; =1
                 
                 	.DEF	zzF=r20
                 	.DEF	zzB=r10
                 ;	.DEF	zzC=r11
                 ;	.DEF	zzC=r18
                 	.DEF	zzC=r22
                 	.DEF	zzD=r12
                 	.DEF	zzE=r13
                 	.DEF	zzH=r14
                 	.DEF	zzL=r15
                 	.DEF	zzIXl=r16
                 ;	.DEF	zzIXh=r17
                 	.DEF	zzIXh=r8
                 ;	.DEF	zzIYl=r18
                 	.DEF	zzIYl=r11
                 	.DEF	zzIYh=r19
                 
                 	.DEF	zzTmp   =r21
                 	.DEF	FROMRAM0=r23
                 	.DEF	FROMRAM1=r1
                 ;	.DEF	FROMRAM2=r22
                 	.DEF	FROMRAM2=r18
                 
                 	.DEF	zzPCl = r24           		;Rd
                 	.DEF	zzPCh = r25            		;Rd
                 
                 ;	.DEF	LSTART=r26			;X
                 ;	.DEF	LSTARTh=r27             	;X
                 	.DEF	zzSPl = r28             	;Y
                 	.DEF	zzSPh = r29             	;Y
                 ;	.DEF	JMPPTR = r30             	;Z
                 ;	.DEF	JMPPTRh = r31             	;Z
                 
                 	.DEF	temp	  = r21			; === zzTmp
                 #include "commons.def"
                 
                 	ldi   	YH, high(0xf800+((@1)-1)*80+((@0)-1))
                     	ldi   	YL, low(0xf800+((@1)-1)*80+((@0)-1))
                 .ENDM
                 
                 .MACRO 	puts
                 	ldi	zh, high((@0)*2)    
                 	ldi	zl, low((@0)*2)
                 	call	DO_PUTS
                 .ENDM
                 
                 .MACRO 	con_puts
                 	ldi	zh, high((@0)*2)    
                 	ldi	zl, low((@0)*2)
                 	call	STR_OUT
                 .ENDM
                 
                 .MACRO	con_putc
                 	ldi   	temp, @0
                 	mov	zzC, temp
                 	ldi	temp, 0x04
                 	call  	BIOS_CMD
                 .ENDM
                 
                 .MACRO	tcall
                         pushw	Z
                         pushw	X
                         ldi	ZL, low((@0)*2)
                         ldi	ZH, high((@0)*2)
                         add	ZL, @1
                         adc	ZH, zero
                         add	ZL, @1
                         adc	ZH, zero
                 	lpm	XL, Z+
                 	lpm	XH, Z
                 	mov	ZL, XL
                 	mov	ZH, XH
                         icall
                 	popw	X
                 	popw	Z
                 .ENDM
                 
                 .MACRO 	con_puts_ram
                 	ldi	zh, high(@0)    
                 	ldi	zl, low(@0)
                 	call	STR_OUT_RAM
                 .ENDM
                 
                 
                 ; move @2 bytes from @0 to @1 backward
                 .MACRO	ZXYb
                 	ldiw	Z, @0
                 	ldiw	Y, @2
                 	ldiw	X, @1
                 	call	LAN_ZXYb
                 .ENDM
                 
                 ; move @2 bytes from @0 to @1 froward
                 .MACRO	ZXYf
                 	ldiw	Z, @0
                 	ldiw	Y, @2
                 	ldiw	X, @1
                 	call	LAN_ZXYf
                 .ENDM
                 
                 ; move @1 bytes from Z to @0 froward
                 .MACRO	ZXYf_Z
                 	ldiw	Y, @1
                 	ldiw	X, @0
                 	call	LAN_ZXYf
                 .ENDM
                 #include "bios.def"
                 
                 
                 ; Standard CPM 2.2
                 .EQU	BIOS_FUNC_COLD_START	= 0x00
                 .EQU	BIOS_FUNC_START		= 0x01
                 .EQU	BIOS_FUNC_CONST		= 0x02
                 .EQU	BIOS_FUNC_CONIN		= 0x03
                 .EQU	BIOS_FUNC_CONOUT	= 0x04
                 .EQU	BIOS_FUNC_LIST		= 0x05
                 .EQU	BIOS_FUNC_PUNCH		= 0x06
                 .EQU	BIOS_FUNC_READER	= 0X07
                 .EQU	BIOS_FUNC_HOME		= 0x08
                 .EQU	BIOS_FUNC_SELDISK	= 0X09
                 .EQU	BIOS_FUNC_SETTRK	= 0X0a
                 .EQU	BIOS_FUNC_SETSEC	= 0x0b
                 .EQU	BIOS_FUNC_SETDMA	= 0x0c
                 .EQU	BIOS_FUNC_READ		= 0x0d
                 .EQU	BIOS_FUNC_WRITE		= 0x0e
                 .EQU	BIOS_FUNC_LISTST	= 0x0f
                 .EQU	BIOS_FUNC_SECTRN	= 0x10
                 
                 ; Standard CPM 3.0
                 
                 ; Extended CRISS, no direct call, internal call BIOS, code in temp
                 .EQU	BIOS_FUNC_CONBUF_APPEND	= 0xf0
                 .EQU	BIOS_FUNC_PRBUF_APPEND	= 0xf1
                 
                 ;.EQU	BIOS_FUNC_REFRESH_HW	= 0xf8
                 .EQU	BIOS_FUNC_CHAROUT_RAW	= 0xf9
                 .EQU	BIOS_FUNC_CRT_ATTR	= 0xfa
                 .EQU	BIOS_FUNC_ECON_ATTR_GET	= 0xfb
                 .EQU	BIOS_FUNC_ECON_ATTR_SET	= 0xfc
                 .EQU	BIOS_FUNC_CRT_CHAR	= 0xfd	; raw output to crt
                 .EQU	BIOS_FUNC_SET_VIDEOMODE	= 0xfe
                 .EQU	BIOS_FUNC_CRT_RESET	= 0xff	; reset crt settings
                 
                 .MACRO	BIOS_CALL
                 	ldi	temp, @0
                 	call	BIOS
                 .ENDM
                 
                 /*
                 	tcbe	0x00, BIOS_L00
                 	tcbe	0x01, BIOS_L01
                 	tcbe	0x02, BIOS_L02		; CONST
                 	tcbe	0x03, BIOS_L03		; CONIN
                 	tcbe	0x04, BIOS_L04		; CONOUT
                 	tcbe	0x05, BIOS_L05		; LIST
                 	tcbe	0x06, BIOS_L06		; PUNCH
                 	tcbe	0x07, BIOS_L07		; READER
                 	tcbe	0x08, BIOS_L08		; HOME
                 	tcbe	0x09, BIOS_L09		; SELDISK
                 	tcbe	0x0a, BIOS_L0A		; SETTRK
                 	tcbe	0x0b, BIOS_L0B		; SETSEC
                 	tcbe	0x0c, BIOS_L0C		; SETDMA
                 	tcbe	0x0d, BIOS_L0D		; READ
                 	tcbe	0x0e, BIOS_L0E		; WRITE
                 	tcbe	0x0f, BIOS_L0F		; LISTST
                 	tcbe	0x10, BIOS_L10		; SECTRN
                 	
                 	;!!! internal only calls !!!
                 	tcbe	0xf0, BIOS_Lf0		; CRISS: append to con buffer
                 	tcbe	0xf1, BIOS_Lf1		; CRISS: append to pr buffer
                 	tcbe	0xfb, ECON_GET_ATTR	; get attribute for curr char, return to temp
                 	tcbe	0xfc, ECON_SET_ATTR	; set attribute in zzC
                 	tcbe	0xfd, BIOS_CRT_CHAR	; raw send char to CRT
                 	tcbe	0xfe, BIOS_SET_VIDEO_MODE ; SET VIDEO MODE
                 	tcbe	0xff, _BIOS_RESET	; RESET
                 */
                 #include "bdos.def"
                 
                 .EQU	BDOS_02_CONOUT	= 0x02 ; WRITE CONSOLE  -7 CHAR IN E  NONE
                 .EQU	BDOS_03_AUXIN	= 0x03 ; AUXILIARY INPUT
                 .EQU	BDOS_03_RDRIN	= 0x03 ; READ READER    NONE             -7 CHAR IN A
                 .EQU	BDOS_04_AUXOUT	= 0x04 ; AUXILIARY OUTPUT
                 .EQU	BDOS_04_PUNOUT	= 0x04 ; WRITE PUNCH    -7 CHAR IN E  NONE
                 .EQU	BDOS_05_LSTOUT	= 0x05 ; WRITE LIST     -7 CHAR IN E  NONE
                 .EQU	BDOS_06_DCONIO	= 0x06 ; DIRECT CON I/O -7 CHAR IN E  I/O STATUS IN A
                 ;                                                          IF E=0FEH,
                 ;                                                         INPUT IF E=0FFH
                 .EQU	BDOS_07_AUXIST	= 0x07 ; GET AUXIN: STATUS               A=FF IS CHARACTER
                 ;                                                         READY, A=0 IF NONE
                 .EQU	BDOS_07_GTIOB	= 0x07 ; GET I/O STATUS NONE             I/O STATUS IN A
                 .EQU	BDOS_08_AUXOST	= 0x08 ; GET AUXOUT: STATUS              A=FF IF READY, A=0
                 ;	                                                         IF NOT READY
                 .EQU	BDOS_08_PTIOB	= 0x08 ; PUT I/O STATUS I/O STATUS IN E  NONE
                 .EQU	BDOS_09_PRSTR	= 0x09 ; PRINT STRING   STRING-ADDRESS   NONE
                 ;                                        IN DE (TERM=$)
                 .EQU	BDOS_0A_RDSTR	= 0x0A ; READ BUFFER    BUFFER-ADDRESS  READ BUFFER FILLED
                 ;                                        IN DE
                 ;       READ BUFFER     BYTE    FUNCTION
                 ;                          1     MAXIMUM BUFFER LENGTH
                 ;                          2     CURRENT BUFFER LENGTH (RETURNED VALUE)
                 ;                        3-N     DATA (RETURNED VALUES)
                 ; 
                 .EQU	BDOS_0B_CONSTA	= 0x0B ; CONSOLE STAT   NONE            LSB(A)=1 IF CHAR READY
                 .EQU	BDOS_0D_INBDOS	= 0x0D ; INIT BDOS      NONE            NONE
                 .EQU	BDOS_0E_LOGDSK	= 0x0E ; LOG-IN DISK    VALUE IN E      NONE
                 ;                                        A=0,B=1,...
                 .EQU	BDOS_0F_OPENF	= 0x0F ; OPEN FILE      FCB-ADDR IN DE  BYTE ADDR.OF FCB,
                 ;                                                         OR 0FFH IF NOT
                 .EQU	BDOS_10_CLOSF	= 0x10 ; CLOSE FILE     FCB-ADDR IN DE  BYTE ADDR.OF FCB,
                 ;                                                         OR 0FFH IF NOT
                 .EQU	BDOS_11_SFIRST	= 0x11 ; SEARCH FILE    FCB-ADDR IN DE  BYTE ADDR.OF FCB(0-3),
                 ;                                                         OR 0FFH IF NOT
                 .EQU	BDOS_12_SNEXT	= 0x12 ; SEARCH NEXT    FCB-ADDR IN DE  BYTE ADDR.OF NEXT FCB,
                 ;                                                         OR 0FFH IF NOT
                 .EQU	BDOS_13_DELF	= 0x13 ; DELETE FILE    FCB-ADDR IN DE  BYTE ADDR.OF FCB(0-3),
                 ;                                                         OR 0FFH IF NOT
                 .EQU	BDOS_14_READF	= 0x14 ; READ RECORD    FCB-ADDR IN DE  0=SUCCESSFUL READ
                 ;                                                        1=READ PAST EOF
                 ;                                                        2=READING RANDOM DATA
                 .EQU	BDOS_15_WRITEF	= 0x15 ; WRITE RECORD   FCB-ADDR IN DE  0=SUCCESSFUL WRITE
                 ;                                                        1=ERROR EXTENDING
                 ;                                                        2=END OF DISK DATA
                 ;                                                        255=NO MORE DIR SPACE
                 .EQU	BDOS_16_MAKEF	= 0x16 ; 
                 .EQU	BDOS_17_RENAM	= 0x17 ; 
                 .EQU	BDOS_18_RDLOG	= 0x18 ; RET. LOG CODE  NONE            LOGIN VECTOR IN HL
                 .EQU	BDOS_19_RDDRV	= 0x19 ; READ DRIVE #   NONE            # OF LOGGED IN DRIVE IN
                 ;                                                        (A=0,B=1,C=2....)
                 .EQU	BDOS_1A_SETDMA	= 0x1A ; SET DMA ADDR.  ADDR. OF 128    NONE
                 ;                                        BYTE BUFFER IN DE
                 .EQU	BDOS_1B_GETALV	= 0x1B ; GET ALL.VECT.  NONE            ALL.VECT IN HL
                 .EQU	BDOS_1C_WRTPRT	= 0x1C ; WRITE PROT DSK NONE            NONE
                 .EQU	BDOS_1D_GETROV	= 0x1D ; GET R/O VECT.  NONE            HL= R/O VECT. VALUE
                 .EQU	BDOS_1E_SETFAT	= 0x1E ; SET FILE ATTR. FCB-ADDR.IN DE  DIR. CODE IN A
                 .EQU	BDOS_1F_GTDPAR	= 0x1F ; GET DSK PAR.   NONE            HL=DPB ADDRESS
                 .EQU	BDOS_20_USRCOD	= 0x20 ; GET/SET USR.CD E=0FFH (GET)    A=CURRENT CODE (GET)
                 ;                                        E-CODE (SET)    A=NO VALUE (SET)
                 .EQU	BDOS_21_RRAND	= 0x21 ; READ  RANDOM   FCB-ADDR IN DE  A=RETURN CODE
                 .EQU	BDOS_22_WRAND	= 0x22 ; WRITE RANDOM   FCB-ADDR IN DE  1=READ'G UNWRITTEN DATA
                 ;                                                        2=(NOT USED)
                 ;                                                        3=CAN'T CLOSE CURR. EXT
                 ;                                                        4=SEEK TO UNWR. EXT.
                 ;                                                        5=DIR OVERFLOW(WRITE)
                 ;                                                        6=SEEK PAST END OF DSK
                 .EQU	BDOS_23_CFLSZ	= 0x23 ; COMP FILE SZ.  FCB ADDR.IN DE  RAND.REC.FIELD SET TO
                 ;                                                         FILE SIZE
                 .EQU	BDOS_24_SETRAR	= 0x24 ; SET RAND. REC. FCB-ADDR.IN DE  RAND.REC.FIELD SET
                 
                 ;.MACRO	IRQ_INT
                 ;	sbi	GPIOR0, 7
                 ;	sbi	GPIOR0, @0
                 ;	reti
                 ;.ENDM
                 
                 .ORG 	0
000000 c066      	rjmp	RESET
                 
                 .ORG	PCI3addr
00000e c043      	rjmp	PCI3_INT
                 
                 .ORG	OC2Aaddr
000012 c033      	rjmp	TMR_10MS_INC
                 
                 .ORG	URXC1addr
000038 c020      	rjmp	URXC1_INT
                 
                 .ORG	UDRE1addr
00003a 9af6      	sbi	GPIOR0, IRQ_V_TTX
00003b c01e      	rjmp	INT_RETI
                 
                 #include "spi.def"
                 
                 .EQU    SPI_SLAVE_RTC   = (1<<PB1)|(1<<PB3)                     ; Y1 +8
                 .EQU    SPI_SLAVE_ROM   = (1<<PB2)|(1<<PB3)			; Y2 +8
                 .EQU    SPI_SLAVE_CRST  = (1<<PB1)|(1<<PB2)|(1<<PB3)            ; Y3 +8
                 .EQU    SPI_SLAVE_LAN   = (1<<PB0)|(1<<PB3)			; Y4 +8
                 .EQU    SPI_SLAVE_BUZ   = (1<<PB0)|(1<<PB1)|(1<<PB3)            ; Y5 +8
                 ;.EQU    SPI_SLAVE_IRQ   = (1<<PB0)|(1<<PB1)|(1<<PB3)            ; Y5 +8
                 .EQU    SPI_SLAVE_SD    = (1<<PB0)|(1<<PB2)|(1<<PB3)            ; Y6 +8
                 .EQU    SPI_SLAVE_LED   = (1<<PB0)|(1<<PB1)|(1<<PB2)|(1<<PB3)   ; Y7 +8
                 .EQU    SPI_SLAVE_CAN   = (1<<PB0)|(1<<PB1)|(1<<PB2)|(1<<PB3)   ; Y7 +8
                 
                 .EQU    SPI_SLAVE_CLR   = (1<<PB0)|(1<<PB1)|(1<<PB2)    	; Y7
                 
                 ;.EQU    SPI_SLAVE_EXT   = (1<<PB1)|(1<<PB2)    			; Y6 - test ext mode
                 
                 .EQU    SPI_FCK_SPI2X 	= 0x10
                 
                 .EQU    SPI_FCK_DIV_2   = (SPI_FCK_SPI2X)|0
                 .EQU    SPI_FCK_DIV_4   = 0
                 .EQU    SPI_FCK_DIV_8   = (SPI_FCK_SPI2X)|(1<<SPR0)
                 .EQU    SPI_FCK_DIV_16  = (1<<SPR0)
                 .EQU    SPI_FCK_DIV_64	= (1<<SPR1)
                 .EQU    SPI_FCK_DIV_128	= (1<<SPR0)|(1<<SPR1)
                 
                 .EQU    SPI_FCK_DIV_16_CPHA	= (1<<SPR1) | (1<<CPHA) 
                 .EQU    SPI_FCK_DIV_64_CPHA	= (1<<SPR1) | (1<<CPHA) 
                 
                 ; Init SPI: @0 = slave address, @1 = prescaler settings
                 .MACRO	SPI_INIT
                 	push  	temp
                   	_out	PORTB, (1<<PB4) | @0  ; SPI disabled
                 	_out	DDRB, (1<<PB0)|(1<<PB1)|(1<<PB2)|(1<<PB3)|(1<<PB4)|(1<<PB7)|(1<<PB5)
                 
                   	_out	SPSR, (@1)>>4	; SPI2X
                   	_out	SPCR, (1<<SPE) | (1<<MSTR) | ((@1) & 0x0f)	; Start SPI in Master Mode @1 = clock divider
                 
                   	cbi	PORTD, PD1		; enable SPI decoder
                 	pop   	temp
                 .ENDM
                 
                 
                 ; Init SPI from stack: temp contains address, first pop returns prescaler
                 .MACRO	SPI_INIT_STACK
                 ;	pop  	temp
                 	andi	temp, 0x0f		; mask just for the case
                 	ori	temp, (1<<PB4)
                 	out	PORTB, temp
                 ;  	_out	PORTB, (1<<PB4) | @0  ; SPI disabled
                 	_out	DDRB, (1<<PB0)|(1<<PB1)|(1<<PB2)|(1<<PB3)|(1<<PB4)|(1<<PB7)|(1<<PB5)
                 
                 	pop	temp		; get prescaler
                 	push	temp		; save for the next step prescaler
                 	swap	temp
                 	andi	temp, 0x01	; SPI2X flag if any
                   	out	SPSR, temp	; SPI2X
                 
                 	pop	temp		; get prescaler
                 	andi	temp, 0x0f
                 	ori	temp, (1<<SPE) | (1<<MSTR)
                 	out	SPCR, temp
                 ;  	_out	SPCR, (1<<SPE) | (1<<MSTR) | @1	; Start SPI in Master Mode 20/4 MHz
                 
                   	cbi	PORTD, PD1		; enable SPI decoder
                 ;	pop   	temp
                 .ENDM
                 
                 
                 ; select slave
                 .MACRO	SPI_SELECT
                   	cbi	PORTB, PB4     ; select slave
                 .ENDM
                 
                 
                 ; deselect slave
                 .MACRO	SPI_DESELECT
                   	sbi	PORTB, PB4     ; deselect slave
                 .ENDM
                 
                 
                 ; disable SPI
                 .MACRO	SPI_STOP
                 ;	push	temp
                 ;	_out	SPCR, 0       		; disable SPI
                 	out	SPCR, zero       	; disable SPI
                   	sbi	PORTD, PD1		; disable SPI decoder
                 ;    	_out  	DDRB, 0       		; release data port
                     	out  	DDRB, zero       	; release data port
                 ;    	pop   	temp
                 .ENDM
                 
                 
                 .MACRO	FAST_SPI
                 	out	SPDR, temp
                 DOSPI_L1:	
                 	in	temp, SPSR
                 	sbrs	temp, SPIF
                 	rjmp	DOSPI_L1
                 	in	temp, SPDR
                 .ENDM
                 
                 ; send data to SPI
                 .MACRO	iSPI
                 	ldi	temp, @0
                 	call	DOSPI
                 .ENDM
                 
                 ; send data to SPI
                 .MACRO	tSPI
                 	ldi	temp, @0
                 	call	DOSPI
                 .ENDM
                 
                 ; send data to SPI
                 .MACRO	rSPI
                 	mov	temp, @0
                 	call	DOSPI
                 .ENDM
                 #include "lan.def"
                 
                 .EQU	LAN_EIE		= 0x1B
                 .EQU	LAN_EIR		= 0x1C
                 .EQU	LAN_ESTAT	= 0x1D
                 .EQU	LAN_ECON2	= 0x1E
                 .EQU	LAN_ECON1	= 0x1F
                 
                 ; bank 0
                 .EQU	LAN_ERDPT	= 0x00
                 .EQU	LAN_ERDPTL	= 0x00
                 .EQU	LAN_ERDPTH	= 0x01
                 
                 .EQU	LAN_EWRPT	= 0x02
                 .EQU	LAN_EWRPTL	= 0x02
                 .EQU	LAN_EWRPTH	= 0x03
                 
                 .EQU	LAN_ETXST	= 0x04
                 .EQU	LAN_ETXSTL	= 0x04
                 .EQU	LAN_ETXSTH	= 0x05
                 
                 .EQU	LAN_ETXND	= 0x06
                 .EQU	LAN_ETXNDL	= 0x06
                 .EQU	LAN_ETXNDH	= 0x07
                 
                 .EQU	LAN_ERXST	= 0x08
                 .EQU	LAN_ERXSTL	= 0x08
                 .EQU	LAN_ERXSTH	= 0x09
                 
                 .EQU	LAN_ERXND	= 0x0a
                 .EQU	LAN_ERXNDL	= 0x0a
                 .EQU	LAN_ERXNDH	= 0x0b
                 
                 .EQU	LAN_ERXRDPT	= 0x0c
                 .EQU	LAN_ERXRDPTL	= 0x0c
                 .EQU	LAN_ERXRDPTH	= 0x0d
                 
                 ; bank 1
                 .EQU	LAN_ERXFCON	= 0x18
                 .EQU	LAN_EPKTCNT	= 0x19
                 
                 
                 ; bank 2
                 .EQU	LAN_MACON1	= 0x00
                 .EQU	LAN_MACON3	= 0x02
                 .EQU	LAN_MACON4	= 0x03
                 .EQU	LAN_MABBIPG	= 0x04
                 
                 .EQU	LAN_MAIPG	= 0x06
                 .EQU	LAN_MAIPGL	= 0x06
                 .EQU	LAN_MAIPGH	= 0x07
                 
                 .EQU	LAN_MAMXFL	= 0x0a
                 .EQU	LAN_MAMXFLL	= 0x0a
                 .EQU	LAN_MAMXFLH	= 0x0b
                 
                 .EQU	LAN_MICMD	= 0x12
                 .EQU	LAN_MIREGADR	= 0x14
                 
                 .EQU	LAN_MIWR	= 0x16
                 .EQU	LAN_MIWRL	= 0x16
                 .EQU	LAN_MIWRH	= 0x17
                 
                 .EQU	LAN_MIRD	= 0x18
                 .EQU	LAN_MIRDL	= 0x18
                 .EQU	LAN_MIRDH	= 0x19
                 
                 ; bank 3
                 .EQU	LAN_MAADR5	= 0x00
                 .EQU	LAN_MAADR6	= 0x01
                 .EQU	LAN_MAADR3	= 0x02
                 .EQU	LAN_MAADR4	= 0x03
                 .EQU	LAN_MAADR1	= 0x04
                 .EQU	LAN_MAADR2	= 0x05
                 
                 .EQU	LAN_EREVID	= 0x12
                 
                 ; PHY regs
                 .EQU	LAN_PHCON1	= 0x00
                 .EQU	LAN_PHSTAT1	= 0x01
                 .EQU	LAN_PHID1	= 0x02
                 .EQU	LAN_PHID2	= 0x03
                 .EQU	LAN_PHCON2	= 0x10
                 .EQU	LAN_PHSTAT2	= 0x11
                 .EQU	LAN_PHIE	= 0x12
                 .EQU	LAN_PHIR	= 0x13
                 .EQU	LAN_PHLCON	= 0x14
                 
                 ; control comands
                 .EQU	LAN_REG_RCR	= 0x00 << 5
                 .EQU	LAN_REG_READ	= LAN_REG_RCR	; alias
                 .EQU	LAN_REG_RBM	= 0x01 << 5
                 .EQU	LAN_REG_WCR	= 0x02 << 5
                 .EQU	LAN_REG_WRITE	= LAN_REG_WCR	; alias
                 .EQU	LAN_REG_WBM	= 0x03 << 5	
                 .EQU	LAN_REG_BFS	= 0x04 << 5
                 .EQU	LAN_REG_BFC	= 0x05 << 5
                 .EQU	LAN_REG_SRC	= 0x07 << 5
                 
                 ; bank settings
                 .EQU	LAN_BANK0	= 0x00
                 .EQU	LAN_BANK1	= 0x01
                 .EQU	LAN_BANK2	= 0x02
                 .EQU	LAN_BANK3	= 0x03
                 
                 ; RW buffer settings
                 .EQU	LAN_M_BUFSIZE	= 0x2000
                 .EQU	LAN_M_RXSIZE	= 0x1a00
                 .EQU	LAN_M_BUFEND	= LAN_M_BUFSIZE-1
                 .EQU	LAN_M_MAXFRAME	= 1500
                 .EQU	LAN_M_RXSTART	= 0x0000
                 .EQU	LAN_M_RXEND	= LAN_M_RXSIZE-1
                 .EQU	LAN_M_TXSTART	= LAN_M_RXSIZE
                 .EQU	LAN_M_TXEND	= LAN_M_BUFSIZE-1
                 
                 
                 ;LAN COMMANDS
                 .EQU	LAN_FUNC_INIT         = 0
                 .EQU	LAN_FUNC_INIT_CUSTOM  = 1
                 .EQU	LAN_FUNC_COPY_RAM_BUF = 2
                 .EQU	LAN_FUNC_COPY_BUF_RAM = 3	; copy FULL buffer
                 .EQU	LAN_FUNC_GET_ETH_REG  = 4	; copy FULL buffer
                 .EQU	LAN_FUNC_GET_MX_REG   = 5
                 .EQU	LAN_FUNC_SEND         = 6
                 .EQU	LAN_FUNC_RECEIVE      = 7
                 .EQU	LAN_FUNC_GET_EPKTCNT  = 8
                 .EQU	LAN_FUNC_UPDATE_REG   = 9
                 .EQU	LAN_FUNC_GET_PHY_REG  = 10
                 .EQU	LAN_FUNC_LAN_IP_CRC   = 11
                 .EQU	LAN_FUNC_BUILD_IP     = 12
                 .EQU	LAN_FUNC_BUILD_UDP    = 13
                 .EQU	LAN_FUNC_ARP_RESP     = 14
                 .EQU	LAN_FUNC_BUILD_ETH    = 15
                 .EQU	LAN_FUNC_CHECK_FRAME  = 16
                 .EQU	LAN_FUNC_GET_ESTAT    = 17
                 .EQU	LAN_FUNC_PROCESS      = 18
                 .EQU	LAN_FUNC_GET_UDP_DATA = 19
                 .EQU	LAN_FUNC_BUILD_ARP_REQ= 20
                 .EQU	LAN_FUNC_SEND_UDP     = 21
                 .EQU	LAN_FUNC_PING_REQ     = 22	;!!! replaced from previous version !!!
                 .EQU	LAN_FUNC_PING_RESP    = 23	
                 ;SYSTEM CALLS
                 .EQU	LAN_FUNC_SEND_SRV     = 119
                 .EQU	LAN_FUNC_SEND_PR      = 120
                 .EQU	LAN_FUNC_SEND_PRN     = 121	; remote PRN server
                 .EQU	LAN_FUNC_SEND_RSD     = 122	; remote SD server
                 ;.EQU	LAN_FUNC_ = 
                 ;.EQU	LAN_FUNC_ = 
                 
                 .EQU	LAN_PROTOCOL_ETH  = 8
                 .EQU	LAN_PROTOCOL_IPH  = 8
                 .EQU	LAN_PROTOCOL_IPL  = 0
                 .EQU	LAN_PROTOCOL_UDP  = 17
                 .EQU	LAN_PROTOCOL_TCP  = 6
                 .EQU	LAN_PROTOCOL_ICMP = 1
                 
                 .EQU	LAN_PROT_ICMP_ECHO  = 0
                 .EQU	LAN_PROT_ICMP_PING  = 8
                 
                 .EQU	LAN_INPUT_ARP_IN    = 0x81	; ARP
                 .EQU	LAN_INPUT_ARP_RESP  = 0x82	; ARP
                 .EQU	LAN_INPUT_UDP_MAIN  = 0x83	; UDP to main
                 .EQU	LAN_INPUT_UDP_PR    = 0x84	; UDP to PRSRV
                 .EQU	LAN_INPUT_UDP_SRV   = 0x85	; UDP to SRV
                 
                 .EQU	LAN_INPUT_PING_IN   = 0x8a	; Ping request received
                 .EQU	LAN_INPUT_PING_RESP = 0x8b	; Ping request echo received
                 
                 
                 .MACRO	LAN_ETH_REG_READ
                         SPI_SELECT
                 	iSPI	LAN_REG_READ | @0
                 	iSPI	0xff		; read data
                         SPI_DESELECT
                 .ENDM
                 
                 ; reg number from stacl
                 .MACRO	LAN_ETH_REG_READ_S
                         SPI_SELECT
                         pop	temp
                         ori	temp, LAN_REG_READ
                         call	DOSPI
                 	iSPI	0xff		; read data
                         SPI_DESELECT
                 .ENDM
                 
                 .MACRO	LAN_Mx_REG_READ
                         SPI_SELECT
                 	iSPI	LAN_REG_READ | @0
                 	iSPI	0xff		; dummy byte skip
                 	iSPI	0xff
                         SPI_DESELECT
                 .ENDM
                 
                 .MACRO	LAN_Mx_REG_READ_S
                         SPI_SELECT
                         pop	temp
                         ori	temp, LAN_REG_READ
                         call	DOSPI
                 	iSPI	0xff		; dummy byte skip
                 	iSPI	0xff
                         SPI_DESELECT
                 .ENDM
                 
                 ; write @1 to register @0
                 .MACRO	LAN_CREG_WRITE_C
                         SPI_SELECT
                 	iSPI	(@2) | (@0)
                 	iSPI	@1
                         SPI_DESELECT
                 .ENDM
                 
                 ; write stack to register @0, oper @1
                 .MACRO	LAN_CREG_WRITE_C_S
                         SPI_SELECT
                 	iSPI	(@1) | (@0)
                 	pop	temp
                 	call	DOSPI
                 	SPI_DESELECT
                 .ENDM
                 
                 
                 ; write @1 to register @0
                 .MACRO	LAN_CREG_WRITE
                         SPI_SELECT
                 	iSPI	LAN_REG_WRITE | (@0)
                 	iSPI	(@1)
                         SPI_DESELECT
                 .ENDM
                 
                 ; write reg @1 to register @0
                 .MACRO	LAN_CREG_WRITE_R
                         SPI_SELECT
                 	iSPI	LAN_REG_WRITE | (@0)
                 	mov	temp, @1
                 	call	DOSPI
                 ;	iSPI	(@1)
                         SPI_DESELECT
                 .ENDM
                 
                 ; write word @1 to register @0
                 .MACRO	LAN_CREG_WRITE_LH
                         LAN_CREG_WRITE @0L, low(@1)
                         LAN_CREG_WRITE @0H, high(@1)
                 .ENDM
                 
                 ; write req @1 to register @0
                 .MACRO	LAN_CREG_WRITE_LH_R
                         LAN_CREG_WRITE_R @0L, @1L
                         LAN_CREG_WRITE_R @0H, @1H
                 .ENDM
                 
                 ; write data from stack to register @0
                 .MACRO	LAN_CREG_WRITE_S
                         SPI_SELECT
                 	iSPI	LAN_REG_WRITE | (@0)
                 	pop	temp
                 	call	DOSPI
                         SPI_DESELECT
                 .ENDM
                 
                 
                 ; write @1 to PHY register @0
                 .MACRO	LAN_WRITE_PHY
                 	LAN_CREG_WRITE LAN_MIREGADR, @0
                 	LAN_CREG_WRITE_LH LAN_MIWR, @1
                 	call	LAN_WAIT_10us
                 .ENDM
                 
                 
                 ;.EQU	CMDLAN_INIT_DEFAULT 	= 0
                 ;.EQU	CMDLAN_INIT_CUSTOM 	= 1
                 ;.EQU	CMDLAN_FILL_BUFER 	= 2
                 ;.EQU	CMDLAN_SEND_BUFER 	= 3
                 ;.EQU	CMDLAN_ETH_READ 	= 4
                 ;.EQU	CMDLAN_MX_READ 		= 5
                 ;.EQU	CMDLAN_SEND_FRAME 	= 6
                 ;.EQU	CMDLAN_GET_FRAME 	= 7
                 ;.EQU	CMDLAN_PCOUNT 		= 8
                 ;.EQU	CMDLAN_ETH_SET 		= 9
                 ;.EQU	CMDLAN_PHY_READ 	= 10
                 ;.EQU	CMDLAN_CRC 		= 11
                 ;.EQU	CMDLAN_BUILD_IP		= 12
                 ;.EQU	CMDLAN_BUILD_UDP	= 13
                 ;.EQU	CMDLAN_BUILD_ARP_RESP	= 14
                 ;.EQU	CMDLAN_BUILD_ETH	= 15
                 ;.EQU	CMDLAN_FRAME_TYPE	= 16
                 ;.EQU	CMDLAN_STAT		= 17
                 ;.EQU	CMDLAN_PROCESS		= 18
                 
                 ;.EQU	CMDLAN_SEND_UDP		= 21
                 ;.EQU	CMDLAN_REMOVE_UDP_HEADER= 22
                 
                 ; internal call only!
                 ;.EQU	CMDLAN_BUILD_UDP_LEAN	= 101
                 ;.EQU	CMDLAN_RAM_TO_ZZ_UDP	= 102
                 ;.EQU	CMDLAN_UDP_SET_L	= 103	
                 ;.EQU	CMDLAN_ZZ_TO_RAM_UDP	= 104
                 
                 ;.EQU	CMDLAN_SEND_SERVER	= 119
                 ;.EQU	CMDLAN_SEND_PR		= 120
                 
                 
                 .MACRO	EXEC_LAN_CMD
                 	ldi	temp, @0
                 	call	LAN_CMD
                 .ENDM
                 
                 .MACRO	_EXEC_LAN_CMD
                 	ldi	temp, @0
                 	rcall	_LAN_CMD
                 .ENDM
                 
                 ; write buffer starting Z Y bytes length
                 .MACRO	LAN_TBUF_WRITE
                         SPI_SELECT
                 	iSPI	LAN_REG_WBM | 0x1a	; WBM command
                 	iSPI	0		; per packet control byte, bit 0 = 0 == use MACON 3 settings
                 ltbw_l3:
                 	cpi	@1H, 0
                 	brne	ltbw_l1
                 	cpi	@1L, 0
                 	breq	ltbw_l2
                 ltbw_l1:
                 	ld	temp, @0+
                 	call	DOSPI
                 	sbiw	@1, 1
                 	rjmp	ltbw_l3
                 ltbw_l2:
                         SPI_DESELECT
                 .ENDM
                 
                 
                 ; read current paket to (@0), report data length to @1
                 .MACRO	LAN_TBUF_READ
                         SPI_SELECT
                 	iSPI	LAN_REG_RBM | 0x1a	; RBM command
                 
                 	call 	DOSPI
                 	sts	LAN_OP_RXDPT, temp 	; was LAN_RXDPT
                 	call 	DOSPI
                 	sts	LAN_OP_RXDPT+1, temp
                 
                 	call 	DOSPI
                 	mov	@1L, temp
                 	call 	DOSPI
                 	mov	@1H, temp		; received packet length
                 	cpiw	@1, 4			; is there data?
                 	brsh	ltbw_l5
                 	push	zero
                 	push	zero			; zero length to return
                 	rjmp	ltbw_l2			; empty packet
                 
                 ltbw_l5:
                 	sbiw	@1, 4			; remove crc from reading
                 
                 	;boundary check	
                 	lds	temp, LAN_OP_BUF_SIZE
                 	cp	@1L, temp
                 	lds	temp, LAN_OP_BUF_SIZE+1
                 	cpc	@1H, temp
                 	brlo	ltbw_l4
                 
                 	ldw	@1, LAN_OP_BUF_SIZE	; limit to BUF size
                 	
                 ltbw_l4:
                 	pushw	@1			; store data length to return
                 
                 	call 	DOSPI
                 	sts	LAN_RXSTATUS, temp 
                 	push	temp			; store lo byte for check
                 	call 	DOSPI
                 	sts	LAN_RXSTATUS+1, temp 
                 
                 	pop	temp			; status low byte
                 	sbrs	temp, 7			; check success
                 	rjmp	ltbw_l2			; exit on error
                 
                 ltbw_l3:				; read buffer
                 	cpi	@1H, 0
                 	brne	ltbw_l1
                 	cpi	@1L, 0
                 	breq	ltbw_l2
                 ltbw_l1:
                 	ldi	temp, 0xff
                 	call	DOSPI
                 	st	@0+, temp 
                 	sbiw	@1, 1
                 	rjmp	ltbw_l3
                 ltbw_l2:
                 	popw	@1			; restore length
                         SPI_DESELECT
                 ;	lds	temp, LAN_RXSTATUS 	; status for return
                 .ENDM
                 
                 
                 ; copy word normal to be
                 .MACRO	LAN_COPY_PORT
                 	lds	temp, @0
                 	sts	@1+1, temp
                 	lds	temp, @0+1
                 	sts	@1, temp
                 .ENDM
                 
                 .MACRO	stswbe
                 	sts	@0, @1H
                 	sts	@0+1, @1L
                 .ENDM
                 
                 
                 ; copy 6 bytes from (@1) to (@0)
                 .MACRO	COPY_MAC
                 	ldiw	Z, @1
                 	ldiw	X, @0
                 	rcall	_LAN_COPY_MAC
                 .ENDM
                 
                 ; copy 4 bytes from (@1) to (@0)
                 .MACRO	COPY_IP
                 	ldiw	Z, @1
                 	ldiw	X, @0
                 	rcall	_LAN_COPY_IP
                 .ENDM
                 
                 ; copy 2 bytes from (@1) to (@0)
                 .MACRO	COPY_PORT
                 	ldstt2	@0, @1
                 .ENDM
                 
                 ; set register to appropriate point in OP buffer
                 .MACRO	setlop
                 	ldw	@0, LAN_OP_BUF
                 	adiw	@0, @1-LAN_BUF			; set offset to LAN*_ETH_TYPE data
                 .ENDM
                 
                 #include "lan_local.def"		; settings for CRISS project
                 
                 ;.EQU	LAN_SPI_SETTINGS = SPI_FCK_DIV_4
                 .EQU	LAN_SPI_SETTINGS = SPI_FCK_DIV_2
                 
                 ; LAN LPM/ELPM command
                 .MACRO	celpm
                 	elpm	@0, @1
                 .ENDM
                 
                 ; LAN 10 us delay
                 .MACRO	_LAN_WAIT_10us
                 	push	temp
                 	delay3	210
                 	pop	temp
                 .ENDM
                 
                 .MACRO	DELAY_10us
                 	rcall	LAN_WAIT_10us
                 .ENDM	
                 
                 .MACRO	DELAY_10us_LC
                 	call	LAN_WAIT_10us
                 .ENDM
                 #include "can.def"
                 
                 .EQU	CAN_CMD_RESET	= 0b11000000
                 .EQU	CAN_CMD_READRX0	= 0b10010000	; read from the beginning
                 .EQU	CAN_CMD_READRX1	= 0b10010100
                 .EQU	CAN_CMD_WRITE	= 0b00000010
                 .EQU	CAN_CMD_LOADTX0	= 0b01000000	; load from beginning
                 .EQU	CAN_CMD_LOADTX1	= 0b01000010
                 .EQU	CAN_CMD_LOADTX2	= 0b01000100
                 .EQU	CAN_CMD_RTS	= 0b10000000
                 .EQU	CAN_CMD_RTS0	= 0b10000001
                 .EQU	CAN_CMD_RTS1	= 0b10000010
                 .EQU	CAN_CMD_RTS2	= 0b10000100
                 .EQU	CAN_CMD_STATUS	= 0b10100000
                 .EQU	CAN_CMD_RXSTAT	= 0b10110000
                 .EQU	CAN_CMD_BITMOD	= 0b00000101
                 
                 .EQU	CAN_REG_CANCTRL	= 0x0f
                 .EQU	CAN_REG_CANSTAT	= 0x0e
                 
                 .EQU	CAN_REG_CNF1	= 0x2a
                 .EQU	CAN_REG_CNF2	= 0x29
                 .EQU	CAN_REG_CNF3	= 0x28
                 
                 .EQU	CAN_REG_RXF0SIDH= 0x00
                 .EQU	CAN_REG_RXF0SIDL= 0x01
                 .EQU	CAN_REG_RXF0EID8= 0x02
                 .EQU	CAN_REG_RXF0EID0= 0x03
                 
                 .EQU	CAN_REG_RXM0SIDH= 0x20
                 .EQU	CAN_REG_RXM0SIDL= 0x21
                 .EQU	CAN_REG_RXM0EID8= 0x22
                 .EQU	CAN_REG_RXM0EID0= 0x23
                 
                 .EQU	CAN_REG_RXB0CTRL= 0x60
                 .EQU	CAN_REG_RXBnSIDH= 0x61
                 .EQU	CAN_REG_RXBnSIDL= 0x62
                 .EQU	CAN_REG_RXBnEID8= 0x63
                 .EQU	CAN_REG_RXBnEID0= 0x64
                 .EQU	CAN_REG_RXB0DLC = 0x65
                 
                 .EQU	CAN_REG_TXRTSCTRL=0x0d
                 
                 .EQU	CAN_REG_TXB0CTRL= 0x30		; TX buffer 0
                 .EQU	CAN_REG_TXB0SIDH= 0x31
                 .EQU	CAN_REG_TXB0SIDL= 0x32
                 .EQU	CAN_REG_TXB0EID8= 0x33
                 .EQU	CAN_REG_TXB0EID0= 0x34
                 .EQU	CAN_REG_TXB0DLC = 0x35
                 .EQU	CAN_REG_TXB0D0  = 0x36
                 .EQU	CAN_REG_TXB0D1  = 0x37
                 .EQU	CAN_REG_TXB0D2  = 0x38
                 .EQU	CAN_REG_TXB0D3  = 0x39
                 .EQU	CAN_REG_TXB0D4  = 0x3a
                 .EQU	CAN_REG_TXB0D5  = 0x3b
                 .EQU	CAN_REG_TXB0D6  = 0x3c
                 .EQU	CAN_REG_TXB0D7  = 0x3d
                 
                 ; commands definition
                 .EQU	CMDCAN_INIT	= 0
                 .EQU	CMDCAN_INIT_BUF	= 1
                 .EQU	CMDCAN_SEND	= 6
                 .EQU	CMDCAN_RECEIVE	= 7
                 .EQU	CMDCAN_RX_STATUS= 8
                 .EQU	CMDCAN_STATUS	= 17
                 .EQU	CMDCAN_SET_TXLEN= 21
                 .EQU	CMDCAN_ABORT_TX	= 22
                 .EQU	CMDCAN_TX_STATUS= 23
                 .EQU	CMDCAN_RESET	= 24
                 
                 
                 ; read register @0
                 .MACRO	CAN_READ_REG
                         SPI_SELECT
                 	iSPI	CAN_CMD_READ
                 	iSPI	@0
                 	iSPI	0xff		; read data
                         SPI_DESELECT
                 .ENDM
                 
                 ; write register @0 data @1
                 .MACRO	CAN_WRITE_REG
                         SPI_SELECT
                 	iSPI	CAN_CMD_WRITE
                 	iSPI	@0
                 	iSPI	@1		; read data
                         SPI_DESELECT
                 .ENDM
                 
                 ; read register @0
                 .MACRO	CAN_RESET
                         SPI_SELECT
                 	iSPI	CAN_CMD_RESET
                         SPI_DESELECT
                 .ENDM
                 
                 ; write zzC to register @0, uses temp
                 .MACRO	CAN_CALL_WRITE
                 	ldi	temp, @0
                 	rcall	CAN_EXEC_WRITE
                 .ENDM
                 
                 .MACRO	EXEC_CAN_CMD
                 	ldi	temp, @0
                 	call	CAN_CMD
                 .ENDM
                 
                 .MACRO	_EXEC_CAN_CMD
                 	ldi	temp, @0
                 	rcall	_CAN_CMD
                 .ENDM
                 #include "clr.def"
                 
                 .EQU 	CLR_CMD_DEFAULT 	= 0 ; set default mode/color
                 .EQU 	CLR_CMD_USER_COLOR 	= 1 ; 1 - set user static color
                 .EQU 	CLR_CMD_PATTERN 	= 2 ; 2 - pattern command
                 .EQU 	CLR_CMD_SET_X 		= 3 ; 3 - set X
                 .EQU 	CLR_CMD_SET_Y 		= 4 ; 4 - set Y
                 .EQU 	CLR_CMD_CLEAR_LINE 	= 5 ; 5 - clear line
                 .EQU 	CLR_CMD_CLEAR_SCREEN 	= 6 ; 6 - cler screen
                 .EQU 	CLR_CMD_SCROLL 		= 7 ; 7 - scroll
                 .EQU 	CLR_CMD_GOTO_PATTERN 	= 8 ; 8 - goto pattern mode
                 .EQU 	CLR_CMD_RAW 		= 0xff ; 0xff - raw command
                 
                 
                 .EQU 	CLR_CLR_BLACK 		= 0 ; 
                 .EQU 	CLR_CLR_RED 		= 1 ; 
                 .EQU 	CLR_CLR_GREEN 		= 2 ; 
                 .EQU 	CLR_CLR_YELLOW 		= 3 ; 
                 .EQU 	CLR_CLR_BLUE 		= 4 ; 
                 .EQU 	CLR_CLR_MAGENTA		= 5 ; 
                 .EQU 	CLR_CLR_CYAN 		= 6 ; 
                 .EQU 	CLR_CLR_WHITE 		= 7 ; 
                 
                 ; colors:
                 ; 1 - red
                 ; 2 - green
                 ; 3 - yellow
                 ; 4 - blue
                 ; 5 - magenta
                 ; 6 - cyan
                 ; 7 - white
                 
                 .MACRO	EXEC_CLR_CMD
                 	ldi	temp, @0
                 	call	CLR_CMD
                 .ENDM
                 
                 .ORG    INT_VECTORS_SIZE
                 
                 TMR_10MS_INC:				; inc timer counter
000046 935f      	push	temp
000047 b75f      	in	temp, SREG
000048 935f      	push	temp
000049 9150 3f56 	lds	temp, TMR_10MS
00004b 9553      	inc	temp
00004c 9350 3f56 	sts	TMR_10MS, temp
00004e 915f      	pop	temp
00004f bf5f      	out	SREG, temp
000050 915f      	pop	temp
000051 9518      	reti
                 
                 PCI3_INT:
000052 994f              sbic	PIND, 7
000053 9af0      	sbi	GPIOR0, IRQ_V_LAN
000054 994e              sbic	PIND, 6
000055 9af2      	sbi	GPIOR0, IRQ_V_RTC
000056 9948              sbic	PIND, 0
000057 9af3      	sbi	GPIOR0, IRQ_V_CPD
000058 c001      	rjmp	INT_RETI			; response any interrupt, set up via enble/disable specifiq INT
                 
                 URXC1_INT:
000059 9af7      	sbi	GPIOR0, IRQ_V_TRX
                 
                 INT_RETI:
00005a 935f      	push	temp
00005b e25b      	ldi	temp, high(IRQOPCODES)	; next command will execute IRQ handler
00005c bd5b      	out	GPIOR2, temp		; !!!!! restore!!!!!
00005d 915f      	pop	temp
00005e 9518      	reti
                 
                 ; standard SPI output: in in temp, out to temp
                 DOSPI:
00005f bd5e      	out	SPDR, temp
                 DOSPI_L1:	
000060 b55d      	in	temp, SPSR
000061 ff57      	sbrs	temp, SPIF
000062 cffd      	rjmp	DOSPI_L1
000063 b55e      	in	temp, SPDR
000064 9508      	ret
                 
                 ; output to videoram
                 VIDEO:
000065 0000      	nop
000066 9508      	ret
                 
                 RESET:
000067 e450
000068 bf5e
000069 ef5f
00006a bf5d        	_outw	SPL, SPH, RAMEND	; init stack pointer
00006b 940e 8800 	call	INITPROC
00006d 940e b507 	call	HW_INIT
00006f 940e 8802     	call	z80INITPROC
000071 940e 8804     	call	DOSTART    		; welcome and initial tests
000073 c18c      	rjmp	z80_start
                 
                 #include "z80.def"
                 
                 	.EQU	ADDRLPORT 	= PORTA
                 	.EQU	CTRLPORT 	= PORTD
                 	.EQU	DATAPORT 	= PORTB
                 	.EQU	DATADDR 	= DDRB
                 	.EQU	DATAPIN 	= PINB
                 	.EQU	RWE 		= PD5
                 	.EQU	ROE 		= PD4
                 
                 	; z80 flags
                 	.EQU	zzZF = 1
                 	.EQU	zzCF = 0
                 	.EQU	zzPF = 3
                 	.EQU	PF = zzPF
                 	.EQU	zzSF = 2
                 	.EQU	zzVF = 3
                 	.EQU	zzHF = 5
                 	.EQU	zzNF = 6
                 	.EQU	zzIF = 7
                 
                 	.EQU	_I_ = 1<<zzIF
                 	.EQU	_Z_ = 1<<zzZF
                 	.EQU	_C_ = 1<<zzCF
                 	.EQU	_P_ = 1<<zzPF
                 	.EQU	_S_ = 1<<zzSF
                 	.EQU	_V_ = 1<<zzVF
                 	.EQU	_H_ = 1<<zzHF
                 	.EQU	_N_ = 1<<zzNF
                 	.EQU	___ = 0
                 
                 
                 ; read from RAM from current position 0 = reseiver, inc PC
                 .MACRO LDRAM_PC
                 	out 	ADDRHPORT, zzPCh      	; +1
                 	out 	ADDRLPORT, zzPCl	; +1
                 	out 	DATADDR, ZERO          	; +1
                 ;	nop
                 ;	cbi   	PORTD, PD4              ; +2 /OE pulse start
                 	out	CTRLPORT, RAMOE		; +1
                 ;       nop
                 	adiw	zzPCl,1			; +2
                 	in	@0, DATAPIN           	; +1	
                 	out	CTRLPORT, FF		; +1    =+9
                 .ENDM	
                 
                 .MACRO LDRAM_PC_NODDR
                 	LDRAM_PC @0
                 .ENDM
                 
                 .MACRO _LDRAM_PC_NODDR
                 	out 	ADDRHPORT, zzPCh      	; +1
                 	out 	ADDRLPORT, zzPCl	; +1
                 	out 	DATADDR, ZERO          	; +1
                 ;	sbi	CTRLPORT, ROE		; +2
                 ;	inc	zzR			; +1 
                 ;	nop
                 ;	cbi   	PORTD, PD4              ; /OE pulse start
                 	out	CTRLPORT, RAMOE		; +1
                 ;	nop
                 ;	nop
                 	adiw	zzPCl,1			; +2
                 	in	@0, DATAPIN           	; +1	
                 ;	cbi	CTRLPORT, ROE		; +2
                 	sbi	CTRLPORT, 4	;!!!!    !!!!	
                 ;	out	CTRLPORT, FF		; +1    =+8
                 .ENDM	
                 
                 .MACRO LDRAM_NODDR
                 	out 	ADDRHPORT, @0      	; +1
                 	out 	ADDRLPORT, @1		; +1
                 	out 	DATADDR, ZERO          	; +1
                 ;	nop
                 ;	cbi   	PORTD, PD4              ; /OE pulse start
                 	out	CTRLPORT, RAMOE		; +1
                 	nop
                 	nop
                 	in	@2, DATAPIN           	; +1	
                 	out	CTRLPORT, FF		; +1    =+9
                 .ENDM	
                 
                 .MACRO LDRAM
                 	out 	ADDRHPORT, @0      	; +1
                 	out 	ADDRLPORT, @1		; +1
                 	out 	DATADDR, ZERO          	; +1
                 ;	nop
                 ;	cbi   	PORTD, PD4              ; /OE pulse start
                 	out	CTRLPORT, RAMOE		; +1
                 	nop
                 	nop
                 	in	@2, DATAPIN           	; +1	
                 	out	CTRLPORT, FF		; +1    =+9
                 .ENDM	
                 
                 ; z80 load word (@2,@3) from ram (@0,@1)
                 .MACRO 	LDRW_NODDR
                     	mov 	FROMRAM1, @0
                 	mov 	FROMRAM2, @1
                 	LDRAM_NODDR FROMRAM1,FROMRAM2,@3
                 	INC2 	FROMRAM1, FROMRAM2
                 	LDRAM_NODDR FROMRAM1, FROMRAM2,@2
                 .ENDM	
                 
                 .MACRO _stram
                 	out   	PORTC, @0
                     	out   	PORTA, @1         	; set address
                 	out	PORTB, @2
                    	_out  	DDRB, 0xff        	; Data port to out
                 	cbi   	PORTD, PD5
                 	sbi	PORTD, PD5         	; /WE pulse
                 .ENDM
                 
                 .MACRO _ldram
                 	out   	PORTC, @0
                     	out   	PORTA, @1         	; set address
                 	_out	DDRB, 0			; Data port to in
                 ;	nop                             
                 	cbi   	PORTD, PD4              ; /OE pulse start
                 	nop                             
                 	in    	@2, PINB        	; read port value
                 	sbi	PORTD, PD4         	; /OE pulse end
                 .ENDM
                 
                 
                 .MACRO STRAM
                 	out 	ADDRHPORT, @0      	; +1
                 	out 	ADDRLPORT, @1		; +1
                 	out	DATAPORT, @2
                 	out 	DATADDR, FF          	; +1
                 ;        in	_sreg, SREG                 	;!!!!!! FOR (HL) OPERANDS!!!!!  !!!!!!
                 ;	sbi	CTRLPORT, RWE		; +2
                 ;	inc	zzR			; +1 
                         cp	@0, VIDEORAM		; +1		; videoram?
                 ;        nop
                 	cbi   	PORTD, PD5
                 ;	out	CTRLPORT, RAMWE		; +1
                 	brlo	STRAM_NOVRAM		; +2
                 ;        nop
                 
                 	out	CTRLPORT, FF		; +1  		; stop write
                 
                 	; video ram - send char to CPD
                 	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4		
                 	SPI_SELECT
                 	push	@2
                 	mov	temp, @0
                 	call	DOSPI
                 	delay3	12
                 	mov	temp, @1
                 	call	DOSPI
                 	delay3	12
                 	pop	temp
                 	call	DOSPI
                 	SPI_STOP
                 
                 STRAM_NOVRAM:
                 	out	CTRLPORT, FF		; +1    =+9
                 STRAM_END:
                 
                 .ENDM	
                 
                 .MACRO STRAM_NODDR
                 	STRAM	@0,@1,@2
                 .ENDM
                 
                 /*
                 .MACRO __STRAM_NODDR
                 	out 	ADDRHPORT, @0      	; +1
                 	out 	ADDRLPORT, @1		; +1
                 	out	DATAPORT, @2
                 ;	out 	DATADDR, FF          	; +1
                 ;	sbi	CTRLPORT, RWE		; +2
                 ;	inc	zzR			; +1 
                         cp	@0, VIDEORAM		; +1		; videoram?
                 	cbi   	PORTD, PD5
                 ;	out	CTRLPORT, RAMWE		; +1
                 	brlo	STRAM_NOVRAM		; +2
                 
                 	sbi	CTRLPORT, 5	;!!!!    !!!!	
                 ;	out	CTRLPORT, FF		; +1  		; stop write
                 	; video ram - send char to CPD
                 	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4		
                 	SPI_SELECT
                 	mov	temp, @0
                 	call	DOSPI
                 	mov	temp, @1
                 	call	DOSPI
                 	mov	temp, @2
                 	call	DOSPI
                 	SPI_STOP
                 	out 	DATADDR, FF          	; +1		; restore DDR
                 
                 STRAM_NOVRAM:
                 	sbi	CTRLPORT, 5	;!!!!    !!!!	
                 ;	out	CTRLPORT, FF		; +1    =+9
                 .ENDM	
                 */
                 
                 .MACRO STRAM_RAMONLY
                 	out 	ADDRHPORT, @0      	; +1
                 	out 	ADDRLPORT, @1		; +1
                 	out	DATAPORT, @2
                 	out 	DATADDR, FF          	; +1
                 ;        in	_sreg, SREG                 	;!!!!!! FOR (HL) OPERANDS!!!!!  !!!!!!
                 ;	sbi	CTRLPORT, RWE		; +2
                 ;	inc	zzR			; +1 
                 ;        cp	@0, VIDEORAM		; +1		; videoram?
                 ;        nop
                 	cbi   	PORTD, PD5
                 ;	out	CTRLPORT, RAMWE		; +1
                 ;	brlo	STRAM_NOVRAM		; +2
                         nop
                 
                 	out	CTRLPORT, FF		; +1  		; stop write
                 .ENDM	
                 
                 
                 ; increment word register: high, low
                 .MACRO INC2 
                 	add	@1, ONE
                 	adc 	@0, ZERO
                 .ENDM	
                 
                 ; decrement word register: high, low
                 .MACRO DEC2 
                 	sub	@1, ONE
                 	sbc 	@0, ZERO
                 .ENDM	
                 
                 ; add signed @2 to 16-bit unsigned @0(high) @1(low)
                 .MACRO ADDWS 
                 	clr 	zzTmp
                 	sbrc 	@2, 7
                 	com 	zzTmp
                 	add 	@1, @2
                 	adc 	@0, zzTmp
                 .ENDM
                 
                 ; exchange register with ram value: reg, ram
                 .MACRO EX 
                 	lds 	zzTmp, @1
                 	sts 	@1, @0
                 	mov 	@0, zzTmp
                 .ENDM	
                 
                 ; exchange registers: reg1, reg2
                 .MACRO EXR 
                 	mov 	zzTmp, @1
                 	mov 	@1, @0
                 	mov 	@0, zzTmp
                 .ENDM	
                 
                 ; z80 push command high,low
                 .MACRO zzPUSH
                 	DEC2 	zzSPh, zzSPl
                 	STRAM 	zzSPh, zzSPl, @0
                 	DEC2 	zzSPh, zzSPl
                 	STRAM 	zzSPh, zzSPl, @1
                 .ENDM	
                 
                 ; z80 push command high,low
                 .MACRO zzPOP
                 	LDRAM 	zzSPh, zzSPl, @1
                 	INC2 	zzSPh, zzSPl
                 	LDRAM 	zzSPh, zzSPl, @0
                 	INC2 	zzSPh, zzSPl
                 .ENDM	
                 
                 ; z80 set memory var (@0) to value (@1)
                 .MACRO zzSET
                 	ldi 	zzTmp, @1
                 	sts 	@0, zzTmp
                 .ENDM	
                 
                 .MACRO 	zzCPx
                 	sbr 	zzF, 1<<zzPF
                 	LDRAM_NODDR zzH, zzL, FROMRAM0
                 	@0 	zzH, zzL
                 	DEC2 	zzB, zzC
                 	cp	zzC, ZERO
                 	cpc	zzB, ZERO
                 	brne 	LBL_CPx_1		; P is set if BC!=0 now
                 	cbr 	zzF, 1<<zzPF
                 LBL_CPx_1:
                 	cp	zzA, FROMRAM0
                 .ENDM	
                 
                 .MACRO 	zzCPD
                 	zzCPx 	DEC2
                 .ENDM	
                 
                 .MACRO 	zzCPI
                 	zzCPx 	INC2
                 .ENDM	
                 
                 
                 .MACRO 	zzLDx
                 ;	inc zzR
                 	LDRAM 	zzH, zzL, zzTmp
                 	STRAM 	zzD, zzE, zzTmp
                 	@0 	zzH, zzL
                 	@0 	zzD, zzE
                 	DEC2 	zzB, zzC
                 	cbr 	zzF, 1<<zzPF
                 	cp	zzC, ZERO
                 	cpc	zzB, ZERO
                 	breq 	LBL_LDx_1
                 	sbr 	zzF, 1<<zzPF
                 	clz				; for LDIR command
                 LBL_LDx_1:
                 .ENDM	
                 
                 .MACRO	zzDAA
                 ;        pushw	Z
                 	ldi 	Xh, high(DAATABLE)
                         mov	Xl, zzA
                 
                         clr	zzTmp
                         sbrc	zzF, zzHF
                         sbr	zzTmp, 0x01
                        	sbrc	zzF, zzCF
                         sbr	zzTmp, 0x02
                         sbrc	zzF, zzNF
                         sbr	zzTmp, 0x04
                         add	Xh, zzTmp
                 
                         ld	zzA, X			; new A
                         ldi	zzTmp, 0x08
                         add	Xh, zzTmp			
                         ld	zzF, X			; new Flags
                 
                 ;	popw	Z
                 .ENDM
                 
                 .MACRO	zzRRD
                 	mov 	FROMRAM2,zzA
                 	mov 	FROMRAM1,FROMRAM0
                 	ldi 	zzTmp,0x0f
                 	and 	FROMRAM1,zzTmp
                 	and 	FROMRAM2,zzTmp
                 	ldi 	zzTmp,0xf0
                 	and 	zzA,zzTmp
                 	and 	FROMRAM0,zzTmp
                 	or 	zzA,FROMRAM1
                 	or 	FROMRAM0,FROMRAM2
                 	swap 	FROMRAM0
                 	STRAM 	zzH,zzL,FROMRAM0
                 	or	zzA, zzA
                 .ENDM
                 
                 .MACRO  zzRLD
                 	swap 	FROMRAM0
                 	mov 	FROMRAM2,zzA
                 	mov 	FROMRAM1,FROMRAM0
                 	ldi 	zzTmp,0x0f
                 	and 	FROMRAM1,zzTmp
                 	and 	FROMRAM2,zzTmp
                 	ldi 	zzTmp,0xf0
                 	and 	zzA,zzTmp
                 	and 	FROMRAM0,zzTmp
                 	or 	zzA,	FROMRAM1
                 	or 	FROMRAM0,FROMRAM2
                 	STRAM 	zzH,zzL,FROMRAM0
                 	or	zzA, zzA
                 .ENDM
                 
                 .MACRO  SET_P_FLAG
                 	; set P flag
                 	ldi Xh,high(PFTABLE)
                 	mov Xl,@0
                 	ld zzTmp,X
                 	or zzF,zzTmp
                 .ENDM
                 
                 ; mul: hl = hl*a & 0xffff, a = hl*a >> 16; Z if HL==0; C if A!=0
                 .MACRO	zMUL
                 	ldi	zzF, 0
                 	ldi	zzTmp, 0
                 	push	r0
                 	push	r1
                 	mul	zzL, zzA 		; r1:10 = l*a
                 	add	zzH, r1			; h += r1
                 	adc	zzTmp, zero		; tmp = (h+r1)>>8  - borrow
                 	mov	zzL, r0			; l = r0 	- set result
                 	mul	zzH, zzA		; r1:10 = h*a
                 	add	zzTmp, r1		; tmp += r1	- borrow
                 	mov	zzH, r0			; h = r0	- result
                 	mov	zzA, zzTmp		; a = hl*a >> 16 - result
                 	cpse	zzA, zero
                 	ori	zzF, _C_		; set C if a!=0
                 	mov	zzTmp, zzH
                 	or	zzTmp, zzL
                 	brne	m_not_zero	
                 	ori	zzF, _Z_		; set Z if hl==0
                 m_not_zero:
                 	pop	r1
                 	pop	r0
                 .ENDM
                 
                 ; div: hl = hl/a   a = hl % a    Z if HL==0;
                 .MACRO	zDIV
                   ; div: r25:r24 / r23:r22  , r23:r22 - result   r25:r24 - reminder
                   ; uses r21 (zzTmp), r26, r27
                         push	r24
                         push	r25
                         push	r26
                         push	r27
                 
                         mov	r25, zzH
                         mov	r24, zzL
                         mov	r23, zero
                         mov	r22, zzA
                 
                         ; div sub starts here
                 	sub	r26, r26
                 	sub	r27, r27
                 	ldi	r21, 0x11	; 17
                 	rjmp	lbl_9e; .+14     	;  0x9e
                 lbl_90:
                 	adc	r26, r26
                 	adc	r27, r27
                 	cp	r26, r22
                 	cpc	r27, r23
                 	brcs	lbl_9e		; .+4      	;  0x9e
                 	sub	r26, r22
                 	sbc	r27, r23
                 lbl_9e:
                 	adc	r24, r24
                 	adc	r25, r25
                 	dec	r21
                 	brne	lbl_90 		;.-22     	;  0x90
                 	com	r24
                 	com	r25
                 	movw	r22, r24
                 	movw	r24, r26
                 	; div sub ends here
                 
                 	mov	zzH, r23
                 	mov	zzL, r22		; result
                 
                 	mov	zzA, r24		; reminder
                 
                 	ldi	zzTmp, 0
                 
                 	cpse	zzA, zero
                 	ori	zzF, _C_		; set C if a!=0
                 
                 	mov	zzTmp, zzH
                 	or	zzTmp, zzL
                 	brne	m_not_zero	
                 	ori	zzF, _Z_		; set Z if hl==0
                 m_not_zero:
                 
                 	pop	r27
                 	pop	r26
                 	pop	r25
                 	pop	r24
                 ;	ret
                 
                 .ENDM
                 
                 .MACRO	zFLOAT
                 	call	FLOAT_zCMD	
                 #include "ports.def"                    ; i/o ports defines
                 
                 
                 .EQU	cpd_vstat	= cpd_base+0x00
                 .EQU	cpd_vcurh	= cpd_base+0x01
                 .EQU	cpd_vcurl	= cpd_base+0x02
                 
                 .EQU	cpd_kmodk	= cpd_base+0x03
                 
                 	.EQU	CTRL	= 0
                 	.EQU	SHIFT	= 1
                 	.EQU	SCRLOCK = 2
                 	.EQU	CAPSLOCK= 3
                 	.EQU	ALT	= 4
                 
                 
                 .EQU	cpd_kactk	= cpd_base+0x04
                 .EQU	cpd_kchar	= cpd_base+0x05
                 
                 .EQU	cpd_mpcmd	= cpd_base+0x06	; melody control port
                 
                 .EQU	cpd_twcmd	= cpd_base+0x07
                 .EQU	cpd_twdti	= cpd_base+0x08
                 
                 .EQU	cpd_micex	= cpd_base+0x09	; mouse x
                 .EQU	cpd_micey	= cpd_base+0x0a	; mouse y
                 
                 .EQU	cpd_sysrq	= cpd_base+0x0b
                 .EQU	cpd_sysaa	= cpd_base+0x0c
                 .EQU	cpd_sysvv	= cpd_base+0x0d
                 
                 .EQU	cpd_ctcvv	= cpd_base+0x0e	; CTC max count value
                 
                 .EQU	cpd_comtc	= cpd_base+0x0f	; COM-port Tx data counter (set =1 to transmit comtx data)
                 
                 ; res
                 
                 .EQU	cpd_mpbuf	= cpd_base+0x10	; 16 bytes
                 
                 .EQU	cpd_irqfl	= cpd_base+0x20
                 ;	.EQU	IRQ_COM_RX	= 7	; COM-port char received
                 ;	.EQU	IRQ_COM_TX	= 6     ; COM-port clear to send
                 ;	.EQU	IRQ_MOUSE	= 5     ; Mouse/joistick pointer changed
                 ;	.EQU	IRQ_____	= 4     ; 
                 ;	.EQU	IRQ_MUSIC	= 3	; MUSIC synthesator - end of melody
                 ;	.EQU	IRQ_CTC		= 2     ; Timer == 0
                 ;	.EQU	IRQ_GPIO	= 1     ; GPIO ????
                 ;	.EQU	IRQ_KBD		= 0 	; Keyboard key pressed
                 
                 .EQU	cpd_comst	= cpd_base+0x21
                 .EQU	cpd_comtx	= cpd_base+0x22
                 .EQU	cpd_comrx	= cpd_base+0x23
                 
                 ; --------------- SYSPORT COMMANDS ---------------------------------------
                 
                 .EQU	cpd_sys_read_request = 0x81
                 .EQU	cpd_sys_write_request = 0x82
                 
                 
                 ; --------------- PERIPHERIAL ACCESS -------------------------------------
                 
                 .EQU	rs232_status	= 0xC0
                 .EQU	rs232_data	= 0xC6
                 .EQU	rs232_baud	= 0xC4
                 
                 .EQU	cpd_gpior0	= 0x3E	; IRQ system flag register - do not use!
                 .EQU	cpd_gpior1	= 0x4A  ; IRQ mask register 
                 ;	.EQU	IRQ_COM_RX	= 7	; COM-port char received
                 ;	.EQU	IRQ_COM_TX	= 6     ; COM-port clear to send
                 ;	.EQU	IRQ_MOUSE	= 5     ; Mouse/joistick pointer changed
                 ;	.EQU	IRQ_____	= 4     ; 
                 ;	.EQU	IRQ_MUSIC	= 3	; MUSIC synthesator - end of melody
                 ;	.EQU	IRQ_CTC		= 2     ; Timer == 0
                 ;	.EQU	IRQ_GPIO	= 1     ; GPIO ????
                 ;	.EQU	IRQ_KBD		= 0 	; Keyboard key pressed
                 
                 .EQU	cpd_gpior2	= 0x4B
                 
                 .EQU	fe_user_base	= 128
                 .EQU	fe_res_base	= 96
                 .EQU	fe_rtc_base	= 80
                 .EQU	fe_lan_base	= 48
                 .EQU	fe_can_base	= 16
                 .EQU	fe_eeprom_base	= 2
                 .EQU	fe_sd_base	= 1
                 .EQU	fe_spi_base	= 0
                 
                 ; --------------- MACROS -------------------------------------------------
                 
                 .MACRO	nportin
                 	ldi	temp, @0
                 	call	CPDPORTIN
                 .ENDM
                 
                 .MACRO	nportout
                 	sts	CDATA+1, @1
                 	ldi	temp, @0
                 	call	CPDPORTOUT
                 .ENDM
                 
                 .MACRO	nportout_t
                 	ldi	temp, @1
                 	sts	CDATA+1, temp
                 	ldi	temp, @0
                 	call	CPDPORTOUT
                 .ENDM
                 
                 .MACRO	nportout_r
                 	sts	CDATA+1, @1
                 	mov	temp, @0
                 	call	CPDPORTOUT
                 .ENDM
                 
                 ; waiting sysport clearance
                 .MACRO	sysport_ready
                 _spi_l0:
                 	nportin cpd_sysrq
                 	cpi	temp, 0
                 	brne	_spi_l0		; wait clearance
                 .ENDM
                 
                 ; read from cpd sysport, @0 = sysport address/code
                 .MACRO	sysportin
                 	sysport_ready		; wait ready state
                 	nportout cpd_sysaa, @0	; out address 
                 	nportout cpd_sysrq, cpd_sys_read_request	; read request
                 	sysport_ready		; wait ready state
                 	nportin cpd_sysvv	; read data to temp
                 .ENDM
                 
                 ; write data to cpd sysport, @0 = sysport address/code, @1 = value
                 .MACRO	sysportout
                 	sysport_ready		; wait ready state
                 	nportout cpd_sysaa, @0	; out address 
                 	nportout cpd_sysvv, @1	; out data 
                 	nportout cpd_sysrq, cpd_sys_write_request	; send write request
                 .ENDM
                 
                 
                 #include "debug.def"                    ; debug defines
                 
                 	call	UART1_SEND
                 .ENDM
                 
                 .MACRO uDBGr
                 	mov	temp, @0
                 	call	UART1_SEND
                 .ENDM
                 
                 .MACRO uDBGc
                 	ldi	temp, @0
                 	call	UART1_SEND
                 .ENDM
                 
                 .MACRO uDBGcr
                 	uDBGc 	13
                 .ENDM	
                 
                 .MACRO uDBGh
                 	mov	temp, @0
                 	call	UART1_HEXOUT
                 .ENDM
                 
                 .MACRO uDBGh_temp
                 	pop	temp
                 	push	temp
                 	call	UART1_HEXOUT
                 .ENDM
                 
                 
                 .MACRO uDBGm
                 	lds	temp, @0
                 	call	UART1_HEXOUT
                 .ENDM
                 
                 .MACRO uDBGw
                 	mov	temp, @0
                 	call	UART1_HEXOUT
                 	mov	temp, @1
                 	call	UART1_HEXOUT
                 .ENDM
                 
                 .MACRO uDBGa
                 	mov	temp, @0
                 	call	UART1_HEXOUT
                 	mov	temp, @1
                 	call	UART1_HEXOUT
                 	uDBGc	':'
                 .ENDM
                 
                 	; debug zRAM cell
                 .MACRO uDBGz
                 	ldiw	Z, @0
                 	call	DBG_ZRAM
                 .ENDM
                 
                 
                 .MACRO NOTIFY
                 	push	temp
                 	lds	temp, SYS_NOTIFY	
                 	sbrc	temp, @0
                 	call	@1
                 	pop	temp
                 .ENDM
                 
                 .MACRO NOTIFYt
                 	sts	DBG_DATA, temp
                 	push	temp
                 	ldi	temp, @1
                 	sts	DBG_CODE, temp
                 	pop	temp
                 	NOTIFY	@0, DBG_TEMP
                 .ENDM
                 
                 .ORG  0x200              ; 04
                 
                 z80_START:
                 zCMD_NONI: ; NONI == zCMDstart
                 zCMD_start:
                 
                 ;	sbic	GPIOR0, 7		; check interrupt request
                 ;	call	EXTINTRPOC		; call if any	
                 ;	call	DEBUG_Z80
                 ;	call	DBG_UART_CMD
                 ;	ldi Xh, high(zOPCODE__LBLS_L)
000200 b5bb      	in 	Xh, GPIOR2		; high(zOPCODE__LBLS_L)
                 zCMDP_start:
000201 b998
000202 b982
000203 b854
000204 b83b
000205 9601
000206 b1a3
000207 b82b      	LDRAM_PC Xl			; command OPCODE
                 
                 zCMDP_decode:
000208 91ec      	ld Zl, 	X			; decoding processor pointer
000209 95b3      	inc Xh
00020a 91fc      	ld Zh, 	X
                 
00020b 9409      	ijmp				; goto command processing
                 
                 .ORG  0x300                ; 06
                 
                 #include "z80/z80_asm_cseg.asm"		; interrupts disabled block
                 
                 	
                 
000300 940c 0200 	jmp zCMD_start
                 
                 zCMD_01: ; LD   BC nn
000302 b998
000303 b982
000304 b854
000305 b83b
000306 9601
000307 b123
000308 b82b      	LDRAM_PC_NODDR FROMRAM2
000309 b998
00030a b982
00030b b854
00030c b83b
00030d 9601
00030e b013
00030f b82b      	LDRAM_PC_NODDR FROMRAM1
000310 2ca1      	mov zzB, FROMRAM1
000311 2f62      	mov zzC, FROMRAM2
                 
000312 940c 0200 	jmp zCMD_start
                 
                 zCMD_02: ; LD   (BC) A
000314 2f71      	mov FROMRAM0,zzA
                 
000315 b8a8
000316 b962
000317 b915
000318 b824
000319 14a6
00031a 985d
00031b f100
00031c b82b
00031d 935f
00031e e158
00031f b955
000320 eb5f
000321 b954
000322 e050
000323 bd5d
000324 e550
000325 bd5c
000326 9859
000327 915f
000328 982c
000329 931f
00032a 2d5a
00032b 940e 005f
00032d e054
00032e 955a
00032f f7f1
000330 2f56
000331 940e 005f
000333 e054
000334 955a
000335 f7f1
000336 915f
000337 940e 005f
000339 bc5c
00033a 9a59
00033b b854
00033c b82b      	STRAM zzB,zzC,zzA
00033d 940c 0200 	jmp zCMD_start
                 
                 zCMD_03: ; INC   BC
00033f 0d69
000340 1ca5      	INC2 zzB,zzC
                 
000341 940c 0200 	jmp zCMD_start
                 
                 zCMD_04: ; INC   B
000343 0ca9      	add zzB,ONE
                 
000344 b75f      	in zzTmp, SREG
000345 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000346 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
000347 2b45      	or zzF, zzTmp ; combine flags
000348 940c 0200 	jmp zCMD_start
                 
                 zCMD_05: ; DEC   B
00034a 18a9      	sub zzB,ONE
                 
00034b b75f      	in zzTmp, SREG
00034c 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00034d 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00034e 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
00034f 2b45      	or zzF, zzTmp ; combine flags
000350 940c 0200 	jmp zCMD_start
                 
                 zCMD_06: ; LD   B n
000352 b998
000353 b982
000354 b854
000355 b83b
000356 9601
000357 b173
000358 b82b      	LDRAM_PC_NODDR FROMRAM0
000359 2ea7      	mov zzB,FROMRAM0
                 
00035a 940c 0200 	jmp zCMD_start
                 
                 zCMD_07: ; RLCA  
00035c fb17      	bst zzA,7
00035d 1f11      	rol zzA
00035e f910      	bld zzA,0
                 
00035f b75f      	in zzTmp, SREG
000360 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
000361 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
000362 2b45      	or zzF, zzTmp ; combine flags
000363 940c 0200 	jmp zCMD_start
                 
                 zCMD_08: ; EX   AF AFe
000365 9150 0901
000367 9310 0901
000369 2f15      	EX zzA,zzAe
00036a 9150 0902
00036c 9340 0902
00036e 2f45      	EX zzF,zzFe
                 
00036f 940c 0200 	jmp zCMD_start
                 
                 zCMD_09: ; ADD  HL BC
000371 0ef6      	add zzL,zzC
000372 1cea      	adc zzH,zzB
                 
000373 b75f      	in zzTmp, SREG
000374 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
000375 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
000376 2b45      	or zzF, zzTmp ; combine flags
000377 940c 0200 	jmp zCMD_start
                 
                 zCMD_0a: ; LD   A (BC)
000379 b8a8
00037a b962
00037b b854
00037c b83b
00037d 0000
00037e 0000
00037f b173
000380 b82b      	LDRAM_NODDR zzB,zzC,FROMRAM0
000381 2f17      	mov zzA,FROMRAM0
                 
000382 940c 0200 	jmp zCMD_start
                 
                 zCMD_0b: ; DEC   BC
000384 1969
000385 08a5      	DEC2 zzB,zzC
                 
000386 940c 0200 	jmp zCMD_start
                 
                 zCMD_0c: ; INC   C
000388 0d69      	add zzC,ONE
                 
000389 b75f      	in zzTmp, SREG
00038a 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00038b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00038c 2b45      	or zzF, zzTmp ; combine flags
00038d 940c 0200 	jmp zCMD_start
                 
                 zCMD_0d: ; DEC   C
00038f 1969      	sub zzC,ONE
                 
000390 b75f      	in zzTmp, SREG
000391 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000392 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
000393 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
000394 2b45      	or zzF, zzTmp ; combine flags
000395 940c 0200 	jmp zCMD_start
                 
                 zCMD_0e: ; LD   C n
000397 b998
000398 b982
000399 b854
00039a b83b
00039b 9601
00039c b173
00039d b82b      	LDRAM_PC_NODDR FROMRAM0
00039e 2f67      	mov zzC,FROMRAM0
                 
00039f 940c 0200 	jmp zCMD_start
                 
                 zCMD_0f: ; RRCA  
0003a1 fb10      	bst zzA,0
0003a2 9517      	ror zzA
0003a3 f917      	bld zzA,7
                 
0003a4 b75f      	in zzTmp, SREG
0003a5 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
0003a6 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0003a7 2b45      	or zzF, zzTmp ; combine flags
0003a8 940c 0200 	jmp zCMD_start
                 
                 zCMD_10: ; DJNZ  s
0003aa b998
0003ab b982
0003ac b854
0003ad b83b
0003ae 9601
0003af b173
0003b0 b82b      	LDRAM_PC_NODDR FROMRAM0
0003b1 94aa      	dec zzB
0003b2 f029      	breq zCMD_10_1
0003b3 2755
0003b4 fd77
0003b5 9550
0003b6 0f87
0003b7 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 	zCMD_10_1:
                 
0003b8 940c 0200 	jmp zCMD_start
                 
                 zCMD_11: ; LD   DE nn
0003ba b998
0003bb b982
0003bc b854
0003bd b83b
0003be 9601
0003bf b123
0003c0 b82b      	LDRAM_PC_NODDR FROMRAM2
0003c1 b998
0003c2 b982
0003c3 b854
0003c4 b83b
0003c5 9601
0003c6 b013
0003c7 b82b      	LDRAM_PC_NODDR FROMRAM1
0003c8 2cc1      	mov zzD, FROMRAM1
0003c9 2ed2      	mov zzE, FROMRAM2
                 
0003ca 940c 0200 	jmp zCMD_start
                 
                 zCMD_12: ; LD   (DE) A
0003cc 2f71      	mov FROMRAM0,zzA
                 
0003cd b8c8
0003ce b8d2
0003cf b915
0003d0 b824
0003d1 14c6
0003d2 985d
0003d3 f100
0003d4 b82b
0003d5 935f
0003d6 e158
0003d7 b955
0003d8 eb5f
0003d9 b954
0003da e050
0003db bd5d
0003dc e550
0003dd bd5c
0003de 9859
0003df 915f
0003e0 982c
0003e1 931f
0003e2 2d5c
0003e3 940e 005f
0003e5 e054
0003e6 955a
0003e7 f7f1
0003e8 2d5d
0003e9 940e 005f
0003eb e054
0003ec 955a
0003ed f7f1
0003ee 915f
0003ef 940e 005f
0003f1 bc5c
0003f2 9a59
0003f3 b854
0003f4 b82b      	STRAM zzD,zzE,zzA
0003f5 940c 0200 	jmp zCMD_start
                 
                 zCMD_13: ; INC   DE
0003f7 0cd9
0003f8 1cc5      	INC2 zzD,zzE
                 
0003f9 940c 0200 	jmp zCMD_start
                 
                 zCMD_14: ; INC   D
0003fb 0cc9      	add zzD,ONE
                 
0003fc b75f      	in zzTmp, SREG
0003fd 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0003fe 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0003ff 2b45      	or zzF, zzTmp ; combine flags
000400 940c 0200 	jmp zCMD_start
                 
                 zCMD_15: ; DEC   D
000402 18c9      	sub zzD,ONE
                 
000403 b75f      	in zzTmp, SREG
000404 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000405 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
000406 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
000407 2b45      	or zzF, zzTmp ; combine flags
000408 940c 0200 	jmp zCMD_start
                 
                 zCMD_16: ; LD   D n
00040a b998
00040b b982
00040c b854
00040d b83b
00040e 9601
00040f b173
000410 b82b      	LDRAM_PC_NODDR FROMRAM0
000411 2ec7      	mov zzD,FROMRAM0
                 
000412 940c 0200 	jmp zCMD_start
                 
                 zCMD_17: ; RLA   
000414 bf4f      	out SREG,zzF
000415 1f11      	rol zzA
                 
000416 b75f      	in zzTmp, SREG
000417 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
000418 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
000419 2b45      	or zzF, zzTmp ; combine flags
00041a 940c 0200 	jmp zCMD_start
                 
                 zCMD_18: ; JR   * s
00041c b998
00041d b982
00041e b854
00041f b83b
000420 9601
000421 b173
000422 b82b      	LDRAM_PC_NODDR FROMRAM0
000423 1055      	cpse ZERO,ZERO
000424 940c 0200 	jmp zCMD_start
000426 2755
000427 fd77
000428 9550
000429 0f87
00042a 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
00042b 940c 0200 	jmp zCMD_start
                 
                 zCMD_19: ; ADD  HL DE
00042d 0cfd      	add zzL,zzE
00042e 1cec      	adc zzH,zzD
                 
00042f b75f      	in zzTmp, SREG
000430 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
000431 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
000432 2b45      	or zzF, zzTmp ; combine flags
000433 940c 0200 	jmp zCMD_start
                 
                 zCMD_1a: ; LD   A (DE)
000435 b8c8
000436 b8d2
000437 b854
000438 b83b
000439 0000
00043a 0000
00043b b173
00043c b82b      	LDRAM_NODDR zzD,zzE,FROMRAM0
00043d 2f17      	mov zzA,FROMRAM0
                 
00043e 940c 0200 	jmp zCMD_start
                 
                 zCMD_1b: ; DEC   DE
000440 18d9
000441 08c5      	DEC2 zzD,zzE
                 
000442 940c 0200 	jmp zCMD_start
                 
                 zCMD_1c: ; INC   E
000444 0cd9      	add zzE,ONE
                 
000445 b75f      	in zzTmp, SREG
000446 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000447 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
000448 2b45      	or zzF, zzTmp ; combine flags
000449 940c 0200 	jmp zCMD_start
                 
                 zCMD_1d: ; DEC   E
00044b 18d9      	sub zzE,ONE
                 
00044c b75f      	in zzTmp, SREG
00044d 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00044e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00044f 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
000450 2b45      	or zzF, zzTmp ; combine flags
000451 940c 0200 	jmp zCMD_start
                 
                 zCMD_1e: ; LD   E n
000453 b998
000454 b982
000455 b854
000456 b83b
000457 9601
000458 b173
000459 b82b      	LDRAM_PC_NODDR FROMRAM0
00045a 2ed7      	mov zzE,FROMRAM0
                 
00045b 940c 0200 	jmp zCMD_start
                 
                 zCMD_1f: ; RRA   
00045d bf4f      	out SREG,zzF
00045e 9517      	ror zzA
                 
00045f b75f      	in zzTmp, SREG
000460 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
000461 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
000462 2b45      	or zzF, zzTmp ; combine flags
000463 940c 0200 	jmp zCMD_start
                 
                 zCMD_20: ; JR   NZ s
000465 b998
000466 b982
000467 b854
000468 b83b
000469 9601
00046a b173
00046b b82b      	LDRAM_PC_NODDR FROMRAM0
00046c fd41      	sbrc zzF,zzZF
00046d 940c 0200 	jmp zCMD_start
00046f 2755
000470 fd77
000471 9550
000472 0f87
000473 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
000474 940c 0200 	jmp zCMD_start
                 
                 zCMD_21: ; LD   HL nn
000476 b998
000477 b982
000478 b854
000479 b83b
00047a 9601
00047b b123
00047c b82b      	LDRAM_PC_NODDR FROMRAM2
00047d b998
00047e b982
00047f b854
000480 b83b
000481 9601
000482 b013
000483 b82b      	LDRAM_PC_NODDR FROMRAM1
000484 2ce1      	mov zzH, FROMRAM1
000485 2ef2      	mov zzL, FROMRAM2
                 
000486 940c 0200 	jmp zCMD_start
                 
                 zCMD_22: ; LD   (ww) HL
                 	
                 
000488 b998
000489 b982
00048a b854
00048b b83b
00048c 9601
00048d b123
00048e b82b      	LDRAM_PC_NODDR FROMRAM2
00048f b998
000490 b982
000491 b854
000492 b83b
000493 9601
000494 b013
000495 b82b      	LDRAM_PC_NODDR FROMRAM1
000496 b818
000497 b922
000498 b8f5
000499 b824
00049a 1416
00049b 985d
00049c f100
00049d b82b
00049e 935f
00049f e158
0004a0 b955
0004a1 eb5f
0004a2 b954
0004a3 e050
0004a4 bd5d
0004a5 e550
0004a6 bd5c
0004a7 9859
0004a8 915f
0004a9 982c
0004aa 92ff
0004ab 2d51
0004ac 940e 005f
0004ae e054
0004af 955a
0004b0 f7f1
0004b1 2f52
0004b2 940e 005f
0004b4 e054
0004b5 955a
0004b6 f7f1
0004b7 915f
0004b8 940e 005f
0004ba bc5c
0004bb 9a59
0004bc b854
0004bd b82b      	STRAM FROMRAM1,FROMRAM2,zzL
0004be 0d29
0004bf 1c15      	INC2 FROMRAM1,FROMRAM2
0004c0 b818
0004c1 b922
0004c2 b8e5
0004c3 b824
0004c4 1416
0004c5 985d
0004c6 f100
0004c7 b82b
0004c8 935f
0004c9 e158
0004ca b955
0004cb eb5f
0004cc b954
0004cd e050
0004ce bd5d
0004cf e550
0004d0 bd5c
0004d1 9859
0004d2 915f
0004d3 982c
0004d4 92ef
0004d5 2d51
0004d6 940e 005f
0004d8 e054
0004d9 955a
0004da f7f1
0004db 2f52
0004dc 940e 005f
0004de e054
0004df 955a
0004e0 f7f1
0004e1 915f
0004e2 940e 005f
0004e4 bc5c
0004e5 9a59
0004e6 b854
0004e7 b82b      	STRAM FROMRAM1,FROMRAM2,zzH
0004e8 940c 0200 	jmp zCMD_start
                 
                 zCMD_23: ; INC   HL
0004ea 0cf9
0004eb 1ce5      	INC2 zzH,zzL
                 
0004ec 940c 0200 	jmp zCMD_start
                 
                 zCMD_24: ; INC   H
0004ee 0ce9      	add zzH,ONE
                 
0004ef b75f      	in zzTmp, SREG
0004f0 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0004f1 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0004f2 2b45      	or zzF, zzTmp ; combine flags
0004f3 940c 0200 	jmp zCMD_start
                 
                 zCMD_25: ; DEC   H
0004f5 18e9      	sub zzH,ONE
                 
0004f6 b75f      	in zzTmp, SREG
0004f7 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0004f8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0004f9 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
0004fa 2b45      	or zzF, zzTmp ; combine flags
0004fb 940c 0200 	jmp zCMD_start
                 
                 zCMD_26: ; LD   H n
0004fd b998
0004fe b982
0004ff b854
000500 b83b
000501 9601
000502 b173
000503 b82b      	LDRAM_PC_NODDR FROMRAM0
000504 2ee7      	mov zzH,FROMRAM0
                 
000505 940c 0200 	jmp zCMD_start
                 
                 zCMD_27: ; DAA   
000507 e1bb
000508 2fa1
000509 2755
00050a fd45
00050b 6051
00050c fd40
00050d 6052
00050e fd46
00050f 6054
000510 0fb5
000511 911c
000512 e058
000513 0fb5
000514 914c      	zzDAA
                 
000515 940c 0200 	jmp zCMD_start
                 
                 zCMD_28: ; JR   Z s
000517 b998
000518 b982
000519 b854
00051a b83b
00051b 9601
00051c b173
00051d b82b      	LDRAM_PC_NODDR FROMRAM0
00051e ff41      	sbrs zzF,zzZF
00051f 940c 0200 	jmp zCMD_start
000521 2755
000522 fd77
000523 9550
000524 0f87
000525 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
000526 940c 0200 	jmp zCMD_start
                 
                 zCMD_29: ; ADD  HL HL
000528 0cff      	add zzL,zzL
000529 1cee      	adc zzH,zzH
                 
00052a b75f      	in zzTmp, SREG
00052b 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
00052c 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
00052d 2b45      	or zzF, zzTmp ; combine flags
00052e 940c 0200 	jmp zCMD_start
                 
                 zCMD_2a: ; LD   HL (ww)
000530 b998
000531 b982
000532 b854
000533 b83b
000534 9601
000535 b123
000536 b82b      	LDRAM_PC_NODDR FROMRAM2
000537 b998
000538 b982
000539 b854
00053a b83b
00053b 9601
00053c b013
00053d b82b      	LDRAM_PC_NODDR FROMRAM1
00053e b818
00053f b922
000540 b854
000541 b83b
000542 0000
000543 0000
000544 b0f3
000545 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzL
000546 0d29
000547 1c15      	INC2 FROMRAM1,FROMRAM2
000548 b818
000549 b922
00054a b854
00054b b83b
00054c 0000
00054d 0000
00054e b0e3
00054f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzH
                 	
                 
000550 940c 0200 	jmp zCMD_start
                 
                 zCMD_2b: ; DEC   HL
000552 18f9
000553 08e5      	DEC2 zzH,zzL
                 
000554 940c 0200 	jmp zCMD_start
                 
                 zCMD_2c: ; INC   L
000556 0cf9      	add zzL,ONE
                 
000557 b75f      	in zzTmp, SREG
000558 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000559 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00055a 2b45      	or zzF, zzTmp ; combine flags
00055b 940c 0200 	jmp zCMD_start
                 
                 zCMD_2d: ; DEC   L
00055d 18f9      	sub zzL,ONE
                 
00055e b75f      	in zzTmp, SREG
00055f 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000560 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
000561 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
000562 2b45      	or zzF, zzTmp ; combine flags
000563 940c 0200 	jmp zCMD_start
                 
                 zCMD_2e: ; LD   L n
000565 b998
000566 b982
000567 b854
000568 b83b
000569 9601
00056a b173
00056b b82b      	LDRAM_PC_NODDR FROMRAM0
00056c 2ef7      	mov zzL,FROMRAM0
                 
00056d 940c 0200 	jmp zCMD_start
                 
                 zCMD_2f: ; CPL   A
00056f 9510      	com zzA
                 
000570 784f      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|_C_) ; mask old flags
000571 6e40      	ori zzF, 	(_I_|___|___|_H_|___|_N_|___) ; set flags
000572 940c 0200 	jmp zCMD_start
                 
                 zCMD_30: ; JR   NC s
000574 b998
000575 b982
000576 b854
000577 b83b
000578 9601
000579 b173
00057a b82b      	LDRAM_PC_NODDR FROMRAM0
00057b fd40      	sbrc zzF,zzCF
00057c 940c 0200 	jmp zCMD_start
00057e 2755
00057f fd77
000580 9550
000581 0f87
000582 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
000583 940c 0200 	jmp zCMD_start
                 
                 zCMD_31: ; LD   SP nn
000585 b998
000586 b982
000587 b854
000588 b83b
000589 9601
00058a b123
00058b b82b      	LDRAM_PC_NODDR FROMRAM2
00058c b998
00058d b982
00058e b854
00058f b83b
000590 9601
000591 b013
000592 b82b      	LDRAM_PC_NODDR FROMRAM1
000593 2dd1      	mov zzSPh, FROMRAM1
000594 2fc2      	mov zzSPl, FROMRAM2
                 
000595 940c 0200 	jmp zCMD_start
                 
                 zCMD_32: ; LD   (nn) A
000597 2f71      	mov FROMRAM0,zzA
                 
000598 b998
000599 b982
00059a b854
00059b b83b
00059c 9601
00059d b123
00059e b82b      	LDRAM_PC_NODDR FROMRAM2
00059f b998
0005a0 b982
0005a1 b854
0005a2 b83b
0005a3 9601
0005a4 b013
0005a5 b82b      	LDRAM_PC_NODDR FROMRAM1
0005a6 b818
0005a7 b922
0005a8 b915
0005a9 b824
0005aa 1416
0005ab 985d
0005ac f100
0005ad b82b
0005ae 935f
0005af e158
0005b0 b955
0005b1 eb5f
0005b2 b954
0005b3 e050
0005b4 bd5d
0005b5 e550
0005b6 bd5c
0005b7 9859
0005b8 915f
0005b9 982c
0005ba 931f
0005bb 2d51
0005bc 940e 005f
0005be e054
0005bf 955a
0005c0 f7f1
0005c1 2f52
0005c2 940e 005f
0005c4 e054
0005c5 955a
0005c6 f7f1
0005c7 915f
0005c8 940e 005f
0005ca bc5c
0005cb 9a59
0005cc b854
0005cd b82b      	STRAM FROMRAM1,FROMRAM2,zzA
0005ce 940c 0200 	jmp zCMD_start
                 
                 zCMD_33: ; INC   SP
0005d0 0dc9
0005d1 1dd5      	INC2 zzSPh,zzSPl
                 
0005d2 940c 0200 	jmp zCMD_start
                 
                 zCMD_34: ; INC   (HL)
0005d4 b8e8
0005d5 b8f2
0005d6 b854
0005d7 b83b
0005d8 0000
0005d9 0000
0005da b173
0005db b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0005dc 0d79      	add FROMRAM0,ONE
                 
0005dd b67f      	in _sreg, SREG
0005de b8e8
0005df b8f2
0005e0 b975
0005e1 b824
0005e2 14e6
0005e3 985d
0005e4 f100
0005e5 b82b
0005e6 935f
0005e7 e158
0005e8 b955
0005e9 eb5f
0005ea b954
0005eb e050
0005ec bd5d
0005ed e550
0005ee bd5c
0005ef 9859
0005f0 915f
0005f1 982c
0005f2 937f
0005f3 2d5e
0005f4 940e 005f
0005f6 e054
0005f7 955a
0005f8 f7f1
0005f9 2d5f
0005fa 940e 005f
0005fc e054
0005fd 955a
0005fe f7f1
0005ff 915f
000600 940e 005f
000602 bc5c
000603 9a59
000604 b854
000605 b82b      	STRAM zzH,zzL,FROMRAM0
000606 be7f      	out SREG,_sreg
000607 b75f      	in zzTmp, SREG
000608 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000609 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00060a 2b45      	or zzF, zzTmp ; combine flags
00060b 940c 0200 	jmp zCMD_start
                 
                 zCMD_35: ; DEC   (HL)
00060d b8e8
00060e b8f2
00060f b854
000610 b83b
000611 0000
000612 0000
000613 b173
000614 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
000615 1979      	sub FROMRAM0,ONE
                 
000616 b67f      	in _sreg, SREG
000617 b8e8
000618 b8f2
000619 b975
00061a b824
00061b 14e6
00061c 985d
00061d f100
00061e b82b
00061f 935f
000620 e158
000621 b955
000622 eb5f
000623 b954
000624 e050
000625 bd5d
000626 e550
000627 bd5c
000628 9859
000629 915f
00062a 982c
00062b 937f
00062c 2d5e
00062d 940e 005f
00062f e054
000630 955a
000631 f7f1
000632 2d5f
000633 940e 005f
000635 e054
000636 955a
000637 f7f1
000638 915f
000639 940e 005f
00063b bc5c
00063c 9a59
00063d b854
00063e b82b      	STRAM zzH,zzL,FROMRAM0
00063f be7f      	out SREG,_sreg
000640 b75f      	in zzTmp, SREG
000641 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
000642 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
000643 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
000644 2b45      	or zzF, zzTmp ; combine flags
000645 940c 0200 	jmp zCMD_start
                 
                 zCMD_36: ; LD   (HL) n
000647 b998
000648 b982
000649 b854
00064a b83b
00064b 9601
00064c b173
00064d b82b      	LDRAM_PC_NODDR FROMRAM0
00064e 2f77      	mov FROMRAM0,FROMRAM0
                 
00064f b67f      	in _sreg, SREG
000650 b8e8
000651 b8f2
000652 b975
000653 b824
000654 14e6
000655 985d
000656 f100
000657 b82b
000658 935f
000659 e158
00065a b955
00065b eb5f
00065c b954
00065d e050
00065e bd5d
00065f e550
000660 bd5c
000661 9859
000662 915f
000663 982c
000664 937f
000665 2d5e
000666 940e 005f
000668 e054
000669 955a
00066a f7f1
00066b 2d5f
00066c 940e 005f
00066e e054
00066f 955a
000670 f7f1
000671 915f
000672 940e 005f
000674 bc5c
000675 9a59
000676 b854
000677 b82b      	STRAM zzH,zzL,FROMRAM0
000678 be7f      	out SREG,_sreg
000679 940c 0200 	jmp zCMD_start
                 
                 zCMD_37: ; SCF   
                 	
                 
00067b 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
00067c 6841      	ori zzF, 	(_I_|___|___|___|___|___|_C_) ; set flags
00067d 940c 0200 	jmp zCMD_start
                 
                 zCMD_38: ; JR   C s
00067f b998
000680 b982
000681 b854
000682 b83b
000683 9601
000684 b173
000685 b82b      	LDRAM_PC_NODDR FROMRAM0
000686 ff40      	sbrs zzF,zzCF
000687 940c 0200 	jmp zCMD_start
000689 2755
00068a fd77
00068b 9550
00068c 0f87
00068d 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
00068e 940c 0200 	jmp zCMD_start
                 
                 zCMD_39: ; ADD  HL SP
000690 0efc      	add zzL,zzSPl
000691 1eed      	adc zzH,zzSPh
                 
000692 b75f      	in zzTmp, SREG
000693 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
000694 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
000695 2b45      	or zzF, zzTmp ; combine flags
000696 940c 0200 	jmp zCMD_start
                 
                 zCMD_3a: ; LD   A (nn)
000698 b998
000699 b982
00069a b854
00069b b83b
00069c 9601
00069d b123
00069e b82b      	LDRAM_PC_NODDR FROMRAM2
00069f b998
0006a0 b982
0006a1 b854
0006a2 b83b
0006a3 9601
0006a4 b013
0006a5 b82b      	LDRAM_PC_NODDR FROMRAM1
0006a6 b818
0006a7 b922
0006a8 b854
0006a9 b83b
0006aa 0000
0006ab 0000
0006ac b173
0006ad b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0006ae 2f17      	mov zzA,FROMRAM0
                 
0006af 940c 0200 	jmp zCMD_start
                 
                 zCMD_3b: ; DEC   SP
0006b1 19c9
0006b2 09d5      	DEC2 zzSPh,zzSPl
                 
0006b3 940c 0200 	jmp zCMD_start
                 
                 zCMD_3c: ; INC   A
0006b5 0d19      	add zzA,ONE
                 
0006b6 b75f      	in zzTmp, SREG
0006b7 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0006b8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0006b9 2b45      	or zzF, zzTmp ; combine flags
0006ba 940c 0200 	jmp zCMD_start
                 
                 zCMD_3d: ; DEC   A
0006bc 1919      	sub zzA,ONE
                 
0006bd b75f      	in zzTmp, SREG
0006be 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0006bf 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0006c0 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
0006c1 2b45      	or zzF, zzTmp ; combine flags
0006c2 940c 0200 	jmp zCMD_start
                 
                 zCMD_3e: ; LD   A n
0006c4 b998
0006c5 b982
0006c6 b854
0006c7 b83b
0006c8 9601
0006c9 b173
0006ca b82b      	LDRAM_PC_NODDR FROMRAM0
0006cb 2f17      	mov zzA,FROMRAM0
                 
0006cc 940c 0200 	jmp zCMD_start
                 
                 zCMD_3f: ; CCF   
0006ce 784f      	andi zzF,(_I_|_S_|_Z_|_V_|_C_)
0006cf fb40      	bst zzF,zzCF
0006d0 f945      	bld zzF,zzHF
0006d1 e051      	ldi zzTmp,1<<zzCF
0006d2 2745      	eor zzF,zzTmp
                 
0006d3 940c 0200 	jmp zCMD_start
                 
                 zCMD_40: ; LD   B B
0006d5 2caa      	mov zzB,zzB
                 
0006d6 940c 0200 	jmp zCMD_start
                 
                 zCMD_41: ; LD   B C
0006d8 2ea6      	mov zzB,zzC
                 
0006d9 940c 0200 	jmp zCMD_start
                 
                 zCMD_42: ; LD   B D
0006db 2cac      	mov zzB,zzD
                 
0006dc 940c 0200 	jmp zCMD_start
                 
                 zCMD_43: ; LD   B E
0006de 2cad      	mov zzB,zzE
                 
0006df 940c 0200 	jmp zCMD_start
                 
                 zCMD_44: ; LD   B H
0006e1 2cae      	mov zzB,zzH
                 
0006e2 940c 0200 	jmp zCMD_start
                 
                 zCMD_45: ; LD   B L
0006e4 2caf      	mov zzB,zzL
                 
0006e5 940c 0200 	jmp zCMD_start
                 
                 zCMD_46: ; LD   B (HL)
0006e7 b8e8
0006e8 b8f2
0006e9 b854
0006ea b83b
0006eb 0000
0006ec 0000
0006ed b173
0006ee b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0006ef 2ea7      	mov zzB,FROMRAM0
                 
0006f0 940c 0200 	jmp zCMD_start
                 
                 zCMD_47: ; LD   B A
0006f2 2ea1      	mov zzB,zzA
                 
0006f3 940c 0200 	jmp zCMD_start
                 
                 zCMD_48: ; LD   C B
0006f5 2d6a      	mov zzC,zzB
                 
0006f6 940c 0200 	jmp zCMD_start
                 
                 zCMD_49: ; LD   C C
0006f8 2f66      	mov zzC,zzC
                 
0006f9 940c 0200 	jmp zCMD_start
                 
                 zCMD_4a: ; LD   C D
0006fb 2d6c      	mov zzC,zzD
                 
0006fc 940c 0200 	jmp zCMD_start
                 
                 zCMD_4b: ; LD   C E
0006fe 2d6d      	mov zzC,zzE
                 
0006ff 940c 0200 	jmp zCMD_start
                 
                 zCMD_4c: ; LD   C H
000701 2d6e      	mov zzC,zzH
                 
000702 940c 0200 	jmp zCMD_start
                 
                 zCMD_4d: ; LD   C L
000704 2d6f      	mov zzC,zzL
                 
000705 940c 0200 	jmp zCMD_start
                 
                 zCMD_4e: ; LD   C (HL)
000707 b8e8
000708 b8f2
000709 b854
00070a b83b
00070b 0000
00070c 0000
00070d b173
00070e b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00070f 2f67      	mov zzC,FROMRAM0
                 
000710 940c 0200 	jmp zCMD_start
                 
                 zCMD_4f: ; LD   C A
000712 2f61      	mov zzC,zzA
                 
000713 940c 0200 	jmp zCMD_start
                 
                 zCMD_50: ; LD   D B
000715 2cca      	mov zzD,zzB
                 
000716 940c 0200 	jmp zCMD_start
                 
                 zCMD_51: ; LD   D C
000718 2ec6      	mov zzD,zzC
                 
000719 940c 0200 	jmp zCMD_start
                 
                 zCMD_52: ; LD   D D
00071b 2ccc      	mov zzD,zzD
                 
00071c 940c 0200 	jmp zCMD_start
                 
                 zCMD_53: ; LD   D E
00071e 2ccd      	mov zzD,zzE
                 
00071f 940c 0200 	jmp zCMD_start
                 
                 zCMD_54: ; LD   D H
000721 2cce      	mov zzD,zzH
                 
000722 940c 0200 	jmp zCMD_start
                 
                 zCMD_55: ; LD   D L
000724 2ccf      	mov zzD,zzL
                 
000725 940c 0200 	jmp zCMD_start
                 
                 zCMD_56: ; LD   D (HL)
000727 b8e8
000728 b8f2
000729 b854
00072a b83b
00072b 0000
00072c 0000
00072d b173
00072e b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00072f 2ec7      	mov zzD,FROMRAM0
                 
000730 940c 0200 	jmp zCMD_start
                 
                 zCMD_57: ; LD   D A
000732 2ec1      	mov zzD,zzA
                 
000733 940c 0200 	jmp zCMD_start
                 
                 zCMD_58: ; LD   E B
000735 2cda      	mov zzE,zzB
                 
000736 940c 0200 	jmp zCMD_start
                 
                 zCMD_59: ; LD   E C
000738 2ed6      	mov zzE,zzC
                 
000739 940c 0200 	jmp zCMD_start
                 
                 zCMD_5a: ; LD   E D
00073b 2cdc      	mov zzE,zzD
                 
00073c 940c 0200 	jmp zCMD_start
                 
                 zCMD_5b: ; LD   E E
00073e 2cdd      	mov zzE,zzE
                 
00073f 940c 0200 	jmp zCMD_start
                 
                 zCMD_5c: ; LD   E H
000741 2cde      	mov zzE,zzH
                 
000742 940c 0200 	jmp zCMD_start
                 
                 zCMD_5d: ; LD   E L
000744 2cdf      	mov zzE,zzL
                 
000745 940c 0200 	jmp zCMD_start
                 
                 zCMD_5e: ; LD   E (HL)
000747 b8e8
000748 b8f2
000749 b854
00074a b83b
00074b 0000
00074c 0000
00074d b173
00074e b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00074f 2ed7      	mov zzE,FROMRAM0
                 
000750 940c 0200 	jmp zCMD_start
                 
                 zCMD_5f: ; LD   E A
000752 2ed1      	mov zzE,zzA
                 
000753 940c 0200 	jmp zCMD_start
                 
                 zCMD_60: ; LD   H B
000755 2cea      	mov zzH,zzB
                 
000756 940c 0200 	jmp zCMD_start
                 
                 zCMD_61: ; LD   H C
000758 2ee6      	mov zzH,zzC
                 
000759 940c 0200 	jmp zCMD_start
                 
                 zCMD_62: ; LD   H D
00075b 2cec      	mov zzH,zzD
                 
00075c 940c 0200 	jmp zCMD_start
                 
                 zCMD_63: ; LD   H E
00075e 2ced      	mov zzH,zzE
                 
00075f 940c 0200 	jmp zCMD_start
                 
                 zCMD_64: ; LD   H H
000761 2cee      	mov zzH,zzH
                 
000762 940c 0200 	jmp zCMD_start
                 
                 zCMD_65: ; LD   H L
000764 2cef      	mov zzH,zzL
                 
000765 940c 0200 	jmp zCMD_start
                 
                 zCMD_66: ; LD   H (HL)
000767 b8e8
000768 b8f2
000769 b854
00076a b83b
00076b 0000
00076c 0000
00076d b173
00076e b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00076f 2ee7      	mov zzH,FROMRAM0
                 
000770 940c 0200 	jmp zCMD_start
                 
                 zCMD_67: ; LD   H A
000772 2ee1      	mov zzH,zzA
                 
000773 940c 0200 	jmp zCMD_start
                 
                 zCMD_68: ; LD   L B
000775 2cfa      	mov zzL,zzB
                 
000776 940c 0200 	jmp zCMD_start
                 
                 zCMD_69: ; LD   L C
000778 2ef6      	mov zzL,zzC
                 
000779 940c 0200 	jmp zCMD_start
                 
                 zCMD_6a: ; LD   L D
00077b 2cfc      	mov zzL,zzD
                 
00077c 940c 0200 	jmp zCMD_start
                 
                 zCMD_6b: ; LD   L E
00077e 2cfd      	mov zzL,zzE
                 
00077f 940c 0200 	jmp zCMD_start
                 
                 zCMD_6c: ; LD   L H
000781 2cfe      	mov zzL,zzH
                 
000782 940c 0200 	jmp zCMD_start
                 
                 zCMD_6d: ; LD   L L
000784 2cff      	mov zzL,zzL
                 
000785 940c 0200 	jmp zCMD_start
                 
                 zCMD_6e: ; LD   L (HL)
000787 b8e8
000788 b8f2
000789 b854
00078a b83b
00078b 0000
00078c 0000
00078d b173
00078e b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00078f 2ef7      	mov zzL,FROMRAM0
                 
000790 940c 0200 	jmp zCMD_start
                 
                 zCMD_6f: ; LD   L A
000792 2ef1      	mov zzL,zzA
                 
000793 940c 0200 	jmp zCMD_start
                 
                 zCMD_70: ; LD   (HL) B
000795 2d7a      	mov FROMRAM0,zzB
                 
000796 b67f      	in _sreg, SREG
000797 b8e8
000798 b8f2
000799 b8a5
00079a b824
00079b 14e6
00079c 985d
00079d f100
00079e b82b
00079f 935f
0007a0 e158
0007a1 b955
0007a2 eb5f
0007a3 b954
0007a4 e050
0007a5 bd5d
0007a6 e550
0007a7 bd5c
0007a8 9859
0007a9 915f
0007aa 982c
0007ab 92af
0007ac 2d5e
0007ad 940e 005f
0007af e054
0007b0 955a
0007b1 f7f1
0007b2 2d5f
0007b3 940e 005f
0007b5 e054
0007b6 955a
0007b7 f7f1
0007b8 915f
0007b9 940e 005f
0007bb bc5c
0007bc 9a59
0007bd b854
0007be b82b      	STRAM zzH,zzL,zzB
0007bf be7f      	out SREG,_sreg
0007c0 940c 0200 	jmp zCMD_start
                 
                 zCMD_71: ; LD   (HL) C
0007c2 2f76      	mov FROMRAM0,zzC
                 
0007c3 b67f      	in _sreg, SREG
0007c4 b8e8
0007c5 b8f2
0007c6 b965
0007c7 b824
0007c8 14e6
0007c9 985d
0007ca f100
0007cb b82b
0007cc 935f
0007cd e158
0007ce b955
0007cf eb5f
0007d0 b954
0007d1 e050
0007d2 bd5d
0007d3 e550
0007d4 bd5c
0007d5 9859
0007d6 915f
0007d7 982c
0007d8 936f
0007d9 2d5e
0007da 940e 005f
0007dc e054
0007dd 955a
0007de f7f1
0007df 2d5f
0007e0 940e 005f
0007e2 e054
0007e3 955a
0007e4 f7f1
0007e5 915f
0007e6 940e 005f
0007e8 bc5c
0007e9 9a59
0007ea b854
0007eb b82b      	STRAM zzH,zzL,zzC
0007ec be7f      	out SREG,_sreg
0007ed 940c 0200 	jmp zCMD_start
                 
                 zCMD_72: ; LD   (HL) D
0007ef 2d7c      	mov FROMRAM0,zzD
                 
0007f0 b67f      	in _sreg, SREG
0007f1 b8e8
0007f2 b8f2
0007f3 b8c5
0007f4 b824
0007f5 14e6
0007f6 985d
0007f7 f100
0007f8 b82b
0007f9 935f
0007fa e158
0007fb b955
0007fc eb5f
0007fd b954
0007fe e050
0007ff bd5d
000800 e550
000801 bd5c
000802 9859
000803 915f
000804 982c
000805 92cf
000806 2d5e
000807 940e 005f
000809 e054
00080a 955a
00080b f7f1
00080c 2d5f
00080d 940e 005f
00080f e054
000810 955a
000811 f7f1
000812 915f
000813 940e 005f
000815 bc5c
000816 9a59
000817 b854
000818 b82b      	STRAM zzH,zzL,zzD
000819 be7f      	out SREG,_sreg
00081a 940c 0200 	jmp zCMD_start
                 
                 zCMD_73: ; LD   (HL) E
00081c 2d7d      	mov FROMRAM0,zzE
                 
00081d b67f      	in _sreg, SREG
00081e b8e8
00081f b8f2
000820 b8d5
000821 b824
000822 14e6
000823 985d
000824 f100
000825 b82b
000826 935f
000827 e158
000828 b955
000829 eb5f
00082a b954
00082b e050
00082c bd5d
00082d e550
00082e bd5c
00082f 9859
000830 915f
000831 982c
000832 92df
000833 2d5e
000834 940e 005f
000836 e054
000837 955a
000838 f7f1
000839 2d5f
00083a 940e 005f
00083c e054
00083d 955a
00083e f7f1
00083f 915f
000840 940e 005f
000842 bc5c
000843 9a59
000844 b854
000845 b82b      	STRAM zzH,zzL,zzE
000846 be7f      	out SREG,_sreg
000847 940c 0200 	jmp zCMD_start
                 
                 zCMD_74: ; LD   (HL) H
000849 2d7e      	mov FROMRAM0,zzH
                 
00084a b67f      	in _sreg, SREG
00084b b8e8
00084c b8f2
00084d b8e5
00084e b824
00084f 14e6
000850 985d
000851 f100
000852 b82b
000853 935f
000854 e158
000855 b955
000856 eb5f
000857 b954
000858 e050
000859 bd5d
00085a e550
00085b bd5c
00085c 9859
00085d 915f
00085e 982c
00085f 92ef
000860 2d5e
000861 940e 005f
000863 e054
000864 955a
000865 f7f1
000866 2d5f
000867 940e 005f
000869 e054
00086a 955a
00086b f7f1
00086c 915f
00086d 940e 005f
00086f bc5c
000870 9a59
000871 b854
000872 b82b      	STRAM zzH,zzL,zzH
000873 be7f      	out SREG,_sreg
000874 940c 0200 	jmp zCMD_start
                 
                 zCMD_75: ; LD   (HL) L
000876 2d7f      	mov FROMRAM0,zzL
                 
000877 b67f      	in _sreg, SREG
000878 b8e8
000879 b8f2
00087a b8f5
00087b b824
00087c 14e6
00087d 985d
00087e f100
00087f b82b
000880 935f
000881 e158
000882 b955
000883 eb5f
000884 b954
000885 e050
000886 bd5d
000887 e550
000888 bd5c
000889 9859
00088a 915f
00088b 982c
00088c 92ff
00088d 2d5e
00088e 940e 005f
000890 e054
000891 955a
000892 f7f1
000893 2d5f
000894 940e 005f
000896 e054
000897 955a
000898 f7f1
000899 915f
00089a 940e 005f
00089c bc5c
00089d 9a59
00089e b854
00089f b82b      	STRAM zzH,zzL,zzL
0008a0 be7f      	out SREG,_sreg
0008a1 940c 0200 	jmp zCMD_start
                 
                 zCMD_76: ; HALT  
0008a3 1989
0008a4 0995      	DEC2 zzPCh,zzPCl
                 
0008a5 940c 0200 	jmp zCMD_start
                 
                 zCMD_77: ; LD   (HL) A
0008a7 2f71      	mov FROMRAM0,zzA
                 
0008a8 b67f      	in _sreg, SREG
0008a9 b8e8
0008aa b8f2
0008ab b915
0008ac b824
0008ad 14e6
0008ae 985d
0008af f100
0008b0 b82b
0008b1 935f
0008b2 e158
0008b3 b955
0008b4 eb5f
0008b5 b954
0008b6 e050
0008b7 bd5d
0008b8 e550
0008b9 bd5c
0008ba 9859
0008bb 915f
0008bc 982c
0008bd 931f
0008be 2d5e
0008bf 940e 005f
0008c1 e054
0008c2 955a
0008c3 f7f1
0008c4 2d5f
0008c5 940e 005f
0008c7 e054
0008c8 955a
0008c9 f7f1
0008ca 915f
0008cb 940e 005f
0008cd bc5c
0008ce 9a59
0008cf b854
0008d0 b82b      	STRAM zzH,zzL,zzA
0008d1 be7f      	out SREG,_sreg
0008d2 940c 0200 	jmp zCMD_start
                 
                 zCMD_78: ; LD   A B
0008d4 2d1a      	mov zzA,zzB
                 
0008d5 940c 0200 	jmp zCMD_start
                 
                 zCMD_79: ; LD   A C
0008d7 2f16      	mov zzA,zzC
                 
0008d8 940c 0200 	jmp zCMD_start
                 
                 zCMD_7a: ; LD   A D
0008da 2d1c      	mov zzA,zzD
                 
0008db 940c 0200 	jmp zCMD_start
                 
                 zCMD_7b: ; LD   A E
0008dd 2d1d      	mov zzA,zzE
                 
0008de 940c 0200 	jmp zCMD_start
                 
                 zCMD_7c: ; LD   A H
0008e0 2d1e      	mov zzA,zzH
                 
0008e1 940c 0200 	jmp zCMD_start
                 
                 zCMD_7d: ; LD   A L
0008e3 2d1f      	mov zzA,zzL
                 
0008e4 940c 0200 	jmp zCMD_start
                 
                 zCMD_7e: ; LD   A (HL)
0008e6 b8e8
0008e7 b8f2
0008e8 b854
0008e9 b83b
0008ea 0000
0008eb 0000
0008ec b173
0008ed b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0008ee 2f17      	mov zzA,FROMRAM0
                 
0008ef 940c 0200 	jmp zCMD_start
                 
                 zCMD_7f: ; LD   A A
0008f1 2f11      	mov zzA,zzA
                 
0008f2 940c 0200 	jmp zCMD_start
                 
                 zCMD_80: ; ADD  A B
0008f4 0d1a      	add zzA,zzB
                 
0008f5 b74f      	in zzF, SREG
0008f6 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
0008f7 940c 0200 	jmp zCMD_start
                 
                 zCMD_81: ; ADD  A C
0008f9 0f16      	add zzA,zzC
                 
0008fa b74f      	in zzF, SREG
0008fb 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
0008fc 940c 0200 	jmp zCMD_start
                 
                 zCMD_82: ; ADD  A D
0008fe 0d1c      	add zzA,zzD
                 
0008ff b74f      	in zzF, SREG
000900 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000901 940c 0200 	jmp zCMD_start
                 
                 zCMD_83: ; ADD  A E
000903 0d1d      	add zzA,zzE
                 
000904 b74f      	in zzF, SREG
000905 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000906 940c 0200 	jmp zCMD_start
                 
                 zCMD_84: ; ADD  A H
000908 0d1e      	add zzA,zzH
                 
000909 b74f      	in zzF, SREG
00090a 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00090b 940c 0200 	jmp zCMD_start
                 
                 zCMD_85: ; ADD  A L
00090d 0d1f      	add zzA,zzL
                 
00090e b74f      	in zzF, SREG
00090f 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000910 940c 0200 	jmp zCMD_start
                 
                 zCMD_86: ; ADD  A (HL)
000912 b8e8
000913 b8f2
000914 b854
000915 b83b
000916 0000
000917 0000
000918 b173
000919 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00091a 0f17      	add zzA,FROMRAM0
                 
00091b b74f      	in zzF, SREG
00091c 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00091d 940c 0200 	jmp zCMD_start
                 
                 zCMD_87: ; ADD  A A
00091f 0f11      	add zzA,zzA
                 
000920 b74f      	in zzF, SREG
000921 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000922 940c 0200 	jmp zCMD_start
                 
                 zCMD_88: ; ADC  A B
000924 bf4f      	out SREG,zzF
000925 1d1a      	adc zzA,zzB
                 
000926 b74f      	in zzF, SREG
000927 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000928 940c 0200 	jmp zCMD_start
                 
                 zCMD_89: ; ADC  A C
00092a bf4f      	out SREG,zzF
00092b 1f16      	adc zzA,zzC
                 
00092c b74f      	in zzF, SREG
00092d 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00092e 940c 0200 	jmp zCMD_start
                 
                 zCMD_8a: ; ADC  A D
000930 bf4f      	out SREG,zzF
000931 1d1c      	adc zzA,zzD
                 
000932 b74f      	in zzF, SREG
000933 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000934 940c 0200 	jmp zCMD_start
                 
                 zCMD_8b: ; ADC  A E
000936 bf4f      	out SREG,zzF
000937 1d1d      	adc zzA,zzE
                 
000938 b74f      	in zzF, SREG
000939 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00093a 940c 0200 	jmp zCMD_start
                 
                 zCMD_8c: ; ADC  A H
00093c bf4f      	out SREG,zzF
00093d 1d1e      	adc zzA,zzH
                 
00093e b74f      	in zzF, SREG
00093f 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000940 940c 0200 	jmp zCMD_start
                 
                 zCMD_8d: ; ADC  A L
000942 bf4f      	out SREG,zzF
000943 1d1f      	adc zzA,zzL
                 
000944 b74f      	in zzF, SREG
000945 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000946 940c 0200 	jmp zCMD_start
                 
                 zCMD_8e: ; ADC  A (HL)
000948 b8e8
000949 b8f2
00094a b854
00094b b83b
00094c 0000
00094d 0000
00094e b173
00094f b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
000950 bf4f      	out SREG,zzF
000951 1f17      	adc zzA,FROMRAM0
                 
000952 b74f      	in zzF, SREG
000953 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000954 940c 0200 	jmp zCMD_start
                 
                 zCMD_8f: ; ADC  A A
000956 bf4f      	out SREG,zzF
000957 1f11      	adc zzA,zzA
                 
000958 b74f      	in zzF, SREG
000959 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00095a 940c 0200 	jmp zCMD_start
                 
                 zCMD_90: ; SUB  A B
00095c 191a      	sub zzA,zzB
                 
00095d b75f      	in zzTmp, SREG
00095e 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00095f ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000960 2b45      	or zzF, zzTmp ; combine flags
000961 940c 0200 	jmp zCMD_start
                 
                 zCMD_91: ; SUB  A C
000963 1b16      	sub zzA,zzC
                 
000964 b75f      	in zzTmp, SREG
000965 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000966 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000967 2b45      	or zzF, zzTmp ; combine flags
000968 940c 0200 	jmp zCMD_start
                 
                 zCMD_92: ; SUB  A D
00096a 191c      	sub zzA,zzD
                 
00096b b75f      	in zzTmp, SREG
00096c 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00096d ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00096e 2b45      	or zzF, zzTmp ; combine flags
00096f 940c 0200 	jmp zCMD_start
                 
                 zCMD_93: ; SUB  A E
000971 191d      	sub zzA,zzE
                 
000972 b75f      	in zzTmp, SREG
000973 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000974 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000975 2b45      	or zzF, zzTmp ; combine flags
000976 940c 0200 	jmp zCMD_start
                 
                 zCMD_94: ; SUB  A H
000978 191e      	sub zzA,zzH
                 
000979 b75f      	in zzTmp, SREG
00097a 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00097b ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00097c 2b45      	or zzF, zzTmp ; combine flags
00097d 940c 0200 	jmp zCMD_start
                 
                 zCMD_95: ; SUB  A L
00097f 191f      	sub zzA,zzL
                 
000980 b75f      	in zzTmp, SREG
000981 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000982 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000983 2b45      	or zzF, zzTmp ; combine flags
000984 940c 0200 	jmp zCMD_start
                 
                 zCMD_96: ; SUB  A (HL)
000986 b8e8
000987 b8f2
000988 b854
000989 b83b
00098a 0000
00098b 0000
00098c b173
00098d b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00098e 1b17      	sub zzA,FROMRAM0
                 
00098f b75f      	in zzTmp, SREG
000990 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000991 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000992 2b45      	or zzF, zzTmp ; combine flags
000993 940c 0200 	jmp zCMD_start
                 
                 zCMD_97: ; SUB  A A
000995 1b11      	sub zzA,zzA
                 
000996 b75f      	in zzTmp, SREG
000997 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000998 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000999 2b45      	or zzF, zzTmp ; combine flags
00099a 940c 0200 	jmp zCMD_start
                 
                 zCMD_98: ; SBC  A B
00099c bf4f      	out SREG,zzF
00099d 9418      	sez
00099e 091a      	sbc zzA,zzB
                 
00099f b75f      	in zzTmp, SREG
0009a0 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009a1 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009a2 2b45      	or zzF, zzTmp ; combine flags
0009a3 940c 0200 	jmp zCMD_start
                 
                 zCMD_99: ; SBC  A C
0009a5 bf4f      	out SREG,zzF
0009a6 9418      	sez
0009a7 0b16      	sbc zzA,zzC
                 
0009a8 b75f      	in zzTmp, SREG
0009a9 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009aa ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009ab 2b45      	or zzF, zzTmp ; combine flags
0009ac 940c 0200 	jmp zCMD_start
                 
                 zCMD_9a: ; SBC  A D
0009ae bf4f      	out SREG,zzF
0009af 9418      	sez
0009b0 091c      	sbc zzA,zzD
                 
0009b1 b75f      	in zzTmp, SREG
0009b2 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009b3 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009b4 2b45      	or zzF, zzTmp ; combine flags
0009b5 940c 0200 	jmp zCMD_start
                 
                 zCMD_9b: ; SBC  A E
0009b7 bf4f      	out SREG,zzF
0009b8 9418      	sez
0009b9 091d      	sbc zzA,zzE
                 
0009ba b75f      	in zzTmp, SREG
0009bb 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009bc ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009bd 2b45      	or zzF, zzTmp ; combine flags
0009be 940c 0200 	jmp zCMD_start
                 
                 zCMD_9c: ; SBC  A H
0009c0 bf4f      	out SREG,zzF
0009c1 9418      	sez
0009c2 091e      	sbc zzA,zzH
                 
0009c3 b75f      	in zzTmp, SREG
0009c4 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009c5 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009c6 2b45      	or zzF, zzTmp ; combine flags
0009c7 940c 0200 	jmp zCMD_start
                 
                 zCMD_9d: ; SBC  A L
0009c9 bf4f      	out SREG,zzF
0009ca 9418      	sez
0009cb 091f      	sbc zzA,zzL
                 
0009cc b75f      	in zzTmp, SREG
0009cd 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009ce ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009cf 2b45      	or zzF, zzTmp ; combine flags
0009d0 940c 0200 	jmp zCMD_start
                 
                 zCMD_9e: ; SBC  A (HL)
0009d2 b8e8
0009d3 b8f2
0009d4 b854
0009d5 b83b
0009d6 0000
0009d7 0000
0009d8 b173
0009d9 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0009da bf4f      	out SREG,zzF
0009db 9418      	sez
0009dc 0b17      	sbc zzA,FROMRAM0
                 
0009dd b75f      	in zzTmp, SREG
0009de 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009df ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009e0 2b45      	or zzF, zzTmp ; combine flags
0009e1 940c 0200 	jmp zCMD_start
                 
                 zCMD_9f: ; SBC  A A
0009e3 bf4f      	out SREG,zzF
0009e4 9418      	sez
0009e5 0b11      	sbc zzA,zzA
                 
0009e6 b75f      	in zzTmp, SREG
0009e7 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0009e8 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0009e9 2b45      	or zzF, zzTmp ; combine flags
0009ea 940c 0200 	jmp zCMD_start
                 
                 zCMD_a0: ; AND  A B
0009ec 211a      	and zzA,zzB
                 
0009ed b75f      	in zzTmp, SREG
0009ee 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
0009ef ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
0009f0 2b45      	or zzF, zzTmp ; combine flags
0009f1 e1b8
0009f2 2fa1
0009f3 915c
0009f4 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0009f5 940c 0200 	jmp zCMD_start
                 
                 zCMD_a1: ; AND  A C
0009f7 2316      	and zzA,zzC
                 
0009f8 b75f      	in zzTmp, SREG
0009f9 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
0009fa ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
0009fb 2b45      	or zzF, zzTmp ; combine flags
0009fc e1b8
0009fd 2fa1
0009fe 915c
0009ff 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a00 940c 0200 	jmp zCMD_start
                 
                 zCMD_a2: ; AND  A D
000a02 211c      	and zzA,zzD
                 
000a03 b75f      	in zzTmp, SREG
000a04 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
000a05 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
000a06 2b45      	or zzF, zzTmp ; combine flags
000a07 e1b8
000a08 2fa1
000a09 915c
000a0a 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a0b 940c 0200 	jmp zCMD_start
                 
                 zCMD_a3: ; AND  A E
000a0d 211d      	and zzA,zzE
                 
000a0e b75f      	in zzTmp, SREG
000a0f 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
000a10 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
000a11 2b45      	or zzF, zzTmp ; combine flags
000a12 e1b8
000a13 2fa1
000a14 915c
000a15 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a16 940c 0200 	jmp zCMD_start
                 
                 zCMD_a4: ; AND  A H
000a18 211e      	and zzA,zzH
                 
000a19 b75f      	in zzTmp, SREG
000a1a 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
000a1b ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
000a1c 2b45      	or zzF, zzTmp ; combine flags
000a1d e1b8
000a1e 2fa1
000a1f 915c
000a20 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a21 940c 0200 	jmp zCMD_start
                 
                 zCMD_a5: ; AND  A L
000a23 211f      	and zzA,zzL
                 
000a24 b75f      	in zzTmp, SREG
000a25 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
000a26 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
000a27 2b45      	or zzF, zzTmp ; combine flags
000a28 e1b8
000a29 2fa1
000a2a 915c
000a2b 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a2c 940c 0200 	jmp zCMD_start
                 
                 zCMD_a6: ; AND  A (HL)
000a2e b8e8
000a2f b8f2
000a30 b854
000a31 b83b
000a32 0000
000a33 0000
000a34 b173
000a35 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
000a36 2317      	and zzA,FROMRAM0
                 
000a37 b75f      	in zzTmp, SREG
000a38 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
000a39 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
000a3a 2b45      	or zzF, zzTmp ; combine flags
000a3b e1b8
000a3c 2fa1
000a3d 915c
000a3e 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a3f 940c 0200 	jmp zCMD_start
                 
                 zCMD_a7: ; AND  A A
000a41 2311      	and zzA,zzA
                 
000a42 b75f      	in zzTmp, SREG
000a43 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
000a44 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
000a45 2b45      	or zzF, zzTmp ; combine flags
000a46 e1b8
000a47 2fa1
000a48 915c
000a49 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a4a 940c 0200 	jmp zCMD_start
                 
                 zCMD_a8: ; XOR  A B
000a4c 251a      	eor zzA,zzB
                 
000a4d b74f      	in zzF, SREG
000a4e 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a4f e1b8
000a50 2fa1
000a51 915c
000a52 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a53 940c 0200 	jmp zCMD_start
                 
                 zCMD_a9: ; XOR  A C
000a55 2716      	eor zzA,zzC
                 
000a56 b74f      	in zzF, SREG
000a57 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a58 e1b8
000a59 2fa1
000a5a 915c
000a5b 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a5c 940c 0200 	jmp zCMD_start
                 
                 zCMD_aa: ; XOR  A D
000a5e 251c      	eor zzA,zzD
                 
000a5f b74f      	in zzF, SREG
000a60 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a61 e1b8
000a62 2fa1
000a63 915c
000a64 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a65 940c 0200 	jmp zCMD_start
                 
                 zCMD_ab: ; XOR  A E
000a67 251d      	eor zzA,zzE
                 
000a68 b74f      	in zzF, SREG
000a69 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a6a e1b8
000a6b 2fa1
000a6c 915c
000a6d 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a6e 940c 0200 	jmp zCMD_start
                 
                 zCMD_ac: ; XOR  A H
000a70 251e      	eor zzA,zzH
                 
000a71 b74f      	in zzF, SREG
000a72 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a73 e1b8
000a74 2fa1
000a75 915c
000a76 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a77 940c 0200 	jmp zCMD_start
                 
                 zCMD_ad: ; XOR  A L
000a79 251f      	eor zzA,zzL
                 
000a7a b74f      	in zzF, SREG
000a7b 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a7c e1b8
000a7d 2fa1
000a7e 915c
000a7f 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a80 940c 0200 	jmp zCMD_start
                 
                 zCMD_ae: ; XOR  A (HL)
000a82 b8e8
000a83 b8f2
000a84 b854
000a85 b83b
000a86 0000
000a87 0000
000a88 b173
000a89 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
000a8a 2717      	eor zzA,FROMRAM0
                 
000a8b b74f      	in zzF, SREG
000a8c 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a8d e1b8
000a8e 2fa1
000a8f 915c
000a90 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a91 940c 0200 	jmp zCMD_start
                 
                 zCMD_af: ; XOR  A A
000a93 2711      	eor zzA,zzA
                 
000a94 b74f      	in zzF, SREG
000a95 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a96 e1b8
000a97 2fa1
000a98 915c
000a99 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000a9a 940c 0200 	jmp zCMD_start
                 
                 zCMD_b0: ; OR   A B
000a9c 291a      	or zzA,zzB
                 
000a9d b74f      	in zzF, SREG
000a9e 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000a9f e1b8
000aa0 2fa1
000aa1 915c
000aa2 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000aa3 940c 0200 	jmp zCMD_start
                 
                 zCMD_b1: ; OR   A C
000aa5 2b16      	or zzA,zzC
                 
000aa6 b74f      	in zzF, SREG
000aa7 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000aa8 e1b8
000aa9 2fa1
000aaa 915c
000aab 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000aac 940c 0200 	jmp zCMD_start
                 
                 zCMD_b2: ; OR   A D
000aae 291c      	or zzA,zzD
                 
000aaf b74f      	in zzF, SREG
000ab0 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000ab1 e1b8
000ab2 2fa1
000ab3 915c
000ab4 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000ab5 940c 0200 	jmp zCMD_start
                 
                 zCMD_b3: ; OR   A E
000ab7 291d      	or zzA,zzE
                 
000ab8 b74f      	in zzF, SREG
000ab9 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000aba e1b8
000abb 2fa1
000abc 915c
000abd 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000abe 940c 0200 	jmp zCMD_start
                 
                 zCMD_b4: ; OR   A H
000ac0 291e      	or zzA,zzH
                 
000ac1 b74f      	in zzF, SREG
000ac2 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000ac3 e1b8
000ac4 2fa1
000ac5 915c
000ac6 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000ac7 940c 0200 	jmp zCMD_start
                 
                 zCMD_b5: ; OR   A L
000ac9 291f      	or zzA,zzL
                 
000aca b74f      	in zzF, SREG
000acb 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000acc e1b8
000acd 2fa1
000ace 915c
000acf 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000ad0 940c 0200 	jmp zCMD_start
                 
                 zCMD_b6: ; OR   A (HL)
000ad2 b8e8
000ad3 b8f2
000ad4 b854
000ad5 b83b
000ad6 0000
000ad7 0000
000ad8 b173
000ad9 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
000ada 2b17      	or zzA,FROMRAM0
                 
000adb b74f      	in zzF, SREG
000adc 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000add e1b8
000ade 2fa1
000adf 915c
000ae0 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000ae1 940c 0200 	jmp zCMD_start
                 
                 zCMD_b7: ; OR   A A
000ae3 2b11      	or zzA,zzA
                 
000ae4 b74f      	in zzF, SREG
000ae5 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
000ae6 e1b8
000ae7 2fa1
000ae8 915c
000ae9 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
000aea 940c 0200 	jmp zCMD_start
                 
                 zCMD_b8: ; CP   A B
000aec 151a      	cp zzA,zzB
                 
000aed b75f      	in zzTmp, SREG
000aee 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000aef ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000af0 2b45      	or zzF, zzTmp ; combine flags
000af1 940c 0200 	jmp zCMD_start
                 
                 zCMD_b9: ; CP   A C
000af3 1716      	cp zzA,zzC
                 
000af4 b75f      	in zzTmp, SREG
000af5 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000af6 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000af7 2b45      	or zzF, zzTmp ; combine flags
000af8 940c 0200 	jmp zCMD_start
                 
                 zCMD_ba: ; CP   A D
000afa 151c      	cp zzA,zzD
                 
000afb b75f      	in zzTmp, SREG
000afc 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000afd ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000afe 2b45      	or zzF, zzTmp ; combine flags
000aff 940c 0200 	jmp zCMD_start
                 
                 zCMD_bb: ; CP   A E
000b01 151d      	cp zzA,zzE
                 
000b02 b75f      	in zzTmp, SREG
000b03 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000b04 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000b05 2b45      	or zzF, zzTmp ; combine flags
000b06 940c 0200 	jmp zCMD_start
                 
                 zCMD_bc: ; CP   A H
000b08 151e      	cp zzA,zzH
                 
000b09 b75f      	in zzTmp, SREG
000b0a 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000b0b ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000b0c 2b45      	or zzF, zzTmp ; combine flags
000b0d 940c 0200 	jmp zCMD_start
                 
                 zCMD_bd: ; CP   A L
000b0f 151f      	cp zzA,zzL
                 
000b10 b75f      	in zzTmp, SREG
000b11 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000b12 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000b13 2b45      	or zzF, zzTmp ; combine flags
000b14 940c 0200 	jmp zCMD_start
                 
                 zCMD_be: ; CP   A (HL)
000b16 b8e8
000b17 b8f2
000b18 b854
000b19 b83b
000b1a 0000
000b1b 0000
000b1c b173
000b1d b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
000b1e 1717      	cp zzA,FROMRAM0
                 
000b1f b75f      	in zzTmp, SREG
000b20 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000b21 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000b22 2b45      	or zzF, zzTmp ; combine flags
000b23 940c 0200 	jmp zCMD_start
                 
                 zCMD_bf: ; CP   A A
000b25 1711      	cp zzA,zzA
                 
000b26 b75f      	in zzTmp, SREG
000b27 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000b28 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000b29 2b45      	or zzF, zzTmp ; combine flags
000b2a 940c 0200 	jmp zCMD_start
                 
                 zCMD_c0: ; RET   NZ
000b2c fd41      	sbrc zzF,zzZF
000b2d 940c 0200 	jmp zCMD_start
000b2f b9d8
000b30 b9c2
000b31 b854
000b32 b83b
000b33 0000
000b34 0000
000b35 b183
000b36 b82b
000b37 0dc9
000b38 1dd5
000b39 b9d8
000b3a b9c2
000b3b b854
000b3c b83b
000b3d 0000
000b3e 0000
000b3f b193
000b40 b82b
000b41 0dc9
000b42 1dd5      	zzPOP zzPCh,zzPCl
                 
000b43 940c 0200 	jmp zCMD_start
                 
                 zCMD_c1: ; POP   BC
000b45 b9d8
000b46 b9c2
000b47 b854
000b48 b83b
000b49 0000
000b4a 0000
000b4b b163
000b4c b82b
000b4d 0dc9
000b4e 1dd5
000b4f b9d8
000b50 b9c2
000b51 b854
000b52 b83b
000b53 0000
000b54 0000
000b55 b0a3
000b56 b82b
000b57 0dc9
000b58 1dd5      	zzPOP zzB,zzC
                 
000b59 940c 0200 	jmp zCMD_start
                 
                 zCMD_c2: ; JP   NZ nn
000b5b b998
000b5c b982
000b5d b854
000b5e b83b
000b5f 9601
000b60 b123
000b61 b82b      	LDRAM_PC_NODDR FROMRAM2
000b62 b998
000b63 b982
000b64 b854
000b65 b83b
000b66 9601
000b67 b013
000b68 b82b      	LDRAM_PC_NODDR FROMRAM1
000b69 fd41      	sbrc zzF,zzZF
000b6a 940c 0200 	jmp zCMD_start
000b6c 2f82      	mov zzPCl,FROMRAM2
000b6d 2d91      	mov zzPCh,FROMRAM1
                 
000b6e 940c 0200 	jmp zCMD_start
                 
                 zCMD_c3: ; JP   * nn
000b70 b998
000b71 b982
000b72 b854
000b73 b83b
000b74 9601
000b75 b123
000b76 b82b      	LDRAM_PC_NODDR FROMRAM2
000b77 b998
000b78 b982
000b79 b854
000b7a b83b
000b7b 9601
000b7c b013
000b7d b82b      	LDRAM_PC_NODDR FROMRAM1
000b7e 1055      	cpse ZERO,ZERO
000b7f 940c 0200 	jmp zCMD_start
000b81 2f82      	mov zzPCl,FROMRAM2
000b82 2d91      	mov zzPCh,FROMRAM1
                 
000b83 940c 0200 	jmp zCMD_start
                 
                 zCMD_c4: ; CALL NZ nn
000b85 b998
000b86 b982
000b87 b854
000b88 b83b
000b89 9601
000b8a b123
000b8b b82b      	LDRAM_PC_NODDR FROMRAM2
000b8c b998
000b8d b982
000b8e b854
000b8f b83b
000b90 9601
000b91 b013
000b92 b82b      	LDRAM_PC_NODDR FROMRAM1
000b93 fd41      	sbrc zzF,zzZF
000b94 940c 0200 	jmp zCMD_start
000b96 19c9
000b97 09d5
000b98 b9d8
000b99 b9c2
000b9a b995
000b9b b824
000b9c 15d6
000b9d 985d
000b9e f100
000b9f b82b
000ba0 935f
000ba1 e158
000ba2 b955
000ba3 eb5f
000ba4 b954
000ba5 e050
000ba6 bd5d
000ba7 e550
000ba8 bd5c
000ba9 9859
000baa 915f
000bab 982c
000bac 939f
000bad 2f5d
000bae 940e 005f
000bb0 e054
000bb1 955a
000bb2 f7f1
000bb3 2f5c
000bb4 940e 005f
000bb6 e054
000bb7 955a
000bb8 f7f1
000bb9 915f
000bba 940e 005f
000bbc bc5c
000bbd 9a59
000bbe b854
000bbf b82b
000bc0 19c9
000bc1 09d5
000bc2 b9d8
000bc3 b9c2
000bc4 b985
000bc5 b824
000bc6 15d6
000bc7 985d
000bc8 f100
000bc9 b82b
000bca 935f
000bcb e158
000bcc b955
000bcd eb5f
000bce b954
000bcf e050
000bd0 bd5d
000bd1 e550
000bd2 bd5c
000bd3 9859
000bd4 915f
000bd5 982c
000bd6 938f
000bd7 2f5d
000bd8 940e 005f
000bda e054
000bdb 955a
000bdc f7f1
000bdd 2f5c
000bde 940e 005f
000be0 e054
000be1 955a
000be2 f7f1
000be3 915f
000be4 940e 005f
000be6 bc5c
000be7 9a59
000be8 b854
000be9 b82b      	zzPUSH zzPCh,zzPCl
000bea 2f82      	mov zzPCl,FROMRAM2
000beb 2d91      	mov zzPCh,FROMRAM1
                 
000bec 940c 0200 	jmp zCMD_start
                 
                 zCMD_c5: ; PUSH  BC
000bee 19c9
000bef 09d5
000bf0 b9d8
000bf1 b9c2
000bf2 b8a5
000bf3 b824
000bf4 15d6
000bf5 985d
000bf6 f100
000bf7 b82b
000bf8 935f
000bf9 e158
000bfa b955
000bfb eb5f
000bfc b954
000bfd e050
000bfe bd5d
000bff e550
000c00 bd5c
000c01 9859
000c02 915f
000c03 982c
000c04 92af
000c05 2f5d
000c06 940e 005f
000c08 e054
000c09 955a
000c0a f7f1
000c0b 2f5c
000c0c 940e 005f
000c0e e054
000c0f 955a
000c10 f7f1
000c11 915f
000c12 940e 005f
000c14 bc5c
000c15 9a59
000c16 b854
000c17 b82b
000c18 19c9
000c19 09d5
000c1a b9d8
000c1b b9c2
000c1c b965
000c1d b824
000c1e 15d6
000c1f 985d
000c20 f100
000c21 b82b
000c22 935f
000c23 e158
000c24 b955
000c25 eb5f
000c26 b954
000c27 e050
000c28 bd5d
000c29 e550
000c2a bd5c
000c2b 9859
000c2c 915f
000c2d 982c
000c2e 936f
000c2f 2f5d
000c30 940e 005f
000c32 e054
000c33 955a
000c34 f7f1
000c35 2f5c
000c36 940e 005f
000c38 e054
000c39 955a
000c3a f7f1
000c3b 915f
000c3c 940e 005f
000c3e bc5c
000c3f 9a59
000c40 b854
000c41 b82b      	zzPUSH zzB,zzC
                 
000c42 940c 0200 	jmp zCMD_start
                 
                 zCMD_c6: ; ADD  A n
000c44 b998
000c45 b982
000c46 b854
000c47 b83b
000c48 9601
000c49 b173
000c4a b82b      	LDRAM_PC_NODDR FROMRAM0
000c4b 0f17      	add zzA,FROMRAM0
                 
000c4c b74f      	in zzF, SREG
000c4d 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000c4e 940c 0200 	jmp zCMD_start
                 
                 zCMD_c7: ; RST   00h
000c50 19c9
000c51 09d5
000c52 b9d8
000c53 b9c2
000c54 b995
000c55 b824
000c56 15d6
000c57 985d
000c58 f100
000c59 b82b
000c5a 935f
000c5b e158
000c5c b955
000c5d eb5f
000c5e b954
000c5f e050
000c60 bd5d
000c61 e550
000c62 bd5c
000c63 9859
000c64 915f
000c65 982c
000c66 939f
000c67 2f5d
000c68 940e 005f
000c6a e054
000c6b 955a
000c6c f7f1
000c6d 2f5c
000c6e 940e 005f
000c70 e054
000c71 955a
000c72 f7f1
000c73 915f
000c74 940e 005f
000c76 bc5c
000c77 9a59
000c78 b854
000c79 b82b
000c7a 19c9
000c7b 09d5
000c7c b9d8
000c7d b9c2
000c7e b985
000c7f b824
000c80 15d6
000c81 985d
000c82 f100
000c83 b82b
000c84 935f
000c85 e158
000c86 b955
000c87 eb5f
000c88 b954
000c89 e050
000c8a bd5d
000c8b e550
000c8c bd5c
000c8d 9859
000c8e 915f
000c8f 982c
000c90 938f
000c91 2f5d
000c92 940e 005f
000c94 e054
000c95 955a
000c96 f7f1
000c97 2f5c
000c98 940e 005f
000c9a e054
000c9b 955a
000c9c f7f1
000c9d 915f
000c9e 940e 005f
000ca0 bc5c
000ca1 9a59
000ca2 b854
000ca3 b82b      	zzPUSH zzPCh,zzPCl
000ca4 2799      	clr zzPCh
000ca5 e080      	ldi zzPCl,0
                 
000ca6 940c 0200 	jmp zCMD_start
                 
                 zCMD_c8: ; RET   Z
000ca8 ff41      	sbrs zzF,zzZF
000ca9 940c 0200 	jmp zCMD_start
000cab b9d8
000cac b9c2
000cad b854
000cae b83b
000caf 0000
000cb0 0000
000cb1 b183
000cb2 b82b
000cb3 0dc9
000cb4 1dd5
000cb5 b9d8
000cb6 b9c2
000cb7 b854
000cb8 b83b
000cb9 0000
000cba 0000
000cbb b193
000cbc b82b
000cbd 0dc9
000cbe 1dd5      	zzPOP zzPCh,zzPCl
                 
000cbf 940c 0200 	jmp zCMD_start
                 
                 zCMD_c9: ; RET   *
000cc1 1055      	cpse ZERO,ZERO
000cc2 940c 0200 	jmp zCMD_start
000cc4 b9d8
000cc5 b9c2
000cc6 b854
000cc7 b83b
000cc8 0000
000cc9 0000
000cca b183
000ccb b82b
000ccc 0dc9
000ccd 1dd5
000cce b9d8
000ccf b9c2
000cd0 b854
000cd1 b83b
000cd2 0000
000cd3 0000
000cd4 b193
000cd5 b82b
000cd6 0dc9
000cd7 1dd5      	zzPOP zzPCh,zzPCl
                 
000cd8 940c 0200 	jmp zCMD_start
                 
                 zCMD_ca: ; JP   Z nn
000cda b998
000cdb b982
000cdc b854
000cdd b83b
000cde 9601
000cdf b123
000ce0 b82b      	LDRAM_PC_NODDR FROMRAM2
000ce1 b998
000ce2 b982
000ce3 b854
000ce4 b83b
000ce5 9601
000ce6 b013
000ce7 b82b      	LDRAM_PC_NODDR FROMRAM1
000ce8 ff41      	sbrs zzF,zzZF
000ce9 940c 0200 	jmp zCMD_start
000ceb 2f82      	mov zzPCl,FROMRAM2
000cec 2d91      	mov zzPCh,FROMRAM1
                 
000ced 940c 0200 	jmp zCMD_start
                 
                 zCMD_cb: ; CB*   
000cef e0bc      	ldi Xh, high(zOPCODE_CB_LBLS_L)
000cf0 940c 0201 	jmp zCMDP_start
                 
000cf2 940c 0200 	jmp zCMD_start
                 
                 zCMD_cc: ; CALL Z nn
000cf4 b998
000cf5 b982
000cf6 b854
000cf7 b83b
000cf8 9601
000cf9 b123
000cfa b82b      	LDRAM_PC_NODDR FROMRAM2
000cfb b998
000cfc b982
000cfd b854
000cfe b83b
000cff 9601
000d00 b013
000d01 b82b      	LDRAM_PC_NODDR FROMRAM1
000d02 ff41      	sbrs zzF,zzZF
000d03 940c 0200 	jmp zCMD_start
000d05 19c9
000d06 09d5
000d07 b9d8
000d08 b9c2
000d09 b995
000d0a b824
000d0b 15d6
000d0c 985d
000d0d f100
000d0e b82b
000d0f 935f
000d10 e158
000d11 b955
000d12 eb5f
000d13 b954
000d14 e050
000d15 bd5d
000d16 e550
000d17 bd5c
000d18 9859
000d19 915f
000d1a 982c
000d1b 939f
000d1c 2f5d
000d1d 940e 005f
000d1f e054
000d20 955a
000d21 f7f1
000d22 2f5c
000d23 940e 005f
000d25 e054
000d26 955a
000d27 f7f1
000d28 915f
000d29 940e 005f
000d2b bc5c
000d2c 9a59
000d2d b854
000d2e b82b
000d2f 19c9
000d30 09d5
000d31 b9d8
000d32 b9c2
000d33 b985
000d34 b824
000d35 15d6
000d36 985d
000d37 f100
000d38 b82b
000d39 935f
000d3a e158
000d3b b955
000d3c eb5f
000d3d b954
000d3e e050
000d3f bd5d
000d40 e550
000d41 bd5c
000d42 9859
000d43 915f
000d44 982c
000d45 938f
000d46 2f5d
000d47 940e 005f
000d49 e054
000d4a 955a
000d4b f7f1
000d4c 2f5c
000d4d 940e 005f
000d4f e054
000d50 955a
000d51 f7f1
000d52 915f
000d53 940e 005f
000d55 bc5c
000d56 9a59
000d57 b854
000d58 b82b      	zzPUSH zzPCh,zzPCl
000d59 2f82      	mov zzPCl,FROMRAM2
000d5a 2d91      	mov zzPCh,FROMRAM1
                 
000d5b 940c 0200 	jmp zCMD_start
                 
                 zCMD_cd: ; CALL * nn
000d5d b998
000d5e b982
000d5f b854
000d60 b83b
000d61 9601
000d62 b123
000d63 b82b      	LDRAM_PC_NODDR FROMRAM2
000d64 b998
000d65 b982
000d66 b854
000d67 b83b
000d68 9601
000d69 b013
000d6a b82b      	LDRAM_PC_NODDR FROMRAM1
000d6b 1055      	cpse ZERO,ZERO
000d6c 940c 0200 	jmp zCMD_start
000d6e 19c9
000d6f 09d5
000d70 b9d8
000d71 b9c2
000d72 b995
000d73 b824
000d74 15d6
000d75 985d
000d76 f100
000d77 b82b
000d78 935f
000d79 e158
000d7a b955
000d7b eb5f
000d7c b954
000d7d e050
000d7e bd5d
000d7f e550
000d80 bd5c
000d81 9859
000d82 915f
000d83 982c
000d84 939f
000d85 2f5d
000d86 940e 005f
000d88 e054
000d89 955a
000d8a f7f1
000d8b 2f5c
000d8c 940e 005f
000d8e e054
000d8f 955a
000d90 f7f1
000d91 915f
000d92 940e 005f
000d94 bc5c
000d95 9a59
000d96 b854
000d97 b82b
000d98 19c9
000d99 09d5
000d9a b9d8
000d9b b9c2
000d9c b985
000d9d b824
000d9e 15d6
000d9f 985d
000da0 f100
000da1 b82b
000da2 935f
000da3 e158
000da4 b955
000da5 eb5f
000da6 b954
000da7 e050
000da8 bd5d
000da9 e550
000daa bd5c
000dab 9859
000dac 915f
000dad 982c
000dae 938f
000daf 2f5d
000db0 940e 005f
000db2 e054
000db3 955a
000db4 f7f1
000db5 2f5c
000db6 940e 005f
000db8 e054
000db9 955a
000dba f7f1
000dbb 915f
000dbc 940e 005f
000dbe bc5c
000dbf 9a59
000dc0 b854
000dc1 b82b      	zzPUSH zzPCh,zzPCl
000dc2 2f82      	mov zzPCl,FROMRAM2
000dc3 2d91      	mov zzPCh,FROMRAM1
                 
000dc4 940c 0200 	jmp zCMD_start
                 
                 zCMD_ce: ; ADC  A n
000dc6 b998
000dc7 b982
000dc8 b854
000dc9 b83b
000dca 9601
000dcb b173
000dcc b82b      	LDRAM_PC_NODDR FROMRAM0
000dcd bf4f      	out SREG,zzF
000dce 1f17      	adc zzA,FROMRAM0
                 
000dcf b74f      	in zzF, SREG
000dd0 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
000dd1 940c 0200 	jmp zCMD_start
                 
                 zCMD_cf: ; RST   08h
000dd3 19c9
000dd4 09d5
000dd5 b9d8
000dd6 b9c2
000dd7 b995
000dd8 b824
000dd9 15d6
000dda 985d
000ddb f100
000ddc b82b
000ddd 935f
000dde e158
000ddf b955
000de0 eb5f
000de1 b954
000de2 e050
000de3 bd5d
000de4 e550
000de5 bd5c
000de6 9859
000de7 915f
000de8 982c
000de9 939f
000dea 2f5d
000deb 940e 005f
000ded e054
000dee 955a
000def f7f1
000df0 2f5c
000df1 940e 005f
000df3 e054
000df4 955a
000df5 f7f1
000df6 915f
000df7 940e 005f
000df9 bc5c
000dfa 9a59
000dfb b854
000dfc b82b
000dfd 19c9
000dfe 09d5
000dff b9d8
000e00 b9c2
000e01 b985
000e02 b824
000e03 15d6
000e04 985d
000e05 f100
000e06 b82b
000e07 935f
000e08 e158
000e09 b955
000e0a eb5f
000e0b b954
000e0c e050
000e0d bd5d
000e0e e550
000e0f bd5c
000e10 9859
000e11 915f
000e12 982c
000e13 938f
000e14 2f5d
000e15 940e 005f
000e17 e054
000e18 955a
000e19 f7f1
000e1a 2f5c
000e1b 940e 005f
000e1d e054
000e1e 955a
000e1f f7f1
000e20 915f
000e21 940e 005f
000e23 bc5c
000e24 9a59
000e25 b854
000e26 b82b      	zzPUSH zzPCh,zzPCl
000e27 2799      	clr zzPCh
000e28 e088      	ldi zzPCl,0x08
                 
000e29 940c 0200 	jmp zCMD_start
                 
                 zCMD_d0: ; RET   NC
000e2b fd40      	sbrc zzF,zzCF
000e2c 940c 0200 	jmp zCMD_start
000e2e b9d8
000e2f b9c2
000e30 b854
000e31 b83b
000e32 0000
000e33 0000
000e34 b183
000e35 b82b
000e36 0dc9
000e37 1dd5
000e38 b9d8
000e39 b9c2
000e3a b854
000e3b b83b
000e3c 0000
000e3d 0000
000e3e b193
000e3f b82b
000e40 0dc9
000e41 1dd5      	zzPOP zzPCh,zzPCl
                 
000e42 940c 0200 	jmp zCMD_start
                 
                 zCMD_d1: ; POP   DE
000e44 b9d8
000e45 b9c2
000e46 b854
000e47 b83b
000e48 0000
000e49 0000
000e4a b0d3
000e4b b82b
000e4c 0dc9
000e4d 1dd5
000e4e b9d8
000e4f b9c2
000e50 b854
000e51 b83b
000e52 0000
000e53 0000
000e54 b0c3
000e55 b82b
000e56 0dc9
000e57 1dd5      	zzPOP zzD,zzE
                 
000e58 940c 0200 	jmp zCMD_start
                 
                 zCMD_d2: ; JP   NC nn
000e5a b998
000e5b b982
000e5c b854
000e5d b83b
000e5e 9601
000e5f b123
000e60 b82b      	LDRAM_PC_NODDR FROMRAM2
000e61 b998
000e62 b982
000e63 b854
000e64 b83b
000e65 9601
000e66 b013
000e67 b82b      	LDRAM_PC_NODDR FROMRAM1
000e68 fd40      	sbrc zzF,zzCF
000e69 940c 0200 	jmp zCMD_start
000e6b 2f82      	mov zzPCl,FROMRAM2
000e6c 2d91      	mov zzPCh,FROMRAM1
                 
000e6d 940c 0200 	jmp zCMD_start
                 
                 zCMD_d3: ; OUT  (n) A
000e6f b998
000e70 b982
000e71 b854
000e72 b83b
000e73 9601
000e74 b173
000e75 b82b      	LDRAM_PC_NODDR FROMRAM0
000e76 2f57      	mov zzTmp,FROMRAM0
000e77 9310 090e 	sts CDATA,zzA
000e79 940e 7208 	call PORTOUT
                 
000e7b 940c 0200 	jmp zCMD_start
                 
                 zCMD_d4: ; CALL NC nn
000e7d b998
000e7e b982
000e7f b854
000e80 b83b
000e81 9601
000e82 b123
000e83 b82b      	LDRAM_PC_NODDR FROMRAM2
000e84 b998
000e85 b982
000e86 b854
000e87 b83b
000e88 9601
000e89 b013
000e8a b82b      	LDRAM_PC_NODDR FROMRAM1
000e8b fd40      	sbrc zzF,zzCF
000e8c 940c 0200 	jmp zCMD_start
000e8e 19c9
000e8f 09d5
000e90 b9d8
000e91 b9c2
000e92 b995
000e93 b824
000e94 15d6
000e95 985d
000e96 f100
000e97 b82b
000e98 935f
000e99 e158
000e9a b955
000e9b eb5f
000e9c b954
000e9d e050
000e9e bd5d
000e9f e550
000ea0 bd5c
000ea1 9859
000ea2 915f
000ea3 982c
000ea4 939f
000ea5 2f5d
000ea6 940e 005f
000ea8 e054
000ea9 955a
000eaa f7f1
000eab 2f5c
000eac 940e 005f
000eae e054
000eaf 955a
000eb0 f7f1
000eb1 915f
000eb2 940e 005f
000eb4 bc5c
000eb5 9a59
000eb6 b854
000eb7 b82b
000eb8 19c9
000eb9 09d5
000eba b9d8
000ebb b9c2
000ebc b985
000ebd b824
000ebe 15d6
000ebf 985d
000ec0 f100
000ec1 b82b
000ec2 935f
000ec3 e158
000ec4 b955
000ec5 eb5f
000ec6 b954
000ec7 e050
000ec8 bd5d
000ec9 e550
000eca bd5c
000ecb 9859
000ecc 915f
000ecd 982c
000ece 938f
000ecf 2f5d
000ed0 940e 005f
000ed2 e054
000ed3 955a
000ed4 f7f1
000ed5 2f5c
000ed6 940e 005f
000ed8 e054
000ed9 955a
000eda f7f1
000edb 915f
000edc 940e 005f
000ede bc5c
000edf 9a59
000ee0 b854
000ee1 b82b      	zzPUSH zzPCh,zzPCl
000ee2 2f82      	mov zzPCl,FROMRAM2
000ee3 2d91      	mov zzPCh,FROMRAM1
                 
000ee4 940c 0200 	jmp zCMD_start
                 
                 zCMD_d5: ; PUSH  DE
000ee6 19c9
000ee7 09d5
000ee8 b9d8
000ee9 b9c2
000eea b8c5
000eeb b824
000eec 15d6
000eed 985d
000eee f100
000eef b82b
000ef0 935f
000ef1 e158
000ef2 b955
000ef3 eb5f
000ef4 b954
000ef5 e050
000ef6 bd5d
000ef7 e550
000ef8 bd5c
000ef9 9859
000efa 915f
000efb 982c
000efc 92cf
000efd 2f5d
000efe 940e 005f
000f00 e054
000f01 955a
000f02 f7f1
000f03 2f5c
000f04 940e 005f
000f06 e054
000f07 955a
000f08 f7f1
000f09 915f
000f0a 940e 005f
000f0c bc5c
000f0d 9a59
000f0e b854
000f0f b82b
000f10 19c9
000f11 09d5
000f12 b9d8
000f13 b9c2
000f14 b8d5
000f15 b824
000f16 15d6
000f17 985d
000f18 f100
000f19 b82b
000f1a 935f
000f1b e158
000f1c b955
000f1d eb5f
000f1e b954
000f1f e050
000f20 bd5d
000f21 e550
000f22 bd5c
000f23 9859
000f24 915f
000f25 982c
000f26 92df
000f27 2f5d
000f28 940e 005f
000f2a e054
000f2b 955a
000f2c f7f1
000f2d 2f5c
000f2e 940e 005f
000f30 e054
000f31 955a
000f32 f7f1
000f33 915f
000f34 940e 005f
000f36 bc5c
000f37 9a59
000f38 b854
000f39 b82b      	zzPUSH zzD,zzE
                 
000f3a 940c 0200 	jmp zCMD_start
                 
                 zCMD_d6: ; SUB  A n
000f3c b998
000f3d b982
000f3e b854
000f3f b83b
000f40 9601
000f41 b173
000f42 b82b      	LDRAM_PC_NODDR FROMRAM0
000f43 1b17      	sub zzA,FROMRAM0
                 
000f44 b75f      	in zzTmp, SREG
000f45 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
000f46 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
000f47 2b45      	or zzF, zzTmp ; combine flags
000f48 940c 0200 	jmp zCMD_start
                 
                 zCMD_d7: ; RST   10h
000f4a 19c9
000f4b 09d5
000f4c b9d8
000f4d b9c2
000f4e b995
000f4f b824
000f50 15d6
000f51 985d
000f52 f100
000f53 b82b
000f54 935f
000f55 e158
000f56 b955
000f57 eb5f
000f58 b954
000f59 e050
000f5a bd5d
000f5b e550
000f5c bd5c
000f5d 9859
000f5e 915f
000f5f 982c
000f60 939f
000f61 2f5d
000f62 940e 005f
000f64 e054
000f65 955a
000f66 f7f1
000f67 2f5c
000f68 940e 005f
000f6a e054
000f6b 955a
000f6c f7f1
000f6d 915f
000f6e 940e 005f
000f70 bc5c
000f71 9a59
000f72 b854
000f73 b82b
000f74 19c9
000f75 09d5
000f76 b9d8
000f77 b9c2
000f78 b985
000f79 b824
000f7a 15d6
000f7b 985d
000f7c f100
000f7d b82b
000f7e 935f
000f7f e158
000f80 b955
000f81 eb5f
000f82 b954
000f83 e050
000f84 bd5d
000f85 e550
000f86 bd5c
000f87 9859
000f88 915f
000f89 982c
000f8a 938f
000f8b 2f5d
000f8c 940e 005f
000f8e e054
000f8f 955a
000f90 f7f1
000f91 2f5c
000f92 940e 005f
000f94 e054
000f95 955a
000f96 f7f1
000f97 915f
000f98 940e 005f
000f9a bc5c
000f9b 9a59
000f9c b854
000f9d b82b      	zzPUSH zzPCh,zzPCl
000f9e 2799      	clr zzPCh
000f9f e180      	ldi zzPCl,0x10
                 
000fa0 940c 0200 	jmp zCMD_start
                 
                 zCMD_d8: ; RET   C
000fa2 ff40      	sbrs zzF,zzCF
000fa3 940c 0200 	jmp zCMD_start
000fa5 b9d8
000fa6 b9c2
000fa7 b854
000fa8 b83b
000fa9 0000
000faa 0000
000fab b183
000fac b82b
000fad 0dc9
000fae 1dd5
000faf b9d8
000fb0 b9c2
000fb1 b854
000fb2 b83b
000fb3 0000
000fb4 0000
000fb5 b193
000fb6 b82b
000fb7 0dc9
000fb8 1dd5      	zzPOP zzPCh,zzPCl
                 
000fb9 940c 0200 	jmp zCMD_start
                 
                 zCMD_d9: ; EXX   
000fbb 9150 0907
000fbd 92e0 0907
000fbf 2ee5      	EX zzH,zzHe
000fc0 9150 0908
000fc2 92f0 0908
000fc4 2ef5      	EX zzL,zzLe
000fc5 9150 0903
000fc7 92a0 0903
000fc9 2ea5      	EX zzB,zzBe
000fca 9150 0904
000fcc 9360 0904
000fce 2f65      	EX zzC,zzCe
000fcf 9150 0905
000fd1 92c0 0905
000fd3 2ec5      	EX zzD,zzDe
000fd4 9150 0906
000fd6 92d0 0906
000fd8 2ed5      	EX zzE,zzEe
                 	
                 
000fd9 940c 0200 	jmp zCMD_start
                 
                 zCMD_da: ; JP   C nn
000fdb b998
000fdc b982
000fdd b854
000fde b83b
000fdf 9601
000fe0 b123
000fe1 b82b      	LDRAM_PC_NODDR FROMRAM2
000fe2 b998
000fe3 b982
000fe4 b854
000fe5 b83b
000fe6 9601
000fe7 b013
000fe8 b82b      	LDRAM_PC_NODDR FROMRAM1
000fe9 ff40      	sbrs zzF,zzCF
000fea 940c 0200 	jmp zCMD_start
000fec 2f82      	mov zzPCl,FROMRAM2
000fed 2d91      	mov zzPCh,FROMRAM1
                 
000fee 940c 0200 	jmp zCMD_start
                 
                 zCMD_db: ; IN   A (n)
000ff0 b998
000ff1 b982
000ff2 b854
000ff3 b83b
000ff4 9601
000ff5 b173
000ff6 b82b      	LDRAM_PC_NODDR FROMRAM0
000ff7 2f57      	mov zzTmp,FROMRAM0
000ff8 940e 7206 	call PORTIN
000ffa 2f15      	mov zzA,zzTmp
                 
000ffb 940c 0200 	jmp zCMD_start
                 
                 zCMD_dc: ; CALL C nn
000ffd b998
000ffe b982
000fff b854
001000 b83b
001001 9601
001002 b123
001003 b82b      	LDRAM_PC_NODDR FROMRAM2
001004 b998
001005 b982
001006 b854
001007 b83b
001008 9601
001009 b013
00100a b82b      	LDRAM_PC_NODDR FROMRAM1
00100b ff40      	sbrs zzF,zzCF
00100c 940c 0200 	jmp zCMD_start
00100e 19c9
00100f 09d5
001010 b9d8
001011 b9c2
001012 b995
001013 b824
001014 15d6
001015 985d
001016 f100
001017 b82b
001018 935f
001019 e158
00101a b955
00101b eb5f
00101c b954
00101d e050
00101e bd5d
00101f e550
001020 bd5c
001021 9859
001022 915f
001023 982c
001024 939f
001025 2f5d
001026 940e 005f
001028 e054
001029 955a
00102a f7f1
00102b 2f5c
00102c 940e 005f
00102e e054
00102f 955a
001030 f7f1
001031 915f
001032 940e 005f
001034 bc5c
001035 9a59
001036 b854
001037 b82b
001038 19c9
001039 09d5
00103a b9d8
00103b b9c2
00103c b985
00103d b824
00103e 15d6
00103f 985d
001040 f100
001041 b82b
001042 935f
001043 e158
001044 b955
001045 eb5f
001046 b954
001047 e050
001048 bd5d
001049 e550
00104a bd5c
00104b 9859
00104c 915f
00104d 982c
00104e 938f
00104f 2f5d
001050 940e 005f
001052 e054
001053 955a
001054 f7f1
001055 2f5c
001056 940e 005f
001058 e054
001059 955a
00105a f7f1
00105b 915f
00105c 940e 005f
00105e bc5c
00105f 9a59
001060 b854
001061 b82b      	zzPUSH zzPCh,zzPCl
001062 2f82      	mov zzPCl,FROMRAM2
001063 2d91      	mov zzPCh,FROMRAM1
                 
001064 940c 0200 	jmp zCMD_start
                 
                 zCMD_dd: ; DD*   
001066 e0be      	ldi Xh, high(zOPCODE_DD_LBLS_L)
001067 940c 0201 	jmp zCMDP_start
                 
001069 940c 0200 	jmp zCMD_start
                 
                 zCMD_de: ; SBC  A n
00106b b998
00106c b982
00106d b854
00106e b83b
00106f 9601
001070 b173
001071 b82b      	LDRAM_PC_NODDR FROMRAM0
001072 bf4f      	out SREG,zzF
001073 9418      	sez
001074 0b17      	sbc zzA,FROMRAM0
                 
001075 b75f      	in zzTmp, SREG
001076 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
001077 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
001078 2b45      	or zzF, zzTmp ; combine flags
001079 940c 0200 	jmp zCMD_start
                 
                 zCMD_df: ; RST   18h
00107b 19c9
00107c 09d5
00107d b9d8
00107e b9c2
00107f b995
001080 b824
001081 15d6
001082 985d
001083 f100
001084 b82b
001085 935f
001086 e158
001087 b955
001088 eb5f
001089 b954
00108a e050
00108b bd5d
00108c e550
00108d bd5c
00108e 9859
00108f 915f
001090 982c
001091 939f
001092 2f5d
001093 940e 005f
001095 e054
001096 955a
001097 f7f1
001098 2f5c
001099 940e 005f
00109b e054
00109c 955a
00109d f7f1
00109e 915f
00109f 940e 005f
0010a1 bc5c
0010a2 9a59
0010a3 b854
0010a4 b82b
0010a5 19c9
0010a6 09d5
0010a7 b9d8
0010a8 b9c2
0010a9 b985
0010aa b824
0010ab 15d6
0010ac 985d
0010ad f100
0010ae b82b
0010af 935f
0010b0 e158
0010b1 b955
0010b2 eb5f
0010b3 b954
0010b4 e050
0010b5 bd5d
0010b6 e550
0010b7 bd5c
0010b8 9859
0010b9 915f
0010ba 982c
0010bb 938f
0010bc 2f5d
0010bd 940e 005f
0010bf e054
0010c0 955a
0010c1 f7f1
0010c2 2f5c
0010c3 940e 005f
0010c5 e054
0010c6 955a
0010c7 f7f1
0010c8 915f
0010c9 940e 005f
0010cb bc5c
0010cc 9a59
0010cd b854
0010ce b82b      	zzPUSH zzPCh,zzPCl
0010cf 2799      	clr zzPCh
0010d0 e188      	ldi zzPCl,0x18
                 
0010d1 940c 0200 	jmp zCMD_start
                 
                 zCMD_e0: ; RET   PO
0010d3 fd43      	sbrc zzF,zzPF
0010d4 940c 0200 	jmp zCMD_start
0010d6 b9d8
0010d7 b9c2
0010d8 b854
0010d9 b83b
0010da 0000
0010db 0000
0010dc b183
0010dd b82b
0010de 0dc9
0010df 1dd5
0010e0 b9d8
0010e1 b9c2
0010e2 b854
0010e3 b83b
0010e4 0000
0010e5 0000
0010e6 b193
0010e7 b82b
0010e8 0dc9
0010e9 1dd5      	zzPOP zzPCh,zzPCl
                 
0010ea 940c 0200 	jmp zCMD_start
                 
                 zCMD_e1: ; POP   HL
0010ec b9d8
0010ed b9c2
0010ee b854
0010ef b83b
0010f0 0000
0010f1 0000
0010f2 b0f3
0010f3 b82b
0010f4 0dc9
0010f5 1dd5
0010f6 b9d8
0010f7 b9c2
0010f8 b854
0010f9 b83b
0010fa 0000
0010fb 0000
0010fc b0e3
0010fd b82b
0010fe 0dc9
0010ff 1dd5      	zzPOP zzH,zzL
                 
001100 940c 0200 	jmp zCMD_start
                 
                 zCMD_e2: ; JP   PO nn
001102 b998
001103 b982
001104 b854
001105 b83b
001106 9601
001107 b123
001108 b82b      	LDRAM_PC_NODDR FROMRAM2
001109 b998
00110a b982
00110b b854
00110c b83b
00110d 9601
00110e b013
00110f b82b      	LDRAM_PC_NODDR FROMRAM1
001110 fd43      	sbrc zzF,zzPF
001111 940c 0200 	jmp zCMD_start
001113 2f82      	mov zzPCl,FROMRAM2
001114 2d91      	mov zzPCh,FROMRAM1
                 
001115 940c 0200 	jmp zCMD_start
                 
                 zCMD_e3: ; EX   (SP) HL
001117 2e1d      	mov FROMRAM1,zzSPh
001118 2f2c      	mov FROMRAM2,zzSPl
001119 b818
00111a b922
00111b b854
00111c b83b
00111d 0000
00111e 0000
00111f b173
001120 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
001121 2d5f
001122 2ef7
001123 2f75      	EXR FROMRAM0,zzL
001124 b818
001125 b922
001126 b975
001127 b824
001128 1416
001129 985d
00112a f100
00112b b82b
00112c 935f
00112d e158
00112e b955
00112f eb5f
001130 b954
001131 e050
001132 bd5d
001133 e550
001134 bd5c
001135 9859
001136 915f
001137 982c
001138 937f
001139 2d51
00113a 940e 005f
00113c e054
00113d 955a
00113e f7f1
00113f 2f52
001140 940e 005f
001142 e054
001143 955a
001144 f7f1
001145 915f
001146 940e 005f
001148 bc5c
001149 9a59
00114a b854
00114b b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00114c 0d29
00114d 1c15      	INC2 FROMRAM1,FROMRAM2
00114e b818
00114f b922
001150 b854
001151 b83b
001152 0000
001153 0000
001154 b173
001155 b82b      	LDRAM FROMRAM1,FROMRAM2,FROMRAM0
001156 2d5e
001157 2ee7
001158 2f75      	EXR FROMRAM0,zzH
001159 b818
00115a b922
00115b b975
00115c b824
00115d 1416
00115e 985d
00115f f100
001160 b82b
001161 935f
001162 e158
001163 b955
001164 eb5f
001165 b954
001166 e050
001167 bd5d
001168 e550
001169 bd5c
00116a 9859
00116b 915f
00116c 982c
00116d 937f
00116e 2d51
00116f 940e 005f
001171 e054
001172 955a
001173 f7f1
001174 2f52
001175 940e 005f
001177 e054
001178 955a
001179 f7f1
00117a 915f
00117b 940e 005f
00117d bc5c
00117e 9a59
00117f b854
001180 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
                 	
                 
001181 940c 0200 	jmp zCMD_start
                 
                 zCMD_e4: ; CALL PO nn
001183 b998
001184 b982
001185 b854
001186 b83b
001187 9601
001188 b123
001189 b82b      	LDRAM_PC_NODDR FROMRAM2
00118a b998
00118b b982
00118c b854
00118d b83b
00118e 9601
00118f b013
001190 b82b      	LDRAM_PC_NODDR FROMRAM1
001191 fd43      	sbrc zzF,zzPF
001192 940c 0200 	jmp zCMD_start
001194 19c9
001195 09d5
001196 b9d8
001197 b9c2
001198 b995
001199 b824
00119a 15d6
00119b 985d
00119c f100
00119d b82b
00119e 935f
00119f e158
0011a0 b955
0011a1 eb5f
0011a2 b954
0011a3 e050
0011a4 bd5d
0011a5 e550
0011a6 bd5c
0011a7 9859
0011a8 915f
0011a9 982c
0011aa 939f
0011ab 2f5d
0011ac 940e 005f
0011ae e054
0011af 955a
0011b0 f7f1
0011b1 2f5c
0011b2 940e 005f
0011b4 e054
0011b5 955a
0011b6 f7f1
0011b7 915f
0011b8 940e 005f
0011ba bc5c
0011bb 9a59
0011bc b854
0011bd b82b
0011be 19c9
0011bf 09d5
0011c0 b9d8
0011c1 b9c2
0011c2 b985
0011c3 b824
0011c4 15d6
0011c5 985d
0011c6 f100
0011c7 b82b
0011c8 935f
0011c9 e158
0011ca b955
0011cb eb5f
0011cc b954
0011cd e050
0011ce bd5d
0011cf e550
0011d0 bd5c
0011d1 9859
0011d2 915f
0011d3 982c
0011d4 938f
0011d5 2f5d
0011d6 940e 005f
0011d8 e054
0011d9 955a
0011da f7f1
0011db 2f5c
0011dc 940e 005f
0011de e054
0011df 955a
0011e0 f7f1
0011e1 915f
0011e2 940e 005f
0011e4 bc5c
0011e5 9a59
0011e6 b854
0011e7 b82b      	zzPUSH zzPCh,zzPCl
0011e8 2f82      	mov zzPCl,FROMRAM2
0011e9 2d91      	mov zzPCh,FROMRAM1
                 
0011ea 940c 0200 	jmp zCMD_start
                 
                 zCMD_e5: ; PUSH  HL
0011ec 19c9
0011ed 09d5
0011ee b9d8
0011ef b9c2
0011f0 b8e5
0011f1 b824
0011f2 15d6
0011f3 985d
0011f4 f100
0011f5 b82b
0011f6 935f
0011f7 e158
0011f8 b955
0011f9 eb5f
0011fa b954
0011fb e050
0011fc bd5d
0011fd e550
0011fe bd5c
0011ff 9859
001200 915f
001201 982c
001202 92ef
001203 2f5d
001204 940e 005f
001206 e054
001207 955a
001208 f7f1
001209 2f5c
00120a 940e 005f
00120c e054
00120d 955a
00120e f7f1
00120f 915f
001210 940e 005f
001212 bc5c
001213 9a59
001214 b854
001215 b82b
001216 19c9
001217 09d5
001218 b9d8
001219 b9c2
00121a b8f5
00121b b824
00121c 15d6
00121d 985d
00121e f100
00121f b82b
001220 935f
001221 e158
001222 b955
001223 eb5f
001224 b954
001225 e050
001226 bd5d
001227 e550
001228 bd5c
001229 9859
00122a 915f
00122b 982c
00122c 92ff
00122d 2f5d
00122e 940e 005f
001230 e054
001231 955a
001232 f7f1
001233 2f5c
001234 940e 005f
001236 e054
001237 955a
001238 f7f1
001239 915f
00123a 940e 005f
00123c bc5c
00123d 9a59
00123e b854
00123f b82b      	zzPUSH zzH,zzL
                 
001240 940c 0200 	jmp zCMD_start
                 
                 zCMD_e6: ; AND  A n
001242 b998
001243 b982
001244 b854
001245 b83b
001246 9601
001247 b173
001248 b82b      	LDRAM_PC_NODDR FROMRAM0
001249 2317      	and zzA,FROMRAM0
                 
00124a b75f      	in zzTmp, SREG
00124b 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
00124c ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
00124d 2b45      	or zzF, zzTmp ; combine flags
00124e e1b8
00124f 2fa1
001250 915c
001251 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
001252 940c 0200 	jmp zCMD_start
                 
                 zCMD_e7: ; RST   20h
001254 19c9
001255 09d5
001256 b9d8
001257 b9c2
001258 b995
001259 b824
00125a 15d6
00125b 985d
00125c f100
00125d b82b
00125e 935f
00125f e158
001260 b955
001261 eb5f
001262 b954
001263 e050
001264 bd5d
001265 e550
001266 bd5c
001267 9859
001268 915f
001269 982c
00126a 939f
00126b 2f5d
00126c 940e 005f
00126e e054
00126f 955a
001270 f7f1
001271 2f5c
001272 940e 005f
001274 e054
001275 955a
001276 f7f1
001277 915f
001278 940e 005f
00127a bc5c
00127b 9a59
00127c b854
00127d b82b
00127e 19c9
00127f 09d5
001280 b9d8
001281 b9c2
001282 b985
001283 b824
001284 15d6
001285 985d
001286 f100
001287 b82b
001288 935f
001289 e158
00128a b955
00128b eb5f
00128c b954
00128d e050
00128e bd5d
00128f e550
001290 bd5c
001291 9859
001292 915f
001293 982c
001294 938f
001295 2f5d
001296 940e 005f
001298 e054
001299 955a
00129a f7f1
00129b 2f5c
00129c 940e 005f
00129e e054
00129f 955a
0012a0 f7f1
0012a1 915f
0012a2 940e 005f
0012a4 bc5c
0012a5 9a59
0012a6 b854
0012a7 b82b      	zzPUSH zzPCh,zzPCl
0012a8 2799      	clr zzPCh
0012a9 e280      	ldi zzPCl,0x20
                 
0012aa 940c 0200 	jmp zCMD_start
                 
                 zCMD_e8: ; RET   PE
0012ac ff43      	sbrs zzF,zzPF
0012ad 940c 0200 	jmp zCMD_start
0012af b9d8
0012b0 b9c2
0012b1 b854
0012b2 b83b
0012b3 0000
0012b4 0000
0012b5 b183
0012b6 b82b
0012b7 0dc9
0012b8 1dd5
0012b9 b9d8
0012ba b9c2
0012bb b854
0012bc b83b
0012bd 0000
0012be 0000
0012bf b193
0012c0 b82b
0012c1 0dc9
0012c2 1dd5      	zzPOP zzPCh,zzPCl
                 
0012c3 940c 0200 	jmp zCMD_start
                 
                 zCMD_e9: ; JP   * HL
0012c5 1055      	cpse ZERO,ZERO
0012c6 940c 0200 	jmp zCMD_start
0012c8 2d8f      	mov zzPCl,zzL
0012c9 2d9e      	mov zzPCh,zzH
                 
0012ca 940c 0200 	jmp zCMD_start
                 
                 zCMD_ea: ; JP   PE nn
0012cc b998
0012cd b982
0012ce b854
0012cf b83b
0012d0 9601
0012d1 b123
0012d2 b82b      	LDRAM_PC_NODDR FROMRAM2
0012d3 b998
0012d4 b982
0012d5 b854
0012d6 b83b
0012d7 9601
0012d8 b013
0012d9 b82b      	LDRAM_PC_NODDR FROMRAM1
0012da ff43      	sbrs zzF,zzPF
0012db 940c 0200 	jmp zCMD_start
0012dd 2f82      	mov zzPCl,FROMRAM2
0012de 2d91      	mov zzPCh,FROMRAM1
                 
0012df 940c 0200 	jmp zCMD_start
                 
                 zCMD_eb: ; EX   DE HL
0012e1 2d5e
0012e2 2cec
0012e3 2ec5      	EXR zzD,zzH
0012e4 2d5f
0012e5 2cfd
0012e6 2ed5      	EXR zzE,zzL
                 	
                 
0012e7 940c 0200 	jmp zCMD_start
                 
                 zCMD_ec: ; CALL PE nn
0012e9 b998
0012ea b982
0012eb b854
0012ec b83b
0012ed 9601
0012ee b123
0012ef b82b      	LDRAM_PC_NODDR FROMRAM2
0012f0 b998
0012f1 b982
0012f2 b854
0012f3 b83b
0012f4 9601
0012f5 b013
0012f6 b82b      	LDRAM_PC_NODDR FROMRAM1
0012f7 ff43      	sbrs zzF,zzPF
0012f8 940c 0200 	jmp zCMD_start
0012fa 19c9
0012fb 09d5
0012fc b9d8
0012fd b9c2
0012fe b995
0012ff b824
001300 15d6
001301 985d
001302 f100
001303 b82b
001304 935f
001305 e158
001306 b955
001307 eb5f
001308 b954
001309 e050
00130a bd5d
00130b e550
00130c bd5c
00130d 9859
00130e 915f
00130f 982c
001310 939f
001311 2f5d
001312 940e 005f
001314 e054
001315 955a
001316 f7f1
001317 2f5c
001318 940e 005f
00131a e054
00131b 955a
00131c f7f1
00131d 915f
00131e 940e 005f
001320 bc5c
001321 9a59
001322 b854
001323 b82b
001324 19c9
001325 09d5
001326 b9d8
001327 b9c2
001328 b985
001329 b824
00132a 15d6
00132b 985d
00132c f100
00132d b82b
00132e 935f
00132f e158
001330 b955
001331 eb5f
001332 b954
001333 e050
001334 bd5d
001335 e550
001336 bd5c
001337 9859
001338 915f
001339 982c
00133a 938f
00133b 2f5d
00133c 940e 005f
00133e e054
00133f 955a
001340 f7f1
001341 2f5c
001342 940e 005f
001344 e054
001345 955a
001346 f7f1
001347 915f
001348 940e 005f
00134a bc5c
00134b 9a59
00134c b854
00134d b82b      	zzPUSH zzPCh,zzPCl
00134e 2f82      	mov zzPCl,FROMRAM2
00134f 2d91      	mov zzPCh,FROMRAM1
                 
001350 940c 0200 	jmp zCMD_start
                 
                 zCMD_ed: ; ED*   
001352 e1b0      	ldi Xh, high(zOPCODE_ED_LBLS_L)
001353 940c 0201 	jmp zCMDP_start
                 
001355 940c 0200 	jmp zCMD_start
                 
                 zCMD_ee: ; XOR  A n
001357 b998
001358 b982
001359 b854
00135a b83b
00135b 9601
00135c b173
00135d b82b      	LDRAM_PC_NODDR FROMRAM0
00135e 2717      	eor zzA,FROMRAM0
                 
00135f b74f      	in zzF, SREG
001360 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
001361 e1b8
001362 2fa1
001363 915c
001364 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
001365 940c 0200 	jmp zCMD_start
                 
                 zCMD_ef: ; RST   28h
001367 19c9
001368 09d5
001369 b9d8
00136a b9c2
00136b b995
00136c b824
00136d 15d6
00136e 985d
00136f f100
001370 b82b
001371 935f
001372 e158
001373 b955
001374 eb5f
001375 b954
001376 e050
001377 bd5d
001378 e550
001379 bd5c
00137a 9859
00137b 915f
00137c 982c
00137d 939f
00137e 2f5d
00137f 940e 005f
001381 e054
001382 955a
001383 f7f1
001384 2f5c
001385 940e 005f
001387 e054
001388 955a
001389 f7f1
00138a 915f
00138b 940e 005f
00138d bc5c
00138e 9a59
00138f b854
001390 b82b
001391 19c9
001392 09d5
001393 b9d8
001394 b9c2
001395 b985
001396 b824
001397 15d6
001398 985d
001399 f100
00139a b82b
00139b 935f
00139c e158
00139d b955
00139e eb5f
00139f b954
0013a0 e050
0013a1 bd5d
0013a2 e550
0013a3 bd5c
0013a4 9859
0013a5 915f
0013a6 982c
0013a7 938f
0013a8 2f5d
0013a9 940e 005f
0013ab e054
0013ac 955a
0013ad f7f1
0013ae 2f5c
0013af 940e 005f
0013b1 e054
0013b2 955a
0013b3 f7f1
0013b4 915f
0013b5 940e 005f
0013b7 bc5c
0013b8 9a59
0013b9 b854
0013ba b82b      	zzPUSH zzPCh,zzPCl
0013bb 2799      	clr zzPCh
0013bc e288      	ldi zzPCl,0x28
                 
0013bd 940c 0200 	jmp zCMD_start
                 
                 zCMD_f0: ; RET   P
0013bf fd42      	sbrc zzF,zzSF
0013c0 940c 0200 	jmp zCMD_start
0013c2 b9d8
0013c3 b9c2
0013c4 b854
0013c5 b83b
0013c6 0000
0013c7 0000
0013c8 b183
0013c9 b82b
0013ca 0dc9
0013cb 1dd5
0013cc b9d8
0013cd b9c2
0013ce b854
0013cf b83b
0013d0 0000
0013d1 0000
0013d2 b193
0013d3 b82b
0013d4 0dc9
0013d5 1dd5      	zzPOP zzPCh,zzPCl
                 
0013d6 940c 0200 	jmp zCMD_start
                 
                 zCMD_f1: ; POP   AF
0013d8 b9d8
0013d9 b9c2
0013da b854
0013db b83b
0013dc 0000
0013dd 0000
0013de b173
0013df b82b
0013e0 0dc9
0013e1 1dd5
0013e2 b9d8
0013e3 b9c2
0013e4 b854
0013e5 b83b
0013e6 0000
0013e7 0000
0013e8 b113
0013e9 b82b
0013ea 0dc9
0013eb 1dd5      	zzPOP zzA,FROMRAM0
0013ec e1ba      	ldi Xh,high(FZ2ATABLE)
0013ed 2fa7      	mov Xl,FROMRAM0
0013ee 914c      	ld zzF,X
                 
0013ef 940c 0200 	jmp zCMD_start
                 
                 zCMD_f2: ; JP   P nn
0013f1 b998
0013f2 b982
0013f3 b854
0013f4 b83b
0013f5 9601
0013f6 b123
0013f7 b82b      	LDRAM_PC_NODDR FROMRAM2
0013f8 b998
0013f9 b982
0013fa b854
0013fb b83b
0013fc 9601
0013fd b013
0013fe b82b      	LDRAM_PC_NODDR FROMRAM1
0013ff fd42      	sbrc zzF,zzSF
001400 940c 0200 	jmp zCMD_start
001402 2f82      	mov zzPCl,FROMRAM2
001403 2d91      	mov zzPCh,FROMRAM1
                 
001404 940c 0200 	jmp zCMD_start
                 
                 zCMD_f3: ; DI    
001406 e050
001407 9350 0909 	zzSET zzIFF1,0
001409 e050
00140a 9350 090a 	zzSET zzIFF2,0
                 
00140c 940c 0200 	jmp zCMD_start
                 
                 zCMD_f4: ; CALL P nn
00140e b998
00140f b982
001410 b854
001411 b83b
001412 9601
001413 b123
001414 b82b      	LDRAM_PC_NODDR FROMRAM2
001415 b998
001416 b982
001417 b854
001418 b83b
001419 9601
00141a b013
00141b b82b      	LDRAM_PC_NODDR FROMRAM1
00141c fd42      	sbrc zzF,zzSF
00141d 940c 0200 	jmp zCMD_start
00141f 19c9
001420 09d5
001421 b9d8
001422 b9c2
001423 b995
001424 b824
001425 15d6
001426 985d
001427 f100
001428 b82b
001429 935f
00142a e158
00142b b955
00142c eb5f
00142d b954
00142e e050
00142f bd5d
001430 e550
001431 bd5c
001432 9859
001433 915f
001434 982c
001435 939f
001436 2f5d
001437 940e 005f
001439 e054
00143a 955a
00143b f7f1
00143c 2f5c
00143d 940e 005f
00143f e054
001440 955a
001441 f7f1
001442 915f
001443 940e 005f
001445 bc5c
001446 9a59
001447 b854
001448 b82b
001449 19c9
00144a 09d5
00144b b9d8
00144c b9c2
00144d b985
00144e b824
00144f 15d6
001450 985d
001451 f100
001452 b82b
001453 935f
001454 e158
001455 b955
001456 eb5f
001457 b954
001458 e050
001459 bd5d
00145a e550
00145b bd5c
00145c 9859
00145d 915f
00145e 982c
00145f 938f
001460 2f5d
001461 940e 005f
001463 e054
001464 955a
001465 f7f1
001466 2f5c
001467 940e 005f
001469 e054
00146a 955a
00146b f7f1
00146c 915f
00146d 940e 005f
00146f bc5c
001470 9a59
001471 b854
001472 b82b      	zzPUSH zzPCh,zzPCl
001473 2f82      	mov zzPCl,FROMRAM2
001474 2d91      	mov zzPCh,FROMRAM1
                 
001475 940c 0200 	jmp zCMD_start
                 
                 zCMD_f5: ; PUSH  AF
001477 e1b9      	ldi Xh,high(FA2ZTABLE)
001478 2fa4      	mov Xl,zzF
001479 917c      	ld FROMRAM0,X
00147a 19c9
00147b 09d5
00147c b9d8
00147d b9c2
00147e b915
00147f b824
001480 15d6
001481 985d
001482 f100
001483 b82b
001484 935f
001485 e158
001486 b955
001487 eb5f
001488 b954
001489 e050
00148a bd5d
00148b e550
00148c bd5c
00148d 9859
00148e 915f
00148f 982c
001490 931f
001491 2f5d
001492 940e 005f
001494 e054
001495 955a
001496 f7f1
001497 2f5c
001498 940e 005f
00149a e054
00149b 955a
00149c f7f1
00149d 915f
00149e 940e 005f
0014a0 bc5c
0014a1 9a59
0014a2 b854
0014a3 b82b
0014a4 19c9
0014a5 09d5
0014a6 b9d8
0014a7 b9c2
0014a8 b975
0014a9 b824
0014aa 15d6
0014ab 985d
0014ac f100
0014ad b82b
0014ae 935f
0014af e158
0014b0 b955
0014b1 eb5f
0014b2 b954
0014b3 e050
0014b4 bd5d
0014b5 e550
0014b6 bd5c
0014b7 9859
0014b8 915f
0014b9 982c
0014ba 937f
0014bb 2f5d
0014bc 940e 005f
0014be e054
0014bf 955a
0014c0 f7f1
0014c1 2f5c
0014c2 940e 005f
0014c4 e054
0014c5 955a
0014c6 f7f1
0014c7 915f
0014c8 940e 005f
0014ca bc5c
0014cb 9a59
0014cc b854
0014cd b82b      	zzPUSH zzA,FROMRAM0
                 
0014ce 940c 0200 	jmp zCMD_start
                 
                 zCMD_f6: ; OR   A n
0014d0 b998
0014d1 b982
0014d2 b854
0014d3 b83b
0014d4 9601
0014d5 b173
0014d6 b82b      	LDRAM_PC_NODDR FROMRAM0
0014d7 2b17      	or zzA,FROMRAM0
                 
0014d8 b74f      	in zzF, SREG
0014d9 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0014da e1b8
0014db 2fa1
0014dc 915c
0014dd 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0014de 940c 0200 	jmp zCMD_start
                 
                 zCMD_f7: ; RST   30h
0014e0 19c9
0014e1 09d5
0014e2 b9d8
0014e3 b9c2
0014e4 b995
0014e5 b824
0014e6 15d6
0014e7 985d
0014e8 f100
0014e9 b82b
0014ea 935f
0014eb e158
0014ec b955
0014ed eb5f
0014ee b954
0014ef e050
0014f0 bd5d
0014f1 e550
0014f2 bd5c
0014f3 9859
0014f4 915f
0014f5 982c
0014f6 939f
0014f7 2f5d
0014f8 940e 005f
0014fa e054
0014fb 955a
0014fc f7f1
0014fd 2f5c
0014fe 940e 005f
001500 e054
001501 955a
001502 f7f1
001503 915f
001504 940e 005f
001506 bc5c
001507 9a59
001508 b854
001509 b82b
00150a 19c9
00150b 09d5
00150c b9d8
00150d b9c2
00150e b985
00150f b824
001510 15d6
001511 985d
001512 f100
001513 b82b
001514 935f
001515 e158
001516 b955
001517 eb5f
001518 b954
001519 e050
00151a bd5d
00151b e550
00151c bd5c
00151d 9859
00151e 915f
00151f 982c
001520 938f
001521 2f5d
001522 940e 005f
001524 e054
001525 955a
001526 f7f1
001527 2f5c
001528 940e 005f
00152a e054
00152b 955a
00152c f7f1
00152d 915f
00152e 940e 005f
001530 bc5c
001531 9a59
001532 b854
001533 b82b      	zzPUSH zzPCh,zzPCl
001534 2799      	clr zzPCh
001535 e380      	ldi zzPCl,0x30
                 
001536 940c 0200 	jmp zCMD_start
                 
                 zCMD_f8: ; RET   M
001538 ff42      	sbrs zzF,zzSF
001539 940c 0200 	jmp zCMD_start
00153b b9d8
00153c b9c2
00153d b854
00153e b83b
00153f 0000
001540 0000
001541 b183
001542 b82b
001543 0dc9
001544 1dd5
001545 b9d8
001546 b9c2
001547 b854
001548 b83b
001549 0000
00154a 0000
00154b b193
00154c b82b
00154d 0dc9
00154e 1dd5      	zzPOP zzPCh,zzPCl
                 
00154f 940c 0200 	jmp zCMD_start
                 
                 zCMD_f9: ; LD   SP HL
001551 2dde      	mov zzSPh, zzH
001552 2dcf      	mov zzSPl, zzL
                 
001553 940c 0200 	jmp zCMD_start
                 
                 zCMD_fa: ; JP   M nn
001555 b998
001556 b982
001557 b854
001558 b83b
001559 9601
00155a b123
00155b b82b      	LDRAM_PC_NODDR FROMRAM2
00155c b998
00155d b982
00155e b854
00155f b83b
001560 9601
001561 b013
001562 b82b      	LDRAM_PC_NODDR FROMRAM1
001563 ff42      	sbrs zzF,zzSF
001564 940c 0200 	jmp zCMD_start
001566 2f82      	mov zzPCl,FROMRAM2
001567 2d91      	mov zzPCh,FROMRAM1
                 
001568 940c 0200 	jmp zCMD_start
                 
                 zCMD_fb: ; EI    
00156a e051
00156b 9350 0909 	zzSET zzIFF1,1
00156d e051
00156e 9350 090a 	zzSET zzIFF2,1
                 
001570 940c 0200 	jmp zCMD_start
                 
                 zCMD_fc: ; CALL M nn
001572 b998
001573 b982
001574 b854
001575 b83b
001576 9601
001577 b123
001578 b82b      	LDRAM_PC_NODDR FROMRAM2
001579 b998
00157a b982
00157b b854
00157c b83b
00157d 9601
00157e b013
00157f b82b      	LDRAM_PC_NODDR FROMRAM1
001580 ff42      	sbrs zzF,zzSF
001581 940c 0200 	jmp zCMD_start
001583 19c9
001584 09d5
001585 b9d8
001586 b9c2
001587 b995
001588 b824
001589 15d6
00158a 985d
00158b f100
00158c b82b
00158d 935f
00158e e158
00158f b955
001590 eb5f
001591 b954
001592 e050
001593 bd5d
001594 e550
001595 bd5c
001596 9859
001597 915f
001598 982c
001599 939f
00159a 2f5d
00159b 940e 005f
00159d e054
00159e 955a
00159f f7f1
0015a0 2f5c
0015a1 940e 005f
0015a3 e054
0015a4 955a
0015a5 f7f1
0015a6 915f
0015a7 940e 005f
0015a9 bc5c
0015aa 9a59
0015ab b854
0015ac b82b
0015ad 19c9
0015ae 09d5
0015af b9d8
0015b0 b9c2
0015b1 b985
0015b2 b824
0015b3 15d6
0015b4 985d
0015b5 f100
0015b6 b82b
0015b7 935f
0015b8 e158
0015b9 b955
0015ba eb5f
0015bb b954
0015bc e050
0015bd bd5d
0015be e550
0015bf bd5c
0015c0 9859
0015c1 915f
0015c2 982c
0015c3 938f
0015c4 2f5d
0015c5 940e 005f
0015c7 e054
0015c8 955a
0015c9 f7f1
0015ca 2f5c
0015cb 940e 005f
0015cd e054
0015ce 955a
0015cf f7f1
0015d0 915f
0015d1 940e 005f
0015d3 bc5c
0015d4 9a59
0015d5 b854
0015d6 b82b      	zzPUSH zzPCh,zzPCl
0015d7 2f82      	mov zzPCl,FROMRAM2
0015d8 2d91      	mov zzPCh,FROMRAM1
                 
0015d9 940c 0200 	jmp zCMD_start
                 
                 zCMD_fd: ; FD*   
0015db e1b2      	ldi Xh, high(zOPCODE_FD_LBLS_L)
0015dc 940c 0201 	jmp zCMDP_start
                 
0015de 940c 0200 	jmp zCMD_start
                 
                 zCMD_fe: ; CP   A n
0015e0 b998
0015e1 b982
0015e2 b854
0015e3 b83b
0015e4 9601
0015e5 b173
0015e6 b82b      	LDRAM_PC_NODDR FROMRAM0
0015e7 1717      	cp zzA,FROMRAM0
                 
0015e8 b75f      	in zzTmp, SREG
0015e9 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0015ea ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0015eb 2b45      	or zzF, zzTmp ; combine flags
0015ec 940c 0200 	jmp zCMD_start
                 
                 zCMD_ff: ; RST   38h
0015ee 19c9
0015ef 09d5
0015f0 b9d8
0015f1 b9c2
0015f2 b995
0015f3 b824
0015f4 15d6
0015f5 985d
0015f6 f100
0015f7 b82b
0015f8 935f
0015f9 e158
0015fa b955
0015fb eb5f
0015fc b954
0015fd e050
0015fe bd5d
0015ff e550
001600 bd5c
001601 9859
001602 915f
001603 982c
001604 939f
001605 2f5d
001606 940e 005f
001608 e054
001609 955a
00160a f7f1
00160b 2f5c
00160c 940e 005f
00160e e054
00160f 955a
001610 f7f1
001611 915f
001612 940e 005f
001614 bc5c
001615 9a59
001616 b854
001617 b82b
001618 19c9
001619 09d5
00161a b9d8
00161b b9c2
00161c b985
00161d b824
00161e 15d6
00161f 985d
001620 f100
001621 b82b
001622 935f
001623 e158
001624 b955
001625 eb5f
001626 b954
001627 e050
001628 bd5d
001629 e550
00162a bd5c
00162b 9859
00162c 915f
00162d 982c
00162e 938f
00162f 2f5d
001630 940e 005f
001632 e054
001633 955a
001634 f7f1
001635 2f5c
001636 940e 005f
001638 e054
001639 955a
00163a f7f1
00163b 915f
00163c 940e 005f
00163e bc5c
00163f 9a59
001640 b854
001641 b82b      	zzPUSH zzPCh,zzPCl
001642 2799      	clr zzPCh
001643 e388      	ldi zzPCl,0x38
                 
001644 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_00: ; RLC   B
001646 faa7      	bst zzB,7
001647 0caa      	lsl zzB
001648 f8a0      	bld zzB,0
001649 28aa      	or zzB,zzB
                 
00164a b74f      	in zzF, SREG
00164b 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00164c e1b8
00164d 2daa
00164e 915c
00164f 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
001650 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_01: ; RLC   C
001652 fb67      	bst zzC,7
001653 0f66      	lsl zzC
001654 f960      	bld zzC,0
001655 2b66      	or zzC,zzC
                 
001656 b74f      	in zzF, SREG
001657 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001658 e1b8
001659 2fa6
00165a 915c
00165b 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
00165c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_02: ; RLC   D
00165e fac7      	bst zzD,7
00165f 0ccc      	lsl zzD
001660 f8c0      	bld zzD,0
001661 28cc      	or zzD,zzD
                 
001662 b74f      	in zzF, SREG
001663 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001664 e1b8
001665 2dac
001666 915c
001667 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
001668 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_03: ; RLC   E
00166a fad7      	bst zzE,7
00166b 0cdd      	lsl zzE
00166c f8d0      	bld zzE,0
00166d 28dd      	or zzE,zzE
                 
00166e b74f      	in zzF, SREG
00166f 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001670 e1b8
001671 2dad
001672 915c
001673 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001674 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_04: ; RLC   H
001676 fae7      	bst zzH,7
001677 0cee      	lsl zzH
001678 f8e0      	bld zzH,0
001679 28ee      	or zzH,zzH
                 
00167a b74f      	in zzF, SREG
00167b 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00167c e1b8
00167d 2dae
00167e 915c
00167f 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
001680 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_05: ; RLC   L
001682 faf7      	bst zzL,7
001683 0cff      	lsl zzL
001684 f8f0      	bld zzL,0
001685 28ff      	or zzL,zzL
                 
001686 b74f      	in zzF, SREG
001687 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001688 e1b8
001689 2daf
00168a 915c
00168b 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
00168c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_06: ; RLC   (HL)
00168e b8e8
00168f b8f2
001690 b854
001691 b83b
001692 0000
001693 0000
001694 b173
001695 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001696 fb77      	bst FROMRAM0,7
001697 0f77      	lsl FROMRAM0
001698 f970      	bld FROMRAM0,0
001699 2b77      	or FROMRAM0,FROMRAM0
                 
00169a b67f      	in _sreg, SREG
00169b b8e8
00169c b8f2
00169d b975
00169e b824
00169f 14e6
0016a0 985d
0016a1 f100
0016a2 b82b
0016a3 935f
0016a4 e158
0016a5 b955
0016a6 eb5f
0016a7 b954
0016a8 e050
0016a9 bd5d
0016aa e550
0016ab bd5c
0016ac 9859
0016ad 915f
0016ae 982c
0016af 937f
0016b0 2d5e
0016b1 940e 005f
0016b3 e054
0016b4 955a
0016b5 f7f1
0016b6 2d5f
0016b7 940e 005f
0016b9 e054
0016ba 955a
0016bb f7f1
0016bc 915f
0016bd 940e 005f
0016bf bc5c
0016c0 9a59
0016c1 b854
0016c2 b82b      	STRAM zzH,zzL,FROMRAM0
0016c3 be7f      	out SREG,_sreg
0016c4 b74f      	in zzF, SREG
0016c5 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0016c6 e1b8
0016c7 2fa7
0016c8 915c
0016c9 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0016ca 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_07: ; RLC   A
0016cc fb17      	bst zzA,7
0016cd 0f11      	lsl zzA
0016ce f910      	bld zzA,0
0016cf 2b11      	or zzA,zzA
                 
0016d0 b74f      	in zzF, SREG
0016d1 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0016d2 e1b8
0016d3 2fa1
0016d4 915c
0016d5 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0016d6 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_08: ; RRC   B
0016d8 faa0      	bst zzB,0
0016d9 94a6      	lsr zzB
0016da f8a7      	bld zzB,7
0016db 28aa      	or zzB,zzB
                 
0016dc b74f      	in zzF, SREG
0016dd 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0016de e1b8
0016df 2daa
0016e0 915c
0016e1 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
0016e2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_09: ; RRC   C
0016e4 fb60      	bst zzC,0
0016e5 9566      	lsr zzC
0016e6 f967      	bld zzC,7
0016e7 2b66      	or zzC,zzC
                 
0016e8 b74f      	in zzF, SREG
0016e9 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0016ea e1b8
0016eb 2fa6
0016ec 915c
0016ed 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
0016ee 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_0a: ; RRC   D
0016f0 fac0      	bst zzD,0
0016f1 94c6      	lsr zzD
0016f2 f8c7      	bld zzD,7
0016f3 28cc      	or zzD,zzD
                 
0016f4 b74f      	in zzF, SREG
0016f5 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0016f6 e1b8
0016f7 2dac
0016f8 915c
0016f9 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
0016fa 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_0b: ; RRC   E
0016fc fad0      	bst zzE,0
0016fd 94d6      	lsr zzE
0016fe f8d7      	bld zzE,7
0016ff 28dd      	or zzE,zzE
                 
001700 b74f      	in zzF, SREG
001701 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001702 e1b8
001703 2dad
001704 915c
001705 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001706 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_0c: ; RRC   H
001708 fae0      	bst zzH,0
001709 94e6      	lsr zzH
00170a f8e7      	bld zzH,7
00170b 28ee      	or zzH,zzH
                 
00170c b74f      	in zzF, SREG
00170d 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00170e e1b8
00170f 2dae
001710 915c
001711 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
001712 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_0d: ; RRC   L
001714 faf0      	bst zzL,0
001715 94f6      	lsr zzL
001716 f8f7      	bld zzL,7
001717 28ff      	or zzL,zzL
                 
001718 b74f      	in zzF, SREG
001719 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00171a e1b8
00171b 2daf
00171c 915c
00171d 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
00171e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_0e: ; RRC   (HL)
001720 b8e8
001721 b8f2
001722 b854
001723 b83b
001724 0000
001725 0000
001726 b173
001727 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001728 fb70      	bst FROMRAM0,0
001729 9576      	lsr FROMRAM0
00172a f977      	bld FROMRAM0,7
00172b 2b77      	or FROMRAM0,FROMRAM0
                 
00172c b67f      	in _sreg, SREG
00172d b8e8
00172e b8f2
00172f b975
001730 b824
001731 14e6
001732 985d
001733 f100
001734 b82b
001735 935f
001736 e158
001737 b955
001738 eb5f
001739 b954
00173a e050
00173b bd5d
00173c e550
00173d bd5c
00173e 9859
00173f 915f
001740 982c
001741 937f
001742 2d5e
001743 940e 005f
001745 e054
001746 955a
001747 f7f1
001748 2d5f
001749 940e 005f
00174b e054
00174c 955a
00174d f7f1
00174e 915f
00174f 940e 005f
001751 bc5c
001752 9a59
001753 b854
001754 b82b      	STRAM zzH,zzL,FROMRAM0
001755 be7f      	out SREG,_sreg
001756 b74f      	in zzF, SREG
001757 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001758 e1b8
001759 2fa7
00175a 915c
00175b 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
00175c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_0f: ; RRC   A
00175e fb10      	bst zzA,0
00175f 9516      	lsr zzA
001760 f917      	bld zzA,7
001761 2b11      	or zzA,zzA
                 
001762 b74f      	in zzF, SREG
001763 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001764 e1b8
001765 2fa1
001766 915c
001767 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
001768 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_10: ; RL    B
00176a bf4f      	out SREG,zzF
00176b 1caa      	rol zzB
                 
00176c b74f      	in zzF, SREG
00176d 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00176e e1b8
00176f 2daa
001770 915c
001771 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
001772 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_11: ; RL    C
001774 bf4f      	out SREG,zzF
001775 1f66      	rol zzC
                 
001776 b74f      	in zzF, SREG
001777 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001778 e1b8
001779 2fa6
00177a 915c
00177b 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
00177c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_12: ; RL    D
00177e bf4f      	out SREG,zzF
00177f 1ccc      	rol zzD
                 
001780 b74f      	in zzF, SREG
001781 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001782 e1b8
001783 2dac
001784 915c
001785 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
001786 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_13: ; RL    E
001788 bf4f      	out SREG,zzF
001789 1cdd      	rol zzE
                 
00178a b74f      	in zzF, SREG
00178b 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00178c e1b8
00178d 2dad
00178e 915c
00178f 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001790 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_14: ; RL    H
001792 bf4f      	out SREG,zzF
001793 1cee      	rol zzH
                 
001794 b74f      	in zzF, SREG
001795 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001796 e1b8
001797 2dae
001798 915c
001799 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
00179a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_15: ; RL    L
00179c bf4f      	out SREG,zzF
00179d 1cff      	rol zzL
                 
00179e b74f      	in zzF, SREG
00179f 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0017a0 e1b8
0017a1 2daf
0017a2 915c
0017a3 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
0017a4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_16: ; RL    (HL)
0017a6 b8e8
0017a7 b8f2
0017a8 b854
0017a9 b83b
0017aa 0000
0017ab 0000
0017ac b173
0017ad b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0017ae bf4f      	out SREG,zzF
0017af 1f77      	rol FROMRAM0
                 
0017b0 b67f      	in _sreg, SREG
0017b1 b8e8
0017b2 b8f2
0017b3 b975
0017b4 b824
0017b5 14e6
0017b6 985d
0017b7 f100
0017b8 b82b
0017b9 935f
0017ba e158
0017bb b955
0017bc eb5f
0017bd b954
0017be e050
0017bf bd5d
0017c0 e550
0017c1 bd5c
0017c2 9859
0017c3 915f
0017c4 982c
0017c5 937f
0017c6 2d5e
0017c7 940e 005f
0017c9 e054
0017ca 955a
0017cb f7f1
0017cc 2d5f
0017cd 940e 005f
0017cf e054
0017d0 955a
0017d1 f7f1
0017d2 915f
0017d3 940e 005f
0017d5 bc5c
0017d6 9a59
0017d7 b854
0017d8 b82b      	STRAM zzH,zzL,FROMRAM0
0017d9 be7f      	out SREG,_sreg
0017da b74f      	in zzF, SREG
0017db 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0017dc e1b8
0017dd 2fa7
0017de 915c
0017df 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0017e0 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_17: ; RL    A
0017e2 bf4f      	out SREG,zzF
0017e3 1f11      	rol zzA
                 
0017e4 b74f      	in zzF, SREG
0017e5 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0017e6 e1b8
0017e7 2fa1
0017e8 915c
0017e9 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0017ea 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_18: ; RR    B
0017ec bf4f      	out SREG,zzF
0017ed 94a7      	ror zzB
                 
0017ee b74f      	in zzF, SREG
0017ef 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0017f0 e1b8
0017f1 2daa
0017f2 915c
0017f3 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
0017f4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_19: ; RR    C
0017f6 bf4f      	out SREG,zzF
0017f7 9567      	ror zzC
                 
0017f8 b74f      	in zzF, SREG
0017f9 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0017fa e1b8
0017fb 2fa6
0017fc 915c
0017fd 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
0017fe 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_1a: ; RR    D
001800 bf4f      	out SREG,zzF
001801 94c7      	ror zzD
                 
001802 b74f      	in zzF, SREG
001803 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001804 e1b8
001805 2dac
001806 915c
001807 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
001808 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_1b: ; RR    E
00180a bf4f      	out SREG,zzF
00180b 94d7      	ror zzE
                 
00180c b74f      	in zzF, SREG
00180d 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00180e e1b8
00180f 2dad
001810 915c
001811 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001812 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_1c: ; RR    H
001814 bf4f      	out SREG,zzF
001815 94e7      	ror zzH
                 
001816 b74f      	in zzF, SREG
001817 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001818 e1b8
001819 2dae
00181a 915c
00181b 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
00181c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_1d: ; RR    L
00181e bf4f      	out SREG,zzF
00181f 94f7      	ror zzL
                 
001820 b74f      	in zzF, SREG
001821 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001822 e1b8
001823 2daf
001824 915c
001825 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
001826 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_1e: ; RR    (HL)
001828 b8e8
001829 b8f2
00182a b854
00182b b83b
00182c 0000
00182d 0000
00182e b173
00182f b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001830 bf4f      	out SREG,zzF
001831 9577      	ror FROMRAM0
                 
001832 b67f      	in _sreg, SREG
001833 b8e8
001834 b8f2
001835 b975
001836 b824
001837 14e6
001838 985d
001839 f100
00183a b82b
00183b 935f
00183c e158
00183d b955
00183e eb5f
00183f b954
001840 e050
001841 bd5d
001842 e550
001843 bd5c
001844 9859
001845 915f
001846 982c
001847 937f
001848 2d5e
001849 940e 005f
00184b e054
00184c 955a
00184d f7f1
00184e 2d5f
00184f 940e 005f
001851 e054
001852 955a
001853 f7f1
001854 915f
001855 940e 005f
001857 bc5c
001858 9a59
001859 b854
00185a b82b      	STRAM zzH,zzL,FROMRAM0
00185b be7f      	out SREG,_sreg
00185c b74f      	in zzF, SREG
00185d 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00185e e1b8
00185f 2fa7
001860 915c
001861 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
001862 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_1f: ; RR    A
001864 bf4f      	out SREG,zzF
001865 9517      	ror zzA
                 
001866 b74f      	in zzF, SREG
001867 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001868 e1b8
001869 2fa1
00186a 915c
00186b 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00186c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_20: ; SLA   B
00186e 0caa      	lsl zzB
                 
00186f b74f      	in zzF, SREG
001870 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001871 e1b8
001872 2daa
001873 915c
001874 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
001875 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_21: ; SLA   C
001877 0f66      	lsl zzC
                 
001878 b74f      	in zzF, SREG
001879 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00187a e1b8
00187b 2fa6
00187c 915c
00187d 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
00187e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_22: ; SLA   D
001880 0ccc      	lsl zzD
                 
001881 b74f      	in zzF, SREG
001882 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001883 e1b8
001884 2dac
001885 915c
001886 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
001887 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_23: ; SLA   E
001889 0cdd      	lsl zzE
                 
00188a b74f      	in zzF, SREG
00188b 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00188c e1b8
00188d 2dad
00188e 915c
00188f 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001890 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_24: ; SLA   H
001892 0cee      	lsl zzH
                 
001893 b74f      	in zzF, SREG
001894 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001895 e1b8
001896 2dae
001897 915c
001898 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
001899 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_25: ; SLA   L
00189b 0cff      	lsl zzL
                 
00189c b74f      	in zzF, SREG
00189d 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00189e e1b8
00189f 2daf
0018a0 915c
0018a1 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
0018a2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_26: ; SLA   (HL)
0018a4 b8e8
0018a5 b8f2
0018a6 b854
0018a7 b83b
0018a8 0000
0018a9 0000
0018aa b173
0018ab b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0018ac 0f77      	lsl FROMRAM0
                 
0018ad b67f      	in _sreg, SREG
0018ae b8e8
0018af b8f2
0018b0 b975
0018b1 b824
0018b2 14e6
0018b3 985d
0018b4 f100
0018b5 b82b
0018b6 935f
0018b7 e158
0018b8 b955
0018b9 eb5f
0018ba b954
0018bb e050
0018bc bd5d
0018bd e550
0018be bd5c
0018bf 9859
0018c0 915f
0018c1 982c
0018c2 937f
0018c3 2d5e
0018c4 940e 005f
0018c6 e054
0018c7 955a
0018c8 f7f1
0018c9 2d5f
0018ca 940e 005f
0018cc e054
0018cd 955a
0018ce f7f1
0018cf 915f
0018d0 940e 005f
0018d2 bc5c
0018d3 9a59
0018d4 b854
0018d5 b82b      	STRAM zzH,zzL,FROMRAM0
0018d6 be7f      	out SREG,_sreg
0018d7 b74f      	in zzF, SREG
0018d8 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0018d9 e1b8
0018da 2fa7
0018db 915c
0018dc 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0018dd 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_27: ; SLA   A
0018df 0f11      	lsl zzA
                 
0018e0 b74f      	in zzF, SREG
0018e1 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0018e2 e1b8
0018e3 2fa1
0018e4 915c
0018e5 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0018e6 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_28: ; SRA   B
0018e8 faa7      	bst zzB,7
0018e9 94a6      	lsr zzB
0018ea f8a7      	bld zzB,7
0018eb 28aa      	or zzB,zzB
                 
0018ec b74f      	in zzF, SREG
0018ed 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0018ee e1b8
0018ef 2daa
0018f0 915c
0018f1 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
0018f2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_29: ; SRA   C
0018f4 fb67      	bst zzC,7
0018f5 9566      	lsr zzC
0018f6 f967      	bld zzC,7
0018f7 2b66      	or zzC,zzC
                 
0018f8 b74f      	in zzF, SREG
0018f9 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0018fa e1b8
0018fb 2fa6
0018fc 915c
0018fd 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
0018fe 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_2a: ; SRA   D
001900 fac7      	bst zzD,7
001901 94c6      	lsr zzD
001902 f8c7      	bld zzD,7
001903 28cc      	or zzD,zzD
                 
001904 b74f      	in zzF, SREG
001905 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001906 e1b8
001907 2dac
001908 915c
001909 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
00190a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_2b: ; SRA   E
00190c fad7      	bst zzE,7
00190d 94d6      	lsr zzE
00190e f8d7      	bld zzE,7
00190f 28dd      	or zzE,zzE
                 
001910 b74f      	in zzF, SREG
001911 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001912 e1b8
001913 2dad
001914 915c
001915 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001916 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_2c: ; SRA   H
001918 fae7      	bst zzH,7
001919 94e6      	lsr zzH
00191a f8e7      	bld zzH,7
00191b 28ee      	or zzH,zzH
                 
00191c b74f      	in zzF, SREG
00191d 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00191e e1b8
00191f 2dae
001920 915c
001921 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
001922 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_2d: ; SRA   L
001924 faf7      	bst zzL,7
001925 94f6      	lsr zzL
001926 f8f7      	bld zzL,7
001927 28ff      	or zzL,zzL
                 
001928 b74f      	in zzF, SREG
001929 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00192a e1b8
00192b 2daf
00192c 915c
00192d 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
00192e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_2e: ; SRA   (HL)
001930 b8e8
001931 b8f2
001932 b854
001933 b83b
001934 0000
001935 0000
001936 b173
001937 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001938 fb77      	bst FROMRAM0,7
001939 9576      	lsr FROMRAM0
00193a f977      	bld FROMRAM0,7
00193b 2b77      	or FROMRAM0,FROMRAM0
                 
00193c b67f      	in _sreg, SREG
00193d b8e8
00193e b8f2
00193f b975
001940 b824
001941 14e6
001942 985d
001943 f100
001944 b82b
001945 935f
001946 e158
001947 b955
001948 eb5f
001949 b954
00194a e050
00194b bd5d
00194c e550
00194d bd5c
00194e 9859
00194f 915f
001950 982c
001951 937f
001952 2d5e
001953 940e 005f
001955 e054
001956 955a
001957 f7f1
001958 2d5f
001959 940e 005f
00195b e054
00195c 955a
00195d f7f1
00195e 915f
00195f 940e 005f
001961 bc5c
001962 9a59
001963 b854
001964 b82b      	STRAM zzH,zzL,FROMRAM0
001965 be7f      	out SREG,_sreg
001966 b74f      	in zzF, SREG
001967 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001968 e1b8
001969 2fa7
00196a 915c
00196b 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
00196c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_2f: ; SRA   A
00196e fb17      	bst zzA,7
00196f 9516      	lsr zzA
001970 f917      	bld zzA,7
001971 2b11      	or zzA,zzA
                 
001972 b74f      	in zzF, SREG
001973 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001974 e1b8
001975 2fa1
001976 915c
001977 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
001978 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_30: ; SLL   B
00197a 0caa      	lsl zzB
00197b 9468      	set
00197c f8a0      	bld zzB,0
00197d 28aa      	or zzB,zzB
                 
00197e b74f      	in zzF, SREG
00197f 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001980 e1b8
001981 2daa
001982 915c
001983 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
001984 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_31: ; SLL   C
001986 0f66      	lsl zzC
001987 9468      	set
001988 f960      	bld zzC,0
001989 2b66      	or zzC,zzC
                 
00198a b74f      	in zzF, SREG
00198b 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
00198c e1b8
00198d 2fa6
00198e 915c
00198f 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
001990 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_32: ; SLL   D
001992 0ccc      	lsl zzD
001993 9468      	set
001994 f8c0      	bld zzD,0
001995 28cc      	or zzD,zzD
                 
001996 b74f      	in zzF, SREG
001997 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001998 e1b8
001999 2dac
00199a 915c
00199b 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
00199c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_33: ; SLL   E
00199e 0cdd      	lsl zzE
00199f 9468      	set
0019a0 f8d0      	bld zzE,0
0019a1 28dd      	or zzE,zzE
                 
0019a2 b74f      	in zzF, SREG
0019a3 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0019a4 e1b8
0019a5 2dad
0019a6 915c
0019a7 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
0019a8 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_34: ; SLL   H
0019aa 0cee      	lsl zzH
0019ab 9468      	set
0019ac f8e0      	bld zzH,0
0019ad 28ee      	or zzH,zzH
                 
0019ae b74f      	in zzF, SREG
0019af 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0019b0 e1b8
0019b1 2dae
0019b2 915c
0019b3 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
0019b4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_35: ; SLL   L
0019b6 0cff      	lsl zzL
0019b7 9468      	set
0019b8 f8f0      	bld zzL,0
0019b9 28ff      	or zzL,zzL
                 
0019ba b74f      	in zzF, SREG
0019bb 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0019bc e1b8
0019bd 2daf
0019be 915c
0019bf 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
0019c0 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_36: ; SLL   (HL)
0019c2 b8e8
0019c3 b8f2
0019c4 b854
0019c5 b83b
0019c6 0000
0019c7 0000
0019c8 b173
0019c9 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0019ca 0f77      	lsl FROMRAM0
0019cb 9468      	set
0019cc f970      	bld FROMRAM0,0
0019cd 2b77      	or FROMRAM0,FROMRAM0
                 
0019ce b67f      	in _sreg, SREG
0019cf b8e8
0019d0 b8f2
0019d1 b975
0019d2 b824
0019d3 14e6
0019d4 985d
0019d5 f100
0019d6 b82b
0019d7 935f
0019d8 e158
0019d9 b955
0019da eb5f
0019db b954
0019dc e050
0019dd bd5d
0019de e550
0019df bd5c
0019e0 9859
0019e1 915f
0019e2 982c
0019e3 937f
0019e4 2d5e
0019e5 940e 005f
0019e7 e054
0019e8 955a
0019e9 f7f1
0019ea 2d5f
0019eb 940e 005f
0019ed e054
0019ee 955a
0019ef f7f1
0019f0 915f
0019f1 940e 005f
0019f3 bc5c
0019f4 9a59
0019f5 b854
0019f6 b82b      	STRAM zzH,zzL,FROMRAM0
0019f7 be7f      	out SREG,_sreg
0019f8 b74f      	in zzF, SREG
0019f9 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0019fa e1b8
0019fb 2fa7
0019fc 915c
0019fd 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0019fe 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_37: ; SLL   A
001a00 0f11      	lsl zzA
001a01 9468      	set
001a02 f910      	bld zzA,0
001a03 2b11      	or zzA,zzA
                 
001a04 b74f      	in zzF, SREG
001a05 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
001a06 e1b8
001a07 2fa1
001a08 915c
001a09 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
001a0a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_38: ; SRL   B
001a0c 94a6      	lsr zzB
                 
001a0d b74f      	in zzF, SREG
001a0e 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a0f e1b8
001a10 2daa
001a11 915c
001a12 2b45      	SET_P_FLAG zzB ;(___|___|___|_P_|___|___) ; set P flag
001a13 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_39: ; SRL   C
001a15 9566      	lsr zzC
                 
001a16 b74f      	in zzF, SREG
001a17 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a18 e1b8
001a19 2fa6
001a1a 915c
001a1b 2b45      	SET_P_FLAG zzC ;(___|___|___|_P_|___|___) ; set P flag
001a1c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_3a: ; SRL   D
001a1e 94c6      	lsr zzD
                 
001a1f b74f      	in zzF, SREG
001a20 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a21 e1b8
001a22 2dac
001a23 915c
001a24 2b45      	SET_P_FLAG zzD ;(___|___|___|_P_|___|___) ; set P flag
001a25 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_3b: ; SRL   E
001a27 94d6      	lsr zzE
                 
001a28 b74f      	in zzF, SREG
001a29 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a2a e1b8
001a2b 2dad
001a2c 915c
001a2d 2b45      	SET_P_FLAG zzE ;(___|___|___|_P_|___|___) ; set P flag
001a2e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_3c: ; SRL   H
001a30 94e6      	lsr zzH
                 
001a31 b74f      	in zzF, SREG
001a32 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a33 e1b8
001a34 2dae
001a35 915c
001a36 2b45      	SET_P_FLAG zzH ;(___|___|___|_P_|___|___) ; set P flag
001a37 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_3d: ; SRL   L
001a39 94f6      	lsr zzL
                 
001a3a b74f      	in zzF, SREG
001a3b 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a3c e1b8
001a3d 2daf
001a3e 915c
001a3f 2b45      	SET_P_FLAG zzL ;(___|___|___|_P_|___|___) ; set P flag
001a40 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_3e: ; SRL   (HL)
001a42 b8e8
001a43 b8f2
001a44 b854
001a45 b83b
001a46 0000
001a47 0000
001a48 b173
001a49 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001a4a 9576      	lsr FROMRAM0
                 
001a4b b67f      	in _sreg, SREG
001a4c b8e8
001a4d b8f2
001a4e b975
001a4f b824
001a50 14e6
001a51 985d
001a52 f100
001a53 b82b
001a54 935f
001a55 e158
001a56 b955
001a57 eb5f
001a58 b954
001a59 e050
001a5a bd5d
001a5b e550
001a5c bd5c
001a5d 9859
001a5e 915f
001a5f 982c
001a60 937f
001a61 2d5e
001a62 940e 005f
001a64 e054
001a65 955a
001a66 f7f1
001a67 2d5f
001a68 940e 005f
001a6a e054
001a6b 955a
001a6c f7f1
001a6d 915f
001a6e 940e 005f
001a70 bc5c
001a71 9a59
001a72 b854
001a73 b82b      	STRAM zzH,zzL,FROMRAM0
001a74 be7f      	out SREG,_sreg
001a75 b74f      	in zzF, SREG
001a76 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a77 e1b8
001a78 2fa7
001a79 915c
001a7a 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
001a7b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_3f: ; SRL   A
001a7d 9516      	lsr zzA
                 
001a7e b74f      	in zzF, SREG
001a7f 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
001a80 e1b8
001a81 2fa1
001a82 915c
001a83 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
001a84 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_40: ; BIT  0 B
001a86 2d5a      	mov zzTmp,zzB
001a87 7051      	andi zzTmp,1<<0
001a88 94b8      	clv
001a89 b75f      	in zzTmp,SREG
001a8a fd51      	sbrc zzTmp,zzZF
001a8b 9438      	sev
                 
001a8c b75f      	in zzTmp, SREG
001a8d 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001a8e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001a8f 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001a90 2b45      	or zzF, zzTmp ; combine flags
001a91 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_41: ; BIT  0 C
001a93 2f56      	mov zzTmp,zzC
001a94 7051      	andi zzTmp,1<<0
001a95 94b8      	clv
001a96 b75f      	in zzTmp,SREG
001a97 fd51      	sbrc zzTmp,zzZF
001a98 9438      	sev
                 
001a99 b75f      	in zzTmp, SREG
001a9a 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001a9b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001a9c 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001a9d 2b45      	or zzF, zzTmp ; combine flags
001a9e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_42: ; BIT  0 D
001aa0 2d5c      	mov zzTmp,zzD
001aa1 7051      	andi zzTmp,1<<0
001aa2 94b8      	clv
001aa3 b75f      	in zzTmp,SREG
001aa4 fd51      	sbrc zzTmp,zzZF
001aa5 9438      	sev
                 
001aa6 b75f      	in zzTmp, SREG
001aa7 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001aa8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001aa9 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001aaa 2b45      	or zzF, zzTmp ; combine flags
001aab 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_43: ; BIT  0 E
001aad 2d5d      	mov zzTmp,zzE
001aae 7051      	andi zzTmp,1<<0
001aaf 94b8      	clv
001ab0 b75f      	in zzTmp,SREG
001ab1 fd51      	sbrc zzTmp,zzZF
001ab2 9438      	sev
                 
001ab3 b75f      	in zzTmp, SREG
001ab4 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ab5 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ab6 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ab7 2b45      	or zzF, zzTmp ; combine flags
001ab8 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_44: ; BIT  0 H
001aba 2d5e      	mov zzTmp,zzH
001abb 7051      	andi zzTmp,1<<0
001abc 94b8      	clv
001abd b75f      	in zzTmp,SREG
001abe fd51      	sbrc zzTmp,zzZF
001abf 9438      	sev
                 
001ac0 b75f      	in zzTmp, SREG
001ac1 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ac2 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ac3 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ac4 2b45      	or zzF, zzTmp ; combine flags
001ac5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_45: ; BIT  0 L
001ac7 2d5f      	mov zzTmp,zzL
001ac8 7051      	andi zzTmp,1<<0
001ac9 94b8      	clv
001aca b75f      	in zzTmp,SREG
001acb fd51      	sbrc zzTmp,zzZF
001acc 9438      	sev
                 
001acd b75f      	in zzTmp, SREG
001ace 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001acf 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ad0 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ad1 2b45      	or zzF, zzTmp ; combine flags
001ad2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_46: ; BIT  0 (HL)
001ad4 b8e8
001ad5 b8f2
001ad6 b854
001ad7 b83b
001ad8 0000
001ad9 0000
001ada b173
001adb b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001adc 2f57      	mov zzTmp,FROMRAM0
001add 7051      	andi zzTmp,1<<0
001ade 94b8      	clv
001adf b75f      	in zzTmp,SREG
001ae0 fd51      	sbrc zzTmp,zzZF
001ae1 9438      	sev
                 
001ae2 b75f      	in zzTmp, SREG
001ae3 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ae4 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ae5 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ae6 2b45      	or zzF, zzTmp ; combine flags
001ae7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_47: ; BIT  0 A
001ae9 2f51      	mov zzTmp,zzA
001aea 7051      	andi zzTmp,1<<0
001aeb 94b8      	clv
001aec b75f      	in zzTmp,SREG
001aed fd51      	sbrc zzTmp,zzZF
001aee 9438      	sev
                 
001aef b75f      	in zzTmp, SREG
001af0 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001af1 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001af2 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001af3 2b45      	or zzF, zzTmp ; combine flags
001af4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_48: ; BIT  1 B
001af6 2d5a      	mov zzTmp,zzB
001af7 7052      	andi zzTmp,1<<1
001af8 94b8      	clv
001af9 b75f      	in zzTmp,SREG
001afa fd51      	sbrc zzTmp,zzZF
001afb 9438      	sev
                 
001afc b75f      	in zzTmp, SREG
001afd 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001afe 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001aff 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b00 2b45      	or zzF, zzTmp ; combine flags
001b01 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_49: ; BIT  1 C
001b03 2f56      	mov zzTmp,zzC
001b04 7052      	andi zzTmp,1<<1
001b05 94b8      	clv
001b06 b75f      	in zzTmp,SREG
001b07 fd51      	sbrc zzTmp,zzZF
001b08 9438      	sev
                 
001b09 b75f      	in zzTmp, SREG
001b0a 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b0b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b0c 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b0d 2b45      	or zzF, zzTmp ; combine flags
001b0e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_4a: ; BIT  1 D
001b10 2d5c      	mov zzTmp,zzD
001b11 7052      	andi zzTmp,1<<1
001b12 94b8      	clv
001b13 b75f      	in zzTmp,SREG
001b14 fd51      	sbrc zzTmp,zzZF
001b15 9438      	sev
                 
001b16 b75f      	in zzTmp, SREG
001b17 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b18 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b19 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b1a 2b45      	or zzF, zzTmp ; combine flags
001b1b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_4b: ; BIT  1 E
001b1d 2d5d      	mov zzTmp,zzE
001b1e 7052      	andi zzTmp,1<<1
001b1f 94b8      	clv
001b20 b75f      	in zzTmp,SREG
001b21 fd51      	sbrc zzTmp,zzZF
001b22 9438      	sev
                 
001b23 b75f      	in zzTmp, SREG
001b24 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b25 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b26 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b27 2b45      	or zzF, zzTmp ; combine flags
001b28 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_4c: ; BIT  1 H
001b2a 2d5e      	mov zzTmp,zzH
001b2b 7052      	andi zzTmp,1<<1
001b2c 94b8      	clv
001b2d b75f      	in zzTmp,SREG
001b2e fd51      	sbrc zzTmp,zzZF
001b2f 9438      	sev
                 
001b30 b75f      	in zzTmp, SREG
001b31 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b32 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b33 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b34 2b45      	or zzF, zzTmp ; combine flags
001b35 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_4d: ; BIT  1 L
001b37 2d5f      	mov zzTmp,zzL
001b38 7052      	andi zzTmp,1<<1
001b39 94b8      	clv
001b3a b75f      	in zzTmp,SREG
001b3b fd51      	sbrc zzTmp,zzZF
001b3c 9438      	sev
                 
001b3d b75f      	in zzTmp, SREG
001b3e 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b3f 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b40 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b41 2b45      	or zzF, zzTmp ; combine flags
001b42 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_4e: ; BIT  1 (HL)
001b44 b8e8
001b45 b8f2
001b46 b854
001b47 b83b
001b48 0000
001b49 0000
001b4a b173
001b4b b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001b4c 2f57      	mov zzTmp,FROMRAM0
001b4d 7052      	andi zzTmp,1<<1
001b4e 94b8      	clv
001b4f b75f      	in zzTmp,SREG
001b50 fd51      	sbrc zzTmp,zzZF
001b51 9438      	sev
                 
001b52 b75f      	in zzTmp, SREG
001b53 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b54 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b55 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b56 2b45      	or zzF, zzTmp ; combine flags
001b57 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_4f: ; BIT  1 A
001b59 2f51      	mov zzTmp,zzA
001b5a 7052      	andi zzTmp,1<<1
001b5b 94b8      	clv
001b5c b75f      	in zzTmp,SREG
001b5d fd51      	sbrc zzTmp,zzZF
001b5e 9438      	sev
                 
001b5f b75f      	in zzTmp, SREG
001b60 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b61 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b62 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b63 2b45      	or zzF, zzTmp ; combine flags
001b64 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_50: ; BIT  2 B
001b66 2d5a      	mov zzTmp,zzB
001b67 7054      	andi zzTmp,1<<2
001b68 94b8      	clv
001b69 b75f      	in zzTmp,SREG
001b6a fd51      	sbrc zzTmp,zzZF
001b6b 9438      	sev
                 
001b6c b75f      	in zzTmp, SREG
001b6d 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b6e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b6f 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b70 2b45      	or zzF, zzTmp ; combine flags
001b71 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_51: ; BIT  2 C
001b73 2f56      	mov zzTmp,zzC
001b74 7054      	andi zzTmp,1<<2
001b75 94b8      	clv
001b76 b75f      	in zzTmp,SREG
001b77 fd51      	sbrc zzTmp,zzZF
001b78 9438      	sev
                 
001b79 b75f      	in zzTmp, SREG
001b7a 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b7b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b7c 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b7d 2b45      	or zzF, zzTmp ; combine flags
001b7e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_52: ; BIT  2 D
001b80 2d5c      	mov zzTmp,zzD
001b81 7054      	andi zzTmp,1<<2
001b82 94b8      	clv
001b83 b75f      	in zzTmp,SREG
001b84 fd51      	sbrc zzTmp,zzZF
001b85 9438      	sev
                 
001b86 b75f      	in zzTmp, SREG
001b87 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b88 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b89 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b8a 2b45      	or zzF, zzTmp ; combine flags
001b8b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_53: ; BIT  2 E
001b8d 2d5d      	mov zzTmp,zzE
001b8e 7054      	andi zzTmp,1<<2
001b8f 94b8      	clv
001b90 b75f      	in zzTmp,SREG
001b91 fd51      	sbrc zzTmp,zzZF
001b92 9438      	sev
                 
001b93 b75f      	in zzTmp, SREG
001b94 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001b95 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001b96 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001b97 2b45      	or zzF, zzTmp ; combine flags
001b98 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_54: ; BIT  2 H
001b9a 2d5e      	mov zzTmp,zzH
001b9b 7054      	andi zzTmp,1<<2
001b9c 94b8      	clv
001b9d b75f      	in zzTmp,SREG
001b9e fd51      	sbrc zzTmp,zzZF
001b9f 9438      	sev
                 
001ba0 b75f      	in zzTmp, SREG
001ba1 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ba2 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ba3 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ba4 2b45      	or zzF, zzTmp ; combine flags
001ba5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_55: ; BIT  2 L
001ba7 2d5f      	mov zzTmp,zzL
001ba8 7054      	andi zzTmp,1<<2
001ba9 94b8      	clv
001baa b75f      	in zzTmp,SREG
001bab fd51      	sbrc zzTmp,zzZF
001bac 9438      	sev
                 
001bad b75f      	in zzTmp, SREG
001bae 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001baf 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001bb0 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001bb1 2b45      	or zzF, zzTmp ; combine flags
001bb2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_56: ; BIT  2 (HL)
001bb4 b8e8
001bb5 b8f2
001bb6 b854
001bb7 b83b
001bb8 0000
001bb9 0000
001bba b173
001bbb b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001bbc 2f57      	mov zzTmp,FROMRAM0
001bbd 7054      	andi zzTmp,1<<2
001bbe 94b8      	clv
001bbf b75f      	in zzTmp,SREG
001bc0 fd51      	sbrc zzTmp,zzZF
001bc1 9438      	sev
                 
001bc2 b75f      	in zzTmp, SREG
001bc3 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001bc4 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001bc5 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001bc6 2b45      	or zzF, zzTmp ; combine flags
001bc7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_57: ; BIT  2 A
001bc9 2f51      	mov zzTmp,zzA
001bca 7054      	andi zzTmp,1<<2
001bcb 94b8      	clv
001bcc b75f      	in zzTmp,SREG
001bcd fd51      	sbrc zzTmp,zzZF
001bce 9438      	sev
                 
001bcf b75f      	in zzTmp, SREG
001bd0 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001bd1 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001bd2 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001bd3 2b45      	or zzF, zzTmp ; combine flags
001bd4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_58: ; BIT  3 B
001bd6 2d5a      	mov zzTmp,zzB
001bd7 7058      	andi zzTmp,1<<3
001bd8 94b8      	clv
001bd9 b75f      	in zzTmp,SREG
001bda fd51      	sbrc zzTmp,zzZF
001bdb 9438      	sev
                 
001bdc b75f      	in zzTmp, SREG
001bdd 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001bde 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001bdf 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001be0 2b45      	or zzF, zzTmp ; combine flags
001be1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_59: ; BIT  3 C
001be3 2f56      	mov zzTmp,zzC
001be4 7058      	andi zzTmp,1<<3
001be5 94b8      	clv
001be6 b75f      	in zzTmp,SREG
001be7 fd51      	sbrc zzTmp,zzZF
001be8 9438      	sev
                 
001be9 b75f      	in zzTmp, SREG
001bea 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001beb 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001bec 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001bed 2b45      	or zzF, zzTmp ; combine flags
001bee 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_5a: ; BIT  3 D
001bf0 2d5c      	mov zzTmp,zzD
001bf1 7058      	andi zzTmp,1<<3
001bf2 94b8      	clv
001bf3 b75f      	in zzTmp,SREG
001bf4 fd51      	sbrc zzTmp,zzZF
001bf5 9438      	sev
                 
001bf6 b75f      	in zzTmp, SREG
001bf7 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001bf8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001bf9 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001bfa 2b45      	or zzF, zzTmp ; combine flags
001bfb 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_5b: ; BIT  3 E
001bfd 2d5d      	mov zzTmp,zzE
001bfe 7058      	andi zzTmp,1<<3
001bff 94b8      	clv
001c00 b75f      	in zzTmp,SREG
001c01 fd51      	sbrc zzTmp,zzZF
001c02 9438      	sev
                 
001c03 b75f      	in zzTmp, SREG
001c04 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c05 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c06 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c07 2b45      	or zzF, zzTmp ; combine flags
001c08 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_5c: ; BIT  3 H
001c0a 2d5e      	mov zzTmp,zzH
001c0b 7058      	andi zzTmp,1<<3
001c0c 94b8      	clv
001c0d b75f      	in zzTmp,SREG
001c0e fd51      	sbrc zzTmp,zzZF
001c0f 9438      	sev
                 
001c10 b75f      	in zzTmp, SREG
001c11 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c12 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c13 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c14 2b45      	or zzF, zzTmp ; combine flags
001c15 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_5d: ; BIT  3 L
001c17 2d5f      	mov zzTmp,zzL
001c18 7058      	andi zzTmp,1<<3
001c19 94b8      	clv
001c1a b75f      	in zzTmp,SREG
001c1b fd51      	sbrc zzTmp,zzZF
001c1c 9438      	sev
                 
001c1d b75f      	in zzTmp, SREG
001c1e 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c1f 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c20 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c21 2b45      	or zzF, zzTmp ; combine flags
001c22 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_5e: ; BIT  3 (HL)
001c24 b8e8
001c25 b8f2
001c26 b854
001c27 b83b
001c28 0000
001c29 0000
001c2a b173
001c2b b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001c2c 2f57      	mov zzTmp,FROMRAM0
001c2d 7058      	andi zzTmp,1<<3
001c2e 94b8      	clv
001c2f b75f      	in zzTmp,SREG
001c30 fd51      	sbrc zzTmp,zzZF
001c31 9438      	sev
                 
001c32 b75f      	in zzTmp, SREG
001c33 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c34 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c35 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c36 2b45      	or zzF, zzTmp ; combine flags
001c37 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_5f: ; BIT  3 A
001c39 2f51      	mov zzTmp,zzA
001c3a 7058      	andi zzTmp,1<<3
001c3b 94b8      	clv
001c3c b75f      	in zzTmp,SREG
001c3d fd51      	sbrc zzTmp,zzZF
001c3e 9438      	sev
                 
001c3f b75f      	in zzTmp, SREG
001c40 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c41 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c42 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c43 2b45      	or zzF, zzTmp ; combine flags
001c44 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_60: ; BIT  4 B
001c46 2d5a      	mov zzTmp,zzB
001c47 7150      	andi zzTmp,1<<4
001c48 94b8      	clv
001c49 b75f      	in zzTmp,SREG
001c4a fd51      	sbrc zzTmp,zzZF
001c4b 9438      	sev
                 
001c4c b75f      	in zzTmp, SREG
001c4d 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c4e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c4f 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c50 2b45      	or zzF, zzTmp ; combine flags
001c51 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_61: ; BIT  4 C
001c53 2f56      	mov zzTmp,zzC
001c54 7150      	andi zzTmp,1<<4
001c55 94b8      	clv
001c56 b75f      	in zzTmp,SREG
001c57 fd51      	sbrc zzTmp,zzZF
001c58 9438      	sev
                 
001c59 b75f      	in zzTmp, SREG
001c5a 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c5b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c5c 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c5d 2b45      	or zzF, zzTmp ; combine flags
001c5e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_62: ; BIT  4 D
001c60 2d5c      	mov zzTmp,zzD
001c61 7150      	andi zzTmp,1<<4
001c62 94b8      	clv
001c63 b75f      	in zzTmp,SREG
001c64 fd51      	sbrc zzTmp,zzZF
001c65 9438      	sev
                 
001c66 b75f      	in zzTmp, SREG
001c67 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c68 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c69 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c6a 2b45      	or zzF, zzTmp ; combine flags
001c6b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_63: ; BIT  4 E
001c6d 2d5d      	mov zzTmp,zzE
001c6e 7150      	andi zzTmp,1<<4
001c6f 94b8      	clv
001c70 b75f      	in zzTmp,SREG
001c71 fd51      	sbrc zzTmp,zzZF
001c72 9438      	sev
                 
001c73 b75f      	in zzTmp, SREG
001c74 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c75 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c76 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c77 2b45      	or zzF, zzTmp ; combine flags
001c78 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_64: ; BIT  4 H
001c7a 2d5e      	mov zzTmp,zzH
001c7b 7150      	andi zzTmp,1<<4
001c7c 94b8      	clv
001c7d b75f      	in zzTmp,SREG
001c7e fd51      	sbrc zzTmp,zzZF
001c7f 9438      	sev
                 
001c80 b75f      	in zzTmp, SREG
001c81 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c82 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c83 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c84 2b45      	or zzF, zzTmp ; combine flags
001c85 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_65: ; BIT  4 L
001c87 2d5f      	mov zzTmp,zzL
001c88 7150      	andi zzTmp,1<<4
001c89 94b8      	clv
001c8a b75f      	in zzTmp,SREG
001c8b fd51      	sbrc zzTmp,zzZF
001c8c 9438      	sev
                 
001c8d b75f      	in zzTmp, SREG
001c8e 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001c8f 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001c90 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001c91 2b45      	or zzF, zzTmp ; combine flags
001c92 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_66: ; BIT  4 (HL)
001c94 b8e8
001c95 b8f2
001c96 b854
001c97 b83b
001c98 0000
001c99 0000
001c9a b173
001c9b b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001c9c 2f57      	mov zzTmp,FROMRAM0
001c9d 7150      	andi zzTmp,1<<4
001c9e 94b8      	clv
001c9f b75f      	in zzTmp,SREG
001ca0 fd51      	sbrc zzTmp,zzZF
001ca1 9438      	sev
                 
001ca2 b75f      	in zzTmp, SREG
001ca3 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ca4 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ca5 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ca6 2b45      	or zzF, zzTmp ; combine flags
001ca7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_67: ; BIT  4 A
001ca9 2f51      	mov zzTmp,zzA
001caa 7150      	andi zzTmp,1<<4
001cab 94b8      	clv
001cac b75f      	in zzTmp,SREG
001cad fd51      	sbrc zzTmp,zzZF
001cae 9438      	sev
                 
001caf b75f      	in zzTmp, SREG
001cb0 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001cb1 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001cb2 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001cb3 2b45      	or zzF, zzTmp ; combine flags
001cb4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_68: ; BIT  5 B
001cb6 2d5a      	mov zzTmp,zzB
001cb7 7250      	andi zzTmp,1<<5
001cb8 94b8      	clv
001cb9 b75f      	in zzTmp,SREG
001cba fd51      	sbrc zzTmp,zzZF
001cbb 9438      	sev
                 
001cbc b75f      	in zzTmp, SREG
001cbd 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001cbe 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001cbf 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001cc0 2b45      	or zzF, zzTmp ; combine flags
001cc1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_69: ; BIT  5 C
001cc3 2f56      	mov zzTmp,zzC
001cc4 7250      	andi zzTmp,1<<5
001cc5 94b8      	clv
001cc6 b75f      	in zzTmp,SREG
001cc7 fd51      	sbrc zzTmp,zzZF
001cc8 9438      	sev
                 
001cc9 b75f      	in zzTmp, SREG
001cca 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ccb 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ccc 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ccd 2b45      	or zzF, zzTmp ; combine flags
001cce 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_6a: ; BIT  5 D
001cd0 2d5c      	mov zzTmp,zzD
001cd1 7250      	andi zzTmp,1<<5
001cd2 94b8      	clv
001cd3 b75f      	in zzTmp,SREG
001cd4 fd51      	sbrc zzTmp,zzZF
001cd5 9438      	sev
                 
001cd6 b75f      	in zzTmp, SREG
001cd7 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001cd8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001cd9 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001cda 2b45      	or zzF, zzTmp ; combine flags
001cdb 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_6b: ; BIT  5 E
001cdd 2d5d      	mov zzTmp,zzE
001cde 7250      	andi zzTmp,1<<5
001cdf 94b8      	clv
001ce0 b75f      	in zzTmp,SREG
001ce1 fd51      	sbrc zzTmp,zzZF
001ce2 9438      	sev
                 
001ce3 b75f      	in zzTmp, SREG
001ce4 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ce5 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001ce6 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001ce7 2b45      	or zzF, zzTmp ; combine flags
001ce8 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_6c: ; BIT  5 H
001cea 2d5e      	mov zzTmp,zzH
001ceb 7250      	andi zzTmp,1<<5
001cec 94b8      	clv
001ced b75f      	in zzTmp,SREG
001cee fd51      	sbrc zzTmp,zzZF
001cef 9438      	sev
                 
001cf0 b75f      	in zzTmp, SREG
001cf1 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001cf2 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001cf3 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001cf4 2b45      	or zzF, zzTmp ; combine flags
001cf5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_6d: ; BIT  5 L
001cf7 2d5f      	mov zzTmp,zzL
001cf8 7250      	andi zzTmp,1<<5
001cf9 94b8      	clv
001cfa b75f      	in zzTmp,SREG
001cfb fd51      	sbrc zzTmp,zzZF
001cfc 9438      	sev
                 
001cfd b75f      	in zzTmp, SREG
001cfe 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001cff 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d00 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d01 2b45      	or zzF, zzTmp ; combine flags
001d02 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_6e: ; BIT  5 (HL)
001d04 b8e8
001d05 b8f2
001d06 b854
001d07 b83b
001d08 0000
001d09 0000
001d0a b173
001d0b b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001d0c 2f57      	mov zzTmp,FROMRAM0
001d0d 7250      	andi zzTmp,1<<5
001d0e 94b8      	clv
001d0f b75f      	in zzTmp,SREG
001d10 fd51      	sbrc zzTmp,zzZF
001d11 9438      	sev
                 
001d12 b75f      	in zzTmp, SREG
001d13 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d14 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d15 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d16 2b45      	or zzF, zzTmp ; combine flags
001d17 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_6f: ; BIT  5 A
001d19 2f51      	mov zzTmp,zzA
001d1a 7250      	andi zzTmp,1<<5
001d1b 94b8      	clv
001d1c b75f      	in zzTmp,SREG
001d1d fd51      	sbrc zzTmp,zzZF
001d1e 9438      	sev
                 
001d1f b75f      	in zzTmp, SREG
001d20 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d21 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d22 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d23 2b45      	or zzF, zzTmp ; combine flags
001d24 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_70: ; BIT  6 B
001d26 2d5a      	mov zzTmp,zzB
001d27 7450      	andi zzTmp,1<<6
001d28 94b8      	clv
001d29 b75f      	in zzTmp,SREG
001d2a fd51      	sbrc zzTmp,zzZF
001d2b 9438      	sev
                 
001d2c b75f      	in zzTmp, SREG
001d2d 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d2e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d2f 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d30 2b45      	or zzF, zzTmp ; combine flags
001d31 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_71: ; BIT  6 C
001d33 2f56      	mov zzTmp,zzC
001d34 7450      	andi zzTmp,1<<6
001d35 94b8      	clv
001d36 b75f      	in zzTmp,SREG
001d37 fd51      	sbrc zzTmp,zzZF
001d38 9438      	sev
                 
001d39 b75f      	in zzTmp, SREG
001d3a 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d3b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d3c 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d3d 2b45      	or zzF, zzTmp ; combine flags
001d3e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_72: ; BIT  6 D
001d40 2d5c      	mov zzTmp,zzD
001d41 7450      	andi zzTmp,1<<6
001d42 94b8      	clv
001d43 b75f      	in zzTmp,SREG
001d44 fd51      	sbrc zzTmp,zzZF
001d45 9438      	sev
                 
001d46 b75f      	in zzTmp, SREG
001d47 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d48 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d49 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d4a 2b45      	or zzF, zzTmp ; combine flags
001d4b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_73: ; BIT  6 E
001d4d 2d5d      	mov zzTmp,zzE
001d4e 7450      	andi zzTmp,1<<6
001d4f 94b8      	clv
001d50 b75f      	in zzTmp,SREG
001d51 fd51      	sbrc zzTmp,zzZF
001d52 9438      	sev
                 
001d53 b75f      	in zzTmp, SREG
001d54 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d55 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d56 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d57 2b45      	or zzF, zzTmp ; combine flags
001d58 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_74: ; BIT  6 H
001d5a 2d5e      	mov zzTmp,zzH
001d5b 7450      	andi zzTmp,1<<6
001d5c 94b8      	clv
001d5d b75f      	in zzTmp,SREG
001d5e fd51      	sbrc zzTmp,zzZF
001d5f 9438      	sev
                 
001d60 b75f      	in zzTmp, SREG
001d61 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d62 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d63 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d64 2b45      	or zzF, zzTmp ; combine flags
001d65 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_75: ; BIT  6 L
001d67 2d5f      	mov zzTmp,zzL
001d68 7450      	andi zzTmp,1<<6
001d69 94b8      	clv
001d6a b75f      	in zzTmp,SREG
001d6b fd51      	sbrc zzTmp,zzZF
001d6c 9438      	sev
                 
001d6d b75f      	in zzTmp, SREG
001d6e 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d6f 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d70 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d71 2b45      	or zzF, zzTmp ; combine flags
001d72 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_76: ; BIT  6 (HL)
001d74 b8e8
001d75 b8f2
001d76 b854
001d77 b83b
001d78 0000
001d79 0000
001d7a b173
001d7b b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001d7c 2f57      	mov zzTmp,FROMRAM0
001d7d 7450      	andi zzTmp,1<<6
001d7e 94b8      	clv
001d7f b75f      	in zzTmp,SREG
001d80 fd51      	sbrc zzTmp,zzZF
001d81 9438      	sev
                 
001d82 b75f      	in zzTmp, SREG
001d83 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d84 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d85 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d86 2b45      	or zzF, zzTmp ; combine flags
001d87 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_77: ; BIT  6 A
001d89 2f51      	mov zzTmp,zzA
001d8a 7450      	andi zzTmp,1<<6
001d8b 94b8      	clv
001d8c b75f      	in zzTmp,SREG
001d8d fd51      	sbrc zzTmp,zzZF
001d8e 9438      	sev
                 
001d8f b75f      	in zzTmp, SREG
001d90 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d91 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d92 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001d93 2b45      	or zzF, zzTmp ; combine flags
001d94 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_78: ; BIT  7 B
001d96 2d5a      	mov zzTmp,zzB
001d97 7850      	andi zzTmp,1<<7
001d98 94b8      	clv
001d99 b75f      	in zzTmp,SREG
001d9a fd51      	sbrc zzTmp,zzZF
001d9b 9438      	sev
                 
001d9c b75f      	in zzTmp, SREG
001d9d 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001d9e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001d9f 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001da0 2b45      	or zzF, zzTmp ; combine flags
001da1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_79: ; BIT  7 C
001da3 2f56      	mov zzTmp,zzC
001da4 7850      	andi zzTmp,1<<7
001da5 94b8      	clv
001da6 b75f      	in zzTmp,SREG
001da7 fd51      	sbrc zzTmp,zzZF
001da8 9438      	sev
                 
001da9 b75f      	in zzTmp, SREG
001daa 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001dab 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001dac 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001dad 2b45      	or zzF, zzTmp ; combine flags
001dae 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_7a: ; BIT  7 D
001db0 2d5c      	mov zzTmp,zzD
001db1 7850      	andi zzTmp,1<<7
001db2 94b8      	clv
001db3 b75f      	in zzTmp,SREG
001db4 fd51      	sbrc zzTmp,zzZF
001db5 9438      	sev
                 
001db6 b75f      	in zzTmp, SREG
001db7 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001db8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001db9 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001dba 2b45      	or zzF, zzTmp ; combine flags
001dbb 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_7b: ; BIT  7 E
001dbd 2d5d      	mov zzTmp,zzE
001dbe 7850      	andi zzTmp,1<<7
001dbf 94b8      	clv
001dc0 b75f      	in zzTmp,SREG
001dc1 fd51      	sbrc zzTmp,zzZF
001dc2 9438      	sev
                 
001dc3 b75f      	in zzTmp, SREG
001dc4 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001dc5 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001dc6 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001dc7 2b45      	or zzF, zzTmp ; combine flags
001dc8 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_7c: ; BIT  7 H
001dca 2d5e      	mov zzTmp,zzH
001dcb 7850      	andi zzTmp,1<<7
001dcc 94b8      	clv
001dcd b75f      	in zzTmp,SREG
001dce fd51      	sbrc zzTmp,zzZF
001dcf 9438      	sev
                 
001dd0 b75f      	in zzTmp, SREG
001dd1 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001dd2 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001dd3 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001dd4 2b45      	or zzF, zzTmp ; combine flags
001dd5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_7d: ; BIT  7 L
001dd7 2d5f      	mov zzTmp,zzL
001dd8 7850      	andi zzTmp,1<<7
001dd9 94b8      	clv
001dda b75f      	in zzTmp,SREG
001ddb fd51      	sbrc zzTmp,zzZF
001ddc 9438      	sev
                 
001ddd b75f      	in zzTmp, SREG
001dde 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001ddf 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001de0 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001de1 2b45      	or zzF, zzTmp ; combine flags
001de2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_7e: ; BIT  7 (HL)
001de4 b8e8
001de5 b8f2
001de6 b854
001de7 b83b
001de8 0000
001de9 0000
001dea b173
001deb b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001dec 2f57      	mov zzTmp,FROMRAM0
001ded 7850      	andi zzTmp,1<<7
001dee 94b8      	clv
001def b75f      	in zzTmp,SREG
001df0 fd51      	sbrc zzTmp,zzZF
001df1 9438      	sev
                 
001df2 b75f      	in zzTmp, SREG
001df3 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001df4 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001df5 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001df6 2b45      	or zzF, zzTmp ; combine flags
001df7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_7f: ; BIT  7 A
001df9 2f51      	mov zzTmp,zzA
001dfa 7850      	andi zzTmp,1<<7
001dfb 94b8      	clv
001dfc b75f      	in zzTmp,SREG
001dfd fd51      	sbrc zzTmp,zzZF
001dfe 9438      	sev
                 
001dff b75f      	in zzTmp, SREG
001e00 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
001e01 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
001e02 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
001e03 2b45      	or zzF, zzTmp ; combine flags
001e04 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_80: ; RES  0 B
001e06 ef5e      	ldi zzTmp,~(1<<0)
001e07 22a5      	and zzB,zzTmp 
                 
001e08 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_81: ; RES  0 C
001e0a ef5e      	ldi zzTmp,~(1<<0)
001e0b 2365      	and zzC,zzTmp 
                 
001e0c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_82: ; RES  0 D
001e0e ef5e      	ldi zzTmp,~(1<<0)
001e0f 22c5      	and zzD,zzTmp 
                 
001e10 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_83: ; RES  0 E
001e12 ef5e      	ldi zzTmp,~(1<<0)
001e13 22d5      	and zzE,zzTmp 
                 
001e14 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_84: ; RES  0 H
001e16 ef5e      	ldi zzTmp,~(1<<0)
001e17 22e5      	and zzH,zzTmp 
                 
001e18 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_85: ; RES  0 L
001e1a ef5e      	ldi zzTmp,~(1<<0)
001e1b 22f5      	and zzL,zzTmp 
                 
001e1c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_86: ; RES  0 (HL)
001e1e b8e8
001e1f b8f2
001e20 b854
001e21 b83b
001e22 0000
001e23 0000
001e24 b173
001e25 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001e26 2f57      	mov zzTmp,FROMRAM0
001e27 7f5e      	cbr zzTmp,1<<0
001e28 2f75      	mov FROMRAM0,zzTmp
001e29 b8e8
001e2a b8f2
001e2b b975
001e2c b824
001e2d 14e6
001e2e 985d
001e2f f100
001e30 b82b
001e31 935f
001e32 e158
001e33 b955
001e34 eb5f
001e35 b954
001e36 e050
001e37 bd5d
001e38 e550
001e39 bd5c
001e3a 9859
001e3b 915f
001e3c 982c
001e3d 937f
001e3e 2d5e
001e3f 940e 005f
001e41 e054
001e42 955a
001e43 f7f1
001e44 2d5f
001e45 940e 005f
001e47 e054
001e48 955a
001e49 f7f1
001e4a 915f
001e4b 940e 005f
001e4d bc5c
001e4e 9a59
001e4f b854
001e50 b82b      	STRAM zzH,zzL,FROMRAM0
                 
001e51 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_87: ; RES  0 A
001e53 ef5e      	ldi zzTmp,~(1<<0)
001e54 2315      	and zzA,zzTmp 
                 
001e55 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_88: ; RES  1 B
001e57 ef5d      	ldi zzTmp,~(1<<1)
001e58 22a5      	and zzB,zzTmp 
                 
001e59 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_89: ; RES  1 C
001e5b ef5d      	ldi zzTmp,~(1<<1)
001e5c 2365      	and zzC,zzTmp 
                 
001e5d 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_8a: ; RES  1 D
001e5f ef5d      	ldi zzTmp,~(1<<1)
001e60 22c5      	and zzD,zzTmp 
                 
001e61 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_8b: ; RES  1 E
001e63 ef5d      	ldi zzTmp,~(1<<1)
001e64 22d5      	and zzE,zzTmp 
                 
001e65 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_8c: ; RES  1 H
001e67 ef5d      	ldi zzTmp,~(1<<1)
001e68 22e5      	and zzH,zzTmp 
                 
001e69 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_8d: ; RES  1 L
001e6b ef5d      	ldi zzTmp,~(1<<1)
001e6c 22f5      	and zzL,zzTmp 
                 
001e6d 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_8e: ; RES  1 (HL)
001e6f b8e8
001e70 b8f2
001e71 b854
001e72 b83b
001e73 0000
001e74 0000
001e75 b173
001e76 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001e77 2f57      	mov zzTmp,FROMRAM0
001e78 7f5d      	cbr zzTmp,1<<1
001e79 2f75      	mov FROMRAM0,zzTmp
001e7a b8e8
001e7b b8f2
001e7c b975
001e7d b824
001e7e 14e6
001e7f 985d
001e80 f100
001e81 b82b
001e82 935f
001e83 e158
001e84 b955
001e85 eb5f
001e86 b954
001e87 e050
001e88 bd5d
001e89 e550
001e8a bd5c
001e8b 9859
001e8c 915f
001e8d 982c
001e8e 937f
001e8f 2d5e
001e90 940e 005f
001e92 e054
001e93 955a
001e94 f7f1
001e95 2d5f
001e96 940e 005f
001e98 e054
001e99 955a
001e9a f7f1
001e9b 915f
001e9c 940e 005f
001e9e bc5c
001e9f 9a59
001ea0 b854
001ea1 b82b      	STRAM zzH,zzL,FROMRAM0
                 
001ea2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_8f: ; RES  1 A
001ea4 ef5d      	ldi zzTmp,~(1<<1)
001ea5 2315      	and zzA,zzTmp 
                 
001ea6 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_90: ; RES  2 B
001ea8 ef5b      	ldi zzTmp,~(1<<2)
001ea9 22a5      	and zzB,zzTmp 
                 
001eaa 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_91: ; RES  2 C
001eac ef5b      	ldi zzTmp,~(1<<2)
001ead 2365      	and zzC,zzTmp 
                 
001eae 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_92: ; RES  2 D
001eb0 ef5b      	ldi zzTmp,~(1<<2)
001eb1 22c5      	and zzD,zzTmp 
                 
001eb2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_93: ; RES  2 E
001eb4 ef5b      	ldi zzTmp,~(1<<2)
001eb5 22d5      	and zzE,zzTmp 
                 
001eb6 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_94: ; RES  2 H
001eb8 ef5b      	ldi zzTmp,~(1<<2)
001eb9 22e5      	and zzH,zzTmp 
                 
001eba 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_95: ; RES  2 L
001ebc ef5b      	ldi zzTmp,~(1<<2)
001ebd 22f5      	and zzL,zzTmp 
                 
001ebe 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_96: ; RES  2 (HL)
001ec0 b8e8
001ec1 b8f2
001ec2 b854
001ec3 b83b
001ec4 0000
001ec5 0000
001ec6 b173
001ec7 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001ec8 2f57      	mov zzTmp,FROMRAM0
001ec9 7f5b      	cbr zzTmp,1<<2
001eca 2f75      	mov FROMRAM0,zzTmp
001ecb b8e8
001ecc b8f2
001ecd b975
001ece b824
001ecf 14e6
001ed0 985d
001ed1 f100
001ed2 b82b
001ed3 935f
001ed4 e158
001ed5 b955
001ed6 eb5f
001ed7 b954
001ed8 e050
001ed9 bd5d
001eda e550
001edb bd5c
001edc 9859
001edd 915f
001ede 982c
001edf 937f
001ee0 2d5e
001ee1 940e 005f
001ee3 e054
001ee4 955a
001ee5 f7f1
001ee6 2d5f
001ee7 940e 005f
001ee9 e054
001eea 955a
001eeb f7f1
001eec 915f
001eed 940e 005f
001eef bc5c
001ef0 9a59
001ef1 b854
001ef2 b82b      	STRAM zzH,zzL,FROMRAM0
                 
001ef3 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_97: ; RES  2 A
001ef5 ef5b      	ldi zzTmp,~(1<<2)
001ef6 2315      	and zzA,zzTmp 
                 
001ef7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_98: ; RES  3 B
001ef9 ef57      	ldi zzTmp,~(1<<3)
001efa 22a5      	and zzB,zzTmp 
                 
001efb 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_99: ; RES  3 C
001efd ef57      	ldi zzTmp,~(1<<3)
001efe 2365      	and zzC,zzTmp 
                 
001eff 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_9a: ; RES  3 D
001f01 ef57      	ldi zzTmp,~(1<<3)
001f02 22c5      	and zzD,zzTmp 
                 
001f03 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_9b: ; RES  3 E
001f05 ef57      	ldi zzTmp,~(1<<3)
001f06 22d5      	and zzE,zzTmp 
                 
001f07 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_9c: ; RES  3 H
001f09 ef57      	ldi zzTmp,~(1<<3)
001f0a 22e5      	and zzH,zzTmp 
                 
001f0b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_9d: ; RES  3 L
001f0d ef57      	ldi zzTmp,~(1<<3)
001f0e 22f5      	and zzL,zzTmp 
                 
001f0f 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_9e: ; RES  3 (HL)
001f11 b8e8
001f12 b8f2
001f13 b854
001f14 b83b
001f15 0000
001f16 0000
001f17 b173
001f18 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001f19 2f57      	mov zzTmp,FROMRAM0
001f1a 7f57      	cbr zzTmp,1<<3
001f1b 2f75      	mov FROMRAM0,zzTmp
001f1c b8e8
001f1d b8f2
001f1e b975
001f1f b824
001f20 14e6
001f21 985d
001f22 f100
001f23 b82b
001f24 935f
001f25 e158
001f26 b955
001f27 eb5f
001f28 b954
001f29 e050
001f2a bd5d
001f2b e550
001f2c bd5c
001f2d 9859
001f2e 915f
001f2f 982c
001f30 937f
001f31 2d5e
001f32 940e 005f
001f34 e054
001f35 955a
001f36 f7f1
001f37 2d5f
001f38 940e 005f
001f3a e054
001f3b 955a
001f3c f7f1
001f3d 915f
001f3e 940e 005f
001f40 bc5c
001f41 9a59
001f42 b854
001f43 b82b      	STRAM zzH,zzL,FROMRAM0
                 
001f44 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_9f: ; RES  3 A
001f46 ef57      	ldi zzTmp,~(1<<3)
001f47 2315      	and zzA,zzTmp 
                 
001f48 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a0: ; RES  4 B
001f4a ee5f      	ldi zzTmp,~(1<<4)
001f4b 22a5      	and zzB,zzTmp 
                 
001f4c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a1: ; RES  4 C
001f4e ee5f      	ldi zzTmp,~(1<<4)
001f4f 2365      	and zzC,zzTmp 
                 
001f50 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a2: ; RES  4 D
001f52 ee5f      	ldi zzTmp,~(1<<4)
001f53 22c5      	and zzD,zzTmp 
                 
001f54 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a3: ; RES  4 E
001f56 ee5f      	ldi zzTmp,~(1<<4)
001f57 22d5      	and zzE,zzTmp 
                 
001f58 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a4: ; RES  4 H
001f5a ee5f      	ldi zzTmp,~(1<<4)
001f5b 22e5      	and zzH,zzTmp 
                 
001f5c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a5: ; RES  4 L
001f5e ee5f      	ldi zzTmp,~(1<<4)
001f5f 22f5      	and zzL,zzTmp 
                 
001f60 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a6: ; RES  4 (HL)
001f62 b8e8
001f63 b8f2
001f64 b854
001f65 b83b
001f66 0000
001f67 0000
001f68 b173
001f69 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001f6a 2f57      	mov zzTmp,FROMRAM0
001f6b 7e5f      	cbr zzTmp,1<<4
001f6c 2f75      	mov FROMRAM0,zzTmp
001f6d b8e8
001f6e b8f2
001f6f b975
001f70 b824
001f71 14e6
001f72 985d
001f73 f100
001f74 b82b
001f75 935f
001f76 e158
001f77 b955
001f78 eb5f
001f79 b954
001f7a e050
001f7b bd5d
001f7c e550
001f7d bd5c
001f7e 9859
001f7f 915f
001f80 982c
001f81 937f
001f82 2d5e
001f83 940e 005f
001f85 e054
001f86 955a
001f87 f7f1
001f88 2d5f
001f89 940e 005f
001f8b e054
001f8c 955a
001f8d f7f1
001f8e 915f
001f8f 940e 005f
001f91 bc5c
001f92 9a59
001f93 b854
001f94 b82b      	STRAM zzH,zzL,FROMRAM0
                 
001f95 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a7: ; RES  4 A
001f97 ee5f      	ldi zzTmp,~(1<<4)
001f98 2315      	and zzA,zzTmp 
                 
001f99 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a8: ; RES  5 B
001f9b ed5f      	ldi zzTmp,~(1<<5)
001f9c 22a5      	and zzB,zzTmp 
                 
001f9d 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_a9: ; RES  5 C
001f9f ed5f      	ldi zzTmp,~(1<<5)
001fa0 2365      	and zzC,zzTmp 
                 
001fa1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_aa: ; RES  5 D
001fa3 ed5f      	ldi zzTmp,~(1<<5)
001fa4 22c5      	and zzD,zzTmp 
                 
001fa5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ab: ; RES  5 E
001fa7 ed5f      	ldi zzTmp,~(1<<5)
001fa8 22d5      	and zzE,zzTmp 
                 
001fa9 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ac: ; RES  5 H
001fab ed5f      	ldi zzTmp,~(1<<5)
001fac 22e5      	and zzH,zzTmp 
                 
001fad 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ad: ; RES  5 L
001faf ed5f      	ldi zzTmp,~(1<<5)
001fb0 22f5      	and zzL,zzTmp 
                 
001fb1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ae: ; RES  5 (HL)
001fb3 b8e8
001fb4 b8f2
001fb5 b854
001fb6 b83b
001fb7 0000
001fb8 0000
001fb9 b173
001fba b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
001fbb 2f57      	mov zzTmp,FROMRAM0
001fbc 7d5f      	cbr zzTmp,1<<5
001fbd 2f75      	mov FROMRAM0,zzTmp
001fbe b8e8
001fbf b8f2
001fc0 b975
001fc1 b824
001fc2 14e6
001fc3 985d
001fc4 f100
001fc5 b82b
001fc6 935f
001fc7 e158
001fc8 b955
001fc9 eb5f
001fca b954
001fcb e050
001fcc bd5d
001fcd e550
001fce bd5c
001fcf 9859
001fd0 915f
001fd1 982c
001fd2 937f
001fd3 2d5e
001fd4 940e 005f
001fd6 e054
001fd7 955a
001fd8 f7f1
001fd9 2d5f
001fda 940e 005f
001fdc e054
001fdd 955a
001fde f7f1
001fdf 915f
001fe0 940e 005f
001fe2 bc5c
001fe3 9a59
001fe4 b854
001fe5 b82b      	STRAM zzH,zzL,FROMRAM0
                 
001fe6 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_af: ; RES  5 A
001fe8 ed5f      	ldi zzTmp,~(1<<5)
001fe9 2315      	and zzA,zzTmp 
                 
001fea 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b0: ; RES  6 B
001fec eb5f      	ldi zzTmp,~(1<<6)
001fed 22a5      	and zzB,zzTmp 
                 
001fee 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b1: ; RES  6 C
001ff0 eb5f      	ldi zzTmp,~(1<<6)
001ff1 2365      	and zzC,zzTmp 
                 
001ff2 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b2: ; RES  6 D
001ff4 eb5f      	ldi zzTmp,~(1<<6)
001ff5 22c5      	and zzD,zzTmp 
                 
001ff6 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b3: ; RES  6 E
001ff8 eb5f      	ldi zzTmp,~(1<<6)
001ff9 22d5      	and zzE,zzTmp 
                 
001ffa 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b4: ; RES  6 H
001ffc eb5f      	ldi zzTmp,~(1<<6)
001ffd 22e5      	and zzH,zzTmp 
                 
001ffe 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b5: ; RES  6 L
002000 eb5f      	ldi zzTmp,~(1<<6)
002001 22f5      	and zzL,zzTmp 
                 
002002 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b6: ; RES  6 (HL)
002004 b8e8
002005 b8f2
002006 b854
002007 b83b
002008 0000
002009 0000
00200a b173
00200b b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00200c 2f57      	mov zzTmp,FROMRAM0
00200d 7b5f      	cbr zzTmp,1<<6
00200e 2f75      	mov FROMRAM0,zzTmp
00200f b8e8
002010 b8f2
002011 b975
002012 b824
002013 14e6
002014 985d
002015 f100
002016 b82b
002017 935f
002018 e158
002019 b955
00201a eb5f
00201b b954
00201c e050
00201d bd5d
00201e e550
00201f bd5c
002020 9859
002021 915f
002022 982c
002023 937f
002024 2d5e
002025 940e 005f
002027 e054
002028 955a
002029 f7f1
00202a 2d5f
00202b 940e 005f
00202d e054
00202e 955a
00202f f7f1
002030 915f
002031 940e 005f
002033 bc5c
002034 9a59
002035 b854
002036 b82b      	STRAM zzH,zzL,FROMRAM0
                 
002037 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b7: ; RES  6 A
002039 eb5f      	ldi zzTmp,~(1<<6)
00203a 2315      	and zzA,zzTmp 
                 
00203b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b8: ; RES  7 B
00203d e75f      	ldi zzTmp,~(1<<7)
00203e 22a5      	and zzB,zzTmp 
                 
00203f 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_b9: ; RES  7 C
002041 e75f      	ldi zzTmp,~(1<<7)
002042 2365      	and zzC,zzTmp 
                 
002043 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ba: ; RES  7 D
002045 e75f      	ldi zzTmp,~(1<<7)
002046 22c5      	and zzD,zzTmp 
                 
002047 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_bb: ; RES  7 E
002049 e75f      	ldi zzTmp,~(1<<7)
00204a 22d5      	and zzE,zzTmp 
                 
00204b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_bc: ; RES  7 H
00204d e75f      	ldi zzTmp,~(1<<7)
00204e 22e5      	and zzH,zzTmp 
                 
00204f 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_bd: ; RES  7 L
002051 e75f      	ldi zzTmp,~(1<<7)
002052 22f5      	and zzL,zzTmp 
                 
002053 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_be: ; RES  7 (HL)
002055 b8e8
002056 b8f2
002057 b854
002058 b83b
002059 0000
00205a 0000
00205b b173
00205c b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00205d 2f57      	mov zzTmp,FROMRAM0
00205e 775f      	cbr zzTmp,1<<7
00205f 2f75      	mov FROMRAM0,zzTmp
002060 b8e8
002061 b8f2
002062 b975
002063 b824
002064 14e6
002065 985d
002066 f100
002067 b82b
002068 935f
002069 e158
00206a b955
00206b eb5f
00206c b954
00206d e050
00206e bd5d
00206f e550
002070 bd5c
002071 9859
002072 915f
002073 982c
002074 937f
002075 2d5e
002076 940e 005f
002078 e054
002079 955a
00207a f7f1
00207b 2d5f
00207c 940e 005f
00207e e054
00207f 955a
002080 f7f1
002081 915f
002082 940e 005f
002084 bc5c
002085 9a59
002086 b854
002087 b82b      	STRAM zzH,zzL,FROMRAM0
                 
002088 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_bf: ; RES  7 A
00208a e75f      	ldi zzTmp,~(1<<7)
00208b 2315      	and zzA,zzTmp 
                 
00208c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c0: ; SET  0 B
00208e e051      	ldi zzTmp,1<<0
00208f 2aa5      	or zzB,zzTmp
                 
002090 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c1: ; SET  0 C
002092 e051      	ldi zzTmp,1<<0
002093 2b65      	or zzC,zzTmp
                 
002094 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c2: ; SET  0 D
002096 e051      	ldi zzTmp,1<<0
002097 2ac5      	or zzD,zzTmp
                 
002098 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c3: ; SET  0 E
00209a e051      	ldi zzTmp,1<<0
00209b 2ad5      	or zzE,zzTmp
                 
00209c 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c4: ; SET  0 H
00209e e051      	ldi zzTmp,1<<0
00209f 2ae5      	or zzH,zzTmp
                 
0020a0 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c5: ; SET  0 L
0020a2 e051      	ldi zzTmp,1<<0
0020a3 2af5      	or zzL,zzTmp
                 
0020a4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c6: ; SET  0 (HL)
0020a6 b8e8
0020a7 b8f2
0020a8 b854
0020a9 b83b
0020aa 0000
0020ab 0000
0020ac b173
0020ad b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0020ae 2f57      	mov zzTmp,FROMRAM0
0020af 6051      	sbr zzTmp,1<<0
0020b0 2f75      	mov FROMRAM0,zzTmp
0020b1 b8e8
0020b2 b8f2
0020b3 b975
0020b4 b824
0020b5 14e6
0020b6 985d
0020b7 f100
0020b8 b82b
0020b9 935f
0020ba e158
0020bb b955
0020bc eb5f
0020bd b954
0020be e050
0020bf bd5d
0020c0 e550
0020c1 bd5c
0020c2 9859
0020c3 915f
0020c4 982c
0020c5 937f
0020c6 2d5e
0020c7 940e 005f
0020c9 e054
0020ca 955a
0020cb f7f1
0020cc 2d5f
0020cd 940e 005f
0020cf e054
0020d0 955a
0020d1 f7f1
0020d2 915f
0020d3 940e 005f
0020d5 bc5c
0020d6 9a59
0020d7 b854
0020d8 b82b      	STRAM zzH,zzL,FROMRAM0
                 
0020d9 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c7: ; SET  0 A
0020db e051      	ldi zzTmp,1<<0
0020dc 2b15      	or zzA,zzTmp
                 
0020dd 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c8: ; SET  1 B
0020df e052      	ldi zzTmp,1<<1
0020e0 2aa5      	or zzB,zzTmp
                 
0020e1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_c9: ; SET  1 C
0020e3 e052      	ldi zzTmp,1<<1
0020e4 2b65      	or zzC,zzTmp
                 
0020e5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ca: ; SET  1 D
0020e7 e052      	ldi zzTmp,1<<1
0020e8 2ac5      	or zzD,zzTmp
                 
0020e9 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_cb: ; SET  1 E
0020eb e052      	ldi zzTmp,1<<1
0020ec 2ad5      	or zzE,zzTmp
                 
0020ed 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_cc: ; SET  1 H
0020ef e052      	ldi zzTmp,1<<1
0020f0 2ae5      	or zzH,zzTmp
                 
0020f1 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_cd: ; SET  1 L
0020f3 e052      	ldi zzTmp,1<<1
0020f4 2af5      	or zzL,zzTmp
                 
0020f5 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ce: ; SET  1 (HL)
0020f7 b8e8
0020f8 b8f2
0020f9 b854
0020fa b83b
0020fb 0000
0020fc 0000
0020fd b173
0020fe b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0020ff 2f57      	mov zzTmp,FROMRAM0
002100 6052      	sbr zzTmp,1<<1
002101 2f75      	mov FROMRAM0,zzTmp
002102 b8e8
002103 b8f2
002104 b975
002105 b824
002106 14e6
002107 985d
002108 f100
002109 b82b
00210a 935f
00210b e158
00210c b955
00210d eb5f
00210e b954
00210f e050
002110 bd5d
002111 e550
002112 bd5c
002113 9859
002114 915f
002115 982c
002116 937f
002117 2d5e
002118 940e 005f
00211a e054
00211b 955a
00211c f7f1
00211d 2d5f
00211e 940e 005f
002120 e054
002121 955a
002122 f7f1
002123 915f
002124 940e 005f
002126 bc5c
002127 9a59
002128 b854
002129 b82b      	STRAM zzH,zzL,FROMRAM0
                 
00212a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_cf: ; SET  1 A
00212c e052      	ldi zzTmp,1<<1
00212d 2b15      	or zzA,zzTmp
                 
00212e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d0: ; SET  2 B
002130 e054      	ldi zzTmp,1<<2
002131 2aa5      	or zzB,zzTmp
                 
002132 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d1: ; SET  2 C
002134 e054      	ldi zzTmp,1<<2
002135 2b65      	or zzC,zzTmp
                 
002136 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d2: ; SET  2 D
002138 e054      	ldi zzTmp,1<<2
002139 2ac5      	or zzD,zzTmp
                 
00213a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d3: ; SET  2 E
00213c e054      	ldi zzTmp,1<<2
00213d 2ad5      	or zzE,zzTmp
                 
00213e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d4: ; SET  2 H
002140 e054      	ldi zzTmp,1<<2
002141 2ae5      	or zzH,zzTmp
                 
002142 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d5: ; SET  2 L
002144 e054      	ldi zzTmp,1<<2
002145 2af5      	or zzL,zzTmp
                 
002146 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d6: ; SET  2 (HL)
002148 b8e8
002149 b8f2
00214a b854
00214b b83b
00214c 0000
00214d 0000
00214e b173
00214f b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
002150 2f57      	mov zzTmp,FROMRAM0
002151 6054      	sbr zzTmp,1<<2
002152 2f75      	mov FROMRAM0,zzTmp
002153 b8e8
002154 b8f2
002155 b975
002156 b824
002157 14e6
002158 985d
002159 f100
00215a b82b
00215b 935f
00215c e158
00215d b955
00215e eb5f
00215f b954
002160 e050
002161 bd5d
002162 e550
002163 bd5c
002164 9859
002165 915f
002166 982c
002167 937f
002168 2d5e
002169 940e 005f
00216b e054
00216c 955a
00216d f7f1
00216e 2d5f
00216f 940e 005f
002171 e054
002172 955a
002173 f7f1
002174 915f
002175 940e 005f
002177 bc5c
002178 9a59
002179 b854
00217a b82b      	STRAM zzH,zzL,FROMRAM0
                 
00217b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d7: ; SET  2 A
00217d e054      	ldi zzTmp,1<<2
00217e 2b15      	or zzA,zzTmp
                 
00217f 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d8: ; SET  3 B
002181 e058      	ldi zzTmp,1<<3
002182 2aa5      	or zzB,zzTmp
                 
002183 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_d9: ; SET  3 C
002185 e058      	ldi zzTmp,1<<3
002186 2b65      	or zzC,zzTmp
                 
002187 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_da: ; SET  3 D
002189 e058      	ldi zzTmp,1<<3
00218a 2ac5      	or zzD,zzTmp
                 
00218b 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_db: ; SET  3 E
00218d e058      	ldi zzTmp,1<<3
00218e 2ad5      	or zzE,zzTmp
                 
00218f 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_dc: ; SET  3 H
002191 e058      	ldi zzTmp,1<<3
002192 2ae5      	or zzH,zzTmp
                 
002193 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_dd: ; SET  3 L
002195 e058      	ldi zzTmp,1<<3
002196 2af5      	or zzL,zzTmp
                 
002197 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_de: ; SET  3 (HL)
002199 b8e8
00219a b8f2
00219b b854
00219c b83b
00219d 0000
00219e 0000
00219f b173
0021a0 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0021a1 2f57      	mov zzTmp,FROMRAM0
0021a2 6058      	sbr zzTmp,1<<3
0021a3 2f75      	mov FROMRAM0,zzTmp
0021a4 b8e8
0021a5 b8f2
0021a6 b975
0021a7 b824
0021a8 14e6
0021a9 985d
0021aa f100
0021ab b82b
0021ac 935f
0021ad e158
0021ae b955
0021af eb5f
0021b0 b954
0021b1 e050
0021b2 bd5d
0021b3 e550
0021b4 bd5c
0021b5 9859
0021b6 915f
0021b7 982c
0021b8 937f
0021b9 2d5e
0021ba 940e 005f
0021bc e054
0021bd 955a
0021be f7f1
0021bf 2d5f
0021c0 940e 005f
0021c2 e054
0021c3 955a
0021c4 f7f1
0021c5 915f
0021c6 940e 005f
0021c8 bc5c
0021c9 9a59
0021ca b854
0021cb b82b      	STRAM zzH,zzL,FROMRAM0
                 
0021cc 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_df: ; SET  3 A
0021ce e058      	ldi zzTmp,1<<3
0021cf 2b15      	or zzA,zzTmp
                 
0021d0 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e0: ; SET  4 B
0021d2 e150      	ldi zzTmp,1<<4
0021d3 2aa5      	or zzB,zzTmp
                 
0021d4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e1: ; SET  4 C
0021d6 e150      	ldi zzTmp,1<<4
0021d7 2b65      	or zzC,zzTmp
                 
0021d8 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e2: ; SET  4 D
0021da e150      	ldi zzTmp,1<<4
0021db 2ac5      	or zzD,zzTmp
                 
0021dc 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e3: ; SET  4 E
0021de e150      	ldi zzTmp,1<<4
0021df 2ad5      	or zzE,zzTmp
                 
0021e0 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e4: ; SET  4 H
0021e2 e150      	ldi zzTmp,1<<4
0021e3 2ae5      	or zzH,zzTmp
                 
0021e4 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e5: ; SET  4 L
0021e6 e150      	ldi zzTmp,1<<4
0021e7 2af5      	or zzL,zzTmp
                 
0021e8 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e6: ; SET  4 (HL)
0021ea b8e8
0021eb b8f2
0021ec b854
0021ed b83b
0021ee 0000
0021ef 0000
0021f0 b173
0021f1 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0021f2 2f57      	mov zzTmp,FROMRAM0
0021f3 6150      	sbr zzTmp,1<<4
0021f4 2f75      	mov FROMRAM0,zzTmp
0021f5 b8e8
0021f6 b8f2
0021f7 b975
0021f8 b824
0021f9 14e6
0021fa 985d
0021fb f100
0021fc b82b
0021fd 935f
0021fe e158
0021ff b955
002200 eb5f
002201 b954
002202 e050
002203 bd5d
002204 e550
002205 bd5c
002206 9859
002207 915f
002208 982c
002209 937f
00220a 2d5e
00220b 940e 005f
00220d e054
00220e 955a
00220f f7f1
002210 2d5f
002211 940e 005f
002213 e054
002214 955a
002215 f7f1
002216 915f
002217 940e 005f
002219 bc5c
00221a 9a59
00221b b854
00221c b82b      	STRAM zzH,zzL,FROMRAM0
                 
00221d 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e7: ; SET  4 A
00221f e150      	ldi zzTmp,1<<4
002220 2b15      	or zzA,zzTmp
                 
002221 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e8: ; SET  5 B
002223 e250      	ldi zzTmp,1<<5
002224 2aa5      	or zzB,zzTmp
                 
002225 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_e9: ; SET  5 C
002227 e250      	ldi zzTmp,1<<5
002228 2b65      	or zzC,zzTmp
                 
002229 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ea: ; SET  5 D
00222b e250      	ldi zzTmp,1<<5
00222c 2ac5      	or zzD,zzTmp
                 
00222d 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_eb: ; SET  5 E
00222f e250      	ldi zzTmp,1<<5
002230 2ad5      	or zzE,zzTmp
                 
002231 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ec: ; SET  5 H
002233 e250      	ldi zzTmp,1<<5
002234 2ae5      	or zzH,zzTmp
                 
002235 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ed: ; SET  5 L
002237 e250      	ldi zzTmp,1<<5
002238 2af5      	or zzL,zzTmp
                 
002239 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ee: ; SET  5 (HL)
00223b b8e8
00223c b8f2
00223d b854
00223e b83b
00223f 0000
002240 0000
002241 b173
002242 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
002243 2f57      	mov zzTmp,FROMRAM0
002244 6250      	sbr zzTmp,1<<5
002245 2f75      	mov FROMRAM0,zzTmp
002246 b8e8
002247 b8f2
002248 b975
002249 b824
00224a 14e6
00224b 985d
00224c f100
00224d b82b
00224e 935f
00224f e158
002250 b955
002251 eb5f
002252 b954
002253 e050
002254 bd5d
002255 e550
002256 bd5c
002257 9859
002258 915f
002259 982c
00225a 937f
00225b 2d5e
00225c 940e 005f
00225e e054
00225f 955a
002260 f7f1
002261 2d5f
002262 940e 005f
002264 e054
002265 955a
002266 f7f1
002267 915f
002268 940e 005f
00226a bc5c
00226b 9a59
00226c b854
00226d b82b      	STRAM zzH,zzL,FROMRAM0
                 
00226e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ef: ; SET  5 A
002270 e250      	ldi zzTmp,1<<5
002271 2b15      	or zzA,zzTmp
                 
002272 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f0: ; SET  6 B
002274 e450      	ldi zzTmp,1<<6
002275 2aa5      	or zzB,zzTmp
                 
002276 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f1: ; SET  6 C
002278 e450      	ldi zzTmp,1<<6
002279 2b65      	or zzC,zzTmp
                 
00227a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f2: ; SET  6 D
00227c e450      	ldi zzTmp,1<<6
00227d 2ac5      	or zzD,zzTmp
                 
00227e 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f3: ; SET  6 E
002280 e450      	ldi zzTmp,1<<6
002281 2ad5      	or zzE,zzTmp
                 
002282 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f4: ; SET  6 H
002284 e450      	ldi zzTmp,1<<6
002285 2ae5      	or zzH,zzTmp
                 
002286 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f5: ; SET  6 L
002288 e450      	ldi zzTmp,1<<6
002289 2af5      	or zzL,zzTmp
                 
00228a 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f6: ; SET  6 (HL)
00228c b8e8
00228d b8f2
00228e b854
00228f b83b
002290 0000
002291 0000
002292 b173
002293 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
002294 2f57      	mov zzTmp,FROMRAM0
002295 6450      	sbr zzTmp,1<<6
002296 2f75      	mov FROMRAM0,zzTmp
002297 b8e8
002298 b8f2
002299 b975
00229a b824
00229b 14e6
00229c 985d
00229d f100
00229e b82b
00229f 935f
0022a0 e158
0022a1 b955
0022a2 eb5f
0022a3 b954
0022a4 e050
0022a5 bd5d
0022a6 e550
0022a7 bd5c
0022a8 9859
0022a9 915f
0022aa 982c
0022ab 937f
0022ac 2d5e
0022ad 940e 005f
0022af e054
0022b0 955a
0022b1 f7f1
0022b2 2d5f
0022b3 940e 005f
0022b5 e054
0022b6 955a
0022b7 f7f1
0022b8 915f
0022b9 940e 005f
0022bb bc5c
0022bc 9a59
0022bd b854
0022be b82b      	STRAM zzH,zzL,FROMRAM0
                 
0022bf 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f7: ; SET  6 A
0022c1 e450      	ldi zzTmp,1<<6
0022c2 2b15      	or zzA,zzTmp
                 
0022c3 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f8: ; SET  7 B
0022c5 e850      	ldi zzTmp,1<<7
0022c6 2aa5      	or zzB,zzTmp
                 
0022c7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_f9: ; SET  7 C
0022c9 e850      	ldi zzTmp,1<<7
0022ca 2b65      	or zzC,zzTmp
                 
0022cb 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_fa: ; SET  7 D
0022cd e850      	ldi zzTmp,1<<7
0022ce 2ac5      	or zzD,zzTmp
                 
0022cf 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_fb: ; SET  7 E
0022d1 e850      	ldi zzTmp,1<<7
0022d2 2ad5      	or zzE,zzTmp
                 
0022d3 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_fc: ; SET  7 H
0022d5 e850      	ldi zzTmp,1<<7
0022d6 2ae5      	or zzH,zzTmp
                 
0022d7 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_fd: ; SET  7 L
0022d9 e850      	ldi zzTmp,1<<7
0022da 2af5      	or zzL,zzTmp
                 
0022db 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_fe: ; SET  7 (HL)
0022dd b8e8
0022de b8f2
0022df b854
0022e0 b83b
0022e1 0000
0022e2 0000
0022e3 b173
0022e4 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
0022e5 2f57      	mov zzTmp,FROMRAM0
0022e6 6850      	sbr zzTmp,1<<7
0022e7 2f75      	mov FROMRAM0,zzTmp
0022e8 b8e8
0022e9 b8f2
0022ea b975
0022eb b824
0022ec 14e6
0022ed 985d
0022ee f100
0022ef b82b
0022f0 935f
0022f1 e158
0022f2 b955
0022f3 eb5f
0022f4 b954
0022f5 e050
0022f6 bd5d
0022f7 e550
0022f8 bd5c
0022f9 9859
0022fa 915f
0022fb 982c
0022fc 937f
0022fd 2d5e
0022fe 940e 005f
002300 e054
002301 955a
002302 f7f1
002303 2d5f
002304 940e 005f
002306 e054
002307 955a
002308 f7f1
002309 915f
00230a 940e 005f
00230c bc5c
00230d 9a59
00230e b854
00230f b82b      	STRAM zzH,zzL,FROMRAM0
                 
002310 940c 0200 	jmp zCMD_start
                 
                 zCMDCB_ff: ; SET  7 A
002312 e850      	ldi zzTmp,1<<7
002313 2b15      	or zzA,zzTmp
                 
002314 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_00: ; NOP   
                 	
                 
002316 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_01: ; LD   BC nn
002318 b998
002319 b982
00231a b854
00231b b83b
00231c 9601
00231d b123
00231e b82b      	LDRAM_PC_NODDR FROMRAM2
00231f b998
002320 b982
002321 b854
002322 b83b
002323 9601
002324 b013
002325 b82b      	LDRAM_PC_NODDR FROMRAM1
002326 2ca1      	mov zzB, FROMRAM1
002327 2f62      	mov zzC, FROMRAM2
                 
002328 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_02: ; LD   (BC) A
00232a 2f71      	mov FROMRAM0,zzA
                 
00232b b8a8
00232c b962
00232d b915
00232e b824
00232f 14a6
002330 985d
002331 f100
002332 b82b
002333 935f
002334 e158
002335 b955
002336 eb5f
002337 b954
002338 e050
002339 bd5d
00233a e550
00233b bd5c
00233c 9859
00233d 915f
00233e 982c
00233f 931f
002340 2d5a
002341 940e 005f
002343 e054
002344 955a
002345 f7f1
002346 2f56
002347 940e 005f
002349 e054
00234a 955a
00234b f7f1
00234c 915f
00234d 940e 005f
00234f bc5c
002350 9a59
002351 b854
002352 b82b      	STRAM zzB,zzC,zzA
002353 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_03: ; INC   BC
002355 0d69
002356 1ca5      	INC2 zzB,zzC
                 
002357 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_04: ; INC   B
002359 0ca9      	add zzB,ONE
                 
00235a b75f      	in zzTmp, SREG
00235b 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00235c 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00235d 2b45      	or zzF, zzTmp ; combine flags
00235e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_05: ; DEC   B
002360 18a9      	sub zzB,ONE
                 
002361 b75f      	in zzTmp, SREG
002362 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
002363 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002364 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
002365 2b45      	or zzF, zzTmp ; combine flags
002366 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_06: ; LD   B n
002368 b998
002369 b982
00236a b854
00236b b83b
00236c 9601
00236d b173
00236e b82b      	LDRAM_PC_NODDR FROMRAM0
00236f 2ea7      	mov zzB,FROMRAM0
                 
002370 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_07: ; RLCA  
002372 fb17      	bst zzA,7
002373 1f11      	rol zzA
002374 f910      	bld zzA,0
                 
002375 b75f      	in zzTmp, SREG
002376 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
002377 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
002378 2b45      	or zzF, zzTmp ; combine flags
002379 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_08: ; EX   AF AFe
00237b 9150 0901
00237d 9310 0901
00237f 2f15      	EX zzA,zzAe
002380 9150 0902
002382 9340 0902
002384 2f45      	EX zzF,zzFe
                 
002385 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_09: ; ADD  IX BC
002387 0f06      	add zzIXl,zzC
002388 1c8a      	adc zzIXh,zzB
                 
002389 b75f      	in zzTmp, SREG
00238a 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
00238b 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
00238c 2b45      	or zzF, zzTmp ; combine flags
00238d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_0a: ; LD   A (BC)
00238f b8a8
002390 b962
002391 b854
002392 b83b
002393 0000
002394 0000
002395 b173
002396 b82b      	LDRAM_NODDR zzB,zzC,FROMRAM0
002397 2f17      	mov zzA,FROMRAM0
                 
002398 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_0b: ; DEC   BC
00239a 1969
00239b 08a5      	DEC2 zzB,zzC
                 
00239c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_0c: ; INC   C
00239e 0d69      	add zzC,ONE
                 
00239f b75f      	in zzTmp, SREG
0023a0 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0023a1 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0023a2 2b45      	or zzF, zzTmp ; combine flags
0023a3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_0d: ; DEC   C
0023a5 1969      	sub zzC,ONE
                 
0023a6 b75f      	in zzTmp, SREG
0023a7 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0023a8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0023a9 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
0023aa 2b45      	or zzF, zzTmp ; combine flags
0023ab 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_0e: ; LD   C n
0023ad b998
0023ae b982
0023af b854
0023b0 b83b
0023b1 9601
0023b2 b173
0023b3 b82b      	LDRAM_PC_NODDR FROMRAM0
0023b4 2f67      	mov zzC,FROMRAM0
                 
0023b5 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_0f: ; RRCA  
0023b7 fb10      	bst zzA,0
0023b8 9517      	ror zzA
0023b9 f917      	bld zzA,7
                 
0023ba b75f      	in zzTmp, SREG
0023bb 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
0023bc 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0023bd 2b45      	or zzF, zzTmp ; combine flags
0023be 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_10: ; DJNZ  s
0023c0 b998
0023c1 b982
0023c2 b854
0023c3 b83b
0023c4 9601
0023c5 b173
0023c6 b82b      	LDRAM_PC_NODDR FROMRAM0
0023c7 94aa      	dec zzB
0023c8 f029      	breq zCMDDD_10_1
0023c9 2755
0023ca fd77
0023cb 9550
0023cc 0f87
0023cd 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 	zCMDDD_10_1:
                 
0023ce 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_11: ; LD   DE nn
0023d0 b998
0023d1 b982
0023d2 b854
0023d3 b83b
0023d4 9601
0023d5 b123
0023d6 b82b      	LDRAM_PC_NODDR FROMRAM2
0023d7 b998
0023d8 b982
0023d9 b854
0023da b83b
0023db 9601
0023dc b013
0023dd b82b      	LDRAM_PC_NODDR FROMRAM1
0023de 2cc1      	mov zzD, FROMRAM1
0023df 2ed2      	mov zzE, FROMRAM2
                 
0023e0 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_12: ; LD   (DE) A
0023e2 2f71      	mov FROMRAM0,zzA
                 
0023e3 b8c8
0023e4 b8d2
0023e5 b915
0023e6 b824
0023e7 14c6
0023e8 985d
0023e9 f100
0023ea b82b
0023eb 935f
0023ec e158
0023ed b955
0023ee eb5f
0023ef b954
0023f0 e050
0023f1 bd5d
0023f2 e550
0023f3 bd5c
0023f4 9859
0023f5 915f
0023f6 982c
0023f7 931f
0023f8 2d5c
0023f9 940e 005f
0023fb e054
0023fc 955a
0023fd f7f1
0023fe 2d5d
0023ff 940e 005f
002401 e054
002402 955a
002403 f7f1
002404 915f
002405 940e 005f
002407 bc5c
002408 9a59
002409 b854
00240a b82b      	STRAM zzD,zzE,zzA
00240b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_13: ; INC   DE
00240d 0cd9
00240e 1cc5      	INC2 zzD,zzE
                 
00240f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_14: ; INC   D
002411 0cc9      	add zzD,ONE
                 
002412 b75f      	in zzTmp, SREG
002413 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
002414 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002415 2b45      	or zzF, zzTmp ; combine flags
002416 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_15: ; DEC   D
002418 18c9      	sub zzD,ONE
                 
002419 b75f      	in zzTmp, SREG
00241a 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00241b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00241c 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
00241d 2b45      	or zzF, zzTmp ; combine flags
00241e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_16: ; LD   D n
002420 b998
002421 b982
002422 b854
002423 b83b
002424 9601
002425 b173
002426 b82b      	LDRAM_PC_NODDR FROMRAM0
002427 2ec7      	mov zzD,FROMRAM0
                 
002428 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_17: ; RLA   
00242a bf4f      	out SREG,zzF
00242b 1f11      	rol zzA
                 
00242c b75f      	in zzTmp, SREG
00242d 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
00242e 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
00242f 2b45      	or zzF, zzTmp ; combine flags
002430 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_18: ; JR   * s
002432 b998
002433 b982
002434 b854
002435 b83b
002436 9601
002437 b173
002438 b82b      	LDRAM_PC_NODDR FROMRAM0
002439 1055      	cpse ZERO,ZERO
00243a 940c 0200 	jmp zCMD_start
00243c 2755
00243d fd77
00243e 9550
00243f 0f87
002440 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
002441 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_19: ; ADD  IX DE
002443 0d0d      	add zzIXl,zzE
002444 1c8c      	adc zzIXh,zzD
                 
002445 b75f      	in zzTmp, SREG
002446 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
002447 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
002448 2b45      	or zzF, zzTmp ; combine flags
002449 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_1a: ; LD   A (DE)
00244b b8c8
00244c b8d2
00244d b854
00244e b83b
00244f 0000
002450 0000
002451 b173
002452 b82b      	LDRAM_NODDR zzD,zzE,FROMRAM0
002453 2f17      	mov zzA,FROMRAM0
                 
002454 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_1b: ; DEC   DE
002456 18d9
002457 08c5      	DEC2 zzD,zzE
                 
002458 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_1c: ; INC   E
00245a 0cd9      	add zzE,ONE
                 
00245b b75f      	in zzTmp, SREG
00245c 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00245d 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00245e 2b45      	or zzF, zzTmp ; combine flags
00245f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_1d: ; DEC   E
002461 18d9      	sub zzE,ONE
                 
002462 b75f      	in zzTmp, SREG
002463 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
002464 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002465 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
002466 2b45      	or zzF, zzTmp ; combine flags
002467 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_1e: ; LD   E n
002469 b998
00246a b982
00246b b854
00246c b83b
00246d 9601
00246e b173
00246f b82b      	LDRAM_PC_NODDR FROMRAM0
002470 2ed7      	mov zzE,FROMRAM0
                 
002471 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_1f: ; RRA   
002473 bf4f      	out SREG,zzF
002474 9517      	ror zzA
                 
002475 b75f      	in zzTmp, SREG
002476 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
002477 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
002478 2b45      	or zzF, zzTmp ; combine flags
002479 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_20: ; JR   NZ s
00247b b998
00247c b982
00247d b854
00247e b83b
00247f 9601
002480 b173
002481 b82b      	LDRAM_PC_NODDR FROMRAM0
002482 fd41      	sbrc zzF,zzZF
002483 940c 0200 	jmp zCMD_start
002485 2755
002486 fd77
002487 9550
002488 0f87
002489 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
00248a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_21: ; LD   IX nn
00248c b998
00248d b982
00248e b854
00248f b83b
002490 9601
002491 b123
002492 b82b      	LDRAM_PC_NODDR FROMRAM2
002493 b998
002494 b982
002495 b854
002496 b83b
002497 9601
002498 b013
002499 b82b      	LDRAM_PC_NODDR FROMRAM1
00249a 2c81      	mov zzIXh, FROMRAM1
00249b 2f02      	mov zzIXl, FROMRAM2
                 
00249c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_22: ; LD   (ww) IX
                 	
                 
00249e b998
00249f b982
0024a0 b854
0024a1 b83b
0024a2 9601
0024a3 b123
0024a4 b82b      	LDRAM_PC_NODDR FROMRAM2
0024a5 b998
0024a6 b982
0024a7 b854
0024a8 b83b
0024a9 9601
0024aa b013
0024ab b82b      	LDRAM_PC_NODDR FROMRAM1
0024ac b818
0024ad b922
0024ae b905
0024af b824
0024b0 1416
0024b1 985d
0024b2 f100
0024b3 b82b
0024b4 935f
0024b5 e158
0024b6 b955
0024b7 eb5f
0024b8 b954
0024b9 e050
0024ba bd5d
0024bb e550
0024bc bd5c
0024bd 9859
0024be 915f
0024bf 982c
0024c0 930f
0024c1 2d51
0024c2 940e 005f
0024c4 e054
0024c5 955a
0024c6 f7f1
0024c7 2f52
0024c8 940e 005f
0024ca e054
0024cb 955a
0024cc f7f1
0024cd 915f
0024ce 940e 005f
0024d0 bc5c
0024d1 9a59
0024d2 b854
0024d3 b82b      	STRAM FROMRAM1,FROMRAM2,zzIXl
0024d4 0d29
0024d5 1c15      	INC2 FROMRAM1,FROMRAM2
0024d6 b818
0024d7 b922
0024d8 b885
0024d9 b824
0024da 1416
0024db 985d
0024dc f100
0024dd b82b
0024de 935f
0024df e158
0024e0 b955
0024e1 eb5f
0024e2 b954
0024e3 e050
0024e4 bd5d
0024e5 e550
0024e6 bd5c
0024e7 9859
0024e8 915f
0024e9 982c
0024ea 928f
0024eb 2d51
0024ec 940e 005f
0024ee e054
0024ef 955a
0024f0 f7f1
0024f1 2f52
0024f2 940e 005f
0024f4 e054
0024f5 955a
0024f6 f7f1
0024f7 915f
0024f8 940e 005f
0024fa bc5c
0024fb 9a59
0024fc b854
0024fd b82b      	STRAM FROMRAM1,FROMRAM2,zzIXh
0024fe 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_23: ; INC   IX
002500 0d09
002501 1c85      	INC2 zzIXh,zzIXl
                 
002502 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_24: ; INC   IXh
002504 0c89      	add zzIXh,ONE
                 
002505 b75f      	in zzTmp, SREG
002506 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
002507 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002508 2b45      	or zzF, zzTmp ; combine flags
002509 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_25: ; DEC   IXh
00250b 1889      	sub zzIXh,ONE
                 
00250c b75f      	in zzTmp, SREG
00250d 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00250e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00250f 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
002510 2b45      	or zzF, zzTmp ; combine flags
002511 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_26: ; LD   IXh n
002513 b998
002514 b982
002515 b854
002516 b83b
002517 9601
002518 b173
002519 b82b      	LDRAM_PC_NODDR FROMRAM0
00251a 2e87      	mov zzIXh,FROMRAM0
                 
00251b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_27: ; DAA   
00251d e1bb
00251e 2fa1
00251f 2755
002520 fd45
002521 6051
002522 fd40
002523 6052
002524 fd46
002525 6054
002526 0fb5
002527 911c
002528 e058
002529 0fb5
00252a 914c      	zzDAA
                 
00252b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_28: ; JR   Z s
00252d b998
00252e b982
00252f b854
002530 b83b
002531 9601
002532 b173
002533 b82b      	LDRAM_PC_NODDR FROMRAM0
002534 ff41      	sbrs zzF,zzZF
002535 940c 0200 	jmp zCMD_start
002537 2755
002538 fd77
002539 9550
00253a 0f87
00253b 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
00253c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_29: ; ADD  IX IX
00253e 0f00      	add zzIXl,zzIXl
00253f 1c88      	adc zzIXh,zzIXh
                 
002540 b75f      	in zzTmp, SREG
002541 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
002542 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
002543 2b45      	or zzF, zzTmp ; combine flags
002544 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_2a: ; LD   IX (ww)
002546 b998
002547 b982
002548 b854
002549 b83b
00254a 9601
00254b b123
00254c b82b      	LDRAM_PC_NODDR FROMRAM2
00254d b998
00254e b982
00254f b854
002550 b83b
002551 9601
002552 b013
002553 b82b      	LDRAM_PC_NODDR FROMRAM1
002554 b818
002555 b922
002556 b854
002557 b83b
002558 0000
002559 0000
00255a b103
00255b b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzIXl
00255c 0d29
00255d 1c15      	INC2 FROMRAM1,FROMRAM2
00255e b818
00255f b922
002560 b854
002561 b83b
002562 0000
002563 0000
002564 b083
002565 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzIXh
                 	
                 
002566 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_2b: ; DEC   IX
002568 1909
002569 0885      	DEC2 zzIXh,zzIXl
                 
00256a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_2c: ; INC   IXl
00256c 0d09      	add zzIXl,ONE
                 
00256d b75f      	in zzTmp, SREG
00256e 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00256f 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002570 2b45      	or zzF, zzTmp ; combine flags
002571 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_2d: ; DEC   IXl
002573 1909      	sub zzIXl,ONE
                 
002574 b75f      	in zzTmp, SREG
002575 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
002576 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002577 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
002578 2b45      	or zzF, zzTmp ; combine flags
002579 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_2e: ; LD   IXl n
00257b b998
00257c b982
00257d b854
00257e b83b
00257f 9601
002580 b173
002581 b82b      	LDRAM_PC_NODDR FROMRAM0
002582 2f07      	mov zzIXl,FROMRAM0
                 
002583 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_2f: ; CPL   A
002585 9510      	com zzA
                 
002586 784f      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|_C_) ; mask old flags
002587 6e40      	ori zzF, 	(_I_|___|___|_H_|___|_N_|___) ; set flags
002588 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_30: ; JR   NC s
00258a b998
00258b b982
00258c b854
00258d b83b
00258e 9601
00258f b173
002590 b82b      	LDRAM_PC_NODDR FROMRAM0
002591 fd40      	sbrc zzF,zzCF
002592 940c 0200 	jmp zCMD_start
002594 2755
002595 fd77
002596 9550
002597 0f87
002598 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
002599 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_31: ; LD   SP nn
00259b b998
00259c b982
00259d b854
00259e b83b
00259f 9601
0025a0 b123
0025a1 b82b      	LDRAM_PC_NODDR FROMRAM2
0025a2 b998
0025a3 b982
0025a4 b854
0025a5 b83b
0025a6 9601
0025a7 b013
0025a8 b82b      	LDRAM_PC_NODDR FROMRAM1
0025a9 2dd1      	mov zzSPh, FROMRAM1
0025aa 2fc2      	mov zzSPl, FROMRAM2
                 
0025ab 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_32: ; LD   (nn) A
0025ad 2f71      	mov FROMRAM0,zzA
                 
0025ae b998
0025af b982
0025b0 b854
0025b1 b83b
0025b2 9601
0025b3 b123
0025b4 b82b      	LDRAM_PC_NODDR FROMRAM2
0025b5 b998
0025b6 b982
0025b7 b854
0025b8 b83b
0025b9 9601
0025ba b013
0025bb b82b      	LDRAM_PC_NODDR FROMRAM1
0025bc b818
0025bd b922
0025be b915
0025bf b824
0025c0 1416
0025c1 985d
0025c2 f100
0025c3 b82b
0025c4 935f
0025c5 e158
0025c6 b955
0025c7 eb5f
0025c8 b954
0025c9 e050
0025ca bd5d
0025cb e550
0025cc bd5c
0025cd 9859
0025ce 915f
0025cf 982c
0025d0 931f
0025d1 2d51
0025d2 940e 005f
0025d4 e054
0025d5 955a
0025d6 f7f1
0025d7 2f52
0025d8 940e 005f
0025da e054
0025db 955a
0025dc f7f1
0025dd 915f
0025de 940e 005f
0025e0 bc5c
0025e1 9a59
0025e2 b854
0025e3 b82b      	STRAM FROMRAM1,FROMRAM2,zzA
0025e4 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_33: ; INC   SP
0025e6 0dc9
0025e7 1dd5      	INC2 zzSPh,zzSPl
                 
0025e8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_34: ; INC   (IX+d)
0025ea b998
0025eb b982
0025ec b854
0025ed b83b
0025ee 9601
0025ef b173
0025f0 b82b      	LDRAM_PC_NODDR FROMRAM0
0025f1 2f20      	mov FROMRAM2,zzIXl
0025f2 2c18      	mov FROMRAM1,zzIXh
0025f3 2755
0025f4 fd77
0025f5 9550
0025f6 0f27
0025f7 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0025f8 b818
0025f9 b922
0025fa b854
0025fb b83b
0025fc 0000
0025fd 0000
0025fe b173
0025ff b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002600 0d79      	add FROMRAM0,ONE
                 
002601 b67f      	in _sreg, SREG
002602 b818
002603 b922
002604 b975
002605 b824
002606 1416
002607 985d
002608 f100
002609 b82b
00260a 935f
00260b e158
00260c b955
00260d eb5f
00260e b954
00260f e050
002610 bd5d
002611 e550
002612 bd5c
002613 9859
002614 915f
002615 982c
002616 937f
002617 2d51
002618 940e 005f
00261a e054
00261b 955a
00261c f7f1
00261d 2f52
00261e 940e 005f
002620 e054
002621 955a
002622 f7f1
002623 915f
002624 940e 005f
002626 bc5c
002627 9a59
002628 b854
002629 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00262a be7f      	out SREG,_sreg
00262b b75f      	in zzTmp, SREG
00262c 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00262d 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00262e 2b45      	or zzF, zzTmp ; combine flags
00262f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_35: ; DEC   (IX+d)
002631 b998
002632 b982
002633 b854
002634 b83b
002635 9601
002636 b173
002637 b82b      	LDRAM_PC_NODDR FROMRAM0
002638 2f20      	mov FROMRAM2,zzIXl
002639 2c18      	mov FROMRAM1,zzIXh
00263a 2755
00263b fd77
00263c 9550
00263d 0f27
00263e 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00263f b818
002640 b922
002641 b854
002642 b83b
002643 0000
002644 0000
002645 b173
002646 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002647 1979      	sub FROMRAM0,ONE
                 
002648 b67f      	in _sreg, SREG
002649 b818
00264a b922
00264b b975
00264c b824
00264d 1416
00264e 985d
00264f f100
002650 b82b
002651 935f
002652 e158
002653 b955
002654 eb5f
002655 b954
002656 e050
002657 bd5d
002658 e550
002659 bd5c
00265a 9859
00265b 915f
00265c 982c
00265d 937f
00265e 2d51
00265f 940e 005f
002661 e054
002662 955a
002663 f7f1
002664 2f52
002665 940e 005f
002667 e054
002668 955a
002669 f7f1
00266a 915f
00266b 940e 005f
00266d bc5c
00266e 9a59
00266f b854
002670 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
002671 be7f      	out SREG,_sreg
002672 b75f      	in zzTmp, SREG
002673 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
002674 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002675 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
002676 2b45      	or zzF, zzTmp ; combine flags
002677 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_36: ; LD   (IX+d) n
002679 b998
00267a b982
00267b b854
00267c b83b
00267d 9601
00267e b173
00267f b82b      	LDRAM_PC_NODDR FROMRAM0
002680 2f20      	mov FROMRAM2,zzIXl
002681 2c18      	mov FROMRAM1,zzIXh
002682 2755
002683 fd77
002684 9550
002685 0f27
002686 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002687 b998
002688 b982
002689 b854
00268a b83b
00268b 9601
00268c b173
00268d b82b      	LDRAM_PC_NODDR FROMRAM0
00268e 2f77      	mov FROMRAM0,FROMRAM0
                 
00268f b67f      	in _sreg, SREG
002690 b818
002691 b922
002692 b975
002693 b824
002694 1416
002695 985d
002696 f100
002697 b82b
002698 935f
002699 e158
00269a b955
00269b eb5f
00269c b954
00269d e050
00269e bd5d
00269f e550
0026a0 bd5c
0026a1 9859
0026a2 915f
0026a3 982c
0026a4 937f
0026a5 2d51
0026a6 940e 005f
0026a8 e054
0026a9 955a
0026aa f7f1
0026ab 2f52
0026ac 940e 005f
0026ae e054
0026af 955a
0026b0 f7f1
0026b1 915f
0026b2 940e 005f
0026b4 bc5c
0026b5 9a59
0026b6 b854
0026b7 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0026b8 be7f      	out SREG,_sreg
0026b9 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_37: ; SCF   
                 	
                 
0026bb 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0026bc 6841      	ori zzF, 	(_I_|___|___|___|___|___|_C_) ; set flags
0026bd 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_38: ; JR   C s
0026bf b998
0026c0 b982
0026c1 b854
0026c2 b83b
0026c3 9601
0026c4 b173
0026c5 b82b      	LDRAM_PC_NODDR FROMRAM0
0026c6 ff40      	sbrs zzF,zzCF
0026c7 940c 0200 	jmp zCMD_start
0026c9 2755
0026ca fd77
0026cb 9550
0026cc 0f87
0026cd 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
0026ce 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_39: ; ADD  IX SP
0026d0 0f0c      	add zzIXl,zzSPl
0026d1 1e8d      	adc zzIXh,zzSPh
                 
0026d2 b75f      	in zzTmp, SREG
0026d3 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
0026d4 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0026d5 2b45      	or zzF, zzTmp ; combine flags
0026d6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_3a: ; LD   A (nn)
0026d8 b998
0026d9 b982
0026da b854
0026db b83b
0026dc 9601
0026dd b123
0026de b82b      	LDRAM_PC_NODDR FROMRAM2
0026df b998
0026e0 b982
0026e1 b854
0026e2 b83b
0026e3 9601
0026e4 b013
0026e5 b82b      	LDRAM_PC_NODDR FROMRAM1
0026e6 b818
0026e7 b922
0026e8 b854
0026e9 b83b
0026ea 0000
0026eb 0000
0026ec b173
0026ed b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0026ee 2f17      	mov zzA,FROMRAM0
                 
0026ef 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_3b: ; DEC   SP
0026f1 19c9
0026f2 09d5      	DEC2 zzSPh,zzSPl
                 
0026f3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_3c: ; INC   A
0026f5 0d19      	add zzA,ONE
                 
0026f6 b75f      	in zzTmp, SREG
0026f7 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0026f8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0026f9 2b45      	or zzF, zzTmp ; combine flags
0026fa 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_3d: ; DEC   A
0026fc 1919      	sub zzA,ONE
                 
0026fd b75f      	in zzTmp, SREG
0026fe 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0026ff 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
002700 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
002701 2b45      	or zzF, zzTmp ; combine flags
002702 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_3e: ; LD   A n
002704 b998
002705 b982
002706 b854
002707 b83b
002708 9601
002709 b173
00270a b82b      	LDRAM_PC_NODDR FROMRAM0
00270b 2f17      	mov zzA,FROMRAM0
                 
00270c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_3f: ; CCF   
00270e 784f      	andi zzF,(_I_|_S_|_Z_|_V_|_C_)
00270f fb40      	bst zzF,zzCF
002710 f945      	bld zzF,zzHF
002711 e051      	ldi zzTmp,1<<zzCF
002712 2745      	eor zzF,zzTmp
                 
002713 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_40: ; LD   B B
002715 2caa      	mov zzB,zzB
                 
002716 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_41: ; LD   B C
002718 2ea6      	mov zzB,zzC
                 
002719 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_42: ; LD   B D
00271b 2cac      	mov zzB,zzD
                 
00271c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_43: ; LD   B E
00271e 2cad      	mov zzB,zzE
                 
00271f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_44: ; LD   B IXh
002721 2ca8      	mov zzB,zzIXh
                 
002722 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_45: ; LD   B IXl
002724 2ea0      	mov zzB,zzIXl
                 
002725 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_46: ; LD   B (IX+d)
002727 b998
002728 b982
002729 b854
00272a b83b
00272b 9601
00272c b173
00272d b82b      	LDRAM_PC_NODDR FROMRAM0
00272e 2f20      	mov FROMRAM2,zzIXl
00272f 2c18      	mov FROMRAM1,zzIXh
002730 2755
002731 fd77
002732 9550
002733 0f27
002734 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002735 b818
002736 b922
002737 b854
002738 b83b
002739 0000
00273a 0000
00273b b173
00273c b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00273d 2ea7      	mov zzB,FROMRAM0
                 
00273e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_47: ; LD   B A
002740 2ea1      	mov zzB,zzA
                 
002741 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_48: ; LD   C B
002743 2d6a      	mov zzC,zzB
                 
002744 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_49: ; LD   C C
002746 2f66      	mov zzC,zzC
                 
002747 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_4a: ; LD   C D
002749 2d6c      	mov zzC,zzD
                 
00274a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_4b: ; LD   C E
00274c 2d6d      	mov zzC,zzE
                 
00274d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_4c: ; LD   C IXh
00274f 2d68      	mov zzC,zzIXh
                 
002750 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_4d: ; LD   C IXl
002752 2f60      	mov zzC,zzIXl
                 
002753 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_4e: ; LD   C (IX+d)
002755 b998
002756 b982
002757 b854
002758 b83b
002759 9601
00275a b173
00275b b82b      	LDRAM_PC_NODDR FROMRAM0
00275c 2f20      	mov FROMRAM2,zzIXl
00275d 2c18      	mov FROMRAM1,zzIXh
00275e 2755
00275f fd77
002760 9550
002761 0f27
002762 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002763 b818
002764 b922
002765 b854
002766 b83b
002767 0000
002768 0000
002769 b173
00276a b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00276b 2f67      	mov zzC,FROMRAM0
                 
00276c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_4f: ; LD   C A
00276e 2f61      	mov zzC,zzA
                 
00276f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_50: ; LD   D B
002771 2cca      	mov zzD,zzB
                 
002772 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_51: ; LD   D C
002774 2ec6      	mov zzD,zzC
                 
002775 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_52: ; LD   D D
002777 2ccc      	mov zzD,zzD
                 
002778 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_53: ; LD   D E
00277a 2ccd      	mov zzD,zzE
                 
00277b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_54: ; LD   D IXh
00277d 2cc8      	mov zzD,zzIXh
                 
00277e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_55: ; LD   D IXl
002780 2ec0      	mov zzD,zzIXl
                 
002781 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_56: ; LD   D (IX+d)
002783 b998
002784 b982
002785 b854
002786 b83b
002787 9601
002788 b173
002789 b82b      	LDRAM_PC_NODDR FROMRAM0
00278a 2f20      	mov FROMRAM2,zzIXl
00278b 2c18      	mov FROMRAM1,zzIXh
00278c 2755
00278d fd77
00278e 9550
00278f 0f27
002790 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002791 b818
002792 b922
002793 b854
002794 b83b
002795 0000
002796 0000
002797 b173
002798 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002799 2ec7      	mov zzD,FROMRAM0
                 
00279a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_57: ; LD   D A
00279c 2ec1      	mov zzD,zzA
                 
00279d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_58: ; LD   E B
00279f 2cda      	mov zzE,zzB
                 
0027a0 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_59: ; LD   E C
0027a2 2ed6      	mov zzE,zzC
                 
0027a3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_5a: ; LD   E D
0027a5 2cdc      	mov zzE,zzD
                 
0027a6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_5b: ; LD   E E
0027a8 2cdd      	mov zzE,zzE
                 
0027a9 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_5c: ; LD   E IXh
0027ab 2cd8      	mov zzE,zzIXh
                 
0027ac 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_5d: ; LD   E IXl
0027ae 2ed0      	mov zzE,zzIXl
                 
0027af 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_5e: ; LD   E (IX+d)
0027b1 b998
0027b2 b982
0027b3 b854
0027b4 b83b
0027b5 9601
0027b6 b173
0027b7 b82b      	LDRAM_PC_NODDR FROMRAM0
0027b8 2f20      	mov FROMRAM2,zzIXl
0027b9 2c18      	mov FROMRAM1,zzIXh
0027ba 2755
0027bb fd77
0027bc 9550
0027bd 0f27
0027be 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0027bf b818
0027c0 b922
0027c1 b854
0027c2 b83b
0027c3 0000
0027c4 0000
0027c5 b173
0027c6 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0027c7 2ed7      	mov zzE,FROMRAM0
                 
0027c8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_5f: ; LD   E A
0027ca 2ed1      	mov zzE,zzA
                 
0027cb 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_60: ; LD   IXh B
0027cd 2c8a      	mov zzIXh,zzB
                 
0027ce 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_61: ; LD   IXh C
0027d0 2e86      	mov zzIXh,zzC
                 
0027d1 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_62: ; LD   IXh D
0027d3 2c8c      	mov zzIXh,zzD
                 
0027d4 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_63: ; LD   IXh E
0027d6 2c8d      	mov zzIXh,zzE
                 
0027d7 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_64: ; LD   IXh IXh
0027d9 2c88      	mov zzIXh,zzIXh
                 
0027da 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_65: ; LD   IXh IXl
0027dc 2e80      	mov zzIXh,zzIXl
                 
0027dd 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_66: ; LD   H (IX+d)
0027df b998
0027e0 b982
0027e1 b854
0027e2 b83b
0027e3 9601
0027e4 b173
0027e5 b82b      	LDRAM_PC_NODDR FROMRAM0
0027e6 2f20      	mov FROMRAM2,zzIXl
0027e7 2c18      	mov FROMRAM1,zzIXh
0027e8 2755
0027e9 fd77
0027ea 9550
0027eb 0f27
0027ec 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0027ed b818
0027ee b922
0027ef b854
0027f0 b83b
0027f1 0000
0027f2 0000
0027f3 b173
0027f4 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0027f5 2ee7      	mov zzH,FROMRAM0
                 
0027f6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_67: ; LD   IXh A
0027f8 2e81      	mov zzIXh,zzA
                 
0027f9 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_68: ; LD   IXl B
0027fb 2d0a      	mov zzIXl,zzB
                 
0027fc 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_69: ; LD   IXl C
0027fe 2f06      	mov zzIXl,zzC
                 
0027ff 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_6a: ; LD   IXl D
002801 2d0c      	mov zzIXl,zzD
                 
002802 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_6b: ; LD   IXl E
002804 2d0d      	mov zzIXl,zzE
                 
002805 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_6c: ; LD   IXl IXh
002807 2d08      	mov zzIXl,zzIXh
                 
002808 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_6d: ; LD   IXl IXl
00280a 2f00      	mov zzIXl,zzIXl
                 
00280b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_6e: ; LD   L (IX+d)
00280d b998
00280e b982
00280f b854
002810 b83b
002811 9601
002812 b173
002813 b82b      	LDRAM_PC_NODDR FROMRAM0
002814 2f20      	mov FROMRAM2,zzIXl
002815 2c18      	mov FROMRAM1,zzIXh
002816 2755
002817 fd77
002818 9550
002819 0f27
00281a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00281b b818
00281c b922
00281d b854
00281e b83b
00281f 0000
002820 0000
002821 b173
002822 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002823 2ef7      	mov zzL,FROMRAM0
                 
002824 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_6f: ; LD   IXl A
002826 2f01      	mov zzIXl,zzA
                 
002827 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_70: ; LD   (IX+d) B
002829 b998
00282a b982
00282b b854
00282c b83b
00282d 9601
00282e b173
00282f b82b      	LDRAM_PC_NODDR FROMRAM0
002830 2f20      	mov FROMRAM2,zzIXl
002831 2c18      	mov FROMRAM1,zzIXh
002832 2755
002833 fd77
002834 9550
002835 0f27
002836 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002837 2d7a      	mov FROMRAM0,zzB
                 
002838 b67f      	in _sreg, SREG
002839 b818
00283a b922
00283b b975
00283c b824
00283d 1416
00283e 985d
00283f f100
002840 b82b
002841 935f
002842 e158
002843 b955
002844 eb5f
002845 b954
002846 e050
002847 bd5d
002848 e550
002849 bd5c
00284a 9859
00284b 915f
00284c 982c
00284d 937f
00284e 2d51
00284f 940e 005f
002851 e054
002852 955a
002853 f7f1
002854 2f52
002855 940e 005f
002857 e054
002858 955a
002859 f7f1
00285a 915f
00285b 940e 005f
00285d bc5c
00285e 9a59
00285f b854
002860 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
002861 be7f      	out SREG,_sreg
002862 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_71: ; LD   (IX+d) C
002864 b998
002865 b982
002866 b854
002867 b83b
002868 9601
002869 b173
00286a b82b      	LDRAM_PC_NODDR FROMRAM0
00286b 2f20      	mov FROMRAM2,zzIXl
00286c 2c18      	mov FROMRAM1,zzIXh
00286d 2755
00286e fd77
00286f 9550
002870 0f27
002871 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002872 2f76      	mov FROMRAM0,zzC
                 
002873 b67f      	in _sreg, SREG
002874 b818
002875 b922
002876 b975
002877 b824
002878 1416
002879 985d
00287a f100
00287b b82b
00287c 935f
00287d e158
00287e b955
00287f eb5f
002880 b954
002881 e050
002882 bd5d
002883 e550
002884 bd5c
002885 9859
002886 915f
002887 982c
002888 937f
002889 2d51
00288a 940e 005f
00288c e054
00288d 955a
00288e f7f1
00288f 2f52
002890 940e 005f
002892 e054
002893 955a
002894 f7f1
002895 915f
002896 940e 005f
002898 bc5c
002899 9a59
00289a b854
00289b b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00289c be7f      	out SREG,_sreg
00289d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_72: ; LD   (IX+d) D
00289f b998
0028a0 b982
0028a1 b854
0028a2 b83b
0028a3 9601
0028a4 b173
0028a5 b82b      	LDRAM_PC_NODDR FROMRAM0
0028a6 2f20      	mov FROMRAM2,zzIXl
0028a7 2c18      	mov FROMRAM1,zzIXh
0028a8 2755
0028a9 fd77
0028aa 9550
0028ab 0f27
0028ac 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0028ad 2d7c      	mov FROMRAM0,zzD
                 
0028ae b67f      	in _sreg, SREG
0028af b818
0028b0 b922
0028b1 b975
0028b2 b824
0028b3 1416
0028b4 985d
0028b5 f100
0028b6 b82b
0028b7 935f
0028b8 e158
0028b9 b955
0028ba eb5f
0028bb b954
0028bc e050
0028bd bd5d
0028be e550
0028bf bd5c
0028c0 9859
0028c1 915f
0028c2 982c
0028c3 937f
0028c4 2d51
0028c5 940e 005f
0028c7 e054
0028c8 955a
0028c9 f7f1
0028ca 2f52
0028cb 940e 005f
0028cd e054
0028ce 955a
0028cf f7f1
0028d0 915f
0028d1 940e 005f
0028d3 bc5c
0028d4 9a59
0028d5 b854
0028d6 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0028d7 be7f      	out SREG,_sreg
0028d8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_73: ; LD   (IX+d) E
0028da b998
0028db b982
0028dc b854
0028dd b83b
0028de 9601
0028df b173
0028e0 b82b      	LDRAM_PC_NODDR FROMRAM0
0028e1 2f20      	mov FROMRAM2,zzIXl
0028e2 2c18      	mov FROMRAM1,zzIXh
0028e3 2755
0028e4 fd77
0028e5 9550
0028e6 0f27
0028e7 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0028e8 2d7d      	mov FROMRAM0,zzE
                 
0028e9 b67f      	in _sreg, SREG
0028ea b818
0028eb b922
0028ec b975
0028ed b824
0028ee 1416
0028ef 985d
0028f0 f100
0028f1 b82b
0028f2 935f
0028f3 e158
0028f4 b955
0028f5 eb5f
0028f6 b954
0028f7 e050
0028f8 bd5d
0028f9 e550
0028fa bd5c
0028fb 9859
0028fc 915f
0028fd 982c
0028fe 937f
0028ff 2d51
002900 940e 005f
002902 e054
002903 955a
002904 f7f1
002905 2f52
002906 940e 005f
002908 e054
002909 955a
00290a f7f1
00290b 915f
00290c 940e 005f
00290e bc5c
00290f 9a59
002910 b854
002911 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
002912 be7f      	out SREG,_sreg
002913 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_74: ; LD   (IX+d) H
002915 b998
002916 b982
002917 b854
002918 b83b
002919 9601
00291a b173
00291b b82b      	LDRAM_PC_NODDR FROMRAM0
00291c 2f20      	mov FROMRAM2,zzIXl
00291d 2c18      	mov FROMRAM1,zzIXh
00291e 2755
00291f fd77
002920 9550
002921 0f27
002922 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002923 2d7e      	mov FROMRAM0,zzH
                 
002924 b67f      	in _sreg, SREG
002925 b818
002926 b922
002927 b975
002928 b824
002929 1416
00292a 985d
00292b f100
00292c b82b
00292d 935f
00292e e158
00292f b955
002930 eb5f
002931 b954
002932 e050
002933 bd5d
002934 e550
002935 bd5c
002936 9859
002937 915f
002938 982c
002939 937f
00293a 2d51
00293b 940e 005f
00293d e054
00293e 955a
00293f f7f1
002940 2f52
002941 940e 005f
002943 e054
002944 955a
002945 f7f1
002946 915f
002947 940e 005f
002949 bc5c
00294a 9a59
00294b b854
00294c b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00294d be7f      	out SREG,_sreg
00294e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_75: ; LD   (IX+d) L
002950 b998
002951 b982
002952 b854
002953 b83b
002954 9601
002955 b173
002956 b82b      	LDRAM_PC_NODDR FROMRAM0
002957 2f20      	mov FROMRAM2,zzIXl
002958 2c18      	mov FROMRAM1,zzIXh
002959 2755
00295a fd77
00295b 9550
00295c 0f27
00295d 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00295e 2d7f      	mov FROMRAM0,zzL
                 
00295f b67f      	in _sreg, SREG
002960 b818
002961 b922
002962 b975
002963 b824
002964 1416
002965 985d
002966 f100
002967 b82b
002968 935f
002969 e158
00296a b955
00296b eb5f
00296c b954
00296d e050
00296e bd5d
00296f e550
002970 bd5c
002971 9859
002972 915f
002973 982c
002974 937f
002975 2d51
002976 940e 005f
002978 e054
002979 955a
00297a f7f1
00297b 2f52
00297c 940e 005f
00297e e054
00297f 955a
002980 f7f1
002981 915f
002982 940e 005f
002984 bc5c
002985 9a59
002986 b854
002987 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
002988 be7f      	out SREG,_sreg
002989 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_76: ; HALT  
00298b 1989
00298c 0995      	DEC2 zzPCh,zzPCl
                 
00298d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_77: ; LD   (IX+d) A
00298f b998
002990 b982
002991 b854
002992 b83b
002993 9601
002994 b173
002995 b82b      	LDRAM_PC_NODDR FROMRAM0
002996 2f20      	mov FROMRAM2,zzIXl
002997 2c18      	mov FROMRAM1,zzIXh
002998 2755
002999 fd77
00299a 9550
00299b 0f27
00299c 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00299d 2f71      	mov FROMRAM0,zzA
                 
00299e b67f      	in _sreg, SREG
00299f b818
0029a0 b922
0029a1 b975
0029a2 b824
0029a3 1416
0029a4 985d
0029a5 f100
0029a6 b82b
0029a7 935f
0029a8 e158
0029a9 b955
0029aa eb5f
0029ab b954
0029ac e050
0029ad bd5d
0029ae e550
0029af bd5c
0029b0 9859
0029b1 915f
0029b2 982c
0029b3 937f
0029b4 2d51
0029b5 940e 005f
0029b7 e054
0029b8 955a
0029b9 f7f1
0029ba 2f52
0029bb 940e 005f
0029bd e054
0029be 955a
0029bf f7f1
0029c0 915f
0029c1 940e 005f
0029c3 bc5c
0029c4 9a59
0029c5 b854
0029c6 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0029c7 be7f      	out SREG,_sreg
0029c8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_78: ; LD   A B
0029ca 2d1a      	mov zzA,zzB
                 
0029cb 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_79: ; LD   A C
0029cd 2f16      	mov zzA,zzC
                 
0029ce 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_7a: ; LD   A D
0029d0 2d1c      	mov zzA,zzD
                 
0029d1 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_7b: ; LD   A E
0029d3 2d1d      	mov zzA,zzE
                 
0029d4 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_7c: ; LD   A IXh
0029d6 2d18      	mov zzA,zzIXh
                 
0029d7 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_7d: ; LD   A IXl
0029d9 2f10      	mov zzA,zzIXl
                 
0029da 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_7e: ; LD   A (IX+d)
0029dc b998
0029dd b982
0029de b854
0029df b83b
0029e0 9601
0029e1 b173
0029e2 b82b      	LDRAM_PC_NODDR FROMRAM0
0029e3 2f20      	mov FROMRAM2,zzIXl
0029e4 2c18      	mov FROMRAM1,zzIXh
0029e5 2755
0029e6 fd77
0029e7 9550
0029e8 0f27
0029e9 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0029ea b818
0029eb b922
0029ec b854
0029ed b83b
0029ee 0000
0029ef 0000
0029f0 b173
0029f1 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0029f2 2f17      	mov zzA,FROMRAM0
                 
0029f3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_7f: ; LD   A A
0029f5 2f11      	mov zzA,zzA
                 
0029f6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_80: ; ADD  A B
0029f8 0d1a      	add zzA,zzB
                 
0029f9 b74f      	in zzF, SREG
0029fa 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
0029fb 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_81: ; ADD  A C
0029fd 0f16      	add zzA,zzC
                 
0029fe b74f      	in zzF, SREG
0029ff 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a00 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_82: ; ADD  A D
002a02 0d1c      	add zzA,zzD
                 
002a03 b74f      	in zzF, SREG
002a04 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a05 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_83: ; ADD  A E
002a07 0d1d      	add zzA,zzE
                 
002a08 b74f      	in zzF, SREG
002a09 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a0a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_84: ; ADD  A IXh
002a0c 0d18      	add zzA,zzIXh
                 
002a0d b74f      	in zzF, SREG
002a0e 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a0f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_85: ; ADD  A IXl
002a11 0f10      	add zzA,zzIXl
                 
002a12 b74f      	in zzF, SREG
002a13 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a14 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_86: ; ADD  A (IX+d)
002a16 b998
002a17 b982
002a18 b854
002a19 b83b
002a1a 9601
002a1b b173
002a1c b82b      	LDRAM_PC_NODDR FROMRAM0
002a1d 2f20      	mov FROMRAM2,zzIXl
002a1e 2c18      	mov FROMRAM1,zzIXh
002a1f 2755
002a20 fd77
002a21 9550
002a22 0f27
002a23 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002a24 b818
002a25 b922
002a26 b854
002a27 b83b
002a28 0000
002a29 0000
002a2a b173
002a2b b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002a2c 0f17      	add zzA,FROMRAM0
                 
002a2d b74f      	in zzF, SREG
002a2e 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a2f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_87: ; ADD  A A
002a31 0f11      	add zzA,zzA
                 
002a32 b74f      	in zzF, SREG
002a33 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a34 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_88: ; ADC  A B
002a36 bf4f      	out SREG,zzF
002a37 1d1a      	adc zzA,zzB
                 
002a38 b74f      	in zzF, SREG
002a39 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a3a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_89: ; ADC  A C
002a3c bf4f      	out SREG,zzF
002a3d 1f16      	adc zzA,zzC
                 
002a3e b74f      	in zzF, SREG
002a3f 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a40 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_8a: ; ADC  A D
002a42 bf4f      	out SREG,zzF
002a43 1d1c      	adc zzA,zzD
                 
002a44 b74f      	in zzF, SREG
002a45 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a46 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_8b: ; ADC  A E
002a48 bf4f      	out SREG,zzF
002a49 1d1d      	adc zzA,zzE
                 
002a4a b74f      	in zzF, SREG
002a4b 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a4c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_8c: ; ADC  A IXh
002a4e bf4f      	out SREG,zzF
002a4f 1d18      	adc zzA,zzIXh
                 
002a50 b74f      	in zzF, SREG
002a51 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a52 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_8d: ; ADC  A IXl
002a54 bf4f      	out SREG,zzF
002a55 1f10      	adc zzA,zzIXl
                 
002a56 b74f      	in zzF, SREG
002a57 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a58 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_8e: ; ADC  A (IX+d)
002a5a b998
002a5b b982
002a5c b854
002a5d b83b
002a5e 9601
002a5f b173
002a60 b82b      	LDRAM_PC_NODDR FROMRAM0
002a61 2f20      	mov FROMRAM2,zzIXl
002a62 2c18      	mov FROMRAM1,zzIXh
002a63 2755
002a64 fd77
002a65 9550
002a66 0f27
002a67 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002a68 b818
002a69 b922
002a6a b854
002a6b b83b
002a6c 0000
002a6d 0000
002a6e b173
002a6f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002a70 bf4f      	out SREG,zzF
002a71 1f17      	adc zzA,FROMRAM0
                 
002a72 b74f      	in zzF, SREG
002a73 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a74 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_8f: ; ADC  A A
002a76 bf4f      	out SREG,zzF
002a77 1f11      	adc zzA,zzA
                 
002a78 b74f      	in zzF, SREG
002a79 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002a7a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_90: ; SUB  A B
002a7c 191a      	sub zzA,zzB
                 
002a7d b75f      	in zzTmp, SREG
002a7e 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002a7f ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002a80 2b45      	or zzF, zzTmp ; combine flags
002a81 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_91: ; SUB  A C
002a83 1b16      	sub zzA,zzC
                 
002a84 b75f      	in zzTmp, SREG
002a85 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002a86 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002a87 2b45      	or zzF, zzTmp ; combine flags
002a88 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_92: ; SUB  A D
002a8a 191c      	sub zzA,zzD
                 
002a8b b75f      	in zzTmp, SREG
002a8c 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002a8d ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002a8e 2b45      	or zzF, zzTmp ; combine flags
002a8f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_93: ; SUB  A E
002a91 191d      	sub zzA,zzE
                 
002a92 b75f      	in zzTmp, SREG
002a93 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002a94 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002a95 2b45      	or zzF, zzTmp ; combine flags
002a96 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_94: ; SUB  A IXh
002a98 1918      	sub zzA,zzIXh
                 
002a99 b75f      	in zzTmp, SREG
002a9a 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002a9b ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002a9c 2b45      	or zzF, zzTmp ; combine flags
002a9d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_95: ; SUB  A IXl
002a9f 1b10      	sub zzA,zzIXl
                 
002aa0 b75f      	in zzTmp, SREG
002aa1 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002aa2 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002aa3 2b45      	or zzF, zzTmp ; combine flags
002aa4 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_96: ; SUB  A (IX+d)
002aa6 b998
002aa7 b982
002aa8 b854
002aa9 b83b
002aaa 9601
002aab b173
002aac b82b      	LDRAM_PC_NODDR FROMRAM0
002aad 2f20      	mov FROMRAM2,zzIXl
002aae 2c18      	mov FROMRAM1,zzIXh
002aaf 2755
002ab0 fd77
002ab1 9550
002ab2 0f27
002ab3 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002ab4 b818
002ab5 b922
002ab6 b854
002ab7 b83b
002ab8 0000
002ab9 0000
002aba b173
002abb b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002abc 1b17      	sub zzA,FROMRAM0
                 
002abd b75f      	in zzTmp, SREG
002abe 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002abf ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002ac0 2b45      	or zzF, zzTmp ; combine flags
002ac1 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_97: ; SUB  A A
002ac3 1b11      	sub zzA,zzA
                 
002ac4 b75f      	in zzTmp, SREG
002ac5 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002ac6 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002ac7 2b45      	or zzF, zzTmp ; combine flags
002ac8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_98: ; SBC  A B
002aca bf4f      	out SREG,zzF
002acb 9418      	sez
002acc 091a      	sbc zzA,zzB
                 
002acd b75f      	in zzTmp, SREG
002ace 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002acf ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002ad0 2b45      	or zzF, zzTmp ; combine flags
002ad1 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_99: ; SBC  A C
002ad3 bf4f      	out SREG,zzF
002ad4 9418      	sez
002ad5 0b16      	sbc zzA,zzC
                 
002ad6 b75f      	in zzTmp, SREG
002ad7 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002ad8 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002ad9 2b45      	or zzF, zzTmp ; combine flags
002ada 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_9a: ; SBC  A D
002adc bf4f      	out SREG,zzF
002add 9418      	sez
002ade 091c      	sbc zzA,zzD
                 
002adf b75f      	in zzTmp, SREG
002ae0 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002ae1 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002ae2 2b45      	or zzF, zzTmp ; combine flags
002ae3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_9b: ; SBC  A E
002ae5 bf4f      	out SREG,zzF
002ae6 9418      	sez
002ae7 091d      	sbc zzA,zzE
                 
002ae8 b75f      	in zzTmp, SREG
002ae9 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002aea ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002aeb 2b45      	or zzF, zzTmp ; combine flags
002aec 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_9c: ; SBC  A IXh
002aee bf4f      	out SREG,zzF
002aef 9418      	sez
002af0 0918      	sbc zzA,zzIXh
                 
002af1 b75f      	in zzTmp, SREG
002af2 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002af3 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002af4 2b45      	or zzF, zzTmp ; combine flags
002af5 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_9d: ; SBC  A IXl
002af7 bf4f      	out SREG,zzF
002af8 9418      	sez
002af9 0b10      	sbc zzA,zzIXl
                 
002afa b75f      	in zzTmp, SREG
002afb 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002afc ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002afd 2b45      	or zzF, zzTmp ; combine flags
002afe 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_9e: ; SBC  A (IX+d)
002b00 b998
002b01 b982
002b02 b854
002b03 b83b
002b04 9601
002b05 b173
002b06 b82b      	LDRAM_PC_NODDR FROMRAM0
002b07 2f20      	mov FROMRAM2,zzIXl
002b08 2c18      	mov FROMRAM1,zzIXh
002b09 2755
002b0a fd77
002b0b 9550
002b0c 0f27
002b0d 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002b0e b818
002b0f b922
002b10 b854
002b11 b83b
002b12 0000
002b13 0000
002b14 b173
002b15 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002b16 bf4f      	out SREG,zzF
002b17 9418      	sez
002b18 0b17      	sbc zzA,FROMRAM0
                 
002b19 b75f      	in zzTmp, SREG
002b1a 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002b1b ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002b1c 2b45      	or zzF, zzTmp ; combine flags
002b1d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_9f: ; SBC  A A
002b1f bf4f      	out SREG,zzF
002b20 9418      	sez
002b21 0b11      	sbc zzA,zzA
                 
002b22 b75f      	in zzTmp, SREG
002b23 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002b24 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002b25 2b45      	or zzF, zzTmp ; combine flags
002b26 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a0: ; AND  A B
002b28 211a      	and zzA,zzB
                 
002b29 b75f      	in zzTmp, SREG
002b2a 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b2b ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b2c 2b45      	or zzF, zzTmp ; combine flags
002b2d e1b8
002b2e 2fa1
002b2f 915c
002b30 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b31 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a1: ; AND  A C
002b33 2316      	and zzA,zzC
                 
002b34 b75f      	in zzTmp, SREG
002b35 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b36 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b37 2b45      	or zzF, zzTmp ; combine flags
002b38 e1b8
002b39 2fa1
002b3a 915c
002b3b 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b3c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a2: ; AND  A D
002b3e 211c      	and zzA,zzD
                 
002b3f b75f      	in zzTmp, SREG
002b40 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b41 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b42 2b45      	or zzF, zzTmp ; combine flags
002b43 e1b8
002b44 2fa1
002b45 915c
002b46 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b47 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a3: ; AND  A E
002b49 211d      	and zzA,zzE
                 
002b4a b75f      	in zzTmp, SREG
002b4b 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b4c ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b4d 2b45      	or zzF, zzTmp ; combine flags
002b4e e1b8
002b4f 2fa1
002b50 915c
002b51 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b52 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a4: ; AND  A IXh
002b54 2118      	and zzA,zzIXh
                 
002b55 b75f      	in zzTmp, SREG
002b56 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b57 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b58 2b45      	or zzF, zzTmp ; combine flags
002b59 e1b8
002b5a 2fa1
002b5b 915c
002b5c 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b5d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a5: ; AND  A IXl
002b5f 2310      	and zzA,zzIXl
                 
002b60 b75f      	in zzTmp, SREG
002b61 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b62 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b63 2b45      	or zzF, zzTmp ; combine flags
002b64 e1b8
002b65 2fa1
002b66 915c
002b67 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b68 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a6: ; AND  A (IX+d)
002b6a b998
002b6b b982
002b6c b854
002b6d b83b
002b6e 9601
002b6f b173
002b70 b82b      	LDRAM_PC_NODDR FROMRAM0
002b71 2f20      	mov FROMRAM2,zzIXl
002b72 2c18      	mov FROMRAM1,zzIXh
002b73 2755
002b74 fd77
002b75 9550
002b76 0f27
002b77 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002b78 b818
002b79 b922
002b7a b854
002b7b b83b
002b7c 0000
002b7d 0000
002b7e b173
002b7f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002b80 2317      	and zzA,FROMRAM0
                 
002b81 b75f      	in zzTmp, SREG
002b82 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b83 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b84 2b45      	or zzF, zzTmp ; combine flags
002b85 e1b8
002b86 2fa1
002b87 915c
002b88 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b89 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a7: ; AND  A A
002b8b 2311      	and zzA,zzA
                 
002b8c b75f      	in zzTmp, SREG
002b8d 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
002b8e ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
002b8f 2b45      	or zzF, zzTmp ; combine flags
002b90 e1b8
002b91 2fa1
002b92 915c
002b93 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b94 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a8: ; XOR  A B
002b96 251a      	eor zzA,zzB
                 
002b97 b74f      	in zzF, SREG
002b98 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002b99 e1b8
002b9a 2fa1
002b9b 915c
002b9c 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002b9d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_a9: ; XOR  A C
002b9f 2716      	eor zzA,zzC
                 
002ba0 b74f      	in zzF, SREG
002ba1 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002ba2 e1b8
002ba3 2fa1
002ba4 915c
002ba5 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002ba6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_aa: ; XOR  A D
002ba8 251c      	eor zzA,zzD
                 
002ba9 b74f      	in zzF, SREG
002baa 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002bab e1b8
002bac 2fa1
002bad 915c
002bae 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002baf 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ab: ; XOR  A E
002bb1 251d      	eor zzA,zzE
                 
002bb2 b74f      	in zzF, SREG
002bb3 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002bb4 e1b8
002bb5 2fa1
002bb6 915c
002bb7 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002bb8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ac: ; XOR  A IXh
002bba 2518      	eor zzA,zzIXh
                 
002bbb b74f      	in zzF, SREG
002bbc 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002bbd e1b8
002bbe 2fa1
002bbf 915c
002bc0 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002bc1 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ad: ; XOR  A IXl
002bc3 2710      	eor zzA,zzIXl
                 
002bc4 b74f      	in zzF, SREG
002bc5 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002bc6 e1b8
002bc7 2fa1
002bc8 915c
002bc9 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002bca 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ae: ; XOR  A (IX+d)
002bcc b998
002bcd b982
002bce b854
002bcf b83b
002bd0 9601
002bd1 b173
002bd2 b82b      	LDRAM_PC_NODDR FROMRAM0
002bd3 2f20      	mov FROMRAM2,zzIXl
002bd4 2c18      	mov FROMRAM1,zzIXh
002bd5 2755
002bd6 fd77
002bd7 9550
002bd8 0f27
002bd9 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002bda b818
002bdb b922
002bdc b854
002bdd b83b
002bde 0000
002bdf 0000
002be0 b173
002be1 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002be2 2717      	eor zzA,FROMRAM0
                 
002be3 b74f      	in zzF, SREG
002be4 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002be5 e1b8
002be6 2fa1
002be7 915c
002be8 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002be9 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_af: ; XOR  A A
002beb 2711      	eor zzA,zzA
                 
002bec b74f      	in zzF, SREG
002bed 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002bee e1b8
002bef 2fa1
002bf0 915c
002bf1 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002bf2 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b0: ; OR   A B
002bf4 291a      	or zzA,zzB
                 
002bf5 b74f      	in zzF, SREG
002bf6 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002bf7 e1b8
002bf8 2fa1
002bf9 915c
002bfa 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002bfb 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b1: ; OR   A C
002bfd 2b16      	or zzA,zzC
                 
002bfe b74f      	in zzF, SREG
002bff 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c00 e1b8
002c01 2fa1
002c02 915c
002c03 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c04 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b2: ; OR   A D
002c06 291c      	or zzA,zzD
                 
002c07 b74f      	in zzF, SREG
002c08 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c09 e1b8
002c0a 2fa1
002c0b 915c
002c0c 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c0d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b3: ; OR   A E
002c0f 291d      	or zzA,zzE
                 
002c10 b74f      	in zzF, SREG
002c11 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c12 e1b8
002c13 2fa1
002c14 915c
002c15 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c16 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b4: ; OR   A IXh
002c18 2918      	or zzA,zzIXh
                 
002c19 b74f      	in zzF, SREG
002c1a 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c1b e1b8
002c1c 2fa1
002c1d 915c
002c1e 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c1f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b5: ; OR   A IXl
002c21 2b10      	or zzA,zzIXl
                 
002c22 b74f      	in zzF, SREG
002c23 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c24 e1b8
002c25 2fa1
002c26 915c
002c27 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c28 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b6: ; OR   A (IX+d)
002c2a b998
002c2b b982
002c2c b854
002c2d b83b
002c2e 9601
002c2f b173
002c30 b82b      	LDRAM_PC_NODDR FROMRAM0
002c31 2f20      	mov FROMRAM2,zzIXl
002c32 2c18      	mov FROMRAM1,zzIXh
002c33 2755
002c34 fd77
002c35 9550
002c36 0f27
002c37 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002c38 b818
002c39 b922
002c3a b854
002c3b b83b
002c3c 0000
002c3d 0000
002c3e b173
002c3f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002c40 2b17      	or zzA,FROMRAM0
                 
002c41 b74f      	in zzF, SREG
002c42 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c43 e1b8
002c44 2fa1
002c45 915c
002c46 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c47 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b7: ; OR   A A
002c49 2b11      	or zzA,zzA
                 
002c4a b74f      	in zzF, SREG
002c4b 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
002c4c e1b8
002c4d 2fa1
002c4e 915c
002c4f 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
002c50 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b8: ; CP   A B
002c52 151a      	cp zzA,zzB
                 
002c53 b75f      	in zzTmp, SREG
002c54 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c55 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c56 2b45      	or zzF, zzTmp ; combine flags
002c57 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_b9: ; CP   A C
002c59 1716      	cp zzA,zzC
                 
002c5a b75f      	in zzTmp, SREG
002c5b 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c5c ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c5d 2b45      	or zzF, zzTmp ; combine flags
002c5e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ba: ; CP   A D
002c60 151c      	cp zzA,zzD
                 
002c61 b75f      	in zzTmp, SREG
002c62 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c63 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c64 2b45      	or zzF, zzTmp ; combine flags
002c65 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_bb: ; CP   A E
002c67 151d      	cp zzA,zzE
                 
002c68 b75f      	in zzTmp, SREG
002c69 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c6a ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c6b 2b45      	or zzF, zzTmp ; combine flags
002c6c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_bc: ; CP   A IXh
002c6e 1518      	cp zzA,zzIXh
                 
002c6f b75f      	in zzTmp, SREG
002c70 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c71 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c72 2b45      	or zzF, zzTmp ; combine flags
002c73 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_bd: ; CP   A IXl
002c75 1710      	cp zzA,zzIXl
                 
002c76 b75f      	in zzTmp, SREG
002c77 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c78 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c79 2b45      	or zzF, zzTmp ; combine flags
002c7a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_be: ; CP   A (IX+d)
002c7c b998
002c7d b982
002c7e b854
002c7f b83b
002c80 9601
002c81 b173
002c82 b82b      	LDRAM_PC_NODDR FROMRAM0
002c83 2f20      	mov FROMRAM2,zzIXl
002c84 2c18      	mov FROMRAM1,zzIXh
002c85 2755
002c86 fd77
002c87 9550
002c88 0f27
002c89 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
002c8a b818
002c8b b922
002c8c b854
002c8d b83b
002c8e 0000
002c8f 0000
002c90 b173
002c91 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
002c92 1717      	cp zzA,FROMRAM0
                 
002c93 b75f      	in zzTmp, SREG
002c94 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c95 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c96 2b45      	or zzF, zzTmp ; combine flags
002c97 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_bf: ; CP   A A
002c99 1711      	cp zzA,zzA
                 
002c9a b75f      	in zzTmp, SREG
002c9b 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
002c9c ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
002c9d 2b45      	or zzF, zzTmp ; combine flags
002c9e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c0: ; RET   NZ
002ca0 fd41      	sbrc zzF,zzZF
002ca1 940c 0200 	jmp zCMD_start
002ca3 b9d8
002ca4 b9c2
002ca5 b854
002ca6 b83b
002ca7 0000
002ca8 0000
002ca9 b183
002caa b82b
002cab 0dc9
002cac 1dd5
002cad b9d8
002cae b9c2
002caf b854
002cb0 b83b
002cb1 0000
002cb2 0000
002cb3 b193
002cb4 b82b
002cb5 0dc9
002cb6 1dd5      	zzPOP zzPCh,zzPCl
                 
002cb7 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c1: ; POP   BC
002cb9 b9d8
002cba b9c2
002cbb b854
002cbc b83b
002cbd 0000
002cbe 0000
002cbf b163
002cc0 b82b
002cc1 0dc9
002cc2 1dd5
002cc3 b9d8
002cc4 b9c2
002cc5 b854
002cc6 b83b
002cc7 0000
002cc8 0000
002cc9 b0a3
002cca b82b
002ccb 0dc9
002ccc 1dd5      	zzPOP zzB,zzC
                 
002ccd 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c2: ; JP   NZ nn
002ccf b998
002cd0 b982
002cd1 b854
002cd2 b83b
002cd3 9601
002cd4 b123
002cd5 b82b      	LDRAM_PC_NODDR FROMRAM2
002cd6 b998
002cd7 b982
002cd8 b854
002cd9 b83b
002cda 9601
002cdb b013
002cdc b82b      	LDRAM_PC_NODDR FROMRAM1
002cdd fd41      	sbrc zzF,zzZF
002cde 940c 0200 	jmp zCMD_start
002ce0 2f82      	mov zzPCl,FROMRAM2
002ce1 2d91      	mov zzPCh,FROMRAM1
                 
002ce2 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c3: ; JP   * nn
002ce4 b998
002ce5 b982
002ce6 b854
002ce7 b83b
002ce8 9601
002ce9 b123
002cea b82b      	LDRAM_PC_NODDR FROMRAM2
002ceb b998
002cec b982
002ced b854
002cee b83b
002cef 9601
002cf0 b013
002cf1 b82b      	LDRAM_PC_NODDR FROMRAM1
002cf2 1055      	cpse ZERO,ZERO
002cf3 940c 0200 	jmp zCMD_start
002cf5 2f82      	mov zzPCl,FROMRAM2
002cf6 2d91      	mov zzPCh,FROMRAM1
                 
002cf7 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c4: ; CALL NZ nn
002cf9 b998
002cfa b982
002cfb b854
002cfc b83b
002cfd 9601
002cfe b123
002cff b82b      	LDRAM_PC_NODDR FROMRAM2
002d00 b998
002d01 b982
002d02 b854
002d03 b83b
002d04 9601
002d05 b013
002d06 b82b      	LDRAM_PC_NODDR FROMRAM1
002d07 fd41      	sbrc zzF,zzZF
002d08 940c 0200 	jmp zCMD_start
002d0a 19c9
002d0b 09d5
002d0c b9d8
002d0d b9c2
002d0e b995
002d0f b824
002d10 15d6
002d11 985d
002d12 f100
002d13 b82b
002d14 935f
002d15 e158
002d16 b955
002d17 eb5f
002d18 b954
002d19 e050
002d1a bd5d
002d1b e550
002d1c bd5c
002d1d 9859
002d1e 915f
002d1f 982c
002d20 939f
002d21 2f5d
002d22 940e 005f
002d24 e054
002d25 955a
002d26 f7f1
002d27 2f5c
002d28 940e 005f
002d2a e054
002d2b 955a
002d2c f7f1
002d2d 915f
002d2e 940e 005f
002d30 bc5c
002d31 9a59
002d32 b854
002d33 b82b
002d34 19c9
002d35 09d5
002d36 b9d8
002d37 b9c2
002d38 b985
002d39 b824
002d3a 15d6
002d3b 985d
002d3c f100
002d3d b82b
002d3e 935f
002d3f e158
002d40 b955
002d41 eb5f
002d42 b954
002d43 e050
002d44 bd5d
002d45 e550
002d46 bd5c
002d47 9859
002d48 915f
002d49 982c
002d4a 938f
002d4b 2f5d
002d4c 940e 005f
002d4e e054
002d4f 955a
002d50 f7f1
002d51 2f5c
002d52 940e 005f
002d54 e054
002d55 955a
002d56 f7f1
002d57 915f
002d58 940e 005f
002d5a bc5c
002d5b 9a59
002d5c b854
002d5d b82b      	zzPUSH zzPCh,zzPCl
002d5e 2f82      	mov zzPCl,FROMRAM2
002d5f 2d91      	mov zzPCh,FROMRAM1
                 
002d60 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c5: ; PUSH  BC
002d62 19c9
002d63 09d5
002d64 b9d8
002d65 b9c2
002d66 b8a5
002d67 b824
002d68 15d6
002d69 985d
002d6a f100
002d6b b82b
002d6c 935f
002d6d e158
002d6e b955
002d6f eb5f
002d70 b954
002d71 e050
002d72 bd5d
002d73 e550
002d74 bd5c
002d75 9859
002d76 915f
002d77 982c
002d78 92af
002d79 2f5d
002d7a 940e 005f
002d7c e054
002d7d 955a
002d7e f7f1
002d7f 2f5c
002d80 940e 005f
002d82 e054
002d83 955a
002d84 f7f1
002d85 915f
002d86 940e 005f
002d88 bc5c
002d89 9a59
002d8a b854
002d8b b82b
002d8c 19c9
002d8d 09d5
002d8e b9d8
002d8f b9c2
002d90 b965
002d91 b824
002d92 15d6
002d93 985d
002d94 f100
002d95 b82b
002d96 935f
002d97 e158
002d98 b955
002d99 eb5f
002d9a b954
002d9b e050
002d9c bd5d
002d9d e550
002d9e bd5c
002d9f 9859
002da0 915f
002da1 982c
002da2 936f
002da3 2f5d
002da4 940e 005f
002da6 e054
002da7 955a
002da8 f7f1
002da9 2f5c
002daa 940e 005f
002dac e054
002dad 955a
002dae f7f1
002daf 915f
002db0 940e 005f
002db2 bc5c
002db3 9a59
002db4 b854
002db5 b82b      	zzPUSH zzB,zzC
                 
002db6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c6: ; ADD  A n
002db8 b998
002db9 b982
002dba b854
002dbb b83b
002dbc 9601
002dbd b173
002dbe b82b      	LDRAM_PC_NODDR FROMRAM0
002dbf 0f17      	add zzA,FROMRAM0
                 
002dc0 b74f      	in zzF, SREG
002dc1 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002dc2 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c7: ; RST   00h
002dc4 19c9
002dc5 09d5
002dc6 b9d8
002dc7 b9c2
002dc8 b995
002dc9 b824
002dca 15d6
002dcb 985d
002dcc f100
002dcd b82b
002dce 935f
002dcf e158
002dd0 b955
002dd1 eb5f
002dd2 b954
002dd3 e050
002dd4 bd5d
002dd5 e550
002dd6 bd5c
002dd7 9859
002dd8 915f
002dd9 982c
002dda 939f
002ddb 2f5d
002ddc 940e 005f
002dde e054
002ddf 955a
002de0 f7f1
002de1 2f5c
002de2 940e 005f
002de4 e054
002de5 955a
002de6 f7f1
002de7 915f
002de8 940e 005f
002dea bc5c
002deb 9a59
002dec b854
002ded b82b
002dee 19c9
002def 09d5
002df0 b9d8
002df1 b9c2
002df2 b985
002df3 b824
002df4 15d6
002df5 985d
002df6 f100
002df7 b82b
002df8 935f
002df9 e158
002dfa b955
002dfb eb5f
002dfc b954
002dfd e050
002dfe bd5d
002dff e550
002e00 bd5c
002e01 9859
002e02 915f
002e03 982c
002e04 938f
002e05 2f5d
002e06 940e 005f
002e08 e054
002e09 955a
002e0a f7f1
002e0b 2f5c
002e0c 940e 005f
002e0e e054
002e0f 955a
002e10 f7f1
002e11 915f
002e12 940e 005f
002e14 bc5c
002e15 9a59
002e16 b854
002e17 b82b      	zzPUSH zzPCh,zzPCl
002e18 2799      	clr zzPCh
002e19 e080      	ldi zzPCl,0
                 
002e1a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c8: ; RET   Z
002e1c ff41      	sbrs zzF,zzZF
002e1d 940c 0200 	jmp zCMD_start
002e1f b9d8
002e20 b9c2
002e21 b854
002e22 b83b
002e23 0000
002e24 0000
002e25 b183
002e26 b82b
002e27 0dc9
002e28 1dd5
002e29 b9d8
002e2a b9c2
002e2b b854
002e2c b83b
002e2d 0000
002e2e 0000
002e2f b193
002e30 b82b
002e31 0dc9
002e32 1dd5      	zzPOP zzPCh,zzPCl
                 
002e33 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_c9: ; RET   *
002e35 1055      	cpse ZERO,ZERO
002e36 940c 0200 	jmp zCMD_start
002e38 b9d8
002e39 b9c2
002e3a b854
002e3b b83b
002e3c 0000
002e3d 0000
002e3e b183
002e3f b82b
002e40 0dc9
002e41 1dd5
002e42 b9d8
002e43 b9c2
002e44 b854
002e45 b83b
002e46 0000
002e47 0000
002e48 b193
002e49 b82b
002e4a 0dc9
002e4b 1dd5      	zzPOP zzPCh,zzPCl
                 
002e4c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ca: ; JP   Z nn
002e4e b998
002e4f b982
002e50 b854
002e51 b83b
002e52 9601
002e53 b123
002e54 b82b      	LDRAM_PC_NODDR FROMRAM2
002e55 b998
002e56 b982
002e57 b854
002e58 b83b
002e59 9601
002e5a b013
002e5b b82b      	LDRAM_PC_NODDR FROMRAM1
002e5c ff41      	sbrs zzF,zzZF
002e5d 940c 0200 	jmp zCMD_start
002e5f 2f82      	mov zzPCl,FROMRAM2
002e60 2d91      	mov zzPCh,FROMRAM1
                 
002e61 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_cb: ; DDCB  
002e63 b998
002e64 b982
002e65 b854
002e66 b83b
002e67 9601
002e68 b173
002e69 b82b      	LDRAM_PC_NODDR FROMRAM0
002e6a e1b4      	ldi Xh, high(zOPCODE_DDCB_LBLS_L)
002e6b 940c 0201 	jmp zCMDP_start
                 
002e6d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_cc: ; CALL Z nn
002e6f b998
002e70 b982
002e71 b854
002e72 b83b
002e73 9601
002e74 b123
002e75 b82b      	LDRAM_PC_NODDR FROMRAM2
002e76 b998
002e77 b982
002e78 b854
002e79 b83b
002e7a 9601
002e7b b013
002e7c b82b      	LDRAM_PC_NODDR FROMRAM1
002e7d ff41      	sbrs zzF,zzZF
002e7e 940c 0200 	jmp zCMD_start
002e80 19c9
002e81 09d5
002e82 b9d8
002e83 b9c2
002e84 b995
002e85 b824
002e86 15d6
002e87 985d
002e88 f100
002e89 b82b
002e8a 935f
002e8b e158
002e8c b955
002e8d eb5f
002e8e b954
002e8f e050
002e90 bd5d
002e91 e550
002e92 bd5c
002e93 9859
002e94 915f
002e95 982c
002e96 939f
002e97 2f5d
002e98 940e 005f
002e9a e054
002e9b 955a
002e9c f7f1
002e9d 2f5c
002e9e 940e 005f
002ea0 e054
002ea1 955a
002ea2 f7f1
002ea3 915f
002ea4 940e 005f
002ea6 bc5c
002ea7 9a59
002ea8 b854
002ea9 b82b
002eaa 19c9
002eab 09d5
002eac b9d8
002ead b9c2
002eae b985
002eaf b824
002eb0 15d6
002eb1 985d
002eb2 f100
002eb3 b82b
002eb4 935f
002eb5 e158
002eb6 b955
002eb7 eb5f
002eb8 b954
002eb9 e050
002eba bd5d
002ebb e550
002ebc bd5c
002ebd 9859
002ebe 915f
002ebf 982c
002ec0 938f
002ec1 2f5d
002ec2 940e 005f
002ec4 e054
002ec5 955a
002ec6 f7f1
002ec7 2f5c
002ec8 940e 005f
002eca e054
002ecb 955a
002ecc f7f1
002ecd 915f
002ece 940e 005f
002ed0 bc5c
002ed1 9a59
002ed2 b854
002ed3 b82b      	zzPUSH zzPCh,zzPCl
002ed4 2f82      	mov zzPCl,FROMRAM2
002ed5 2d91      	mov zzPCh,FROMRAM1
                 
002ed6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_cd: ; CALL * nn
002ed8 b998
002ed9 b982
002eda b854
002edb b83b
002edc 9601
002edd b123
002ede b82b      	LDRAM_PC_NODDR FROMRAM2
002edf b998
002ee0 b982
002ee1 b854
002ee2 b83b
002ee3 9601
002ee4 b013
002ee5 b82b      	LDRAM_PC_NODDR FROMRAM1
002ee6 1055      	cpse ZERO,ZERO
002ee7 940c 0200 	jmp zCMD_start
002ee9 19c9
002eea 09d5
002eeb b9d8
002eec b9c2
002eed b995
002eee b824
002eef 15d6
002ef0 985d
002ef1 f100
002ef2 b82b
002ef3 935f
002ef4 e158
002ef5 b955
002ef6 eb5f
002ef7 b954
002ef8 e050
002ef9 bd5d
002efa e550
002efb bd5c
002efc 9859
002efd 915f
002efe 982c
002eff 939f
002f00 2f5d
002f01 940e 005f
002f03 e054
002f04 955a
002f05 f7f1
002f06 2f5c
002f07 940e 005f
002f09 e054
002f0a 955a
002f0b f7f1
002f0c 915f
002f0d 940e 005f
002f0f bc5c
002f10 9a59
002f11 b854
002f12 b82b
002f13 19c9
002f14 09d5
002f15 b9d8
002f16 b9c2
002f17 b985
002f18 b824
002f19 15d6
002f1a 985d
002f1b f100
002f1c b82b
002f1d 935f
002f1e e158
002f1f b955
002f20 eb5f
002f21 b954
002f22 e050
002f23 bd5d
002f24 e550
002f25 bd5c
002f26 9859
002f27 915f
002f28 982c
002f29 938f
002f2a 2f5d
002f2b 940e 005f
002f2d e054
002f2e 955a
002f2f f7f1
002f30 2f5c
002f31 940e 005f
002f33 e054
002f34 955a
002f35 f7f1
002f36 915f
002f37 940e 005f
002f39 bc5c
002f3a 9a59
002f3b b854
002f3c b82b      	zzPUSH zzPCh,zzPCl
002f3d 2f82      	mov zzPCl,FROMRAM2
002f3e 2d91      	mov zzPCh,FROMRAM1
                 
002f3f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ce: ; ADC  A n
002f41 b998
002f42 b982
002f43 b854
002f44 b83b
002f45 9601
002f46 b173
002f47 b82b      	LDRAM_PC_NODDR FROMRAM0
002f48 bf4f      	out SREG,zzF
002f49 1f17      	adc zzA,FROMRAM0
                 
002f4a b74f      	in zzF, SREG
002f4b 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
002f4c 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_cf: ; RST   08h
002f4e 19c9
002f4f 09d5
002f50 b9d8
002f51 b9c2
002f52 b995
002f53 b824
002f54 15d6
002f55 985d
002f56 f100
002f57 b82b
002f58 935f
002f59 e158
002f5a b955
002f5b eb5f
002f5c b954
002f5d e050
002f5e bd5d
002f5f e550
002f60 bd5c
002f61 9859
002f62 915f
002f63 982c
002f64 939f
002f65 2f5d
002f66 940e 005f
002f68 e054
002f69 955a
002f6a f7f1
002f6b 2f5c
002f6c 940e 005f
002f6e e054
002f6f 955a
002f70 f7f1
002f71 915f
002f72 940e 005f
002f74 bc5c
002f75 9a59
002f76 b854
002f77 b82b
002f78 19c9
002f79 09d5
002f7a b9d8
002f7b b9c2
002f7c b985
002f7d b824
002f7e 15d6
002f7f 985d
002f80 f100
002f81 b82b
002f82 935f
002f83 e158
002f84 b955
002f85 eb5f
002f86 b954
002f87 e050
002f88 bd5d
002f89 e550
002f8a bd5c
002f8b 9859
002f8c 915f
002f8d 982c
002f8e 938f
002f8f 2f5d
002f90 940e 005f
002f92 e054
002f93 955a
002f94 f7f1
002f95 2f5c
002f96 940e 005f
002f98 e054
002f99 955a
002f9a f7f1
002f9b 915f
002f9c 940e 005f
002f9e bc5c
002f9f 9a59
002fa0 b854
002fa1 b82b      	zzPUSH zzPCh,zzPCl
002fa2 2799      	clr zzPCh
002fa3 e088      	ldi zzPCl,0x08
                 
002fa4 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d0: ; RET   NC
002fa6 fd40      	sbrc zzF,zzCF
002fa7 940c 0200 	jmp zCMD_start
002fa9 b9d8
002faa b9c2
002fab b854
002fac b83b
002fad 0000
002fae 0000
002faf b183
002fb0 b82b
002fb1 0dc9
002fb2 1dd5
002fb3 b9d8
002fb4 b9c2
002fb5 b854
002fb6 b83b
002fb7 0000
002fb8 0000
002fb9 b193
002fba b82b
002fbb 0dc9
002fbc 1dd5      	zzPOP zzPCh,zzPCl
                 
002fbd 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d1: ; POP   DE
002fbf b9d8
002fc0 b9c2
002fc1 b854
002fc2 b83b
002fc3 0000
002fc4 0000
002fc5 b0d3
002fc6 b82b
002fc7 0dc9
002fc8 1dd5
002fc9 b9d8
002fca b9c2
002fcb b854
002fcc b83b
002fcd 0000
002fce 0000
002fcf b0c3
002fd0 b82b
002fd1 0dc9
002fd2 1dd5      	zzPOP zzD,zzE
                 
002fd3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d2: ; JP   NC nn
002fd5 b998
002fd6 b982
002fd7 b854
002fd8 b83b
002fd9 9601
002fda b123
002fdb b82b      	LDRAM_PC_NODDR FROMRAM2
002fdc b998
002fdd b982
002fde b854
002fdf b83b
002fe0 9601
002fe1 b013
002fe2 b82b      	LDRAM_PC_NODDR FROMRAM1
002fe3 fd40      	sbrc zzF,zzCF
002fe4 940c 0200 	jmp zCMD_start
002fe6 2f82      	mov zzPCl,FROMRAM2
002fe7 2d91      	mov zzPCh,FROMRAM1
                 
002fe8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d3: ; OUT  (n) A
002fea b998
002feb b982
002fec b854
002fed b83b
002fee 9601
002fef b173
002ff0 b82b      	LDRAM_PC_NODDR FROMRAM0
002ff1 2f57      	mov zzTmp,FROMRAM0
002ff2 9310 090e 	sts CDATA,zzA
002ff4 940e 7208 	call PORTOUT
                 
002ff6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d4: ; CALL NC nn
002ff8 b998
002ff9 b982
002ffa b854
002ffb b83b
002ffc 9601
002ffd b123
002ffe b82b      	LDRAM_PC_NODDR FROMRAM2
002fff b998
003000 b982
003001 b854
003002 b83b
003003 9601
003004 b013
003005 b82b      	LDRAM_PC_NODDR FROMRAM1
003006 fd40      	sbrc zzF,zzCF
003007 940c 0200 	jmp zCMD_start
003009 19c9
00300a 09d5
00300b b9d8
00300c b9c2
00300d b995
00300e b824
00300f 15d6
003010 985d
003011 f100
003012 b82b
003013 935f
003014 e158
003015 b955
003016 eb5f
003017 b954
003018 e050
003019 bd5d
00301a e550
00301b bd5c
00301c 9859
00301d 915f
00301e 982c
00301f 939f
003020 2f5d
003021 940e 005f
003023 e054
003024 955a
003025 f7f1
003026 2f5c
003027 940e 005f
003029 e054
00302a 955a
00302b f7f1
00302c 915f
00302d 940e 005f
00302f bc5c
003030 9a59
003031 b854
003032 b82b
003033 19c9
003034 09d5
003035 b9d8
003036 b9c2
003037 b985
003038 b824
003039 15d6
00303a 985d
00303b f100
00303c b82b
00303d 935f
00303e e158
00303f b955
003040 eb5f
003041 b954
003042 e050
003043 bd5d
003044 e550
003045 bd5c
003046 9859
003047 915f
003048 982c
003049 938f
00304a 2f5d
00304b 940e 005f
00304d e054
00304e 955a
00304f f7f1
003050 2f5c
003051 940e 005f
003053 e054
003054 955a
003055 f7f1
003056 915f
003057 940e 005f
003059 bc5c
00305a 9a59
00305b b854
00305c b82b      	zzPUSH zzPCh,zzPCl
00305d 2f82      	mov zzPCl,FROMRAM2
00305e 2d91      	mov zzPCh,FROMRAM1
                 
00305f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d5: ; PUSH  DE
003061 19c9
003062 09d5
003063 b9d8
003064 b9c2
003065 b8c5
003066 b824
003067 15d6
003068 985d
003069 f100
00306a b82b
00306b 935f
00306c e158
00306d b955
00306e eb5f
00306f b954
003070 e050
003071 bd5d
003072 e550
003073 bd5c
003074 9859
003075 915f
003076 982c
003077 92cf
003078 2f5d
003079 940e 005f
00307b e054
00307c 955a
00307d f7f1
00307e 2f5c
00307f 940e 005f
003081 e054
003082 955a
003083 f7f1
003084 915f
003085 940e 005f
003087 bc5c
003088 9a59
003089 b854
00308a b82b
00308b 19c9
00308c 09d5
00308d b9d8
00308e b9c2
00308f b8d5
003090 b824
003091 15d6
003092 985d
003093 f100
003094 b82b
003095 935f
003096 e158
003097 b955
003098 eb5f
003099 b954
00309a e050
00309b bd5d
00309c e550
00309d bd5c
00309e 9859
00309f 915f
0030a0 982c
0030a1 92df
0030a2 2f5d
0030a3 940e 005f
0030a5 e054
0030a6 955a
0030a7 f7f1
0030a8 2f5c
0030a9 940e 005f
0030ab e054
0030ac 955a
0030ad f7f1
0030ae 915f
0030af 940e 005f
0030b1 bc5c
0030b2 9a59
0030b3 b854
0030b4 b82b      	zzPUSH zzD,zzE
                 
0030b5 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d6: ; SUB  A n
0030b7 b998
0030b8 b982
0030b9 b854
0030ba b83b
0030bb 9601
0030bc b173
0030bd b82b      	LDRAM_PC_NODDR FROMRAM0
0030be 1b17      	sub zzA,FROMRAM0
                 
0030bf b75f      	in zzTmp, SREG
0030c0 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0030c1 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0030c2 2b45      	or zzF, zzTmp ; combine flags
0030c3 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d7: ; RST   10h
0030c5 19c9
0030c6 09d5
0030c7 b9d8
0030c8 b9c2
0030c9 b995
0030ca b824
0030cb 15d6
0030cc 985d
0030cd f100
0030ce b82b
0030cf 935f
0030d0 e158
0030d1 b955
0030d2 eb5f
0030d3 b954
0030d4 e050
0030d5 bd5d
0030d6 e550
0030d7 bd5c
0030d8 9859
0030d9 915f
0030da 982c
0030db 939f
0030dc 2f5d
0030dd 940e 005f
0030df e054
0030e0 955a
0030e1 f7f1
0030e2 2f5c
0030e3 940e 005f
0030e5 e054
0030e6 955a
0030e7 f7f1
0030e8 915f
0030e9 940e 005f
0030eb bc5c
0030ec 9a59
0030ed b854
0030ee b82b
0030ef 19c9
0030f0 09d5
0030f1 b9d8
0030f2 b9c2
0030f3 b985
0030f4 b824
0030f5 15d6
0030f6 985d
0030f7 f100
0030f8 b82b
0030f9 935f
0030fa e158
0030fb b955
0030fc eb5f
0030fd b954
0030fe e050
0030ff bd5d
003100 e550
003101 bd5c
003102 9859
003103 915f
003104 982c
003105 938f
003106 2f5d
003107 940e 005f
003109 e054
00310a 955a
00310b f7f1
00310c 2f5c
00310d 940e 005f
00310f e054
003110 955a
003111 f7f1
003112 915f
003113 940e 005f
003115 bc5c
003116 9a59
003117 b854
003118 b82b      	zzPUSH zzPCh,zzPCl
003119 2799      	clr zzPCh
00311a e180      	ldi zzPCl,0x10
                 
00311b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d8: ; RET   C
00311d ff40      	sbrs zzF,zzCF
00311e 940c 0200 	jmp zCMD_start
003120 b9d8
003121 b9c2
003122 b854
003123 b83b
003124 0000
003125 0000
003126 b183
003127 b82b
003128 0dc9
003129 1dd5
00312a b9d8
00312b b9c2
00312c b854
00312d b83b
00312e 0000
00312f 0000
003130 b193
003131 b82b
003132 0dc9
003133 1dd5      	zzPOP zzPCh,zzPCl
                 
003134 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_d9: ; EXX   
003136 9150 0907
003138 92e0 0907
00313a 2ee5      	EX zzH,zzHe
00313b 9150 0908
00313d 92f0 0908
00313f 2ef5      	EX zzL,zzLe
003140 9150 0903
003142 92a0 0903
003144 2ea5      	EX zzB,zzBe
003145 9150 0904
003147 9360 0904
003149 2f65      	EX zzC,zzCe
00314a 9150 0905
00314c 92c0 0905
00314e 2ec5      	EX zzD,zzDe
00314f 9150 0906
003151 92d0 0906
003153 2ed5      	EX zzE,zzEe
                 	
                 
003154 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_da: ; JP   C nn
003156 b998
003157 b982
003158 b854
003159 b83b
00315a 9601
00315b b123
00315c b82b      	LDRAM_PC_NODDR FROMRAM2
00315d b998
00315e b982
00315f b854
003160 b83b
003161 9601
003162 b013
003163 b82b      	LDRAM_PC_NODDR FROMRAM1
003164 ff40      	sbrs zzF,zzCF
003165 940c 0200 	jmp zCMD_start
003167 2f82      	mov zzPCl,FROMRAM2
003168 2d91      	mov zzPCh,FROMRAM1
                 
003169 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_db: ; IN   A (n)
00316b b998
00316c b982
00316d b854
00316e b83b
00316f 9601
003170 b173
003171 b82b      	LDRAM_PC_NODDR FROMRAM0
003172 2f57      	mov zzTmp,FROMRAM0
003173 940e 7206 	call PORTIN
003175 2f15      	mov zzA,zzTmp
                 
003176 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_dc: ; CALL C nn
003178 b998
003179 b982
00317a b854
00317b b83b
00317c 9601
00317d b123
00317e b82b      	LDRAM_PC_NODDR FROMRAM2
00317f b998
003180 b982
003181 b854
003182 b83b
003183 9601
003184 b013
003185 b82b      	LDRAM_PC_NODDR FROMRAM1
003186 ff40      	sbrs zzF,zzCF
003187 940c 0200 	jmp zCMD_start
003189 19c9
00318a 09d5
00318b b9d8
00318c b9c2
00318d b995
00318e b824
00318f 15d6
003190 985d
003191 f100
003192 b82b
003193 935f
003194 e158
003195 b955
003196 eb5f
003197 b954
003198 e050
003199 bd5d
00319a e550
00319b bd5c
00319c 9859
00319d 915f
00319e 982c
00319f 939f
0031a0 2f5d
0031a1 940e 005f
0031a3 e054
0031a4 955a
0031a5 f7f1
0031a6 2f5c
0031a7 940e 005f
0031a9 e054
0031aa 955a
0031ab f7f1
0031ac 915f
0031ad 940e 005f
0031af bc5c
0031b0 9a59
0031b1 b854
0031b2 b82b
0031b3 19c9
0031b4 09d5
0031b5 b9d8
0031b6 b9c2
0031b7 b985
0031b8 b824
0031b9 15d6
0031ba 985d
0031bb f100
0031bc b82b
0031bd 935f
0031be e158
0031bf b955
0031c0 eb5f
0031c1 b954
0031c2 e050
0031c3 bd5d
0031c4 e550
0031c5 bd5c
0031c6 9859
0031c7 915f
0031c8 982c
0031c9 938f
0031ca 2f5d
0031cb 940e 005f
0031cd e054
0031ce 955a
0031cf f7f1
0031d0 2f5c
0031d1 940e 005f
0031d3 e054
0031d4 955a
0031d5 f7f1
0031d6 915f
0031d7 940e 005f
0031d9 bc5c
0031da 9a59
0031db b854
0031dc b82b      	zzPUSH zzPCh,zzPCl
0031dd 2f82      	mov zzPCl,FROMRAM2
0031de 2d91      	mov zzPCh,FROMRAM1
                 
0031df 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_de: ; SBC  A n
0031e1 b998
0031e2 b982
0031e3 b854
0031e4 b83b
0031e5 9601
0031e6 b173
0031e7 b82b      	LDRAM_PC_NODDR FROMRAM0
0031e8 bf4f      	out SREG,zzF
0031e9 9418      	sez
0031ea 0b17      	sbc zzA,FROMRAM0
                 
0031eb b75f      	in zzTmp, SREG
0031ec 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0031ed ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0031ee 2b45      	or zzF, zzTmp ; combine flags
0031ef 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_df: ; RST   18h
0031f1 19c9
0031f2 09d5
0031f3 b9d8
0031f4 b9c2
0031f5 b995
0031f6 b824
0031f7 15d6
0031f8 985d
0031f9 f100
0031fa b82b
0031fb 935f
0031fc e158
0031fd b955
0031fe eb5f
0031ff b954
003200 e050
003201 bd5d
003202 e550
003203 bd5c
003204 9859
003205 915f
003206 982c
003207 939f
003208 2f5d
003209 940e 005f
00320b e054
00320c 955a
00320d f7f1
00320e 2f5c
00320f 940e 005f
003211 e054
003212 955a
003213 f7f1
003214 915f
003215 940e 005f
003217 bc5c
003218 9a59
003219 b854
00321a b82b
00321b 19c9
00321c 09d5
00321d b9d8
00321e b9c2
00321f b985
003220 b824
003221 15d6
003222 985d
003223 f100
003224 b82b
003225 935f
003226 e158
003227 b955
003228 eb5f
003229 b954
00322a e050
00322b bd5d
00322c e550
00322d bd5c
00322e 9859
00322f 915f
003230 982c
003231 938f
003232 2f5d
003233 940e 005f
003235 e054
003236 955a
003237 f7f1
003238 2f5c
003239 940e 005f
00323b e054
00323c 955a
00323d f7f1
00323e 915f
00323f 940e 005f
003241 bc5c
003242 9a59
003243 b854
003244 b82b      	zzPUSH zzPCh,zzPCl
003245 2799      	clr zzPCh
003246 e188      	ldi zzPCl,0x18
                 
003247 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e0: ; RET   PO
003249 fd43      	sbrc zzF,zzPF
00324a 940c 0200 	jmp zCMD_start
00324c b9d8
00324d b9c2
00324e b854
00324f b83b
003250 0000
003251 0000
003252 b183
003253 b82b
003254 0dc9
003255 1dd5
003256 b9d8
003257 b9c2
003258 b854
003259 b83b
00325a 0000
00325b 0000
00325c b193
00325d b82b
00325e 0dc9
00325f 1dd5      	zzPOP zzPCh,zzPCl
                 
003260 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e1: ; POP   IX
003262 b9d8
003263 b9c2
003264 b854
003265 b83b
003266 0000
003267 0000
003268 b103
003269 b82b
00326a 0dc9
00326b 1dd5
00326c b9d8
00326d b9c2
00326e b854
00326f b83b
003270 0000
003271 0000
003272 b083
003273 b82b
003274 0dc9
003275 1dd5      	zzPOP zzIXh,zzIXl
                 
003276 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e2: ; JP   PO nn
003278 b998
003279 b982
00327a b854
00327b b83b
00327c 9601
00327d b123
00327e b82b      	LDRAM_PC_NODDR FROMRAM2
00327f b998
003280 b982
003281 b854
003282 b83b
003283 9601
003284 b013
003285 b82b      	LDRAM_PC_NODDR FROMRAM1
003286 fd43      	sbrc zzF,zzPF
003287 940c 0200 	jmp zCMD_start
003289 2f82      	mov zzPCl,FROMRAM2
00328a 2d91      	mov zzPCh,FROMRAM1
                 
00328b 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e3: ; EX   (SP) IX
00328d 2e1d      	mov FROMRAM1,zzSPh
00328e 2f2c      	mov FROMRAM2,zzSPl
00328f b818
003290 b922
003291 b854
003292 b83b
003293 0000
003294 0000
003295 b173
003296 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
003297 2f50
003298 2f07
003299 2f75      	EXR FROMRAM0,zzIXl
00329a b818
00329b b922
00329c b975
00329d b824
00329e 1416
00329f 985d
0032a0 f100
0032a1 b82b
0032a2 935f
0032a3 e158
0032a4 b955
0032a5 eb5f
0032a6 b954
0032a7 e050
0032a8 bd5d
0032a9 e550
0032aa bd5c
0032ab 9859
0032ac 915f
0032ad 982c
0032ae 937f
0032af 2d51
0032b0 940e 005f
0032b2 e054
0032b3 955a
0032b4 f7f1
0032b5 2f52
0032b6 940e 005f
0032b8 e054
0032b9 955a
0032ba f7f1
0032bb 915f
0032bc 940e 005f
0032be bc5c
0032bf 9a59
0032c0 b854
0032c1 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0032c2 0d29
0032c3 1c15      	INC2 FROMRAM1,FROMRAM2
0032c4 b818
0032c5 b922
0032c6 b854
0032c7 b83b
0032c8 0000
0032c9 0000
0032ca b173
0032cb b82b      	LDRAM FROMRAM1,FROMRAM2,FROMRAM0
0032cc 2d58
0032cd 2e87
0032ce 2f75      	EXR FROMRAM0,zzIXh
0032cf b818
0032d0 b922
0032d1 b975
0032d2 b824
0032d3 1416
0032d4 985d
0032d5 f100
0032d6 b82b
0032d7 935f
0032d8 e158
0032d9 b955
0032da eb5f
0032db b954
0032dc e050
0032dd bd5d
0032de e550
0032df bd5c
0032e0 9859
0032e1 915f
0032e2 982c
0032e3 937f
0032e4 2d51
0032e5 940e 005f
0032e7 e054
0032e8 955a
0032e9 f7f1
0032ea 2f52
0032eb 940e 005f
0032ed e054
0032ee 955a
0032ef f7f1
0032f0 915f
0032f1 940e 005f
0032f3 bc5c
0032f4 9a59
0032f5 b854
0032f6 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
                 	
                 
0032f7 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e4: ; CALL PO nn
0032f9 b998
0032fa b982
0032fb b854
0032fc b83b
0032fd 9601
0032fe b123
0032ff b82b      	LDRAM_PC_NODDR FROMRAM2
003300 b998
003301 b982
003302 b854
003303 b83b
003304 9601
003305 b013
003306 b82b      	LDRAM_PC_NODDR FROMRAM1
003307 fd43      	sbrc zzF,zzPF
003308 940c 0200 	jmp zCMD_start
00330a 19c9
00330b 09d5
00330c b9d8
00330d b9c2
00330e b995
00330f b824
003310 15d6
003311 985d
003312 f100
003313 b82b
003314 935f
003315 e158
003316 b955
003317 eb5f
003318 b954
003319 e050
00331a bd5d
00331b e550
00331c bd5c
00331d 9859
00331e 915f
00331f 982c
003320 939f
003321 2f5d
003322 940e 005f
003324 e054
003325 955a
003326 f7f1
003327 2f5c
003328 940e 005f
00332a e054
00332b 955a
00332c f7f1
00332d 915f
00332e 940e 005f
003330 bc5c
003331 9a59
003332 b854
003333 b82b
003334 19c9
003335 09d5
003336 b9d8
003337 b9c2
003338 b985
003339 b824
00333a 15d6
00333b 985d
00333c f100
00333d b82b
00333e 935f
00333f e158
003340 b955
003341 eb5f
003342 b954
003343 e050
003344 bd5d
003345 e550
003346 bd5c
003347 9859
003348 915f
003349 982c
00334a 938f
00334b 2f5d
00334c 940e 005f
00334e e054
00334f 955a
003350 f7f1
003351 2f5c
003352 940e 005f
003354 e054
003355 955a
003356 f7f1
003357 915f
003358 940e 005f
00335a bc5c
00335b 9a59
00335c b854
00335d b82b      	zzPUSH zzPCh,zzPCl
00335e 2f82      	mov zzPCl,FROMRAM2
00335f 2d91      	mov zzPCh,FROMRAM1
                 
003360 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e5: ; PUSH  IX
003362 19c9
003363 09d5
003364 b9d8
003365 b9c2
003366 b885
003367 b824
003368 15d6
003369 985d
00336a f100
00336b b82b
00336c 935f
00336d e158
00336e b955
00336f eb5f
003370 b954
003371 e050
003372 bd5d
003373 e550
003374 bd5c
003375 9859
003376 915f
003377 982c
003378 928f
003379 2f5d
00337a 940e 005f
00337c e054
00337d 955a
00337e f7f1
00337f 2f5c
003380 940e 005f
003382 e054
003383 955a
003384 f7f1
003385 915f
003386 940e 005f
003388 bc5c
003389 9a59
00338a b854
00338b b82b
00338c 19c9
00338d 09d5
00338e b9d8
00338f b9c2
003390 b905
003391 b824
003392 15d6
003393 985d
003394 f100
003395 b82b
003396 935f
003397 e158
003398 b955
003399 eb5f
00339a b954
00339b e050
00339c bd5d
00339d e550
00339e bd5c
00339f 9859
0033a0 915f
0033a1 982c
0033a2 930f
0033a3 2f5d
0033a4 940e 005f
0033a6 e054
0033a7 955a
0033a8 f7f1
0033a9 2f5c
0033aa 940e 005f
0033ac e054
0033ad 955a
0033ae f7f1
0033af 915f
0033b0 940e 005f
0033b2 bc5c
0033b3 9a59
0033b4 b854
0033b5 b82b      	zzPUSH zzIXh,zzIXl
                 
0033b6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e6: ; AND  A n
0033b8 b998
0033b9 b982
0033ba b854
0033bb b83b
0033bc 9601
0033bd b173
0033be b82b      	LDRAM_PC_NODDR FROMRAM0
0033bf 2317      	and zzA,FROMRAM0
                 
0033c0 b75f      	in zzTmp, SREG
0033c1 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
0033c2 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
0033c3 2b45      	or zzF, zzTmp ; combine flags
0033c4 e1b8
0033c5 2fa1
0033c6 915c
0033c7 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0033c8 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e7: ; RST   20h
0033ca 19c9
0033cb 09d5
0033cc b9d8
0033cd b9c2
0033ce b995
0033cf b824
0033d0 15d6
0033d1 985d
0033d2 f100
0033d3 b82b
0033d4 935f
0033d5 e158
0033d6 b955
0033d7 eb5f
0033d8 b954
0033d9 e050
0033da bd5d
0033db e550
0033dc bd5c
0033dd 9859
0033de 915f
0033df 982c
0033e0 939f
0033e1 2f5d
0033e2 940e 005f
0033e4 e054
0033e5 955a
0033e6 f7f1
0033e7 2f5c
0033e8 940e 005f
0033ea e054
0033eb 955a
0033ec f7f1
0033ed 915f
0033ee 940e 005f
0033f0 bc5c
0033f1 9a59
0033f2 b854
0033f3 b82b
0033f4 19c9
0033f5 09d5
0033f6 b9d8
0033f7 b9c2
0033f8 b985
0033f9 b824
0033fa 15d6
0033fb 985d
0033fc f100
0033fd b82b
0033fe 935f
0033ff e158
003400 b955
003401 eb5f
003402 b954
003403 e050
003404 bd5d
003405 e550
003406 bd5c
003407 9859
003408 915f
003409 982c
00340a 938f
00340b 2f5d
00340c 940e 005f
00340e e054
00340f 955a
003410 f7f1
003411 2f5c
003412 940e 005f
003414 e054
003415 955a
003416 f7f1
003417 915f
003418 940e 005f
00341a bc5c
00341b 9a59
00341c b854
00341d b82b      	zzPUSH zzPCh,zzPCl
00341e 2799      	clr zzPCh
00341f e280      	ldi zzPCl,0x20
                 
003420 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e8: ; RET   PE
003422 ff43      	sbrs zzF,zzPF
003423 940c 0200 	jmp zCMD_start
003425 b9d8
003426 b9c2
003427 b854
003428 b83b
003429 0000
00342a 0000
00342b b183
00342c b82b
00342d 0dc9
00342e 1dd5
00342f b9d8
003430 b9c2
003431 b854
003432 b83b
003433 0000
003434 0000
003435 b193
003436 b82b
003437 0dc9
003438 1dd5      	zzPOP zzPCh,zzPCl
                 
003439 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_e9: ; JP   * IX
00343b 1055      	cpse ZERO,ZERO
00343c 940c 0200 	jmp zCMD_start
00343e 2f80      	mov zzPCl,zzIXl
00343f 2d98      	mov zzPCh,zzIXh
                 
003440 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ea: ; JP   PE nn
003442 b998
003443 b982
003444 b854
003445 b83b
003446 9601
003447 b123
003448 b82b      	LDRAM_PC_NODDR FROMRAM2
003449 b998
00344a b982
00344b b854
00344c b83b
00344d 9601
00344e b013
00344f b82b      	LDRAM_PC_NODDR FROMRAM1
003450 ff43      	sbrs zzF,zzPF
003451 940c 0200 	jmp zCMD_start
003453 2f82      	mov zzPCl,FROMRAM2
003454 2d91      	mov zzPCh,FROMRAM1
                 
003455 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_eb: ; EX   DE IX
003457 2d58
003458 2c8c
003459 2ec5      	EXR zzD,zzIXh
00345a 2f50
00345b 2d0d
00345c 2ed5      	EXR zzE,zzIXl
                 	
                 
00345d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ec: ; CALL PE nn
00345f b998
003460 b982
003461 b854
003462 b83b
003463 9601
003464 b123
003465 b82b      	LDRAM_PC_NODDR FROMRAM2
003466 b998
003467 b982
003468 b854
003469 b83b
00346a 9601
00346b b013
00346c b82b      	LDRAM_PC_NODDR FROMRAM1
00346d ff43      	sbrs zzF,zzPF
00346e 940c 0200 	jmp zCMD_start
003470 19c9
003471 09d5
003472 b9d8
003473 b9c2
003474 b995
003475 b824
003476 15d6
003477 985d
003478 f100
003479 b82b
00347a 935f
00347b e158
00347c b955
00347d eb5f
00347e b954
00347f e050
003480 bd5d
003481 e550
003482 bd5c
003483 9859
003484 915f
003485 982c
003486 939f
003487 2f5d
003488 940e 005f
00348a e054
00348b 955a
00348c f7f1
00348d 2f5c
00348e 940e 005f
003490 e054
003491 955a
003492 f7f1
003493 915f
003494 940e 005f
003496 bc5c
003497 9a59
003498 b854
003499 b82b
00349a 19c9
00349b 09d5
00349c b9d8
00349d b9c2
00349e b985
00349f b824
0034a0 15d6
0034a1 985d
0034a2 f100
0034a3 b82b
0034a4 935f
0034a5 e158
0034a6 b955
0034a7 eb5f
0034a8 b954
0034a9 e050
0034aa bd5d
0034ab e550
0034ac bd5c
0034ad 9859
0034ae 915f
0034af 982c
0034b0 938f
0034b1 2f5d
0034b2 940e 005f
0034b4 e054
0034b5 955a
0034b6 f7f1
0034b7 2f5c
0034b8 940e 005f
0034ba e054
0034bb 955a
0034bc f7f1
0034bd 915f
0034be 940e 005f
0034c0 bc5c
0034c1 9a59
0034c2 b854
0034c3 b82b      	zzPUSH zzPCh,zzPCl
0034c4 2f82      	mov zzPCl,FROMRAM2
0034c5 2d91      	mov zzPCh,FROMRAM1
                 
0034c6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ee: ; XOR  A n
0034c8 b998
0034c9 b982
0034ca b854
0034cb b83b
0034cc 9601
0034cd b173
0034ce b82b      	LDRAM_PC_NODDR FROMRAM0
0034cf 2717      	eor zzA,FROMRAM0
                 
0034d0 b74f      	in zzF, SREG
0034d1 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0034d2 e1b8
0034d3 2fa1
0034d4 915c
0034d5 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0034d6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ef: ; RST   28h
0034d8 19c9
0034d9 09d5
0034da b9d8
0034db b9c2
0034dc b995
0034dd b824
0034de 15d6
0034df 985d
0034e0 f100
0034e1 b82b
0034e2 935f
0034e3 e158
0034e4 b955
0034e5 eb5f
0034e6 b954
0034e7 e050
0034e8 bd5d
0034e9 e550
0034ea bd5c
0034eb 9859
0034ec 915f
0034ed 982c
0034ee 939f
0034ef 2f5d
0034f0 940e 005f
0034f2 e054
0034f3 955a
0034f4 f7f1
0034f5 2f5c
0034f6 940e 005f
0034f8 e054
0034f9 955a
0034fa f7f1
0034fb 915f
0034fc 940e 005f
0034fe bc5c
0034ff 9a59
003500 b854
003501 b82b
003502 19c9
003503 09d5
003504 b9d8
003505 b9c2
003506 b985
003507 b824
003508 15d6
003509 985d
00350a f100
00350b b82b
00350c 935f
00350d e158
00350e b955
00350f eb5f
003510 b954
003511 e050
003512 bd5d
003513 e550
003514 bd5c
003515 9859
003516 915f
003517 982c
003518 938f
003519 2f5d
00351a 940e 005f
00351c e054
00351d 955a
00351e f7f1
00351f 2f5c
003520 940e 005f
003522 e054
003523 955a
003524 f7f1
003525 915f
003526 940e 005f
003528 bc5c
003529 9a59
00352a b854
00352b b82b      	zzPUSH zzPCh,zzPCl
00352c 2799      	clr zzPCh
00352d e288      	ldi zzPCl,0x28
                 
00352e 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f0: ; RET   P
003530 fd42      	sbrc zzF,zzSF
003531 940c 0200 	jmp zCMD_start
003533 b9d8
003534 b9c2
003535 b854
003536 b83b
003537 0000
003538 0000
003539 b183
00353a b82b
00353b 0dc9
00353c 1dd5
00353d b9d8
00353e b9c2
00353f b854
003540 b83b
003541 0000
003542 0000
003543 b193
003544 b82b
003545 0dc9
003546 1dd5      	zzPOP zzPCh,zzPCl
                 
003547 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f1: ; POP   AF
003549 b9d8
00354a b9c2
00354b b854
00354c b83b
00354d 0000
00354e 0000
00354f b173
003550 b82b
003551 0dc9
003552 1dd5
003553 b9d8
003554 b9c2
003555 b854
003556 b83b
003557 0000
003558 0000
003559 b113
00355a b82b
00355b 0dc9
00355c 1dd5      	zzPOP zzA,FROMRAM0
00355d e1ba      	ldi Xh,high(FZ2ATABLE)
00355e 2fa7      	mov Xl,FROMRAM0
00355f 914c      	ld zzF,X
                 
003560 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f2: ; JP   P nn
003562 b998
003563 b982
003564 b854
003565 b83b
003566 9601
003567 b123
003568 b82b      	LDRAM_PC_NODDR FROMRAM2
003569 b998
00356a b982
00356b b854
00356c b83b
00356d 9601
00356e b013
00356f b82b      	LDRAM_PC_NODDR FROMRAM1
003570 fd42      	sbrc zzF,zzSF
003571 940c 0200 	jmp zCMD_start
003573 2f82      	mov zzPCl,FROMRAM2
003574 2d91      	mov zzPCh,FROMRAM1
                 
003575 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f3: ; DI    
003577 e050
003578 9350 0909 	zzSET zzIFF1,0
00357a e050
00357b 9350 090a 	zzSET zzIFF2,0
                 
00357d 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f4: ; CALL P nn
00357f b998
003580 b982
003581 b854
003582 b83b
003583 9601
003584 b123
003585 b82b      	LDRAM_PC_NODDR FROMRAM2
003586 b998
003587 b982
003588 b854
003589 b83b
00358a 9601
00358b b013
00358c b82b      	LDRAM_PC_NODDR FROMRAM1
00358d fd42      	sbrc zzF,zzSF
00358e 940c 0200 	jmp zCMD_start
003590 19c9
003591 09d5
003592 b9d8
003593 b9c2
003594 b995
003595 b824
003596 15d6
003597 985d
003598 f100
003599 b82b
00359a 935f
00359b e158
00359c b955
00359d eb5f
00359e b954
00359f e050
0035a0 bd5d
0035a1 e550
0035a2 bd5c
0035a3 9859
0035a4 915f
0035a5 982c
0035a6 939f
0035a7 2f5d
0035a8 940e 005f
0035aa e054
0035ab 955a
0035ac f7f1
0035ad 2f5c
0035ae 940e 005f
0035b0 e054
0035b1 955a
0035b2 f7f1
0035b3 915f
0035b4 940e 005f
0035b6 bc5c
0035b7 9a59
0035b8 b854
0035b9 b82b
0035ba 19c9
0035bb 09d5
0035bc b9d8
0035bd b9c2
0035be b985
0035bf b824
0035c0 15d6
0035c1 985d
0035c2 f100
0035c3 b82b
0035c4 935f
0035c5 e158
0035c6 b955
0035c7 eb5f
0035c8 b954
0035c9 e050
0035ca bd5d
0035cb e550
0035cc bd5c
0035cd 9859
0035ce 915f
0035cf 982c
0035d0 938f
0035d1 2f5d
0035d2 940e 005f
0035d4 e054
0035d5 955a
0035d6 f7f1
0035d7 2f5c
0035d8 940e 005f
0035da e054
0035db 955a
0035dc f7f1
0035dd 915f
0035de 940e 005f
0035e0 bc5c
0035e1 9a59
0035e2 b854
0035e3 b82b      	zzPUSH zzPCh,zzPCl
0035e4 2f82      	mov zzPCl,FROMRAM2
0035e5 2d91      	mov zzPCh,FROMRAM1
                 
0035e6 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f5: ; PUSH  AF
0035e8 e1b9      	ldi Xh,high(FA2ZTABLE)
0035e9 2fa4      	mov Xl,zzF
0035ea 917c      	ld FROMRAM0,X
0035eb 19c9
0035ec 09d5
0035ed b9d8
0035ee b9c2
0035ef b915
0035f0 b824
0035f1 15d6
0035f2 985d
0035f3 f100
0035f4 b82b
0035f5 935f
0035f6 e158
0035f7 b955
0035f8 eb5f
0035f9 b954
0035fa e050
0035fb bd5d
0035fc e550
0035fd bd5c
0035fe 9859
0035ff 915f
003600 982c
003601 931f
003602 2f5d
003603 940e 005f
003605 e054
003606 955a
003607 f7f1
003608 2f5c
003609 940e 005f
00360b e054
00360c 955a
00360d f7f1
00360e 915f
00360f 940e 005f
003611 bc5c
003612 9a59
003613 b854
003614 b82b
003615 19c9
003616 09d5
003617 b9d8
003618 b9c2
003619 b975
00361a b824
00361b 15d6
00361c 985d
00361d f100
00361e b82b
00361f 935f
003620 e158
003621 b955
003622 eb5f
003623 b954
003624 e050
003625 bd5d
003626 e550
003627 bd5c
003628 9859
003629 915f
00362a 982c
00362b 937f
00362c 2f5d
00362d 940e 005f
00362f e054
003630 955a
003631 f7f1
003632 2f5c
003633 940e 005f
003635 e054
003636 955a
003637 f7f1
003638 915f
003639 940e 005f
00363b bc5c
00363c 9a59
00363d b854
00363e b82b      	zzPUSH zzA,FROMRAM0
                 
00363f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f6: ; OR   A n
003641 b998
003642 b982
003643 b854
003644 b83b
003645 9601
003646 b173
003647 b82b      	LDRAM_PC_NODDR FROMRAM0
003648 2b17      	or zzA,FROMRAM0
                 
003649 b74f      	in zzF, SREG
00364a 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
00364b e1b8
00364c 2fa1
00364d 915c
00364e 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00364f 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f7: ; RST   30h
003651 19c9
003652 09d5
003653 b9d8
003654 b9c2
003655 b995
003656 b824
003657 15d6
003658 985d
003659 f100
00365a b82b
00365b 935f
00365c e158
00365d b955
00365e eb5f
00365f b954
003660 e050
003661 bd5d
003662 e550
003663 bd5c
003664 9859
003665 915f
003666 982c
003667 939f
003668 2f5d
003669 940e 005f
00366b e054
00366c 955a
00366d f7f1
00366e 2f5c
00366f 940e 005f
003671 e054
003672 955a
003673 f7f1
003674 915f
003675 940e 005f
003677 bc5c
003678 9a59
003679 b854
00367a b82b
00367b 19c9
00367c 09d5
00367d b9d8
00367e b9c2
00367f b985
003680 b824
003681 15d6
003682 985d
003683 f100
003684 b82b
003685 935f
003686 e158
003687 b955
003688 eb5f
003689 b954
00368a e050
00368b bd5d
00368c e550
00368d bd5c
00368e 9859
00368f 915f
003690 982c
003691 938f
003692 2f5d
003693 940e 005f
003695 e054
003696 955a
003697 f7f1
003698 2f5c
003699 940e 005f
00369b e054
00369c 955a
00369d f7f1
00369e 915f
00369f 940e 005f
0036a1 bc5c
0036a2 9a59
0036a3 b854
0036a4 b82b      	zzPUSH zzPCh,zzPCl
0036a5 2799      	clr zzPCh
0036a6 e380      	ldi zzPCl,0x30
                 
0036a7 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f8: ; RET   M
0036a9 ff42      	sbrs zzF,zzSF
0036aa 940c 0200 	jmp zCMD_start
0036ac b9d8
0036ad b9c2
0036ae b854
0036af b83b
0036b0 0000
0036b1 0000
0036b2 b183
0036b3 b82b
0036b4 0dc9
0036b5 1dd5
0036b6 b9d8
0036b7 b9c2
0036b8 b854
0036b9 b83b
0036ba 0000
0036bb 0000
0036bc b193
0036bd b82b
0036be 0dc9
0036bf 1dd5      	zzPOP zzPCh,zzPCl
                 
0036c0 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_f9: ; LD   SP IX
0036c2 2dd8      	mov zzSPh, zzIXh
0036c3 2fc0      	mov zzSPl, zzIXl
                 
0036c4 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_fa: ; JP   M nn
0036c6 b998
0036c7 b982
0036c8 b854
0036c9 b83b
0036ca 9601
0036cb b123
0036cc b82b      	LDRAM_PC_NODDR FROMRAM2
0036cd b998
0036ce b982
0036cf b854
0036d0 b83b
0036d1 9601
0036d2 b013
0036d3 b82b      	LDRAM_PC_NODDR FROMRAM1
0036d4 ff42      	sbrs zzF,zzSF
0036d5 940c 0200 	jmp zCMD_start
0036d7 2f82      	mov zzPCl,FROMRAM2
0036d8 2d91      	mov zzPCh,FROMRAM1
                 
0036d9 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_fb: ; EI    
0036db e051
0036dc 9350 0909 	zzSET zzIFF1,1
0036de e051
0036df 9350 090a 	zzSET zzIFF2,1
                 
0036e1 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_fc: ; CALL M nn
0036e3 b998
0036e4 b982
0036e5 b854
0036e6 b83b
0036e7 9601
0036e8 b123
0036e9 b82b      	LDRAM_PC_NODDR FROMRAM2
0036ea b998
0036eb b982
0036ec b854
0036ed b83b
0036ee 9601
0036ef b013
0036f0 b82b      	LDRAM_PC_NODDR FROMRAM1
0036f1 ff42      	sbrs zzF,zzSF
0036f2 940c 0200 	jmp zCMD_start
0036f4 19c9
0036f5 09d5
0036f6 b9d8
0036f7 b9c2
0036f8 b995
0036f9 b824
0036fa 15d6
0036fb 985d
0036fc f100
0036fd b82b
0036fe 935f
0036ff e158
003700 b955
003701 eb5f
003702 b954
003703 e050
003704 bd5d
003705 e550
003706 bd5c
003707 9859
003708 915f
003709 982c
00370a 939f
00370b 2f5d
00370c 940e 005f
00370e e054
00370f 955a
003710 f7f1
003711 2f5c
003712 940e 005f
003714 e054
003715 955a
003716 f7f1
003717 915f
003718 940e 005f
00371a bc5c
00371b 9a59
00371c b854
00371d b82b
00371e 19c9
00371f 09d5
003720 b9d8
003721 b9c2
003722 b985
003723 b824
003724 15d6
003725 985d
003726 f100
003727 b82b
003728 935f
003729 e158
00372a b955
00372b eb5f
00372c b954
00372d e050
00372e bd5d
00372f e550
003730 bd5c
003731 9859
003732 915f
003733 982c
003734 938f
003735 2f5d
003736 940e 005f
003738 e054
003739 955a
00373a f7f1
00373b 2f5c
00373c 940e 005f
00373e e054
00373f 955a
003740 f7f1
003741 915f
003742 940e 005f
003744 bc5c
003745 9a59
003746 b854
003747 b82b      	zzPUSH zzPCh,zzPCl
003748 2f82      	mov zzPCl,FROMRAM2
003749 2d91      	mov zzPCh,FROMRAM1
                 
00374a 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_fe: ; CP   A n
00374c b998
00374d b982
00374e b854
00374f b83b
003750 9601
003751 b173
003752 b82b      	LDRAM_PC_NODDR FROMRAM0
003753 1717      	cp zzA,FROMRAM0
                 
003754 b75f      	in zzTmp, SREG
003755 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003756 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003757 2b45      	or zzF, zzTmp ; combine flags
003758 940c 0200 	jmp zCMD_start
                 
                 zCMDDD_ff: ; RST   38h
00375a 19c9
00375b 09d5
00375c b9d8
00375d b9c2
00375e b995
00375f b824
003760 15d6
003761 985d
003762 f100
003763 b82b
003764 935f
003765 e158
003766 b955
003767 eb5f
003768 b954
003769 e050
00376a bd5d
00376b e550
00376c bd5c
00376d 9859
00376e 915f
00376f 982c
003770 939f
003771 2f5d
003772 940e 005f
003774 e054
003775 955a
003776 f7f1
003777 2f5c
003778 940e 005f
00377a e054
00377b 955a
00377c f7f1
00377d 915f
00377e 940e 005f
003780 bc5c
003781 9a59
003782 b854
003783 b82b
003784 19c9
003785 09d5
003786 b9d8
003787 b9c2
003788 b985
003789 b824
00378a 15d6
00378b 985d
00378c f100
00378d b82b
00378e 935f
00378f e158
003790 b955
003791 eb5f
003792 b954
003793 e050
003794 bd5d
003795 e550
003796 bd5c
003797 9859
003798 915f
003799 982c
00379a 938f
00379b 2f5d
00379c 940e 005f
00379e e054
00379f 955a
0037a0 f7f1
0037a1 2f5c
0037a2 940e 005f
0037a4 e054
0037a5 955a
0037a6 f7f1
0037a7 915f
0037a8 940e 005f
0037aa bc5c
0037ab 9a59
0037ac b854
0037ad b82b      	zzPUSH zzPCh,zzPCl
0037ae 2799      	clr zzPCh
0037af e388      	ldi zzPCl,0x38
                 
0037b0 940c 0200 	jmp zCMD_start
                 
                 zCMDED_00: ; BIOS 0 
0037b2 e050      	ldi zzTmp, 0x00
0037b3 940e 7200 	call BIOS
                 
0037b5 940c 0200 	jmp zCMD_start
                 
                 zCMDED_01: ; BIOS 1 
0037b7 e051      	ldi zzTmp, 0x01
0037b8 940e 7200 	call BIOS
                 
0037ba 940c 0200 	jmp zCMD_start
                 
                 zCMDED_02: ; BIOS 2 
0037bc e052      	ldi zzTmp, 0x02
0037bd 940e 7200 	call BIOS
                 
0037bf 940c 0200 	jmp zCMD_start
                 
                 zCMDED_03: ; BIOS 3 
0037c1 e053      	ldi zzTmp, 0x03
0037c2 940e 7200 	call BIOS
                 
0037c4 940c 0200 	jmp zCMD_start
                 
                 zCMDED_04: ; BIOS 4 
0037c6 e054      	ldi zzTmp, 0x04
0037c7 940e 7200 	call BIOS
                 
0037c9 940c 0200 	jmp zCMD_start
                 
                 zCMDED_05: ; BIOS 5 
0037cb e055      	ldi zzTmp, 0x05
0037cc 940e 7200 	call BIOS
                 
0037ce 940c 0200 	jmp zCMD_start
                 
                 zCMDED_06: ; BIOS 6 
0037d0 e056      	ldi zzTmp, 0x06
0037d1 940e 7200 	call BIOS
                 
0037d3 940c 0200 	jmp zCMD_start
                 
                 zCMDED_07: ; BIOS 7 
0037d5 e057      	ldi zzTmp, 0x07
0037d6 940e 7200 	call BIOS
                 
0037d8 940c 0200 	jmp zCMD_start
                 
                 zCMDED_08: ; BIOS 8 
0037da e058      	ldi zzTmp, 0x08
0037db 940e 7200 	call BIOS
                 
0037dd 940c 0200 	jmp zCMD_start
                 
                 zCMDED_09: ; BIOS 9 
0037df e059      	ldi zzTmp, 0x09
0037e0 940e 7200 	call BIOS
                 
0037e2 940c 0200 	jmp zCMD_start
                 
                 zCMDED_0a: ; BIOS 10 
0037e4 e05a      	ldi zzTmp, 0x0a
0037e5 940e 7200 	call BIOS
                 
0037e7 940c 0200 	jmp zCMD_start
                 
                 zCMDED_0b: ; BIOS 11 
0037e9 e05b      	ldi zzTmp, 0x0b
0037ea 940e 7200 	call BIOS
                 
0037ec 940c 0200 	jmp zCMD_start
                 
                 zCMDED_0c: ; BIOS 12 
0037ee e05c      	ldi zzTmp, 0x0c
0037ef 940e 7200 	call BIOS
                 
0037f1 940c 0200 	jmp zCMD_start
                 
                 zCMDED_0d: ; BIOS 13 
0037f3 e05d      	ldi zzTmp, 0x0d
0037f4 940e 7200 	call BIOS
                 
0037f6 940c 0200 	jmp zCMD_start
                 
                 zCMDED_0e: ; BIOS 14 
0037f8 e05e      	ldi zzTmp, 0x0e
0037f9 940e 7200 	call BIOS
                 
0037fb 940c 0200 	jmp zCMD_start
                 
                 zCMDED_0f: ; BIOS 15 
0037fd e05f      	ldi zzTmp, 0x0f
0037fe 940e 7200 	call BIOS
                 
003800 940c 0200 	jmp zCMD_start
                 
                 zCMDED_10: ; BIOS 16 
003802 e150      	ldi zzTmp, 0x10
003803 940e 7200 	call BIOS
                 
003805 940c 0200 	jmp zCMD_start
                 
                 zCMDED_11: ; BIOS 17 
003807 e151      	ldi zzTmp, 0x11
003808 940e 7200 	call BIOS
                 
00380a 940c 0200 	jmp zCMD_start
                 
                 zCMDED_12: ; BIOS 18 
00380c e152      	ldi zzTmp, 0x12
00380d 940e 7200 	call BIOS
                 
00380f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_13: ; BIOS 19 
003811 e153      	ldi zzTmp, 0x13
003812 940e 7200 	call BIOS
                 
003814 940c 0200 	jmp zCMD_start
                 
                 zCMDED_14: ; BIOS 20 
003816 e154      	ldi zzTmp, 0x14
003817 940e 7200 	call BIOS
                 
003819 940c 0200 	jmp zCMD_start
                 
                 zCMDED_15: ; BIOS 21 
00381b e155      	ldi zzTmp, 0x15
00381c 940e 7200 	call BIOS
                 
00381e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_16: ; BIOS 22 
003820 e156      	ldi zzTmp, 0x16
003821 940e 7200 	call BIOS
                 
003823 940c 0200 	jmp zCMD_start
                 
                 zCMDED_17: ; BIOS 23 
003825 e157      	ldi zzTmp, 0x17
003826 940e 7200 	call BIOS
                 
003828 940c 0200 	jmp zCMD_start
                 
                 zCMDED_18: ; BIOS 24 
00382a e158      	ldi zzTmp, 0x18
00382b 940e 7200 	call BIOS
                 
00382d 940c 0200 	jmp zCMD_start
                 
                 zCMDED_19: ; BIOS 25 
00382f e159      	ldi zzTmp, 0x19
003830 940e 7200 	call BIOS
                 
003832 940c 0200 	jmp zCMD_start
                 
                 zCMDED_1a: ; BIOS 26 
003834 e15a      	ldi zzTmp, 0x1a
003835 940e 7200 	call BIOS
                 
003837 940c 0200 	jmp zCMD_start
                 
                 zCMDED_1b: ; BIOS 27 
003839 e15b      	ldi zzTmp, 0x1b
00383a 940e 7200 	call BIOS
                 
00383c 940c 0200 	jmp zCMD_start
                 
                 zCMDED_1c: ; BIOS 28 
00383e e15c      	ldi zzTmp, 0x1c
00383f 940e 7200 	call BIOS
                 
003841 940c 0200 	jmp zCMD_start
                 
                 zCMDED_1d: ; BIOS 29 
003843 e15d      	ldi zzTmp, 0x1d
003844 940e 7200 	call BIOS
                 
003846 940c 0200 	jmp zCMD_start
                 
                 zCMDED_1e: ; BIOS 30 
003848 e15e      	ldi zzTmp, 0x1e
003849 940e 7200 	call BIOS
                 
00384b 940c 0200 	jmp zCMD_start
                 
                 zCMDED_1f: ; BIOS 31 
00384d e15f      	ldi zzTmp, 0x1f
00384e 940e 7200 	call BIOS
                 
003850 940c 0200 	jmp zCMD_start
                 
                 zCMDED_20: ; BIOS 32 
003852 e250      	ldi zzTmp, 0x20
003853 940e 7200 	call BIOS
                 
003855 940c 0200 	jmp zCMD_start
                 
                 zCMDED_21: ; BIOS 33 
003857 e251      	ldi zzTmp, 0x21
003858 940e 7200 	call BIOS
                 
00385a 940c 0200 	jmp zCMD_start
                 
                 zCMDED_22: ; BIOS 34 
00385c e252      	ldi zzTmp, 0x22
00385d 940e 7200 	call BIOS
                 
00385f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_23: ; BIOS 35 
003861 e253      	ldi zzTmp, 0x23
003862 940e 7200 	call BIOS
                 
003864 940c 0200 	jmp zCMD_start
                 
                 zCMDED_24: ; BIOS 36 
003866 e254      	ldi zzTmp, 0x24
003867 940e 7200 	call BIOS
                 
003869 940c 0200 	jmp zCMD_start
                 
                 zCMDED_25: ; BIOS 37 
00386b e255      	ldi zzTmp, 0x25
00386c 940e 7200 	call BIOS
                 
00386e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_26: ; BIOS 38 
003870 e256      	ldi zzTmp, 0x26
003871 940e 7200 	call BIOS
                 
003873 940c 0200 	jmp zCMD_start
                 
                 zCMDED_27: ; BDOS  
003875 940e 7204 	call BDOS
                 
003877 940c 0200 	jmp zCMD_start
                 
                 zCMDED_40: ; IN   B (C)
003879 2f56      	mov zzTmp,zzC
00387a 940e 7206 	call PORTIN
00387c 2ea5      	mov zzB,zzTmp
                 
00387d 940c 0200 	jmp zCMD_start
                 
                 zCMDED_41: ; OUT  (C) B
00387f 2f56      	mov zzTmp,zzC
003880 92a0 090e 	sts CDATA,zzB
003882 940e 7208 	call PORTOUT
                 
003884 940c 0200 	jmp zCMD_start
                 
                 zCMDED_42: ; SBC  HL BC
003886 bf4f      	out SREG,zzF
003887 0af6      	sbc zzL,zzC
003888 08ea      	sbc zzH,zzB
003889 b75f      	in zzTmp,SREG
00388a 7f5d      	cbr zzTmp,1<<zzZF
00388b 92ff      	push zzL
00388c 28fe      	or zzL,zzH
00388d f409      	brne zzCMDED_42_1
00388e 6052      	sbr zzTmp,1<<zzZF
00388f 90ff      	zzCMDED_42_1:pop zzL
003890 bf5f      	out SREG,zzTmp
                 
003891 b75f      	in zzTmp, SREG
003892 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003893 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003894 2b45      	or zzF, zzTmp ; combine flags
003895 940c 0200 	jmp zCMD_start
                 
                 zCMDED_43: ; LD   (ww) BC
                 	
                 
003897 b998
003898 b982
003899 b854
00389a b83b
00389b 9601
00389c b123
00389d b82b      	LDRAM_PC_NODDR FROMRAM2
00389e b998
00389f b982
0038a0 b854
0038a1 b83b
0038a2 9601
0038a3 b013
0038a4 b82b      	LDRAM_PC_NODDR FROMRAM1
0038a5 b818
0038a6 b922
0038a7 b965
0038a8 b824
0038a9 1416
0038aa 985d
0038ab f100
0038ac b82b
0038ad 935f
0038ae e158
0038af b955
0038b0 eb5f
0038b1 b954
0038b2 e050
0038b3 bd5d
0038b4 e550
0038b5 bd5c
0038b6 9859
0038b7 915f
0038b8 982c
0038b9 936f
0038ba 2d51
0038bb 940e 005f
0038bd e054
0038be 955a
0038bf f7f1
0038c0 2f52
0038c1 940e 005f
0038c3 e054
0038c4 955a
0038c5 f7f1
0038c6 915f
0038c7 940e 005f
0038c9 bc5c
0038ca 9a59
0038cb b854
0038cc b82b      	STRAM FROMRAM1,FROMRAM2,zzC
0038cd 0d29
0038ce 1c15      	INC2 FROMRAM1,FROMRAM2
0038cf b818
0038d0 b922
0038d1 b8a5
0038d2 b824
0038d3 1416
0038d4 985d
0038d5 f100
0038d6 b82b
0038d7 935f
0038d8 e158
0038d9 b955
0038da eb5f
0038db b954
0038dc e050
0038dd bd5d
0038de e550
0038df bd5c
0038e0 9859
0038e1 915f
0038e2 982c
0038e3 92af
0038e4 2d51
0038e5 940e 005f
0038e7 e054
0038e8 955a
0038e9 f7f1
0038ea 2f52
0038eb 940e 005f
0038ed e054
0038ee 955a
0038ef f7f1
0038f0 915f
0038f1 940e 005f
0038f3 bc5c
0038f4 9a59
0038f5 b854
0038f6 b82b      	STRAM FROMRAM1,FROMRAM2,zzB
0038f7 940c 0200 	jmp zCMD_start
                 
                 zCMDED_44: ; NEG   A
0038f9 9511      	neg zzA
                 
0038fa b75f      	in zzTmp, SREG
0038fb 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0038fc ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0038fd 2b45      	or zzF, zzTmp ; combine flags
0038fe 940c 0200 	jmp zCMD_start
                 
                 zCMDED_45: ; RETN  
003900 9150 090a 	lds zzTmp,zzIFF2
003902 9350 0909 	sts zzIFF1,zzTmp
003904 b9d8
003905 b9c2
003906 b854
003907 b83b
003908 0000
003909 0000
00390a b183
00390b b82b
00390c 0dc9
00390d 1dd5
00390e b9d8
00390f b9c2
003910 b854
003911 b83b
003912 0000
003913 0000
003914 b193
003915 b82b
003916 0dc9
003917 1dd5      	zzPOP zzPCh,zzPCl
003918 940c 7000 	jmp EXTINTRPOC_RETI
                 
00391a 940c 0200 	jmp zCMD_start
                 
                 zCMDED_46: ; IM    0
00391c e050
00391d 9350 090b 	zzSET zzIM,0
                 
00391f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_47: ; LD   I A
003921 2f71      	mov FROMRAM0,zzA
                 
003922 9310 0900 	sts zzI,zzA
003924 940c 0200 	jmp zCMD_start
                 
                 zCMDED_48: ; IN   C (C)
003926 2f56      	mov zzTmp,zzC
003927 940e 7206 	call PORTIN
003929 2f65      	mov zzC,zzTmp
                 
00392a 940c 0200 	jmp zCMD_start
                 
                 zCMDED_49: ; OUT  (C) C
00392c 2f56      	mov zzTmp,zzC
00392d 9360 090e 	sts CDATA,zzC
00392f 940e 7208 	call PORTOUT
                 
003931 940c 0200 	jmp zCMD_start
                 
                 zCMDED_4a: ; ADC  HL BC
003933 bf4f      	out SREG,zzF
003934 1ef6      	adc zzL,zzC
003935 1cea      	adc zzH,zzB
003936 b75f      	in zzTmp,SREG
003937 7f5d      	cbr zzTmp,1<<zzZF
003938 92ff      	push zzL
003939 28fe      	or zzL,zzH
00393a f409      	brne zzCMDED_4a_1
00393b 6052      	sbr zzTmp,1<<zzZF
00393c 90ff      	zzCMDED_4a_1:pop zzL
00393d bf5f      	out SREG,zzTmp
                 
00393e b74f      	in zzF, SREG
00393f 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
003940 940c 0200 	jmp zCMD_start
                 
                 zCMDED_4b: ; LD   BC (ww)
003942 b998
003943 b982
003944 b854
003945 b83b
003946 9601
003947 b123
003948 b82b      	LDRAM_PC_NODDR FROMRAM2
003949 b998
00394a b982
00394b b854
00394c b83b
00394d 9601
00394e b013
00394f b82b      	LDRAM_PC_NODDR FROMRAM1
003950 b818
003951 b922
003952 b854
003953 b83b
003954 0000
003955 0000
003956 b163
003957 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzC
003958 0d29
003959 1c15      	INC2 FROMRAM1,FROMRAM2
00395a b818
00395b b922
00395c b854
00395d b83b
00395e 0000
00395f 0000
003960 b0a3
003961 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzB
                 	
                 
003962 940c 0200 	jmp zCMD_start
                 
                 zCMDED_4c: ; NEG   A
003964 9511      	neg zzA
                 
003965 b75f      	in zzTmp, SREG
003966 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003967 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003968 2b45      	or zzF, zzTmp ; combine flags
003969 940c 0200 	jmp zCMD_start
                 
                 zCMDED_4d: ; RETI  
00396b 9150 090a 	lds zzTmp,zzIFF2
00396d 9350 0909 	sts zzIFF1,zzTmp
00396f b9d8
003970 b9c2
003971 b854
003972 b83b
003973 0000
003974 0000
003975 b183
003976 b82b
003977 0dc9
003978 1dd5
003979 b9d8
00397a b9c2
00397b b854
00397c b83b
00397d 0000
00397e 0000
00397f b193
003980 b82b
003981 0dc9
003982 1dd5      	zzPOP zzPCh,zzPCl
003983 940c 7000 	jmp EXTINTRPOC_RETI
                 
003985 940c 0200 	jmp zCMD_start
                 
                 zCMDED_4e: ; IM    3
003987 e053
003988 9350 090b 	zzSET zzIM,3
                 
00398a 940c 0200 	jmp zCMD_start
                 
                 zCMDED_4f: ; LD   R A
00398c bd16      	out TCNT0,zzA
00398d 2f51      	mov zzTmp,zzA
00398e 7850      	andi zzTmp,0x80
00398f 9350 090c 	sts zzRhb,zzTmp
                 
003991 940c 0200 	jmp zCMD_start
                 
                 zCMDED_50: ; IN   D (C)
003993 2f56      	mov zzTmp,zzC
003994 940e 7206 	call PORTIN
003996 2ec5      	mov zzD,zzTmp
                 
003997 940c 0200 	jmp zCMD_start
                 
                 zCMDED_51: ; OUT  (C) D
003999 2f56      	mov zzTmp,zzC
00399a 92c0 090e 	sts CDATA,zzD
00399c 940e 7208 	call PORTOUT
                 
00399e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_52: ; SBC  HL DE
0039a0 bf4f      	out SREG,zzF
0039a1 08fd      	sbc zzL,zzE
0039a2 08ec      	sbc zzH,zzD
0039a3 b75f      	in zzTmp,SREG
0039a4 7f5d      	cbr zzTmp,1<<zzZF
0039a5 92ff      	push zzL
0039a6 28fe      	or zzL,zzH
0039a7 f409      	brne zzCMDED_52_1
0039a8 6052      	sbr zzTmp,1<<zzZF
0039a9 90ff      	zzCMDED_52_1:pop zzL
0039aa bf5f      	out SREG,zzTmp
                 
0039ab b75f      	in zzTmp, SREG
0039ac 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0039ad ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0039ae 2b45      	or zzF, zzTmp ; combine flags
0039af 940c 0200 	jmp zCMD_start
                 
                 zCMDED_53: ; LD   (ww) DE
                 	
                 
0039b1 b998
0039b2 b982
0039b3 b854
0039b4 b83b
0039b5 9601
0039b6 b123
0039b7 b82b      	LDRAM_PC_NODDR FROMRAM2
0039b8 b998
0039b9 b982
0039ba b854
0039bb b83b
0039bc 9601
0039bd b013
0039be b82b      	LDRAM_PC_NODDR FROMRAM1
0039bf b818
0039c0 b922
0039c1 b8d5
0039c2 b824
0039c3 1416
0039c4 985d
0039c5 f100
0039c6 b82b
0039c7 935f
0039c8 e158
0039c9 b955
0039ca eb5f
0039cb b954
0039cc e050
0039cd bd5d
0039ce e550
0039cf bd5c
0039d0 9859
0039d1 915f
0039d2 982c
0039d3 92df
0039d4 2d51
0039d5 940e 005f
0039d7 e054
0039d8 955a
0039d9 f7f1
0039da 2f52
0039db 940e 005f
0039dd e054
0039de 955a
0039df f7f1
0039e0 915f
0039e1 940e 005f
0039e3 bc5c
0039e4 9a59
0039e5 b854
0039e6 b82b      	STRAM FROMRAM1,FROMRAM2,zzE
0039e7 0d29
0039e8 1c15      	INC2 FROMRAM1,FROMRAM2
0039e9 b818
0039ea b922
0039eb b8c5
0039ec b824
0039ed 1416
0039ee 985d
0039ef f100
0039f0 b82b
0039f1 935f
0039f2 e158
0039f3 b955
0039f4 eb5f
0039f5 b954
0039f6 e050
0039f7 bd5d
0039f8 e550
0039f9 bd5c
0039fa 9859
0039fb 915f
0039fc 982c
0039fd 92cf
0039fe 2d51
0039ff 940e 005f
003a01 e054
003a02 955a
003a03 f7f1
003a04 2f52
003a05 940e 005f
003a07 e054
003a08 955a
003a09 f7f1
003a0a 915f
003a0b 940e 005f
003a0d bc5c
003a0e 9a59
003a0f b854
003a10 b82b      	STRAM FROMRAM1,FROMRAM2,zzD
003a11 940c 0200 	jmp zCMD_start
                 
                 zCMDED_54: ; NEG   A
003a13 9511      	neg zzA
                 
003a14 b75f      	in zzTmp, SREG
003a15 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003a16 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003a17 2b45      	or zzF, zzTmp ; combine flags
003a18 940c 0200 	jmp zCMD_start
                 
                 zCMDED_55: ; RETN  
003a1a 9150 090a 	lds zzTmp,zzIFF2
003a1c 9350 0909 	sts zzIFF1,zzTmp
003a1e b9d8
003a1f b9c2
003a20 b854
003a21 b83b
003a22 0000
003a23 0000
003a24 b183
003a25 b82b
003a26 0dc9
003a27 1dd5
003a28 b9d8
003a29 b9c2
003a2a b854
003a2b b83b
003a2c 0000
003a2d 0000
003a2e b193
003a2f b82b
003a30 0dc9
003a31 1dd5      	zzPOP zzPCh,zzPCl
003a32 940c 7000 	jmp EXTINTRPOC_RETI
                 
003a34 940c 0200 	jmp zCMD_start
                 
                 zCMDED_56: ; IM    1
003a36 e051
003a37 9350 090b 	zzSET zzIM,1
                 
003a39 940c 0200 	jmp zCMD_start
                 
                 zCMDED_57: ; LD   A I
003a3b 9110 0900 	lds zzA,zzI
003a3d 7f47      	andi zzF,~(1<<zzPF)
003a3e 9150 090a 	lds zzTmp,zzIFF2
003a40 fd50      	sbrc zzTmp,0
003a41 6048      	ori zzF,1<<zzPF
003a42 9110 0900 	lds zzA,zzI
003a44 2b11      	or zzA,zzA
                 
003a45 b75f      	in zzTmp, SREG
003a46 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
003a47 7849      	andi zzF, 	(_I_|___|___|___|_V_|___|_C_) ; mask old flags
003a48 2b45      	or zzF, zzTmp ; combine flags
003a49 940c 0200 	jmp zCMD_start
                 
                 zCMDED_58: ; IN   E (C)
003a4b 2f56      	mov zzTmp,zzC
003a4c 940e 7206 	call PORTIN
003a4e 2ed5      	mov zzE,zzTmp
                 
003a4f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_59: ; OUT  (C) E
003a51 2f56      	mov zzTmp,zzC
003a52 92d0 090e 	sts CDATA,zzE
003a54 940e 7208 	call PORTOUT
                 
003a56 940c 0200 	jmp zCMD_start
                 
                 zCMDED_5a: ; ADC  HL DE
003a58 bf4f      	out SREG,zzF
003a59 1cfd      	adc zzL,zzE
003a5a 1cec      	adc zzH,zzD
003a5b b75f      	in zzTmp,SREG
003a5c 7f5d      	cbr zzTmp,1<<zzZF
003a5d 92ff      	push zzL
003a5e 28fe      	or zzL,zzH
003a5f f409      	brne zzCMDED_5a_1
003a60 6052      	sbr zzTmp,1<<zzZF
003a61 90ff      	zzCMDED_5a_1:pop zzL
003a62 bf5f      	out SREG,zzTmp
                 
003a63 b74f      	in zzF, SREG
003a64 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
003a65 940c 0200 	jmp zCMD_start
                 
                 zCMDED_5b: ; LD   DE (ww)
003a67 b998
003a68 b982
003a69 b854
003a6a b83b
003a6b 9601
003a6c b123
003a6d b82b      	LDRAM_PC_NODDR FROMRAM2
003a6e b998
003a6f b982
003a70 b854
003a71 b83b
003a72 9601
003a73 b013
003a74 b82b      	LDRAM_PC_NODDR FROMRAM1
003a75 b818
003a76 b922
003a77 b854
003a78 b83b
003a79 0000
003a7a 0000
003a7b b0d3
003a7c b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzE
003a7d 0d29
003a7e 1c15      	INC2 FROMRAM1,FROMRAM2
003a7f b818
003a80 b922
003a81 b854
003a82 b83b
003a83 0000
003a84 0000
003a85 b0c3
003a86 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzD
                 	
                 
003a87 940c 0200 	jmp zCMD_start
                 
                 zCMDED_5c: ; NEG   A
003a89 9511      	neg zzA
                 
003a8a b75f      	in zzTmp, SREG
003a8b 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003a8c ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003a8d 2b45      	or zzF, zzTmp ; combine flags
003a8e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_5d: ; RETN  
003a90 9150 090a 	lds zzTmp,zzIFF2
003a92 9350 0909 	sts zzIFF1,zzTmp
003a94 b9d8
003a95 b9c2
003a96 b854
003a97 b83b
003a98 0000
003a99 0000
003a9a b183
003a9b b82b
003a9c 0dc9
003a9d 1dd5
003a9e b9d8
003a9f b9c2
003aa0 b854
003aa1 b83b
003aa2 0000
003aa3 0000
003aa4 b193
003aa5 b82b
003aa6 0dc9
003aa7 1dd5      	zzPOP zzPCh,zzPCl
003aa8 940c 7000 	jmp EXTINTRPOC_RETI
                 
003aaa 940c 0200 	jmp zCMD_start
                 
                 zCMDED_5e: ; IM    2
003aac e052
003aad 9350 090b 	zzSET zzIM,2
                 
003aaf 940c 0200 	jmp zCMD_start
                 
                 zCMDED_5f: ; LD   A R
003ab1 7f47      	andi zzF,~(1<<zzPF)
003ab2 9150 090a 	lds zzTmp,zzIFF2
003ab4 fd50      	sbrc zzTmp,0
003ab5 6048      	ori zzF,1<<zzPF
003ab6 b516      	in zzA,TCNT0
003ab7 9150 090c 	lds zzTmp,zzRhb
003ab9 771f      	andi zzA,0x7f
003aba 2b15      	or zzA,zzTmp
                 
003abb b75f      	in zzTmp, SREG
003abc 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
003abd 7849      	andi zzF, 	(_I_|___|___|___|_V_|___|_C_) ; mask old flags
003abe 2b45      	or zzF, zzTmp ; combine flags
003abf 940c 0200 	jmp zCMD_start
                 
                 zCMDED_60: ; IN   H (C)
003ac1 2f56      	mov zzTmp,zzC
003ac2 940e 7206 	call PORTIN
003ac4 2ee5      	mov zzH,zzTmp
                 
003ac5 940c 0200 	jmp zCMD_start
                 
                 zCMDED_61: ; OUT  (C) H
003ac7 2f56      	mov zzTmp,zzC
003ac8 92e0 090e 	sts CDATA,zzH
003aca 940e 7208 	call PORTOUT
                 
003acc 940c 0200 	jmp zCMD_start
                 
                 zCMDED_62: ; SBC  HL HL
003ace bf4f      	out SREG,zzF
003acf 08ff      	sbc zzL,zzL
003ad0 08ee      	sbc zzH,zzH
003ad1 b75f      	in zzTmp,SREG
003ad2 7f5d      	cbr zzTmp,1<<zzZF
003ad3 92ff      	push zzL
003ad4 28fe      	or zzL,zzH
003ad5 f409      	brne zzCMDED_62_1
003ad6 6052      	sbr zzTmp,1<<zzZF
003ad7 90ff      	zzCMDED_62_1:pop zzL
003ad8 bf5f      	out SREG,zzTmp
                 
003ad9 b75f      	in zzTmp, SREG
003ada 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003adb ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003adc 2b45      	or zzF, zzTmp ; combine flags
003add 940c 0200 	jmp zCMD_start
                 
                 zCMDED_63: ; LD   (ww) HL
                 	
                 
003adf b998
003ae0 b982
003ae1 b854
003ae2 b83b
003ae3 9601
003ae4 b123
003ae5 b82b      	LDRAM_PC_NODDR FROMRAM2
003ae6 b998
003ae7 b982
003ae8 b854
003ae9 b83b
003aea 9601
003aeb b013
003aec b82b      	LDRAM_PC_NODDR FROMRAM1
003aed b818
003aee b922
003aef b8f5
003af0 b824
003af1 1416
003af2 985d
003af3 f100
003af4 b82b
003af5 935f
003af6 e158
003af7 b955
003af8 eb5f
003af9 b954
003afa e050
003afb bd5d
003afc e550
003afd bd5c
003afe 9859
003aff 915f
003b00 982c
003b01 92ff
003b02 2d51
003b03 940e 005f
003b05 e054
003b06 955a
003b07 f7f1
003b08 2f52
003b09 940e 005f
003b0b e054
003b0c 955a
003b0d f7f1
003b0e 915f
003b0f 940e 005f
003b11 bc5c
003b12 9a59
003b13 b854
003b14 b82b      	STRAM FROMRAM1,FROMRAM2,zzL
003b15 0d29
003b16 1c15      	INC2 FROMRAM1,FROMRAM2
003b17 b818
003b18 b922
003b19 b8e5
003b1a b824
003b1b 1416
003b1c 985d
003b1d f100
003b1e b82b
003b1f 935f
003b20 e158
003b21 b955
003b22 eb5f
003b23 b954
003b24 e050
003b25 bd5d
003b26 e550
003b27 bd5c
003b28 9859
003b29 915f
003b2a 982c
003b2b 92ef
003b2c 2d51
003b2d 940e 005f
003b2f e054
003b30 955a
003b31 f7f1
003b32 2f52
003b33 940e 005f
003b35 e054
003b36 955a
003b37 f7f1
003b38 915f
003b39 940e 005f
003b3b bc5c
003b3c 9a59
003b3d b854
003b3e b82b      	STRAM FROMRAM1,FROMRAM2,zzH
003b3f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_64: ; NEG   A
003b41 9511      	neg zzA
                 
003b42 b75f      	in zzTmp, SREG
003b43 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003b44 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003b45 2b45      	or zzF, zzTmp ; combine flags
003b46 940c 0200 	jmp zCMD_start
                 
                 zCMDED_65: ; RETN  
003b48 9150 090a 	lds zzTmp,zzIFF2
003b4a 9350 0909 	sts zzIFF1,zzTmp
003b4c b9d8
003b4d b9c2
003b4e b854
003b4f b83b
003b50 0000
003b51 0000
003b52 b183
003b53 b82b
003b54 0dc9
003b55 1dd5
003b56 b9d8
003b57 b9c2
003b58 b854
003b59 b83b
003b5a 0000
003b5b 0000
003b5c b193
003b5d b82b
003b5e 0dc9
003b5f 1dd5      	zzPOP zzPCh,zzPCl
003b60 940c 7000 	jmp EXTINTRPOC_RETI
                 
003b62 940c 0200 	jmp zCMD_start
                 
                 zCMDED_66: ; IM    0
003b64 e050
003b65 9350 090b 	zzSET zzIM,0
                 
003b67 940c 0200 	jmp zCMD_start
                 
                 zCMDED_67: ; RRD  A (HL)
003b69 b8e8
003b6a b8f2
003b6b b854
003b6c b83b
003b6d 0000
003b6e 0000
003b6f b173
003b70 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
003b71 2f21
003b72 2e17
003b73 e05f
003b74 2215
003b75 2325
003b76 ef50
003b77 2315
003b78 2375
003b79 2911
003b7a 2b72
003b7b 9572
003b7c b8e8
003b7d b8f2
003b7e b975
003b7f b824
003b80 14e6
003b81 985d
003b82 f100
003b83 b82b
003b84 935f
003b85 e158
003b86 b955
003b87 eb5f
003b88 b954
003b89 e050
003b8a bd5d
003b8b e550
003b8c bd5c
003b8d 9859
003b8e 915f
003b8f 982c
003b90 937f
003b91 2d5e
003b92 940e 005f
003b94 e054
003b95 955a
003b96 f7f1
003b97 2d5f
003b98 940e 005f
003b9a e054
003b9b 955a
003b9c f7f1
003b9d 915f
003b9e 940e 005f
003ba0 bc5c
003ba1 9a59
003ba2 b854
003ba3 b82b
003ba4 2b11      	zzRRD
                 
003ba5 b75f      	in zzTmp, SREG
003ba6 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
003ba7 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003ba8 2b45      	or zzF, zzTmp ; combine flags
003ba9 e1b8
003baa 2fa1
003bab 915c
003bac 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
003bad 940c 0200 	jmp zCMD_start
                 
                 zCMDED_68: ; IN   L (C)
003baf 2f56      	mov zzTmp,zzC
003bb0 940e 7206 	call PORTIN
003bb2 2ef5      	mov zzL,zzTmp
                 
003bb3 940c 0200 	jmp zCMD_start
                 
                 zCMDED_69: ; OUT  (C) L
003bb5 2f56      	mov zzTmp,zzC
003bb6 92f0 090e 	sts CDATA,zzL
003bb8 940e 7208 	call PORTOUT
                 
003bba 940c 0200 	jmp zCMD_start
                 
                 zCMDED_6a: ; ADC  HL HL
003bbc bf4f      	out SREG,zzF
003bbd 1cff      	adc zzL,zzL
003bbe 1cee      	adc zzH,zzH
003bbf b75f      	in zzTmp,SREG
003bc0 7f5d      	cbr zzTmp,1<<zzZF
003bc1 92ff      	push zzL
003bc2 28fe      	or zzL,zzH
003bc3 f409      	brne zzCMDED_6a_1
003bc4 6052      	sbr zzTmp,1<<zzZF
003bc5 90ff      	zzCMDED_6a_1:pop zzL
003bc6 bf5f      	out SREG,zzTmp
                 
003bc7 b74f      	in zzF, SREG
003bc8 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
003bc9 940c 0200 	jmp zCMD_start
                 
                 zCMDED_6b: ; LD   HL (ww)
003bcb b998
003bcc b982
003bcd b854
003bce b83b
003bcf 9601
003bd0 b123
003bd1 b82b      	LDRAM_PC_NODDR FROMRAM2
003bd2 b998
003bd3 b982
003bd4 b854
003bd5 b83b
003bd6 9601
003bd7 b013
003bd8 b82b      	LDRAM_PC_NODDR FROMRAM1
003bd9 b818
003bda b922
003bdb b854
003bdc b83b
003bdd 0000
003bde 0000
003bdf b0f3
003be0 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzL
003be1 0d29
003be2 1c15      	INC2 FROMRAM1,FROMRAM2
003be3 b818
003be4 b922
003be5 b854
003be6 b83b
003be7 0000
003be8 0000
003be9 b0e3
003bea b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzH
                 	
                 
003beb 940c 0200 	jmp zCMD_start
                 
                 zCMDED_6c: ; NEG   A
003bed 9511      	neg zzA
                 
003bee b75f      	in zzTmp, SREG
003bef 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003bf0 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003bf1 2b45      	or zzF, zzTmp ; combine flags
003bf2 940c 0200 	jmp zCMD_start
                 
                 zCMDED_6d: ; RETN  
003bf4 9150 090a 	lds zzTmp,zzIFF2
003bf6 9350 0909 	sts zzIFF1,zzTmp
003bf8 b9d8
003bf9 b9c2
003bfa b854
003bfb b83b
003bfc 0000
003bfd 0000
003bfe b183
003bff b82b
003c00 0dc9
003c01 1dd5
003c02 b9d8
003c03 b9c2
003c04 b854
003c05 b83b
003c06 0000
003c07 0000
003c08 b193
003c09 b82b
003c0a 0dc9
003c0b 1dd5      	zzPOP zzPCh,zzPCl
003c0c 940c 7000 	jmp EXTINTRPOC_RETI
                 
003c0e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_6e: ; IM    3
003c10 e053
003c11 9350 090b 	zzSET zzIM,3
                 
003c13 940c 0200 	jmp zCMD_start
                 
                 zCMDED_6f: ; RLD  A (HL)
003c15 b8e8
003c16 b8f2
003c17 b854
003c18 b83b
003c19 0000
003c1a 0000
003c1b b173
003c1c b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
003c1d 9572
003c1e 2f21
003c1f 2e17
003c20 e05f
003c21 2215
003c22 2325
003c23 ef50
003c24 2315
003c25 2375
003c26 2911
003c27 2b72
003c28 b8e8
003c29 b8f2
003c2a b975
003c2b b824
003c2c 14e6
003c2d 985d
003c2e f100
003c2f b82b
003c30 935f
003c31 e158
003c32 b955
003c33 eb5f
003c34 b954
003c35 e050
003c36 bd5d
003c37 e550
003c38 bd5c
003c39 9859
003c3a 915f
003c3b 982c
003c3c 937f
003c3d 2d5e
003c3e 940e 005f
003c40 e054
003c41 955a
003c42 f7f1
003c43 2d5f
003c44 940e 005f
003c46 e054
003c47 955a
003c48 f7f1
003c49 915f
003c4a 940e 005f
003c4c bc5c
003c4d 9a59
003c4e b854
003c4f b82b
003c50 2b11      	zzRLD
                 
003c51 b75f      	in zzTmp, SREG
003c52 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
003c53 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003c54 2b45      	or zzF, zzTmp ; combine flags
003c55 e1b8
003c56 2fa1
003c57 915c
003c58 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
003c59 940c 0200 	jmp zCMD_start
                 
                 zCMDED_71: ; OUT  (C) 0
003c5b 2f56      	mov zzTmp,zzC
003c5c e070      	ldi FROMRAM0,0
003c5d 9370 090e 	sts CDATA,FROMRAM0
003c5f 940e 7208 	call PORTOUT
                 
003c61 940c 0200 	jmp zCMD_start
                 
                 zCMDED_72: ; SBC  HL SP
003c63 bf4f      	out SREG,zzF
003c64 0afc      	sbc zzL,zzSPl
003c65 0aed      	sbc zzH,zzSPh
003c66 b75f      	in zzTmp,SREG
003c67 7f5d      	cbr zzTmp,1<<zzZF
003c68 92ff      	push zzL
003c69 28fe      	or zzL,zzH
003c6a f409      	brne zzCMDED_72_1
003c6b 6052      	sbr zzTmp,1<<zzZF
003c6c 90ff      	zzCMDED_72_1:pop zzL
003c6d bf5f      	out SREG,zzTmp
                 
003c6e b75f      	in zzTmp, SREG
003c6f 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003c70 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003c71 2b45      	or zzF, zzTmp ; combine flags
003c72 940c 0200 	jmp zCMD_start
                 
                 zCMDED_73: ; LD   (ww) SP
                 	
                 
003c74 b998
003c75 b982
003c76 b854
003c77 b83b
003c78 9601
003c79 b123
003c7a b82b      	LDRAM_PC_NODDR FROMRAM2
003c7b b998
003c7c b982
003c7d b854
003c7e b83b
003c7f 9601
003c80 b013
003c81 b82b      	LDRAM_PC_NODDR FROMRAM1
003c82 b818
003c83 b922
003c84 b9c5
003c85 b824
003c86 1416
003c87 985d
003c88 f100
003c89 b82b
003c8a 935f
003c8b e158
003c8c b955
003c8d eb5f
003c8e b954
003c8f e050
003c90 bd5d
003c91 e550
003c92 bd5c
003c93 9859
003c94 915f
003c95 982c
003c96 93cf
003c97 2d51
003c98 940e 005f
003c9a e054
003c9b 955a
003c9c f7f1
003c9d 2f52
003c9e 940e 005f
003ca0 e054
003ca1 955a
003ca2 f7f1
003ca3 915f
003ca4 940e 005f
003ca6 bc5c
003ca7 9a59
003ca8 b854
003ca9 b82b      	STRAM FROMRAM1,FROMRAM2,zzSPl
003caa 0d29
003cab 1c15      	INC2 FROMRAM1,FROMRAM2
003cac b818
003cad b922
003cae b9d5
003caf b824
003cb0 1416
003cb1 985d
003cb2 f100
003cb3 b82b
003cb4 935f
003cb5 e158
003cb6 b955
003cb7 eb5f
003cb8 b954
003cb9 e050
003cba bd5d
003cbb e550
003cbc bd5c
003cbd 9859
003cbe 915f
003cbf 982c
003cc0 93df
003cc1 2d51
003cc2 940e 005f
003cc4 e054
003cc5 955a
003cc6 f7f1
003cc7 2f52
003cc8 940e 005f
003cca e054
003ccb 955a
003ccc f7f1
003ccd 915f
003cce 940e 005f
003cd0 bc5c
003cd1 9a59
003cd2 b854
003cd3 b82b      	STRAM FROMRAM1,FROMRAM2,zzSPh
003cd4 940c 0200 	jmp zCMD_start
                 
                 zCMDED_74: ; NEG   A
003cd6 9511      	neg zzA
                 
003cd7 b75f      	in zzTmp, SREG
003cd8 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003cd9 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003cda 2b45      	or zzF, zzTmp ; combine flags
003cdb 940c 0200 	jmp zCMD_start
                 
                 zCMDED_75: ; RETN  
003cdd 9150 090a 	lds zzTmp,zzIFF2
003cdf 9350 0909 	sts zzIFF1,zzTmp
003ce1 b9d8
003ce2 b9c2
003ce3 b854
003ce4 b83b
003ce5 0000
003ce6 0000
003ce7 b183
003ce8 b82b
003ce9 0dc9
003cea 1dd5
003ceb b9d8
003cec b9c2
003ced b854
003cee b83b
003cef 0000
003cf0 0000
003cf1 b193
003cf2 b82b
003cf3 0dc9
003cf4 1dd5      	zzPOP zzPCh,zzPCl
003cf5 940c 7000 	jmp EXTINTRPOC_RETI
                 
003cf7 940c 0200 	jmp zCMD_start
                 
                 zCMDED_76: ; IM    1
003cf9 e051
003cfa 9350 090b 	zzSET zzIM,1
                 
003cfc 940c 0200 	jmp zCMD_start
                 
                 zCMDED_77: ; MUL   
003cfe e040
003cff e050
003d00 920f
003d01 921f
003d02 9ef1
003d03 0ce1
003d04 1d55
003d05 2cf0
003d06 9ee1
003d07 0d51
003d08 2ce0
003d09 2f15
003d0a 1115
003d0b 6041
003d0c 2d5e
003d0d 295f
003d0e f409
003d0f 6042
003d10 901f
003d11 900f      	zMUL
                 
003d12 940c 0200 	jmp zCMD_start
                 
                 zCMDED_78: ; IN   A (C)
003d14 2f56      	mov zzTmp,zzC
003d15 940e 7206 	call PORTIN
003d17 2f15      	mov zzA,zzTmp
                 
003d18 940c 0200 	jmp zCMD_start
                 
                 zCMDED_79: ; OUT  (C) A
003d1a 2f56      	mov zzTmp,zzC
003d1b 9310 090e 	sts CDATA,zzA
003d1d 940e 7208 	call PORTOUT
                 
003d1f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_7a: ; ADC  HL SP
003d21 bf4f      	out SREG,zzF
003d22 1efc      	adc zzL,zzSPl
003d23 1eed      	adc zzH,zzSPh
003d24 b75f      	in zzTmp,SREG
003d25 7f5d      	cbr zzTmp,1<<zzZF
003d26 92ff      	push zzL
003d27 28fe      	or zzL,zzH
003d28 f409      	brne zzCMDED_7a_1
003d29 6052      	sbr zzTmp,1<<zzZF
003d2a 90ff      	zzCMDED_7a_1:pop zzL
003d2b bf5f      	out SREG,zzTmp
                 
003d2c b74f      	in zzF, SREG
003d2d 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
003d2e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_7b: ; LD   SP (ww)
003d30 b998
003d31 b982
003d32 b854
003d33 b83b
003d34 9601
003d35 b123
003d36 b82b      	LDRAM_PC_NODDR FROMRAM2
003d37 b998
003d38 b982
003d39 b854
003d3a b83b
003d3b 9601
003d3c b013
003d3d b82b      	LDRAM_PC_NODDR FROMRAM1
003d3e b818
003d3f b922
003d40 b854
003d41 b83b
003d42 0000
003d43 0000
003d44 b1c3
003d45 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzSPl
003d46 0d29
003d47 1c15      	INC2 FROMRAM1,FROMRAM2
003d48 b818
003d49 b922
003d4a b854
003d4b b83b
003d4c 0000
003d4d 0000
003d4e b1d3
003d4f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzSPh
                 	
                 
003d50 940c 0200 	jmp zCMD_start
                 
                 zCMDED_7c: ; NEG   A
003d52 9511      	neg zzA
                 
003d53 b75f      	in zzTmp, SREG
003d54 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
003d55 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
003d56 2b45      	or zzF, zzTmp ; combine flags
003d57 940c 0200 	jmp zCMD_start
                 
                 zCMDED_7d: ; RETN  
003d59 9150 090a 	lds zzTmp,zzIFF2
003d5b 9350 0909 	sts zzIFF1,zzTmp
003d5d b9d8
003d5e b9c2
003d5f b854
003d60 b83b
003d61 0000
003d62 0000
003d63 b183
003d64 b82b
003d65 0dc9
003d66 1dd5
003d67 b9d8
003d68 b9c2
003d69 b854
003d6a b83b
003d6b 0000
003d6c 0000
003d6d b193
003d6e b82b
003d6f 0dc9
003d70 1dd5      	zzPOP zzPCh,zzPCl
003d71 940c 7000 	jmp EXTINTRPOC_RETI
                 
003d73 940c 0200 	jmp zCMD_start
                 
                 zCMDED_7e: ; IM    2
003d75 e052
003d76 9350 090b 	zzSET zzIM,2
                 
003d78 940c 0200 	jmp zCMD_start
                 
                 zCMDED_7f: ; DIV   
003d7a 938f
003d7b 939f
003d7c 93af
003d7d 93bf
003d7e 2d9e
003d7f 2d8f
003d80 2d75
003d81 2f61
003d82 1baa
003d83 1bbb
003d84 e151
003d85 c007
003d86 1faa
003d87 1fbb
003d88 17a6
003d89 07b7
003d8a f010
003d8b 1ba6
003d8c 0bb7
003d8d 1f88
003d8e 1f99
003d8f 955a
003d90 f7a9
003d91 9580
003d92 9590
003d93 01bc
003d94 01cd
003d95 2ee7
003d96 2ef6
003d97 2f18
003d98 e050
003d99 1115
003d9a 6041
003d9b 2d5e
003d9c 295f
003d9d f409
003d9e 6042
003d9f 91bf
003da0 91af
003da1 919f
003da2 918f      	zDIV
                 
003da3 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a0: ; LDI   
003da5 b8e8
003da6 b8f2
003da7 b854
003da8 b83b
003da9 0000
003daa 0000
003dab b153
003dac b82b
003dad b8c8
003dae b8d2
003daf b955
003db0 b824
003db1 14c6
003db2 985d
003db3 f100
003db4 b82b
003db5 935f
003db6 e158
003db7 b955
003db8 eb5f
003db9 b954
003dba e050
003dbb bd5d
003dbc e550
003dbd bd5c
003dbe 9859
003dbf 915f
003dc0 982c
003dc1 935f
003dc2 2d5c
003dc3 940e 005f
003dc5 e054
003dc6 955a
003dc7 f7f1
003dc8 2d5d
003dc9 940e 005f
003dcb e054
003dcc 955a
003dcd f7f1
003dce 915f
003dcf 940e 005f
003dd1 bc5c
003dd2 9a59
003dd3 b854
003dd4 b82b
003dd5 0cf9
003dd6 1ce5
003dd7 0cd9
003dd8 1cc5
003dd9 1969
003dda 08a5
003ddb 7f47
003ddc 1565
003ddd 04a5
003dde f011
003ddf 6048
003de0 9498      	zzLDx INC2
                 
003de1 784f      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|_C_) ; mask old flags
003de2 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a1: ; CPI   
003de4 6048
003de5 b8e8
003de6 b8f2
003de7 b854
003de8 b83b
003de9 0000
003dea 0000
003deb b173
003dec b82b
003ded 0cf9
003dee 1ce5
003def 1969
003df0 08a5
003df1 1565
003df2 04a5
003df3 f409
003df4 7f47
003df5 1717      	zzCPI
                 
003df6 b75f      	in zzTmp, SREG
003df7 7a56      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|___|___|___) ; mask results flags
003df8 7849      	andi zzF, 	(_I_|___|___|___|_V_|___|_C_) ; mask old flags
003df9 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003dfa 2b45      	or zzF, zzTmp ; combine flags
003dfb 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a2: ; INI   
003dfd 2f56      	mov zzTmp,zzC
003dfe 940e 7206 	call PORTIN
003e00 b8e8
003e01 b8f2
003e02 b955
003e03 b824
003e04 14e6
003e05 985d
003e06 f100
003e07 b82b
003e08 935f
003e09 e158
003e0a b955
003e0b eb5f
003e0c b954
003e0d e050
003e0e bd5d
003e0f e550
003e10 bd5c
003e11 9859
003e12 915f
003e13 982c
003e14 935f
003e15 2d5e
003e16 940e 005f
003e18 e054
003e19 955a
003e1a f7f1
003e1b 2d5f
003e1c 940e 005f
003e1e e054
003e1f 955a
003e20 f7f1
003e21 915f
003e22 940e 005f
003e24 bc5c
003e25 9a59
003e26 b854
003e27 b82b      	STRAM zzH,zzL,zzTmp
003e28 0cf9
003e29 1ce5      	INC2 zzH,zzL
003e2a 94aa      	dec zzB
                 
003e2b b75f      	in zzTmp, SREG
003e2c 7852      	andi zzTmp, 	(_I_|___|_Z_|___|___|___|___) ; mask results flags
003e2d 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003e2e 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003e2f 2b45      	or zzF, zzTmp ; combine flags
003e30 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a3: ; OUTI  
003e32 2f56      	mov zzTmp,zzC
003e33 b8e8
003e34 b8f2
003e35 b854
003e36 b83b
003e37 0000
003e38 0000
003e39 b173
003e3a b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
003e3b 9370 090e 	sts CDATA,FROMRAM0
003e3d 940e 7208 	call PORTOUT
003e3f 0cf9
003e40 1ce5      	INC2 zzH,zzL
003e41 94aa      	dec zzB
                 
003e42 b75f      	in zzTmp, SREG
003e43 7852      	andi zzTmp, 	(_I_|___|_Z_|___|___|___|___) ; mask results flags
003e44 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003e45 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003e46 2b45      	or zzF, zzTmp ; combine flags
003e47 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a4: ; FL32  0
003e49 e050      	ldi zzTmp,0
003e4a 940e bb69 	zFLOAT
                 
003e4c 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a5: ; FL32  1
003e4e e051      	ldi zzTmp,1
003e4f 940e bb69 	zFLOAT
                 
003e51 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a6: ; FL32  2
003e53 e052      	ldi zzTmp,2
003e54 940e bb69 	zFLOAT
                 
003e56 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a7: ; FL32  3
003e58 e053      	ldi zzTmp,3
003e59 940e bb69 	zFLOAT
                 
003e5b 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a8: ; LDD   
003e5d b8e8
003e5e b8f2
003e5f b854
003e60 b83b
003e61 0000
003e62 0000
003e63 b153
003e64 b82b
003e65 b8c8
003e66 b8d2
003e67 b955
003e68 b824
003e69 14c6
003e6a 985d
003e6b f100
003e6c b82b
003e6d 935f
003e6e e158
003e6f b955
003e70 eb5f
003e71 b954
003e72 e050
003e73 bd5d
003e74 e550
003e75 bd5c
003e76 9859
003e77 915f
003e78 982c
003e79 935f
003e7a 2d5c
003e7b 940e 005f
003e7d e054
003e7e 955a
003e7f f7f1
003e80 2d5d
003e81 940e 005f
003e83 e054
003e84 955a
003e85 f7f1
003e86 915f
003e87 940e 005f
003e89 bc5c
003e8a 9a59
003e8b b854
003e8c b82b
003e8d 18f9
003e8e 08e5
003e8f 18d9
003e90 08c5
003e91 1969
003e92 08a5
003e93 7f47
003e94 1565
003e95 04a5
003e96 f011
003e97 6048
003e98 9498      	zzLDx DEC2
                 
003e99 784f      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|_C_) ; mask old flags
003e9a 940c 0200 	jmp zCMD_start
                 
                 zCMDED_a9: ; CPD   
003e9c 6048
003e9d b8e8
003e9e b8f2
003e9f b854
003ea0 b83b
003ea1 0000
003ea2 0000
003ea3 b173
003ea4 b82b
003ea5 18f9
003ea6 08e5
003ea7 1969
003ea8 08a5
003ea9 1565
003eaa 04a5
003eab f409
003eac 7f47
003ead 1717      	zzCPD
                 
003eae b75f      	in zzTmp, SREG
003eaf 7a56      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|___|___|___) ; mask results flags
003eb0 7849      	andi zzF, 	(_I_|___|___|___|_V_|___|_C_) ; mask old flags
003eb1 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003eb2 2b45      	or zzF, zzTmp ; combine flags
003eb3 940c 0200 	jmp zCMD_start
                 
                 zCMDED_aa: ; IND   
003eb5 2f56      	mov zzTmp,zzC
003eb6 940e 7206 	call PORTIN
003eb8 b8e8
003eb9 b8f2
003eba b955
003ebb b824
003ebc 14e6
003ebd 985d
003ebe f100
003ebf b82b
003ec0 935f
003ec1 e158
003ec2 b955
003ec3 eb5f
003ec4 b954
003ec5 e050
003ec6 bd5d
003ec7 e550
003ec8 bd5c
003ec9 9859
003eca 915f
003ecb 982c
003ecc 935f
003ecd 2d5e
003ece 940e 005f
003ed0 e054
003ed1 955a
003ed2 f7f1
003ed3 2d5f
003ed4 940e 005f
003ed6 e054
003ed7 955a
003ed8 f7f1
003ed9 915f
003eda 940e 005f
003edc bc5c
003edd 9a59
003ede b854
003edf b82b      	STRAM zzH,zzL,zzTmp
003ee0 18f9
003ee1 08e5      	DEC2 zzH,zzL
003ee2 94aa      	dec zzB
                 
003ee3 b75f      	in zzTmp, SREG
003ee4 7852      	andi zzTmp, 	(_I_|___|_Z_|___|___|___|___) ; mask results flags
003ee5 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003ee6 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003ee7 2b45      	or zzF, zzTmp ; combine flags
003ee8 940c 0200 	jmp zCMD_start
                 
                 zCMDED_ab: ; OUTD  
003eea 2f56      	mov zzTmp,zzC
003eeb b8e8
003eec b8f2
003eed b854
003eee b83b
003eef 0000
003ef0 0000
003ef1 b173
003ef2 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
003ef3 9370 090e 	sts CDATA,FROMRAM0
003ef5 940e 7208 	call PORTOUT
003ef7 18f9
003ef8 08e5      	DEC2 zzH,zzL
003ef9 94aa      	dec zzB
                 
003efa b75f      	in zzTmp, SREG
003efb 7852      	andi zzTmp, 	(_I_|___|_Z_|___|___|___|___) ; mask results flags
003efc 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003efd 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003efe 2b45      	or zzF, zzTmp ; combine flags
003eff 940c 0200 	jmp zCMD_start
                 
                 zCMDED_b0: ; LDIR  
                 	zzCMDED_b0_1:
003f01 b8e8
003f02 b8f2
003f03 b854
003f04 b83b
003f05 0000
003f06 0000
003f07 b153
003f08 b82b
003f09 b8c8
003f0a b8d2
003f0b b955
003f0c b824
003f0d 14c6
003f0e 985d
003f0f f100
003f10 b82b
003f11 935f
003f12 e158
003f13 b955
003f14 eb5f
003f15 b954
003f16 e050
003f17 bd5d
003f18 e550
003f19 bd5c
003f1a 9859
003f1b 915f
003f1c 982c
003f1d 935f
003f1e 2d5c
003f1f 940e 005f
003f21 e054
003f22 955a
003f23 f7f1
003f24 2d5d
003f25 940e 005f
003f27 e054
003f28 955a
003f29 f7f1
003f2a 915f
003f2b 940e 005f
003f2d bc5c
003f2e 9a59
003f2f b854
003f30 b82b
003f31 0cf9
003f32 1ce5
003f33 0cd9
003f34 1cc5
003f35 1969
003f36 08a5
003f37 7f47
003f38 1565
003f39 04a5
003f3a f011
003f3b 6048
003f3c 9498      	zzLDx INC2
003f3d f619      	brne zzCMDED_b0_1
                 
003f3e 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask old flags
003f3f 940c 0200 	jmp zCMD_start
                 
                 zCMDED_b1: ; CPIR  
                 	zzCMDED_b1_1:
003f41 6048
003f42 b8e8
003f43 b8f2
003f44 b854
003f45 b83b
003f46 0000
003f47 0000
003f48 b173
003f49 b82b
003f4a 0cf9
003f4b 1ce5
003f4c 1969
003f4d 08a5
003f4e 1565
003f4f 04a5
003f50 f409
003f51 7f47
003f52 1717      	zzCPI
003f53 f011      	breq zzCMDED_b1_2
003f54 fd43      	sbrc zzF,zzPF
003f55 cfeb      	rjmp zzCMDED_b1_1
                 	zzCMDED_b1_2:
                 	
                 
003f56 b75f      	in zzTmp, SREG
003f57 7a56      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|___|___|___) ; mask results flags
003f58 7849      	andi zzF, 	(_I_|___|___|___|_V_|___|_C_) ; mask old flags
003f59 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003f5a 2b45      	or zzF, zzTmp ; combine flags
003f5b 940c 0200 	jmp zCMD_start
                 
                 zCMDED_b2: ; INIR  
003f5d 2f56      	mov zzTmp,zzC
                 	zzCMDED_b2_1:
003f5e 940e 7206 	call PORTIN
003f60 b8e8
003f61 b8f2
003f62 b955
003f63 b824
003f64 14e6
003f65 985d
003f66 f100
003f67 b82b
003f68 935f
003f69 e158
003f6a b955
003f6b eb5f
003f6c b954
003f6d e050
003f6e bd5d
003f6f e550
003f70 bd5c
003f71 9859
003f72 915f
003f73 982c
003f74 935f
003f75 2d5e
003f76 940e 005f
003f78 e054
003f79 955a
003f7a f7f1
003f7b 2d5f
003f7c 940e 005f
003f7e e054
003f7f 955a
003f80 f7f1
003f81 915f
003f82 940e 005f
003f84 bc5c
003f85 9a59
003f86 b854
003f87 b82b      	STRAM zzH,zzL,zzTmp
003f88 0cf9
003f89 1ce5      	INC2 zzH,zzL
003f8a 94aa      	dec zzB
003f8b f691      	brne zzCMDED_b2_1
                 
003f8c 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003f8d 6c42      	ori zzF, 	(_I_|___|_Z_|___|___|_N_|___) ; set flags
003f8e 940c 0200 	jmp zCMD_start
                 
                 zCMDED_b3: ; OTIR  
003f90 2f56      	mov zzTmp,zzC
                 	zzCMDED_b3_1:
003f91 b8e8
003f92 b8f2
003f93 b854
003f94 b83b
003f95 0000
003f96 0000
003f97 b173
003f98 b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
003f99 9370 090e 	sts CDATA,FROMRAM0
003f9b 940e 7208 	call PORTOUT
003f9d 0cf9
003f9e 1ce5      	INC2 zzH,zzL
003f9f 94aa      	dec zzB
003fa0 f781      	brne zzCMDED_b3_1
                 
003fa1 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
003fa2 6c42      	ori zzF, 	(_I_|___|_Z_|___|___|_N_|___) ; set flags
003fa3 940c 0200 	jmp zCMD_start
                 
                 zCMDED_b8: ; LDDR  
                 	zzCMDED_b8_1:
003fa5 b8e8
003fa6 b8f2
003fa7 b854
003fa8 b83b
003fa9 0000
003faa 0000
003fab b153
003fac b82b
003fad b8c8
003fae b8d2
003faf b955
003fb0 b824
003fb1 14c6
003fb2 985d
003fb3 f100
003fb4 b82b
003fb5 935f
003fb6 e158
003fb7 b955
003fb8 eb5f
003fb9 b954
003fba e050
003fbb bd5d
003fbc e550
003fbd bd5c
003fbe 9859
003fbf 915f
003fc0 982c
003fc1 935f
003fc2 2d5c
003fc3 940e 005f
003fc5 e054
003fc6 955a
003fc7 f7f1
003fc8 2d5d
003fc9 940e 005f
003fcb e054
003fcc 955a
003fcd f7f1
003fce 915f
003fcf 940e 005f
003fd1 bc5c
003fd2 9a59
003fd3 b854
003fd4 b82b
003fd5 18f9
003fd6 08e5
003fd7 18d9
003fd8 08c5
003fd9 1969
003fda 08a5
003fdb 7f47
003fdc 1565
003fdd 04a5
003fde f011
003fdf 6048
003fe0 9498      	zzLDx DEC2
003fe1 f619      	brne zzCMDED_b8_1
                 
003fe2 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask old flags
003fe3 940c 0200 	jmp zCMD_start
                 
                 zCMDED_b9: ; CPDR  
                 	zzCMDED_b9_1:
003fe5 6048
003fe6 b8e8
003fe7 b8f2
003fe8 b854
003fe9 b83b
003fea 0000
003feb 0000
003fec b173
003fed b82b
003fee 18f9
003fef 08e5
003ff0 1969
003ff1 08a5
003ff2 1565
003ff3 04a5
003ff4 f409
003ff5 7f47
003ff6 1717      	zzCPD
003ff7 f011      	breq zzCMDED_b9_2
003ff8 fd43      	sbrc zzF,zzPF
003ff9 cfeb      	rjmp zzCMDED_b9_1
                 	zzCMDED_b9_2:
                 	
                 
003ffa b75f      	in zzTmp, SREG
003ffb 7a56      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|___|___|___) ; mask results flags
003ffc 7849      	andi zzF, 	(_I_|___|___|___|_V_|___|_C_) ; mask old flags
003ffd 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
003ffe 2b45      	or zzF, zzTmp ; combine flags
003fff 940c 0200 	jmp zCMD_start
                 
                 zCMDED_ba: ; INDR  
004001 2f56      	mov zzTmp,zzC
                 	zzCMDED_ba_1:
004002 940e 7206 	call PORTIN
004004 b8e8
004005 b8f2
004006 b955
004007 b824
004008 14e6
004009 985d
00400a f100
00400b b82b
00400c 935f
00400d e158
00400e b955
00400f eb5f
004010 b954
004011 e050
004012 bd5d
004013 e550
004014 bd5c
004015 9859
004016 915f
004017 982c
004018 935f
004019 2d5e
00401a 940e 005f
00401c e054
00401d 955a
00401e f7f1
00401f 2d5f
004020 940e 005f
004022 e054
004023 955a
004024 f7f1
004025 915f
004026 940e 005f
004028 bc5c
004029 9a59
00402a b854
00402b b82b      	STRAM zzH,zzL,zzTmp
00402c 18f9
00402d 08e5      	DEC2 zzH,zzL
00402e 94aa      	dec zzB
00402f f691      	brne zzCMDED_ba_1
                 
004030 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004031 6c42      	ori zzF, 	(_I_|___|_Z_|___|___|_N_|___) ; set flags
004032 940c 0200 	jmp zCMD_start
                 
                 zCMDED_bb: ; OTDR  
004034 2f56      	mov zzTmp,zzC
                 	zzCMDED_bb_1:
004035 b8e8
004036 b8f2
004037 b854
004038 b83b
004039 0000
00403a 0000
00403b b173
00403c b82b      	LDRAM_NODDR zzH,zzL,FROMRAM0
00403d 9370 090e 	sts CDATA,FROMRAM0
00403f 940e 7208 	call PORTOUT
004041 18f9
004042 08e5      	DEC2 zzH,zzL
004043 94aa      	dec zzB
004044 f781      	brne zzCMDED_bb_1
                 
004045 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004046 6c42      	ori zzF, 	(_I_|___|_Z_|___|___|_N_|___) ; set flags
004047 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_00: ; NOP   
                 	
                 
004049 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_01: ; LD   BC nn
00404b b998
00404c b982
00404d b854
00404e b83b
00404f 9601
004050 b123
004051 b82b      	LDRAM_PC_NODDR FROMRAM2
004052 b998
004053 b982
004054 b854
004055 b83b
004056 9601
004057 b013
004058 b82b      	LDRAM_PC_NODDR FROMRAM1
004059 2ca1      	mov zzB, FROMRAM1
00405a 2f62      	mov zzC, FROMRAM2
                 
00405b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_02: ; LD   (BC) A
00405d 2f71      	mov FROMRAM0,zzA
                 
00405e b8a8
00405f b962
004060 b915
004061 b824
004062 14a6
004063 985d
004064 f100
004065 b82b
004066 935f
004067 e158
004068 b955
004069 eb5f
00406a b954
00406b e050
00406c bd5d
00406d e550
00406e bd5c
00406f 9859
004070 915f
004071 982c
004072 931f
004073 2d5a
004074 940e 005f
004076 e054
004077 955a
004078 f7f1
004079 2f56
00407a 940e 005f
00407c e054
00407d 955a
00407e f7f1
00407f 915f
004080 940e 005f
004082 bc5c
004083 9a59
004084 b854
004085 b82b      	STRAM zzB,zzC,zzA
004086 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_03: ; INC   BC
004088 0d69
004089 1ca5      	INC2 zzB,zzC
                 
00408a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_04: ; INC   B
00408c 0ca9      	add zzB,ONE
                 
00408d b75f      	in zzTmp, SREG
00408e 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00408f 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004090 2b45      	or zzF, zzTmp ; combine flags
004091 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_05: ; DEC   B
004093 18a9      	sub zzB,ONE
                 
004094 b75f      	in zzTmp, SREG
004095 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004096 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004097 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
004098 2b45      	or zzF, zzTmp ; combine flags
004099 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_06: ; LD   B n
00409b b998
00409c b982
00409d b854
00409e b83b
00409f 9601
0040a0 b173
0040a1 b82b      	LDRAM_PC_NODDR FROMRAM0
0040a2 2ea7      	mov zzB,FROMRAM0
                 
0040a3 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_07: ; RLCA  
0040a5 fb17      	bst zzA,7
0040a6 1f11      	rol zzA
0040a7 f910      	bld zzA,0
                 
0040a8 b75f      	in zzTmp, SREG
0040a9 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
0040aa 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0040ab 2b45      	or zzF, zzTmp ; combine flags
0040ac 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_08: ; EX   AF AFe
0040ae 9150 0901
0040b0 9310 0901
0040b2 2f15      	EX zzA,zzAe
0040b3 9150 0902
0040b5 9340 0902
0040b7 2f45      	EX zzF,zzFe
                 
0040b8 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_09: ; ADD  IY BC
0040ba 0eb6      	add zzIYl,zzC
0040bb 1d3a      	adc zzIYh,zzB
                 
0040bc b75f      	in zzTmp, SREG
0040bd 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
0040be 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0040bf 2b45      	or zzF, zzTmp ; combine flags
0040c0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_0a: ; LD   A (BC)
0040c2 b8a8
0040c3 b962
0040c4 b854
0040c5 b83b
0040c6 0000
0040c7 0000
0040c8 b173
0040c9 b82b      	LDRAM_NODDR zzB,zzC,FROMRAM0
0040ca 2f17      	mov zzA,FROMRAM0
                 
0040cb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_0b: ; DEC   BC
0040cd 1969
0040ce 08a5      	DEC2 zzB,zzC
                 
0040cf 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_0c: ; INC   C
0040d1 0d69      	add zzC,ONE
                 
0040d2 b75f      	in zzTmp, SREG
0040d3 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0040d4 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0040d5 2b45      	or zzF, zzTmp ; combine flags
0040d6 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_0d: ; DEC   C
0040d8 1969      	sub zzC,ONE
                 
0040d9 b75f      	in zzTmp, SREG
0040da 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0040db 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0040dc 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
0040dd 2b45      	or zzF, zzTmp ; combine flags
0040de 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_0e: ; LD   C n
0040e0 b998
0040e1 b982
0040e2 b854
0040e3 b83b
0040e4 9601
0040e5 b173
0040e6 b82b      	LDRAM_PC_NODDR FROMRAM0
0040e7 2f67      	mov zzC,FROMRAM0
                 
0040e8 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_0f: ; RRCA  
0040ea fb10      	bst zzA,0
0040eb 9517      	ror zzA
0040ec f917      	bld zzA,7
                 
0040ed b75f      	in zzTmp, SREG
0040ee 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
0040ef 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0040f0 2b45      	or zzF, zzTmp ; combine flags
0040f1 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_10: ; DJNZ  s
0040f3 b998
0040f4 b982
0040f5 b854
0040f6 b83b
0040f7 9601
0040f8 b173
0040f9 b82b      	LDRAM_PC_NODDR FROMRAM0
0040fa 94aa      	dec zzB
0040fb f029      	breq zCMDFD_10_1
0040fc 2755
0040fd fd77
0040fe 9550
0040ff 0f87
004100 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 	zCMDFD_10_1:
                 
004101 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_11: ; LD   DE nn
004103 b998
004104 b982
004105 b854
004106 b83b
004107 9601
004108 b123
004109 b82b      	LDRAM_PC_NODDR FROMRAM2
00410a b998
00410b b982
00410c b854
00410d b83b
00410e 9601
00410f b013
004110 b82b      	LDRAM_PC_NODDR FROMRAM1
004111 2cc1      	mov zzD, FROMRAM1
004112 2ed2      	mov zzE, FROMRAM2
                 
004113 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_12: ; LD   (DE) A
004115 2f71      	mov FROMRAM0,zzA
                 
004116 b8c8
004117 b8d2
004118 b915
004119 b824
00411a 14c6
00411b 985d
00411c f100
00411d b82b
00411e 935f
00411f e158
004120 b955
004121 eb5f
004122 b954
004123 e050
004124 bd5d
004125 e550
004126 bd5c
004127 9859
004128 915f
004129 982c
00412a 931f
00412b 2d5c
00412c 940e 005f
00412e e054
00412f 955a
004130 f7f1
004131 2d5d
004132 940e 005f
004134 e054
004135 955a
004136 f7f1
004137 915f
004138 940e 005f
00413a bc5c
00413b 9a59
00413c b854
00413d b82b      	STRAM zzD,zzE,zzA
00413e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_13: ; INC   DE
004140 0cd9
004141 1cc5      	INC2 zzD,zzE
                 
004142 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_14: ; INC   D
004144 0cc9      	add zzD,ONE
                 
004145 b75f      	in zzTmp, SREG
004146 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004147 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004148 2b45      	or zzF, zzTmp ; combine flags
004149 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_15: ; DEC   D
00414b 18c9      	sub zzD,ONE
                 
00414c b75f      	in zzTmp, SREG
00414d 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00414e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00414f 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
004150 2b45      	or zzF, zzTmp ; combine flags
004151 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_16: ; LD   D n
004153 b998
004154 b982
004155 b854
004156 b83b
004157 9601
004158 b173
004159 b82b      	LDRAM_PC_NODDR FROMRAM0
00415a 2ec7      	mov zzD,FROMRAM0
                 
00415b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_17: ; RLA   
00415d bf4f      	out SREG,zzF
00415e 1f11      	rol zzA
                 
00415f b75f      	in zzTmp, SREG
004160 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
004161 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
004162 2b45      	or zzF, zzTmp ; combine flags
004163 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_18: ; JR   * s
004165 b998
004166 b982
004167 b854
004168 b83b
004169 9601
00416a b173
00416b b82b      	LDRAM_PC_NODDR FROMRAM0
00416c 1055      	cpse ZERO,ZERO
00416d 940c 0200 	jmp zCMD_start
00416f 2755
004170 fd77
004171 9550
004172 0f87
004173 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
004174 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_19: ; ADD  IY DE
004176 0cbd      	add zzIYl,zzE
004177 1d3c      	adc zzIYh,zzD
                 
004178 b75f      	in zzTmp, SREG
004179 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
00417a 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
00417b 2b45      	or zzF, zzTmp ; combine flags
00417c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_1a: ; LD   A (DE)
00417e b8c8
00417f b8d2
004180 b854
004181 b83b
004182 0000
004183 0000
004184 b173
004185 b82b      	LDRAM_NODDR zzD,zzE,FROMRAM0
004186 2f17      	mov zzA,FROMRAM0
                 
004187 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_1b: ; DEC   DE
004189 18d9
00418a 08c5      	DEC2 zzD,zzE
                 
00418b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_1c: ; INC   E
00418d 0cd9      	add zzE,ONE
                 
00418e b75f      	in zzTmp, SREG
00418f 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004190 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004191 2b45      	or zzF, zzTmp ; combine flags
004192 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_1d: ; DEC   E
004194 18d9      	sub zzE,ONE
                 
004195 b75f      	in zzTmp, SREG
004196 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004197 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004198 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
004199 2b45      	or zzF, zzTmp ; combine flags
00419a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_1e: ; LD   E n
00419c b998
00419d b982
00419e b854
00419f b83b
0041a0 9601
0041a1 b173
0041a2 b82b      	LDRAM_PC_NODDR FROMRAM0
0041a3 2ed7      	mov zzE,FROMRAM0
                 
0041a4 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_1f: ; RRA   
0041a6 bf4f      	out SREG,zzF
0041a7 9517      	ror zzA
                 
0041a8 b75f      	in zzTmp, SREG
0041a9 7851      	andi zzTmp, 	(_I_|___|___|___|___|___|_C_) ; mask results flags
0041aa 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0041ab 2b45      	or zzF, zzTmp ; combine flags
0041ac 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_20: ; JR   NZ s
0041ae b998
0041af b982
0041b0 b854
0041b1 b83b
0041b2 9601
0041b3 b173
0041b4 b82b      	LDRAM_PC_NODDR FROMRAM0
0041b5 fd41      	sbrc zzF,zzZF
0041b6 940c 0200 	jmp zCMD_start
0041b8 2755
0041b9 fd77
0041ba 9550
0041bb 0f87
0041bc 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
0041bd 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_21: ; LD   IY nn
0041bf b998
0041c0 b982
0041c1 b854
0041c2 b83b
0041c3 9601
0041c4 b123
0041c5 b82b      	LDRAM_PC_NODDR FROMRAM2
0041c6 b998
0041c7 b982
0041c8 b854
0041c9 b83b
0041ca 9601
0041cb b013
0041cc b82b      	LDRAM_PC_NODDR FROMRAM1
0041cd 2d31      	mov zzIYh, FROMRAM1
0041ce 2eb2      	mov zzIYl, FROMRAM2
                 
0041cf 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_22: ; LD   (ww) IY
                 	
                 
0041d1 b998
0041d2 b982
0041d3 b854
0041d4 b83b
0041d5 9601
0041d6 b123
0041d7 b82b      	LDRAM_PC_NODDR FROMRAM2
0041d8 b998
0041d9 b982
0041da b854
0041db b83b
0041dc 9601
0041dd b013
0041de b82b      	LDRAM_PC_NODDR FROMRAM1
0041df b818
0041e0 b922
0041e1 b8b5
0041e2 b824
0041e3 1416
0041e4 985d
0041e5 f100
0041e6 b82b
0041e7 935f
0041e8 e158
0041e9 b955
0041ea eb5f
0041eb b954
0041ec e050
0041ed bd5d
0041ee e550
0041ef bd5c
0041f0 9859
0041f1 915f
0041f2 982c
0041f3 92bf
0041f4 2d51
0041f5 940e 005f
0041f7 e054
0041f8 955a
0041f9 f7f1
0041fa 2f52
0041fb 940e 005f
0041fd e054
0041fe 955a
0041ff f7f1
004200 915f
004201 940e 005f
004203 bc5c
004204 9a59
004205 b854
004206 b82b      	STRAM FROMRAM1,FROMRAM2,zzIYl
004207 0d29
004208 1c15      	INC2 FROMRAM1,FROMRAM2
004209 b818
00420a b922
00420b b935
00420c b824
00420d 1416
00420e 985d
00420f f100
004210 b82b
004211 935f
004212 e158
004213 b955
004214 eb5f
004215 b954
004216 e050
004217 bd5d
004218 e550
004219 bd5c
00421a 9859
00421b 915f
00421c 982c
00421d 933f
00421e 2d51
00421f 940e 005f
004221 e054
004222 955a
004223 f7f1
004224 2f52
004225 940e 005f
004227 e054
004228 955a
004229 f7f1
00422a 915f
00422b 940e 005f
00422d bc5c
00422e 9a59
00422f b854
004230 b82b      	STRAM FROMRAM1,FROMRAM2,zzIYh
004231 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_23: ; INC   IY
004233 0cb9
004234 1d35      	INC2 zzIYh,zzIYl
                 
004235 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_24: ; INC   IYh
004237 0d39      	add zzIYh,ONE
                 
004238 b75f      	in zzTmp, SREG
004239 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00423a 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00423b 2b45      	or zzF, zzTmp ; combine flags
00423c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_25: ; DEC   IYh
00423e 1939      	sub zzIYh,ONE
                 
00423f b75f      	in zzTmp, SREG
004240 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004241 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004242 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
004243 2b45      	or zzF, zzTmp ; combine flags
004244 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_26: ; LD   IYh n
004246 b998
004247 b982
004248 b854
004249 b83b
00424a 9601
00424b b173
00424c b82b      	LDRAM_PC_NODDR FROMRAM0
00424d 2f37      	mov zzIYh,FROMRAM0
                 
00424e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_27: ; DAA   
004250 e1bb
004251 2fa1
004252 2755
004253 fd45
004254 6051
004255 fd40
004256 6052
004257 fd46
004258 6054
004259 0fb5
00425a 911c
00425b e058
00425c 0fb5
00425d 914c      	zzDAA
                 
00425e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_28: ; JR   Z s
004260 b998
004261 b982
004262 b854
004263 b83b
004264 9601
004265 b173
004266 b82b      	LDRAM_PC_NODDR FROMRAM0
004267 ff41      	sbrs zzF,zzZF
004268 940c 0200 	jmp zCMD_start
00426a 2755
00426b fd77
00426c 9550
00426d 0f87
00426e 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
00426f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_29: ; ADD  IY IY
004271 0cbb      	add zzIYl,zzIYl
004272 1f33      	adc zzIYh,zzIYh
                 
004273 b75f      	in zzTmp, SREG
004274 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
004275 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
004276 2b45      	or zzF, zzTmp ; combine flags
004277 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_2a: ; LD   IY (ww)
004279 b998
00427a b982
00427b b854
00427c b83b
00427d 9601
00427e b123
00427f b82b      	LDRAM_PC_NODDR FROMRAM2
004280 b998
004281 b982
004282 b854
004283 b83b
004284 9601
004285 b013
004286 b82b      	LDRAM_PC_NODDR FROMRAM1
004287 b818
004288 b922
004289 b854
00428a b83b
00428b 0000
00428c 0000
00428d b0b3
00428e b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzIYl
00428f 0d29
004290 1c15      	INC2 FROMRAM1,FROMRAM2
004291 b818
004292 b922
004293 b854
004294 b83b
004295 0000
004296 0000
004297 b133
004298 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,zzIYh
                 	
                 
004299 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_2b: ; DEC   IY
00429b 18b9
00429c 0935      	DEC2 zzIYh,zzIYl
                 
00429d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_2c: ; INC   IYl
00429f 0cb9      	add zzIYl,ONE
                 
0042a0 b75f      	in zzTmp, SREG
0042a1 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0042a2 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0042a3 2b45      	or zzF, zzTmp ; combine flags
0042a4 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_2d: ; DEC   IYl
0042a6 18b9      	sub zzIYl,ONE
                 
0042a7 b75f      	in zzTmp, SREG
0042a8 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0042a9 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0042aa 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
0042ab 2b45      	or zzF, zzTmp ; combine flags
0042ac 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_2e: ; LD   IYl n
0042ae b998
0042af b982
0042b0 b854
0042b1 b83b
0042b2 9601
0042b3 b173
0042b4 b82b      	LDRAM_PC_NODDR FROMRAM0
0042b5 2eb7      	mov zzIYl,FROMRAM0
                 
0042b6 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_2f: ; CPL   A
0042b8 9510      	com zzA
                 
0042b9 784f      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|_C_) ; mask old flags
0042ba 6e40      	ori zzF, 	(_I_|___|___|_H_|___|_N_|___) ; set flags
0042bb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_30: ; JR   NC s
0042bd b998
0042be b982
0042bf b854
0042c0 b83b
0042c1 9601
0042c2 b173
0042c3 b82b      	LDRAM_PC_NODDR FROMRAM0
0042c4 fd40      	sbrc zzF,zzCF
0042c5 940c 0200 	jmp zCMD_start
0042c7 2755
0042c8 fd77
0042c9 9550
0042ca 0f87
0042cb 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
0042cc 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_31: ; LD   SP nn
0042ce b998
0042cf b982
0042d0 b854
0042d1 b83b
0042d2 9601
0042d3 b123
0042d4 b82b      	LDRAM_PC_NODDR FROMRAM2
0042d5 b998
0042d6 b982
0042d7 b854
0042d8 b83b
0042d9 9601
0042da b013
0042db b82b      	LDRAM_PC_NODDR FROMRAM1
0042dc 2dd1      	mov zzSPh, FROMRAM1
0042dd 2fc2      	mov zzSPl, FROMRAM2
                 
0042de 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_32: ; LD   (nn) A
0042e0 2f71      	mov FROMRAM0,zzA
                 
0042e1 b998
0042e2 b982
0042e3 b854
0042e4 b83b
0042e5 9601
0042e6 b123
0042e7 b82b      	LDRAM_PC_NODDR FROMRAM2
0042e8 b998
0042e9 b982
0042ea b854
0042eb b83b
0042ec 9601
0042ed b013
0042ee b82b      	LDRAM_PC_NODDR FROMRAM1
0042ef b818
0042f0 b922
0042f1 b915
0042f2 b824
0042f3 1416
0042f4 985d
0042f5 f100
0042f6 b82b
0042f7 935f
0042f8 e158
0042f9 b955
0042fa eb5f
0042fb b954
0042fc e050
0042fd bd5d
0042fe e550
0042ff bd5c
004300 9859
004301 915f
004302 982c
004303 931f
004304 2d51
004305 940e 005f
004307 e054
004308 955a
004309 f7f1
00430a 2f52
00430b 940e 005f
00430d e054
00430e 955a
00430f f7f1
004310 915f
004311 940e 005f
004313 bc5c
004314 9a59
004315 b854
004316 b82b      	STRAM FROMRAM1,FROMRAM2,zzA
004317 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_33: ; INC   SP
004319 0dc9
00431a 1dd5      	INC2 zzSPh,zzSPl
                 
00431b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_34: ; INC   (IY+d)
00431d b998
00431e b982
00431f b854
004320 b83b
004321 9601
004322 b173
004323 b82b      	LDRAM_PC_NODDR FROMRAM0
004324 2d2b      	mov FROMRAM2,zzIYl
004325 2e13      	mov FROMRAM1,zzIYh
004326 2755
004327 fd77
004328 9550
004329 0f27
00432a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00432b b818
00432c b922
00432d b854
00432e b83b
00432f 0000
004330 0000
004331 b173
004332 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004333 0d79      	add FROMRAM0,ONE
                 
004334 b67f      	in _sreg, SREG
004335 b818
004336 b922
004337 b975
004338 b824
004339 1416
00433a 985d
00433b f100
00433c b82b
00433d 935f
00433e e158
00433f b955
004340 eb5f
004341 b954
004342 e050
004343 bd5d
004344 e550
004345 bd5c
004346 9859
004347 915f
004348 982c
004349 937f
00434a 2d51
00434b 940e 005f
00434d e054
00434e 955a
00434f f7f1
004350 2f52
004351 940e 005f
004353 e054
004354 955a
004355 f7f1
004356 915f
004357 940e 005f
004359 bc5c
00435a 9a59
00435b b854
00435c b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00435d be7f      	out SREG,_sreg
00435e b75f      	in zzTmp, SREG
00435f 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004360 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004361 2b45      	or zzF, zzTmp ; combine flags
004362 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_35: ; DEC   (IY+d)
004364 b998
004365 b982
004366 b854
004367 b83b
004368 9601
004369 b173
00436a b82b      	LDRAM_PC_NODDR FROMRAM0
00436b 2d2b      	mov FROMRAM2,zzIYl
00436c 2e13      	mov FROMRAM1,zzIYh
00436d 2755
00436e fd77
00436f 9550
004370 0f27
004371 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004372 b818
004373 b922
004374 b854
004375 b83b
004376 0000
004377 0000
004378 b173
004379 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00437a 1979      	sub FROMRAM0,ONE
                 
00437b b67f      	in _sreg, SREG
00437c b818
00437d b922
00437e b975
00437f b824
004380 1416
004381 985d
004382 f100
004383 b82b
004384 935f
004385 e158
004386 b955
004387 eb5f
004388 b954
004389 e050
00438a bd5d
00438b e550
00438c bd5c
00438d 9859
00438e 915f
00438f 982c
004390 937f
004391 2d51
004392 940e 005f
004394 e054
004395 955a
004396 f7f1
004397 2f52
004398 940e 005f
00439a e054
00439b 955a
00439c f7f1
00439d 915f
00439e 940e 005f
0043a0 bc5c
0043a1 9a59
0043a2 b854
0043a3 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0043a4 be7f      	out SREG,_sreg
0043a5 b75f      	in zzTmp, SREG
0043a6 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
0043a7 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0043a8 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
0043a9 2b45      	or zzF, zzTmp ; combine flags
0043aa 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_36: ; LD   (IY+d) n
0043ac b998
0043ad b982
0043ae b854
0043af b83b
0043b0 9601
0043b1 b173
0043b2 b82b      	LDRAM_PC_NODDR FROMRAM0
0043b3 2d2b      	mov FROMRAM2,zzIYl
0043b4 2e13      	mov FROMRAM1,zzIYh
0043b5 2755
0043b6 fd77
0043b7 9550
0043b8 0f27
0043b9 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0043ba b998
0043bb b982
0043bc b854
0043bd b83b
0043be 9601
0043bf b173
0043c0 b82b      	LDRAM_PC_NODDR FROMRAM0
0043c1 2f77      	mov FROMRAM0,FROMRAM0
                 
0043c2 b67f      	in _sreg, SREG
0043c3 b818
0043c4 b922
0043c5 b975
0043c6 b824
0043c7 1416
0043c8 985d
0043c9 f100
0043ca b82b
0043cb 935f
0043cc e158
0043cd b955
0043ce eb5f
0043cf b954
0043d0 e050
0043d1 bd5d
0043d2 e550
0043d3 bd5c
0043d4 9859
0043d5 915f
0043d6 982c
0043d7 937f
0043d8 2d51
0043d9 940e 005f
0043db e054
0043dc 955a
0043dd f7f1
0043de 2f52
0043df 940e 005f
0043e1 e054
0043e2 955a
0043e3 f7f1
0043e4 915f
0043e5 940e 005f
0043e7 bc5c
0043e8 9a59
0043e9 b854
0043ea b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0043eb be7f      	out SREG,_sreg
0043ec 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_37: ; SCF   
                 	
                 
0043ee 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
0043ef 6841      	ori zzF, 	(_I_|___|___|___|___|___|_C_) ; set flags
0043f0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_38: ; JR   C s
0043f2 b998
0043f3 b982
0043f4 b854
0043f5 b83b
0043f6 9601
0043f7 b173
0043f8 b82b      	LDRAM_PC_NODDR FROMRAM0
0043f9 ff40      	sbrs zzF,zzCF
0043fa 940c 0200 	jmp zCMD_start
0043fc 2755
0043fd fd77
0043fe 9550
0043ff 0f87
004400 1f95      	ADDWS zzPCh,zzPCl,FROMRAM0
                 
004401 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_39: ; ADD  IY SP
004403 0ebc      	add zzIYl,zzSPl
004404 1f3d      	adc zzIYh,zzSPh
                 
004405 b75f      	in zzTmp, SREG
004406 7a51      	andi zzTmp, 	(_I_|___|___|_H_|___|___|_C_) ; mask results flags
004407 784e      	andi zzF, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask old flags
004408 2b45      	or zzF, zzTmp ; combine flags
004409 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_3a: ; LD   A (nn)
00440b b998
00440c b982
00440d b854
00440e b83b
00440f 9601
004410 b123
004411 b82b      	LDRAM_PC_NODDR FROMRAM2
004412 b998
004413 b982
004414 b854
004415 b83b
004416 9601
004417 b013
004418 b82b      	LDRAM_PC_NODDR FROMRAM1
004419 b818
00441a b922
00441b b854
00441c b83b
00441d 0000
00441e 0000
00441f b173
004420 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004421 2f17      	mov zzA,FROMRAM0
                 
004422 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_3b: ; DEC   SP
004424 19c9
004425 09d5      	DEC2 zzSPh,zzSPl
                 
004426 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_3c: ; INC   A
004428 0d19      	add zzA,ONE
                 
004429 b75f      	in zzTmp, SREG
00442a 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
00442b 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00442c 2b45      	or zzF, zzTmp ; combine flags
00442d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_3d: ; DEC   A
00442f 1919      	sub zzA,ONE
                 
004430 b75f      	in zzTmp, SREG
004431 7a5e      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|___) ; mask results flags
004432 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
004433 6c40      	ori zzF, 	(_I_|___|___|___|___|_N_|___) ; set flags
004434 2b45      	or zzF, zzTmp ; combine flags
004435 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_3e: ; LD   A n
004437 b998
004438 b982
004439 b854
00443a b83b
00443b 9601
00443c b173
00443d b82b      	LDRAM_PC_NODDR FROMRAM0
00443e 2f17      	mov zzA,FROMRAM0
                 
00443f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_3f: ; CCF   
004441 784f      	andi zzF,(_I_|_S_|_Z_|_V_|_C_)
004442 fb40      	bst zzF,zzCF
004443 f945      	bld zzF,zzHF
004444 e051      	ldi zzTmp,1<<zzCF
004445 2745      	eor zzF,zzTmp
                 
004446 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_40: ; LD   B B
004448 2caa      	mov zzB,zzB
                 
004449 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_41: ; LD   B C
00444b 2ea6      	mov zzB,zzC
                 
00444c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_42: ; LD   B D
00444e 2cac      	mov zzB,zzD
                 
00444f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_43: ; LD   B E
004451 2cad      	mov zzB,zzE
                 
004452 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_44: ; LD   B IYh
004454 2ea3      	mov zzB,zzIYh
                 
004455 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_45: ; LD   B IYl
004457 2cab      	mov zzB,zzIYl
                 
004458 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_46: ; LD   B (IY+d)
00445a b998
00445b b982
00445c b854
00445d b83b
00445e 9601
00445f b173
004460 b82b      	LDRAM_PC_NODDR FROMRAM0
004461 2d2b      	mov FROMRAM2,zzIYl
004462 2e13      	mov FROMRAM1,zzIYh
004463 2755
004464 fd77
004465 9550
004466 0f27
004467 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004468 b818
004469 b922
00446a b854
00446b b83b
00446c 0000
00446d 0000
00446e b173
00446f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004470 2ea7      	mov zzB,FROMRAM0
                 
004471 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_47: ; LD   B A
004473 2ea1      	mov zzB,zzA
                 
004474 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_48: ; LD   C B
004476 2d6a      	mov zzC,zzB
                 
004477 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_49: ; LD   C C
004479 2f66      	mov zzC,zzC
                 
00447a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_4a: ; LD   C D
00447c 2d6c      	mov zzC,zzD
                 
00447d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_4b: ; LD   C E
00447f 2d6d      	mov zzC,zzE
                 
004480 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_4c: ; LD   C IYh
004482 2f63      	mov zzC,zzIYh
                 
004483 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_4d: ; LD   C IYl
004485 2d6b      	mov zzC,zzIYl
                 
004486 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_4e: ; LD   C (IY+d)
004488 b998
004489 b982
00448a b854
00448b b83b
00448c 9601
00448d b173
00448e b82b      	LDRAM_PC_NODDR FROMRAM0
00448f 2d2b      	mov FROMRAM2,zzIYl
004490 2e13      	mov FROMRAM1,zzIYh
004491 2755
004492 fd77
004493 9550
004494 0f27
004495 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004496 b818
004497 b922
004498 b854
004499 b83b
00449a 0000
00449b 0000
00449c b173
00449d b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00449e 2f67      	mov zzC,FROMRAM0
                 
00449f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_4f: ; LD   C A
0044a1 2f61      	mov zzC,zzA
                 
0044a2 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_50: ; LD   D B
0044a4 2cca      	mov zzD,zzB
                 
0044a5 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_51: ; LD   D C
0044a7 2ec6      	mov zzD,zzC
                 
0044a8 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_52: ; LD   D D
0044aa 2ccc      	mov zzD,zzD
                 
0044ab 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_53: ; LD   D E
0044ad 2ccd      	mov zzD,zzE
                 
0044ae 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_54: ; LD   D IYh
0044b0 2ec3      	mov zzD,zzIYh
                 
0044b1 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_55: ; LD   D IYl
0044b3 2ccb      	mov zzD,zzIYl
                 
0044b4 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_56: ; LD   D (IY+d)
0044b6 b998
0044b7 b982
0044b8 b854
0044b9 b83b
0044ba 9601
0044bb b173
0044bc b82b      	LDRAM_PC_NODDR FROMRAM0
0044bd 2d2b      	mov FROMRAM2,zzIYl
0044be 2e13      	mov FROMRAM1,zzIYh
0044bf 2755
0044c0 fd77
0044c1 9550
0044c2 0f27
0044c3 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0044c4 b818
0044c5 b922
0044c6 b854
0044c7 b83b
0044c8 0000
0044c9 0000
0044ca b173
0044cb b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0044cc 2ec7      	mov zzD,FROMRAM0
                 
0044cd 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_57: ; LD   D A
0044cf 2ec1      	mov zzD,zzA
                 
0044d0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_58: ; LD   E B
0044d2 2cda      	mov zzE,zzB
                 
0044d3 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_59: ; LD   E C
0044d5 2ed6      	mov zzE,zzC
                 
0044d6 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_5a: ; LD   E D
0044d8 2cdc      	mov zzE,zzD
                 
0044d9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_5b: ; LD   E E
0044db 2cdd      	mov zzE,zzE
                 
0044dc 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_5c: ; LD   E IYh
0044de 2ed3      	mov zzE,zzIYh
                 
0044df 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_5d: ; LD   E IYl
0044e1 2cdb      	mov zzE,zzIYl
                 
0044e2 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_5e: ; LD   E (IY+d)
0044e4 b998
0044e5 b982
0044e6 b854
0044e7 b83b
0044e8 9601
0044e9 b173
0044ea b82b      	LDRAM_PC_NODDR FROMRAM0
0044eb 2d2b      	mov FROMRAM2,zzIYl
0044ec 2e13      	mov FROMRAM1,zzIYh
0044ed 2755
0044ee fd77
0044ef 9550
0044f0 0f27
0044f1 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0044f2 b818
0044f3 b922
0044f4 b854
0044f5 b83b
0044f6 0000
0044f7 0000
0044f8 b173
0044f9 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0044fa 2ed7      	mov zzE,FROMRAM0
                 
0044fb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_5f: ; LD   E A
0044fd 2ed1      	mov zzE,zzA
                 
0044fe 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_60: ; LD   IYh B
004500 2d3a      	mov zzIYh,zzB
                 
004501 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_61: ; LD   IYh C
004503 2f36      	mov zzIYh,zzC
                 
004504 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_62: ; LD   IYh D
004506 2d3c      	mov zzIYh,zzD
                 
004507 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_63: ; LD   IYh E
004509 2d3d      	mov zzIYh,zzE
                 
00450a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_64: ; LD   IYh IYh
00450c 2f33      	mov zzIYh,zzIYh
                 
00450d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_65: ; LD   IYh IYl
00450f 2d3b      	mov zzIYh,zzIYl
                 
004510 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_66: ; LD   H (IY+d)
004512 b998
004513 b982
004514 b854
004515 b83b
004516 9601
004517 b173
004518 b82b      	LDRAM_PC_NODDR FROMRAM0
004519 2d2b      	mov FROMRAM2,zzIYl
00451a 2e13      	mov FROMRAM1,zzIYh
00451b 2755
00451c fd77
00451d 9550
00451e 0f27
00451f 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004520 b818
004521 b922
004522 b854
004523 b83b
004524 0000
004525 0000
004526 b173
004527 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004528 2ee7      	mov zzH,FROMRAM0
                 
004529 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_67: ; LD   IYh A
00452b 2f31      	mov zzIYh,zzA
                 
00452c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_68: ; LD   IYl B
00452e 2cba      	mov zzIYl,zzB
                 
00452f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_69: ; LD   IYl C
004531 2eb6      	mov zzIYl,zzC
                 
004532 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_6a: ; LD   IYl D
004534 2cbc      	mov zzIYl,zzD
                 
004535 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_6b: ; LD   IYl E
004537 2cbd      	mov zzIYl,zzE
                 
004538 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_6c: ; LD   IYl IYh
00453a 2eb3      	mov zzIYl,zzIYh
                 
00453b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_6d: ; LD   IYl IYl
00453d 2cbb      	mov zzIYl,zzIYl
                 
00453e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_6e: ; LD   L (IY+d)
004540 b998
004541 b982
004542 b854
004543 b83b
004544 9601
004545 b173
004546 b82b      	LDRAM_PC_NODDR FROMRAM0
004547 2d2b      	mov FROMRAM2,zzIYl
004548 2e13      	mov FROMRAM1,zzIYh
004549 2755
00454a fd77
00454b 9550
00454c 0f27
00454d 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00454e b818
00454f b922
004550 b854
004551 b83b
004552 0000
004553 0000
004554 b173
004555 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004556 2ef7      	mov zzL,FROMRAM0
                 
004557 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_6f: ; LD   IYl A
004559 2eb1      	mov zzIYl,zzA
                 
00455a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_70: ; LD   (IY+d) B
00455c b998
00455d b982
00455e b854
00455f b83b
004560 9601
004561 b173
004562 b82b      	LDRAM_PC_NODDR FROMRAM0
004563 2d2b      	mov FROMRAM2,zzIYl
004564 2e13      	mov FROMRAM1,zzIYh
004565 2755
004566 fd77
004567 9550
004568 0f27
004569 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00456a 2d7a      	mov FROMRAM0,zzB
                 
00456b b67f      	in _sreg, SREG
00456c b818
00456d b922
00456e b975
00456f b824
004570 1416
004571 985d
004572 f100
004573 b82b
004574 935f
004575 e158
004576 b955
004577 eb5f
004578 b954
004579 e050
00457a bd5d
00457b e550
00457c bd5c
00457d 9859
00457e 915f
00457f 982c
004580 937f
004581 2d51
004582 940e 005f
004584 e054
004585 955a
004586 f7f1
004587 2f52
004588 940e 005f
00458a e054
00458b 955a
00458c f7f1
00458d 915f
00458e 940e 005f
004590 bc5c
004591 9a59
004592 b854
004593 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
004594 be7f      	out SREG,_sreg
004595 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_71: ; LD   (IY+d) C
004597 b998
004598 b982
004599 b854
00459a b83b
00459b 9601
00459c b173
00459d b82b      	LDRAM_PC_NODDR FROMRAM0
00459e 2d2b      	mov FROMRAM2,zzIYl
00459f 2e13      	mov FROMRAM1,zzIYh
0045a0 2755
0045a1 fd77
0045a2 9550
0045a3 0f27
0045a4 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0045a5 2f76      	mov FROMRAM0,zzC
                 
0045a6 b67f      	in _sreg, SREG
0045a7 b818
0045a8 b922
0045a9 b975
0045aa b824
0045ab 1416
0045ac 985d
0045ad f100
0045ae b82b
0045af 935f
0045b0 e158
0045b1 b955
0045b2 eb5f
0045b3 b954
0045b4 e050
0045b5 bd5d
0045b6 e550
0045b7 bd5c
0045b8 9859
0045b9 915f
0045ba 982c
0045bb 937f
0045bc 2d51
0045bd 940e 005f
0045bf e054
0045c0 955a
0045c1 f7f1
0045c2 2f52
0045c3 940e 005f
0045c5 e054
0045c6 955a
0045c7 f7f1
0045c8 915f
0045c9 940e 005f
0045cb bc5c
0045cc 9a59
0045cd b854
0045ce b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0045cf be7f      	out SREG,_sreg
0045d0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_72: ; LD   (IY+d) D
0045d2 b998
0045d3 b982
0045d4 b854
0045d5 b83b
0045d6 9601
0045d7 b173
0045d8 b82b      	LDRAM_PC_NODDR FROMRAM0
0045d9 2d2b      	mov FROMRAM2,zzIYl
0045da 2e13      	mov FROMRAM1,zzIYh
0045db 2755
0045dc fd77
0045dd 9550
0045de 0f27
0045df 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0045e0 2d7c      	mov FROMRAM0,zzD
                 
0045e1 b67f      	in _sreg, SREG
0045e2 b818
0045e3 b922
0045e4 b975
0045e5 b824
0045e6 1416
0045e7 985d
0045e8 f100
0045e9 b82b
0045ea 935f
0045eb e158
0045ec b955
0045ed eb5f
0045ee b954
0045ef e050
0045f0 bd5d
0045f1 e550
0045f2 bd5c
0045f3 9859
0045f4 915f
0045f5 982c
0045f6 937f
0045f7 2d51
0045f8 940e 005f
0045fa e054
0045fb 955a
0045fc f7f1
0045fd 2f52
0045fe 940e 005f
004600 e054
004601 955a
004602 f7f1
004603 915f
004604 940e 005f
004606 bc5c
004607 9a59
004608 b854
004609 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00460a be7f      	out SREG,_sreg
00460b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_73: ; LD   (IY+d) E
00460d b998
00460e b982
00460f b854
004610 b83b
004611 9601
004612 b173
004613 b82b      	LDRAM_PC_NODDR FROMRAM0
004614 2d2b      	mov FROMRAM2,zzIYl
004615 2e13      	mov FROMRAM1,zzIYh
004616 2755
004617 fd77
004618 9550
004619 0f27
00461a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00461b 2d7d      	mov FROMRAM0,zzE
                 
00461c b67f      	in _sreg, SREG
00461d b818
00461e b922
00461f b975
004620 b824
004621 1416
004622 985d
004623 f100
004624 b82b
004625 935f
004626 e158
004627 b955
004628 eb5f
004629 b954
00462a e050
00462b bd5d
00462c e550
00462d bd5c
00462e 9859
00462f 915f
004630 982c
004631 937f
004632 2d51
004633 940e 005f
004635 e054
004636 955a
004637 f7f1
004638 2f52
004639 940e 005f
00463b e054
00463c 955a
00463d f7f1
00463e 915f
00463f 940e 005f
004641 bc5c
004642 9a59
004643 b854
004644 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
004645 be7f      	out SREG,_sreg
004646 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_74: ; LD   (IY+d) H
004648 b998
004649 b982
00464a b854
00464b b83b
00464c 9601
00464d b173
00464e b82b      	LDRAM_PC_NODDR FROMRAM0
00464f 2d2b      	mov FROMRAM2,zzIYl
004650 2e13      	mov FROMRAM1,zzIYh
004651 2755
004652 fd77
004653 9550
004654 0f27
004655 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004656 2d7e      	mov FROMRAM0,zzH
                 
004657 b67f      	in _sreg, SREG
004658 b818
004659 b922
00465a b975
00465b b824
00465c 1416
00465d 985d
00465e f100
00465f b82b
004660 935f
004661 e158
004662 b955
004663 eb5f
004664 b954
004665 e050
004666 bd5d
004667 e550
004668 bd5c
004669 9859
00466a 915f
00466b 982c
00466c 937f
00466d 2d51
00466e 940e 005f
004670 e054
004671 955a
004672 f7f1
004673 2f52
004674 940e 005f
004676 e054
004677 955a
004678 f7f1
004679 915f
00467a 940e 005f
00467c bc5c
00467d 9a59
00467e b854
00467f b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
004680 be7f      	out SREG,_sreg
004681 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_75: ; LD   (IY+d) L
004683 b998
004684 b982
004685 b854
004686 b83b
004687 9601
004688 b173
004689 b82b      	LDRAM_PC_NODDR FROMRAM0
00468a 2d2b      	mov FROMRAM2,zzIYl
00468b 2e13      	mov FROMRAM1,zzIYh
00468c 2755
00468d fd77
00468e 9550
00468f 0f27
004690 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004691 2d7f      	mov FROMRAM0,zzL
                 
004692 b67f      	in _sreg, SREG
004693 b818
004694 b922
004695 b975
004696 b824
004697 1416
004698 985d
004699 f100
00469a b82b
00469b 935f
00469c e158
00469d b955
00469e eb5f
00469f b954
0046a0 e050
0046a1 bd5d
0046a2 e550
0046a3 bd5c
0046a4 9859
0046a5 915f
0046a6 982c
0046a7 937f
0046a8 2d51
0046a9 940e 005f
0046ab e054
0046ac 955a
0046ad f7f1
0046ae 2f52
0046af 940e 005f
0046b1 e054
0046b2 955a
0046b3 f7f1
0046b4 915f
0046b5 940e 005f
0046b7 bc5c
0046b8 9a59
0046b9 b854
0046ba b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0046bb be7f      	out SREG,_sreg
0046bc 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_76: ; HALT  
0046be 1989
0046bf 0995      	DEC2 zzPCh,zzPCl
                 
0046c0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_77: ; LD   (IY+d) A
0046c2 b998
0046c3 b982
0046c4 b854
0046c5 b83b
0046c6 9601
0046c7 b173
0046c8 b82b      	LDRAM_PC_NODDR FROMRAM0
0046c9 2d2b      	mov FROMRAM2,zzIYl
0046ca 2e13      	mov FROMRAM1,zzIYh
0046cb 2755
0046cc fd77
0046cd 9550
0046ce 0f27
0046cf 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0046d0 2f71      	mov FROMRAM0,zzA
                 
0046d1 b67f      	in _sreg, SREG
0046d2 b818
0046d3 b922
0046d4 b975
0046d5 b824
0046d6 1416
0046d7 985d
0046d8 f100
0046d9 b82b
0046da 935f
0046db e158
0046dc b955
0046dd eb5f
0046de b954
0046df e050
0046e0 bd5d
0046e1 e550
0046e2 bd5c
0046e3 9859
0046e4 915f
0046e5 982c
0046e6 937f
0046e7 2d51
0046e8 940e 005f
0046ea e054
0046eb 955a
0046ec f7f1
0046ed 2f52
0046ee 940e 005f
0046f0 e054
0046f1 955a
0046f2 f7f1
0046f3 915f
0046f4 940e 005f
0046f6 bc5c
0046f7 9a59
0046f8 b854
0046f9 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0046fa be7f      	out SREG,_sreg
0046fb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_78: ; LD   A B
0046fd 2d1a      	mov zzA,zzB
                 
0046fe 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_79: ; LD   A C
004700 2f16      	mov zzA,zzC
                 
004701 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_7a: ; LD   A D
004703 2d1c      	mov zzA,zzD
                 
004704 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_7b: ; LD   A E
004706 2d1d      	mov zzA,zzE
                 
004707 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_7c: ; LD   A IYh
004709 2f13      	mov zzA,zzIYh
                 
00470a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_7d: ; LD   A IYl
00470c 2d1b      	mov zzA,zzIYl
                 
00470d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_7e: ; LD   A (IY+d)
00470f b998
004710 b982
004711 b854
004712 b83b
004713 9601
004714 b173
004715 b82b      	LDRAM_PC_NODDR FROMRAM0
004716 2d2b      	mov FROMRAM2,zzIYl
004717 2e13      	mov FROMRAM1,zzIYh
004718 2755
004719 fd77
00471a 9550
00471b 0f27
00471c 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00471d b818
00471e b922
00471f b854
004720 b83b
004721 0000
004722 0000
004723 b173
004724 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004725 2f17      	mov zzA,FROMRAM0
                 
004726 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_7f: ; LD   A A
004728 2f11      	mov zzA,zzA
                 
004729 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_80: ; ADD  A B
00472b 0d1a      	add zzA,zzB
                 
00472c b74f      	in zzF, SREG
00472d 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00472e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_81: ; ADD  A C
004730 0f16      	add zzA,zzC
                 
004731 b74f      	in zzF, SREG
004732 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004733 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_82: ; ADD  A D
004735 0d1c      	add zzA,zzD
                 
004736 b74f      	in zzF, SREG
004737 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004738 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_83: ; ADD  A E
00473a 0d1d      	add zzA,zzE
                 
00473b b74f      	in zzF, SREG
00473c 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00473d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_84: ; ADD  A IYh
00473f 0f13      	add zzA,zzIYh
                 
004740 b74f      	in zzF, SREG
004741 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004742 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_85: ; ADD  A IYl
004744 0d1b      	add zzA,zzIYl
                 
004745 b74f      	in zzF, SREG
004746 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004747 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_86: ; ADD  A (IY+d)
004749 b998
00474a b982
00474b b854
00474c b83b
00474d 9601
00474e b173
00474f b82b      	LDRAM_PC_NODDR FROMRAM0
004750 2d2b      	mov FROMRAM2,zzIYl
004751 2e13      	mov FROMRAM1,zzIYh
004752 2755
004753 fd77
004754 9550
004755 0f27
004756 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004757 b818
004758 b922
004759 b854
00475a b83b
00475b 0000
00475c 0000
00475d b173
00475e b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00475f 0f17      	add zzA,FROMRAM0
                 
004760 b74f      	in zzF, SREG
004761 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004762 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_87: ; ADD  A A
004764 0f11      	add zzA,zzA
                 
004765 b74f      	in zzF, SREG
004766 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004767 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_88: ; ADC  A B
004769 bf4f      	out SREG,zzF
00476a 1d1a      	adc zzA,zzB
                 
00476b b74f      	in zzF, SREG
00476c 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00476d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_89: ; ADC  A C
00476f bf4f      	out SREG,zzF
004770 1f16      	adc zzA,zzC
                 
004771 b74f      	in zzF, SREG
004772 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004773 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_8a: ; ADC  A D
004775 bf4f      	out SREG,zzF
004776 1d1c      	adc zzA,zzD
                 
004777 b74f      	in zzF, SREG
004778 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004779 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_8b: ; ADC  A E
00477b bf4f      	out SREG,zzF
00477c 1d1d      	adc zzA,zzE
                 
00477d b74f      	in zzF, SREG
00477e 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00477f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_8c: ; ADC  A IYh
004781 bf4f      	out SREG,zzF
004782 1f13      	adc zzA,zzIYh
                 
004783 b74f      	in zzF, SREG
004784 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004785 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_8d: ; ADC  A IYl
004787 bf4f      	out SREG,zzF
004788 1d1b      	adc zzA,zzIYl
                 
004789 b74f      	in zzF, SREG
00478a 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
00478b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_8e: ; ADC  A (IY+d)
00478d b998
00478e b982
00478f b854
004790 b83b
004791 9601
004792 b173
004793 b82b      	LDRAM_PC_NODDR FROMRAM0
004794 2d2b      	mov FROMRAM2,zzIYl
004795 2e13      	mov FROMRAM1,zzIYh
004796 2755
004797 fd77
004798 9550
004799 0f27
00479a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00479b b818
00479c b922
00479d b854
00479e b83b
00479f 0000
0047a0 0000
0047a1 b173
0047a2 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0047a3 bf4f      	out SREG,zzF
0047a4 1f17      	adc zzA,FROMRAM0
                 
0047a5 b74f      	in zzF, SREG
0047a6 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
0047a7 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_8f: ; ADC  A A
0047a9 bf4f      	out SREG,zzF
0047aa 1f11      	adc zzA,zzA
                 
0047ab b74f      	in zzF, SREG
0047ac 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
0047ad 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_90: ; SUB  A B
0047af 191a      	sub zzA,zzB
                 
0047b0 b75f      	in zzTmp, SREG
0047b1 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047b2 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047b3 2b45      	or zzF, zzTmp ; combine flags
0047b4 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_91: ; SUB  A C
0047b6 1b16      	sub zzA,zzC
                 
0047b7 b75f      	in zzTmp, SREG
0047b8 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047b9 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047ba 2b45      	or zzF, zzTmp ; combine flags
0047bb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_92: ; SUB  A D
0047bd 191c      	sub zzA,zzD
                 
0047be b75f      	in zzTmp, SREG
0047bf 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047c0 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047c1 2b45      	or zzF, zzTmp ; combine flags
0047c2 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_93: ; SUB  A E
0047c4 191d      	sub zzA,zzE
                 
0047c5 b75f      	in zzTmp, SREG
0047c6 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047c7 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047c8 2b45      	or zzF, zzTmp ; combine flags
0047c9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_94: ; SUB  A IYh
0047cb 1b13      	sub zzA,zzIYh
                 
0047cc b75f      	in zzTmp, SREG
0047cd 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047ce ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047cf 2b45      	or zzF, zzTmp ; combine flags
0047d0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_95: ; SUB  A IYl
0047d2 191b      	sub zzA,zzIYl
                 
0047d3 b75f      	in zzTmp, SREG
0047d4 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047d5 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047d6 2b45      	or zzF, zzTmp ; combine flags
0047d7 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_96: ; SUB  A (IY+d)
0047d9 b998
0047da b982
0047db b854
0047dc b83b
0047dd 9601
0047de b173
0047df b82b      	LDRAM_PC_NODDR FROMRAM0
0047e0 2d2b      	mov FROMRAM2,zzIYl
0047e1 2e13      	mov FROMRAM1,zzIYh
0047e2 2755
0047e3 fd77
0047e4 9550
0047e5 0f27
0047e6 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0047e7 b818
0047e8 b922
0047e9 b854
0047ea b83b
0047eb 0000
0047ec 0000
0047ed b173
0047ee b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0047ef 1b17      	sub zzA,FROMRAM0
                 
0047f0 b75f      	in zzTmp, SREG
0047f1 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047f2 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047f3 2b45      	or zzF, zzTmp ; combine flags
0047f4 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_97: ; SUB  A A
0047f6 1b11      	sub zzA,zzA
                 
0047f7 b75f      	in zzTmp, SREG
0047f8 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0047f9 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0047fa 2b45      	or zzF, zzTmp ; combine flags
0047fb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_98: ; SBC  A B
0047fd bf4f      	out SREG,zzF
0047fe 9418      	sez
0047ff 091a      	sbc zzA,zzB
                 
004800 b75f      	in zzTmp, SREG
004801 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004802 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004803 2b45      	or zzF, zzTmp ; combine flags
004804 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_99: ; SBC  A C
004806 bf4f      	out SREG,zzF
004807 9418      	sez
004808 0b16      	sbc zzA,zzC
                 
004809 b75f      	in zzTmp, SREG
00480a 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00480b ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00480c 2b45      	or zzF, zzTmp ; combine flags
00480d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_9a: ; SBC  A D
00480f bf4f      	out SREG,zzF
004810 9418      	sez
004811 091c      	sbc zzA,zzD
                 
004812 b75f      	in zzTmp, SREG
004813 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004814 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004815 2b45      	or zzF, zzTmp ; combine flags
004816 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_9b: ; SBC  A E
004818 bf4f      	out SREG,zzF
004819 9418      	sez
00481a 091d      	sbc zzA,zzE
                 
00481b b75f      	in zzTmp, SREG
00481c 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00481d ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00481e 2b45      	or zzF, zzTmp ; combine flags
00481f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_9c: ; SBC  A IYh
004821 bf4f      	out SREG,zzF
004822 9418      	sez
004823 0b13      	sbc zzA,zzIYh
                 
004824 b75f      	in zzTmp, SREG
004825 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004826 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004827 2b45      	or zzF, zzTmp ; combine flags
004828 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_9d: ; SBC  A IYl
00482a bf4f      	out SREG,zzF
00482b 9418      	sez
00482c 091b      	sbc zzA,zzIYl
                 
00482d b75f      	in zzTmp, SREG
00482e 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00482f ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004830 2b45      	or zzF, zzTmp ; combine flags
004831 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_9e: ; SBC  A (IY+d)
004833 b998
004834 b982
004835 b854
004836 b83b
004837 9601
004838 b173
004839 b82b      	LDRAM_PC_NODDR FROMRAM0
00483a 2d2b      	mov FROMRAM2,zzIYl
00483b 2e13      	mov FROMRAM1,zzIYh
00483c 2755
00483d fd77
00483e 9550
00483f 0f27
004840 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
004841 b818
004842 b922
004843 b854
004844 b83b
004845 0000
004846 0000
004847 b173
004848 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004849 bf4f      	out SREG,zzF
00484a 9418      	sez
00484b 0b17      	sbc zzA,FROMRAM0
                 
00484c b75f      	in zzTmp, SREG
00484d 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00484e ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00484f 2b45      	or zzF, zzTmp ; combine flags
004850 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_9f: ; SBC  A A
004852 bf4f      	out SREG,zzF
004853 9418      	sez
004854 0b11      	sbc zzA,zzA
                 
004855 b75f      	in zzTmp, SREG
004856 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004857 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004858 2b45      	or zzF, zzTmp ; combine flags
004859 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a0: ; AND  A B
00485b 211a      	and zzA,zzB
                 
00485c b75f      	in zzTmp, SREG
00485d 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
00485e ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
00485f 2b45      	or zzF, zzTmp ; combine flags
004860 e1b8
004861 2fa1
004862 915c
004863 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004864 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a1: ; AND  A C
004866 2316      	and zzA,zzC
                 
004867 b75f      	in zzTmp, SREG
004868 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
004869 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
00486a 2b45      	or zzF, zzTmp ; combine flags
00486b e1b8
00486c 2fa1
00486d 915c
00486e 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00486f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a2: ; AND  A D
004871 211c      	and zzA,zzD
                 
004872 b75f      	in zzTmp, SREG
004873 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
004874 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
004875 2b45      	or zzF, zzTmp ; combine flags
004876 e1b8
004877 2fa1
004878 915c
004879 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00487a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a3: ; AND  A E
00487c 211d      	and zzA,zzE
                 
00487d b75f      	in zzTmp, SREG
00487e 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
00487f ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
004880 2b45      	or zzF, zzTmp ; combine flags
004881 e1b8
004882 2fa1
004883 915c
004884 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004885 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a4: ; AND  A IYh
004887 2313      	and zzA,zzIYh
                 
004888 b75f      	in zzTmp, SREG
004889 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
00488a ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
00488b 2b45      	or zzF, zzTmp ; combine flags
00488c e1b8
00488d 2fa1
00488e 915c
00488f 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004890 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a5: ; AND  A IYl
004892 211b      	and zzA,zzIYl
                 
004893 b75f      	in zzTmp, SREG
004894 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
004895 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
004896 2b45      	or zzF, zzTmp ; combine flags
004897 e1b8
004898 2fa1
004899 915c
00489a 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00489b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a6: ; AND  A (IY+d)
00489d b998
00489e b982
00489f b854
0048a0 b83b
0048a1 9601
0048a2 b173
0048a3 b82b      	LDRAM_PC_NODDR FROMRAM0
0048a4 2d2b      	mov FROMRAM2,zzIYl
0048a5 2e13      	mov FROMRAM1,zzIYh
0048a6 2755
0048a7 fd77
0048a8 9550
0048a9 0f27
0048aa 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0048ab b818
0048ac b922
0048ad b854
0048ae b83b
0048af 0000
0048b0 0000
0048b1 b173
0048b2 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0048b3 2317      	and zzA,FROMRAM0
                 
0048b4 b75f      	in zzTmp, SREG
0048b5 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
0048b6 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
0048b7 2b45      	or zzF, zzTmp ; combine flags
0048b8 e1b8
0048b9 2fa1
0048ba 915c
0048bb 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048bc 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a7: ; AND  A A
0048be 2311      	and zzA,zzA
                 
0048bf b75f      	in zzTmp, SREG
0048c0 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
0048c1 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
0048c2 2b45      	or zzF, zzTmp ; combine flags
0048c3 e1b8
0048c4 2fa1
0048c5 915c
0048c6 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048c7 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a8: ; XOR  A B
0048c9 251a      	eor zzA,zzB
                 
0048ca b74f      	in zzF, SREG
0048cb 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0048cc e1b8
0048cd 2fa1
0048ce 915c
0048cf 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048d0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_a9: ; XOR  A C
0048d2 2716      	eor zzA,zzC
                 
0048d3 b74f      	in zzF, SREG
0048d4 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0048d5 e1b8
0048d6 2fa1
0048d7 915c
0048d8 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048d9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_aa: ; XOR  A D
0048db 251c      	eor zzA,zzD
                 
0048dc b74f      	in zzF, SREG
0048dd 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0048de e1b8
0048df 2fa1
0048e0 915c
0048e1 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048e2 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ab: ; XOR  A E
0048e4 251d      	eor zzA,zzE
                 
0048e5 b74f      	in zzF, SREG
0048e6 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0048e7 e1b8
0048e8 2fa1
0048e9 915c
0048ea 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048eb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ac: ; XOR  A IYh
0048ed 2713      	eor zzA,zzIYh
                 
0048ee b74f      	in zzF, SREG
0048ef 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0048f0 e1b8
0048f1 2fa1
0048f2 915c
0048f3 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048f4 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ad: ; XOR  A IYl
0048f6 251b      	eor zzA,zzIYl
                 
0048f7 b74f      	in zzF, SREG
0048f8 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
0048f9 e1b8
0048fa 2fa1
0048fb 915c
0048fc 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0048fd 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ae: ; XOR  A (IY+d)
0048ff b998
004900 b982
004901 b854
004902 b83b
004903 9601
004904 b173
004905 b82b      	LDRAM_PC_NODDR FROMRAM0
004906 2d2b      	mov FROMRAM2,zzIYl
004907 2e13      	mov FROMRAM1,zzIYh
004908 2755
004909 fd77
00490a 9550
00490b 0f27
00490c 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00490d b818
00490e b922
00490f b854
004910 b83b
004911 0000
004912 0000
004913 b173
004914 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004915 2717      	eor zzA,FROMRAM0
                 
004916 b74f      	in zzF, SREG
004917 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
004918 e1b8
004919 2fa1
00491a 915c
00491b 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00491c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_af: ; XOR  A A
00491e 2711      	eor zzA,zzA
                 
00491f b74f      	in zzF, SREG
004920 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
004921 e1b8
004922 2fa1
004923 915c
004924 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004925 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b0: ; OR   A B
004927 291a      	or zzA,zzB
                 
004928 b74f      	in zzF, SREG
004929 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
00492a e1b8
00492b 2fa1
00492c 915c
00492d 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00492e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b1: ; OR   A C
004930 2b16      	or zzA,zzC
                 
004931 b74f      	in zzF, SREG
004932 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
004933 e1b8
004934 2fa1
004935 915c
004936 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004937 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b2: ; OR   A D
004939 291c      	or zzA,zzD
                 
00493a b74f      	in zzF, SREG
00493b 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
00493c e1b8
00493d 2fa1
00493e 915c
00493f 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004940 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b3: ; OR   A E
004942 291d      	or zzA,zzE
                 
004943 b74f      	in zzF, SREG
004944 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
004945 e1b8
004946 2fa1
004947 915c
004948 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004949 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b4: ; OR   A IYh
00494b 2b13      	or zzA,zzIYh
                 
00494c b74f      	in zzF, SREG
00494d 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
00494e e1b8
00494f 2fa1
004950 915c
004951 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004952 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b5: ; OR   A IYl
004954 291b      	or zzA,zzIYl
                 
004955 b74f      	in zzF, SREG
004956 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
004957 e1b8
004958 2fa1
004959 915c
00495a 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00495b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b6: ; OR   A (IY+d)
00495d b998
00495e b982
00495f b854
004960 b83b
004961 9601
004962 b173
004963 b82b      	LDRAM_PC_NODDR FROMRAM0
004964 2d2b      	mov FROMRAM2,zzIYl
004965 2e13      	mov FROMRAM1,zzIYh
004966 2755
004967 fd77
004968 9550
004969 0f27
00496a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00496b b818
00496c b922
00496d b854
00496e b83b
00496f 0000
004970 0000
004971 b173
004972 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004973 2b17      	or zzA,FROMRAM0
                 
004974 b74f      	in zzF, SREG
004975 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
004976 e1b8
004977 2fa1
004978 915c
004979 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
00497a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b7: ; OR   A A
00497c 2b11      	or zzA,zzA
                 
00497d b74f      	in zzF, SREG
00497e 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
00497f e1b8
004980 2fa1
004981 915c
004982 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
004983 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b8: ; CP   A B
004985 151a      	cp zzA,zzB
                 
004986 b75f      	in zzTmp, SREG
004987 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004988 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004989 2b45      	or zzF, zzTmp ; combine flags
00498a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_b9: ; CP   A C
00498c 1716      	cp zzA,zzC
                 
00498d b75f      	in zzTmp, SREG
00498e 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00498f ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004990 2b45      	or zzF, zzTmp ; combine flags
004991 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ba: ; CP   A D
004993 151c      	cp zzA,zzD
                 
004994 b75f      	in zzTmp, SREG
004995 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004996 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004997 2b45      	or zzF, zzTmp ; combine flags
004998 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_bb: ; CP   A E
00499a 151d      	cp zzA,zzE
                 
00499b b75f      	in zzTmp, SREG
00499c 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
00499d ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00499e 2b45      	or zzF, zzTmp ; combine flags
00499f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_bc: ; CP   A IYh
0049a1 1713      	cp zzA,zzIYh
                 
0049a2 b75f      	in zzTmp, SREG
0049a3 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0049a4 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0049a5 2b45      	or zzF, zzTmp ; combine flags
0049a6 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_bd: ; CP   A IYl
0049a8 151b      	cp zzA,zzIYl
                 
0049a9 b75f      	in zzTmp, SREG
0049aa 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0049ab ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0049ac 2b45      	or zzF, zzTmp ; combine flags
0049ad 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_be: ; CP   A (IY+d)
0049af b998
0049b0 b982
0049b1 b854
0049b2 b83b
0049b3 9601
0049b4 b173
0049b5 b82b      	LDRAM_PC_NODDR FROMRAM0
0049b6 2d2b      	mov FROMRAM2,zzIYl
0049b7 2e13      	mov FROMRAM1,zzIYh
0049b8 2755
0049b9 fd77
0049ba 9550
0049bb 0f27
0049bc 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0049bd b818
0049be b922
0049bf b854
0049c0 b83b
0049c1 0000
0049c2 0000
0049c3 b173
0049c4 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0049c5 1717      	cp zzA,FROMRAM0
                 
0049c6 b75f      	in zzTmp, SREG
0049c7 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0049c8 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0049c9 2b45      	or zzF, zzTmp ; combine flags
0049ca 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_bf: ; CP   A A
0049cc 1711      	cp zzA,zzA
                 
0049cd b75f      	in zzTmp, SREG
0049ce 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
0049cf ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
0049d0 2b45      	or zzF, zzTmp ; combine flags
0049d1 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c0: ; RET   NZ
0049d3 fd41      	sbrc zzF,zzZF
0049d4 940c 0200 	jmp zCMD_start
0049d6 b9d8
0049d7 b9c2
0049d8 b854
0049d9 b83b
0049da 0000
0049db 0000
0049dc b183
0049dd b82b
0049de 0dc9
0049df 1dd5
0049e0 b9d8
0049e1 b9c2
0049e2 b854
0049e3 b83b
0049e4 0000
0049e5 0000
0049e6 b193
0049e7 b82b
0049e8 0dc9
0049e9 1dd5      	zzPOP zzPCh,zzPCl
                 
0049ea 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c1: ; POP   BC
0049ec b9d8
0049ed b9c2
0049ee b854
0049ef b83b
0049f0 0000
0049f1 0000
0049f2 b163
0049f3 b82b
0049f4 0dc9
0049f5 1dd5
0049f6 b9d8
0049f7 b9c2
0049f8 b854
0049f9 b83b
0049fa 0000
0049fb 0000
0049fc b0a3
0049fd b82b
0049fe 0dc9
0049ff 1dd5      	zzPOP zzB,zzC
                 
004a00 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c2: ; JP   NZ nn
004a02 b998
004a03 b982
004a04 b854
004a05 b83b
004a06 9601
004a07 b123
004a08 b82b      	LDRAM_PC_NODDR FROMRAM2
004a09 b998
004a0a b982
004a0b b854
004a0c b83b
004a0d 9601
004a0e b013
004a0f b82b      	LDRAM_PC_NODDR FROMRAM1
004a10 fd41      	sbrc zzF,zzZF
004a11 940c 0200 	jmp zCMD_start
004a13 2f82      	mov zzPCl,FROMRAM2
004a14 2d91      	mov zzPCh,FROMRAM1
                 
004a15 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c3: ; JP   * nn
004a17 b998
004a18 b982
004a19 b854
004a1a b83b
004a1b 9601
004a1c b123
004a1d b82b      	LDRAM_PC_NODDR FROMRAM2
004a1e b998
004a1f b982
004a20 b854
004a21 b83b
004a22 9601
004a23 b013
004a24 b82b      	LDRAM_PC_NODDR FROMRAM1
004a25 1055      	cpse ZERO,ZERO
004a26 940c 0200 	jmp zCMD_start
004a28 2f82      	mov zzPCl,FROMRAM2
004a29 2d91      	mov zzPCh,FROMRAM1
                 
004a2a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c4: ; CALL NZ nn
004a2c b998
004a2d b982
004a2e b854
004a2f b83b
004a30 9601
004a31 b123
004a32 b82b      	LDRAM_PC_NODDR FROMRAM2
004a33 b998
004a34 b982
004a35 b854
004a36 b83b
004a37 9601
004a38 b013
004a39 b82b      	LDRAM_PC_NODDR FROMRAM1
004a3a fd41      	sbrc zzF,zzZF
004a3b 940c 0200 	jmp zCMD_start
004a3d 19c9
004a3e 09d5
004a3f b9d8
004a40 b9c2
004a41 b995
004a42 b824
004a43 15d6
004a44 985d
004a45 f100
004a46 b82b
004a47 935f
004a48 e158
004a49 b955
004a4a eb5f
004a4b b954
004a4c e050
004a4d bd5d
004a4e e550
004a4f bd5c
004a50 9859
004a51 915f
004a52 982c
004a53 939f
004a54 2f5d
004a55 940e 005f
004a57 e054
004a58 955a
004a59 f7f1
004a5a 2f5c
004a5b 940e 005f
004a5d e054
004a5e 955a
004a5f f7f1
004a60 915f
004a61 940e 005f
004a63 bc5c
004a64 9a59
004a65 b854
004a66 b82b
004a67 19c9
004a68 09d5
004a69 b9d8
004a6a b9c2
004a6b b985
004a6c b824
004a6d 15d6
004a6e 985d
004a6f f100
004a70 b82b
004a71 935f
004a72 e158
004a73 b955
004a74 eb5f
004a75 b954
004a76 e050
004a77 bd5d
004a78 e550
004a79 bd5c
004a7a 9859
004a7b 915f
004a7c 982c
004a7d 938f
004a7e 2f5d
004a7f 940e 005f
004a81 e054
004a82 955a
004a83 f7f1
004a84 2f5c
004a85 940e 005f
004a87 e054
004a88 955a
004a89 f7f1
004a8a 915f
004a8b 940e 005f
004a8d bc5c
004a8e 9a59
004a8f b854
004a90 b82b      	zzPUSH zzPCh,zzPCl
004a91 2f82      	mov zzPCl,FROMRAM2
004a92 2d91      	mov zzPCh,FROMRAM1
                 
004a93 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c5: ; PUSH  BC
004a95 19c9
004a96 09d5
004a97 b9d8
004a98 b9c2
004a99 b8a5
004a9a b824
004a9b 15d6
004a9c 985d
004a9d f100
004a9e b82b
004a9f 935f
004aa0 e158
004aa1 b955
004aa2 eb5f
004aa3 b954
004aa4 e050
004aa5 bd5d
004aa6 e550
004aa7 bd5c
004aa8 9859
004aa9 915f
004aaa 982c
004aab 92af
004aac 2f5d
004aad 940e 005f
004aaf e054
004ab0 955a
004ab1 f7f1
004ab2 2f5c
004ab3 940e 005f
004ab5 e054
004ab6 955a
004ab7 f7f1
004ab8 915f
004ab9 940e 005f
004abb bc5c
004abc 9a59
004abd b854
004abe b82b
004abf 19c9
004ac0 09d5
004ac1 b9d8
004ac2 b9c2
004ac3 b965
004ac4 b824
004ac5 15d6
004ac6 985d
004ac7 f100
004ac8 b82b
004ac9 935f
004aca e158
004acb b955
004acc eb5f
004acd b954
004ace e050
004acf bd5d
004ad0 e550
004ad1 bd5c
004ad2 9859
004ad3 915f
004ad4 982c
004ad5 936f
004ad6 2f5d
004ad7 940e 005f
004ad9 e054
004ada 955a
004adb f7f1
004adc 2f5c
004add 940e 005f
004adf e054
004ae0 955a
004ae1 f7f1
004ae2 915f
004ae3 940e 005f
004ae5 bc5c
004ae6 9a59
004ae7 b854
004ae8 b82b      	zzPUSH zzB,zzC
                 
004ae9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c6: ; ADD  A n
004aeb b998
004aec b982
004aed b854
004aee b83b
004aef 9601
004af0 b173
004af1 b82b      	LDRAM_PC_NODDR FROMRAM0
004af2 0f17      	add zzA,FROMRAM0
                 
004af3 b74f      	in zzF, SREG
004af4 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004af5 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c7: ; RST   00h
004af7 19c9
004af8 09d5
004af9 b9d8
004afa b9c2
004afb b995
004afc b824
004afd 15d6
004afe 985d
004aff f100
004b00 b82b
004b01 935f
004b02 e158
004b03 b955
004b04 eb5f
004b05 b954
004b06 e050
004b07 bd5d
004b08 e550
004b09 bd5c
004b0a 9859
004b0b 915f
004b0c 982c
004b0d 939f
004b0e 2f5d
004b0f 940e 005f
004b11 e054
004b12 955a
004b13 f7f1
004b14 2f5c
004b15 940e 005f
004b17 e054
004b18 955a
004b19 f7f1
004b1a 915f
004b1b 940e 005f
004b1d bc5c
004b1e 9a59
004b1f b854
004b20 b82b
004b21 19c9
004b22 09d5
004b23 b9d8
004b24 b9c2
004b25 b985
004b26 b824
004b27 15d6
004b28 985d
004b29 f100
004b2a b82b
004b2b 935f
004b2c e158
004b2d b955
004b2e eb5f
004b2f b954
004b30 e050
004b31 bd5d
004b32 e550
004b33 bd5c
004b34 9859
004b35 915f
004b36 982c
004b37 938f
004b38 2f5d
004b39 940e 005f
004b3b e054
004b3c 955a
004b3d f7f1
004b3e 2f5c
004b3f 940e 005f
004b41 e054
004b42 955a
004b43 f7f1
004b44 915f
004b45 940e 005f
004b47 bc5c
004b48 9a59
004b49 b854
004b4a b82b      	zzPUSH zzPCh,zzPCl
004b4b 2799      	clr zzPCh
004b4c e080      	ldi zzPCl,0
                 
004b4d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c8: ; RET   Z
004b4f ff41      	sbrs zzF,zzZF
004b50 940c 0200 	jmp zCMD_start
004b52 b9d8
004b53 b9c2
004b54 b854
004b55 b83b
004b56 0000
004b57 0000
004b58 b183
004b59 b82b
004b5a 0dc9
004b5b 1dd5
004b5c b9d8
004b5d b9c2
004b5e b854
004b5f b83b
004b60 0000
004b61 0000
004b62 b193
004b63 b82b
004b64 0dc9
004b65 1dd5      	zzPOP zzPCh,zzPCl
                 
004b66 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_c9: ; RET   *
004b68 1055      	cpse ZERO,ZERO
004b69 940c 0200 	jmp zCMD_start
004b6b b9d8
004b6c b9c2
004b6d b854
004b6e b83b
004b6f 0000
004b70 0000
004b71 b183
004b72 b82b
004b73 0dc9
004b74 1dd5
004b75 b9d8
004b76 b9c2
004b77 b854
004b78 b83b
004b79 0000
004b7a 0000
004b7b b193
004b7c b82b
004b7d 0dc9
004b7e 1dd5      	zzPOP zzPCh,zzPCl
                 
004b7f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ca: ; JP   Z nn
004b81 b998
004b82 b982
004b83 b854
004b84 b83b
004b85 9601
004b86 b123
004b87 b82b      	LDRAM_PC_NODDR FROMRAM2
004b88 b998
004b89 b982
004b8a b854
004b8b b83b
004b8c 9601
004b8d b013
004b8e b82b      	LDRAM_PC_NODDR FROMRAM1
004b8f ff41      	sbrs zzF,zzZF
004b90 940c 0200 	jmp zCMD_start
004b92 2f82      	mov zzPCl,FROMRAM2
004b93 2d91      	mov zzPCh,FROMRAM1
                 
004b94 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_cb: ; FDCB  
004b96 b998
004b97 b982
004b98 b854
004b99 b83b
004b9a 9601
004b9b b173
004b9c b82b      	LDRAM_PC_NODDR FROMRAM0
004b9d e1b6      	ldi Xh, high(zOPCODE_FDCB_LBLS_L)
004b9e 940c 0201 	jmp zCMDP_start
                 
004ba0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_cc: ; CALL Z nn
004ba2 b998
004ba3 b982
004ba4 b854
004ba5 b83b
004ba6 9601
004ba7 b123
004ba8 b82b      	LDRAM_PC_NODDR FROMRAM2
004ba9 b998
004baa b982
004bab b854
004bac b83b
004bad 9601
004bae b013
004baf b82b      	LDRAM_PC_NODDR FROMRAM1
004bb0 ff41      	sbrs zzF,zzZF
004bb1 940c 0200 	jmp zCMD_start
004bb3 19c9
004bb4 09d5
004bb5 b9d8
004bb6 b9c2
004bb7 b995
004bb8 b824
004bb9 15d6
004bba 985d
004bbb f100
004bbc b82b
004bbd 935f
004bbe e158
004bbf b955
004bc0 eb5f
004bc1 b954
004bc2 e050
004bc3 bd5d
004bc4 e550
004bc5 bd5c
004bc6 9859
004bc7 915f
004bc8 982c
004bc9 939f
004bca 2f5d
004bcb 940e 005f
004bcd e054
004bce 955a
004bcf f7f1
004bd0 2f5c
004bd1 940e 005f
004bd3 e054
004bd4 955a
004bd5 f7f1
004bd6 915f
004bd7 940e 005f
004bd9 bc5c
004bda 9a59
004bdb b854
004bdc b82b
004bdd 19c9
004bde 09d5
004bdf b9d8
004be0 b9c2
004be1 b985
004be2 b824
004be3 15d6
004be4 985d
004be5 f100
004be6 b82b
004be7 935f
004be8 e158
004be9 b955
004bea eb5f
004beb b954
004bec e050
004bed bd5d
004bee e550
004bef bd5c
004bf0 9859
004bf1 915f
004bf2 982c
004bf3 938f
004bf4 2f5d
004bf5 940e 005f
004bf7 e054
004bf8 955a
004bf9 f7f1
004bfa 2f5c
004bfb 940e 005f
004bfd e054
004bfe 955a
004bff f7f1
004c00 915f
004c01 940e 005f
004c03 bc5c
004c04 9a59
004c05 b854
004c06 b82b      	zzPUSH zzPCh,zzPCl
004c07 2f82      	mov zzPCl,FROMRAM2
004c08 2d91      	mov zzPCh,FROMRAM1
                 
004c09 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_cd: ; CALL * nn
004c0b b998
004c0c b982
004c0d b854
004c0e b83b
004c0f 9601
004c10 b123
004c11 b82b      	LDRAM_PC_NODDR FROMRAM2
004c12 b998
004c13 b982
004c14 b854
004c15 b83b
004c16 9601
004c17 b013
004c18 b82b      	LDRAM_PC_NODDR FROMRAM1
004c19 1055      	cpse ZERO,ZERO
004c1a 940c 0200 	jmp zCMD_start
004c1c 19c9
004c1d 09d5
004c1e b9d8
004c1f b9c2
004c20 b995
004c21 b824
004c22 15d6
004c23 985d
004c24 f100
004c25 b82b
004c26 935f
004c27 e158
004c28 b955
004c29 eb5f
004c2a b954
004c2b e050
004c2c bd5d
004c2d e550
004c2e bd5c
004c2f 9859
004c30 915f
004c31 982c
004c32 939f
004c33 2f5d
004c34 940e 005f
004c36 e054
004c37 955a
004c38 f7f1
004c39 2f5c
004c3a 940e 005f
004c3c e054
004c3d 955a
004c3e f7f1
004c3f 915f
004c40 940e 005f
004c42 bc5c
004c43 9a59
004c44 b854
004c45 b82b
004c46 19c9
004c47 09d5
004c48 b9d8
004c49 b9c2
004c4a b985
004c4b b824
004c4c 15d6
004c4d 985d
004c4e f100
004c4f b82b
004c50 935f
004c51 e158
004c52 b955
004c53 eb5f
004c54 b954
004c55 e050
004c56 bd5d
004c57 e550
004c58 bd5c
004c59 9859
004c5a 915f
004c5b 982c
004c5c 938f
004c5d 2f5d
004c5e 940e 005f
004c60 e054
004c61 955a
004c62 f7f1
004c63 2f5c
004c64 940e 005f
004c66 e054
004c67 955a
004c68 f7f1
004c69 915f
004c6a 940e 005f
004c6c bc5c
004c6d 9a59
004c6e b854
004c6f b82b      	zzPUSH zzPCh,zzPCl
004c70 2f82      	mov zzPCl,FROMRAM2
004c71 2d91      	mov zzPCh,FROMRAM1
                 
004c72 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ce: ; ADC  A n
004c74 b998
004c75 b982
004c76 b854
004c77 b83b
004c78 9601
004c79 b173
004c7a b82b      	LDRAM_PC_NODDR FROMRAM0
004c7b bf4f      	out SREG,zzF
004c7c 1f17      	adc zzA,FROMRAM0
                 
004c7d b74f      	in zzF, SREG
004c7e 7a4f      	andi zzF, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask flags
004c7f 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_cf: ; RST   08h
004c81 19c9
004c82 09d5
004c83 b9d8
004c84 b9c2
004c85 b995
004c86 b824
004c87 15d6
004c88 985d
004c89 f100
004c8a b82b
004c8b 935f
004c8c e158
004c8d b955
004c8e eb5f
004c8f b954
004c90 e050
004c91 bd5d
004c92 e550
004c93 bd5c
004c94 9859
004c95 915f
004c96 982c
004c97 939f
004c98 2f5d
004c99 940e 005f
004c9b e054
004c9c 955a
004c9d f7f1
004c9e 2f5c
004c9f 940e 005f
004ca1 e054
004ca2 955a
004ca3 f7f1
004ca4 915f
004ca5 940e 005f
004ca7 bc5c
004ca8 9a59
004ca9 b854
004caa b82b
004cab 19c9
004cac 09d5
004cad b9d8
004cae b9c2
004caf b985
004cb0 b824
004cb1 15d6
004cb2 985d
004cb3 f100
004cb4 b82b
004cb5 935f
004cb6 e158
004cb7 b955
004cb8 eb5f
004cb9 b954
004cba e050
004cbb bd5d
004cbc e550
004cbd bd5c
004cbe 9859
004cbf 915f
004cc0 982c
004cc1 938f
004cc2 2f5d
004cc3 940e 005f
004cc5 e054
004cc6 955a
004cc7 f7f1
004cc8 2f5c
004cc9 940e 005f
004ccb e054
004ccc 955a
004ccd f7f1
004cce 915f
004ccf 940e 005f
004cd1 bc5c
004cd2 9a59
004cd3 b854
004cd4 b82b      	zzPUSH zzPCh,zzPCl
004cd5 2799      	clr zzPCh
004cd6 e088      	ldi zzPCl,0x08
                 
004cd7 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d0: ; RET   NC
004cd9 fd40      	sbrc zzF,zzCF
004cda 940c 0200 	jmp zCMD_start
004cdc b9d8
004cdd b9c2
004cde b854
004cdf b83b
004ce0 0000
004ce1 0000
004ce2 b183
004ce3 b82b
004ce4 0dc9
004ce5 1dd5
004ce6 b9d8
004ce7 b9c2
004ce8 b854
004ce9 b83b
004cea 0000
004ceb 0000
004cec b193
004ced b82b
004cee 0dc9
004cef 1dd5      	zzPOP zzPCh,zzPCl
                 
004cf0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d1: ; POP   DE
004cf2 b9d8
004cf3 b9c2
004cf4 b854
004cf5 b83b
004cf6 0000
004cf7 0000
004cf8 b0d3
004cf9 b82b
004cfa 0dc9
004cfb 1dd5
004cfc b9d8
004cfd b9c2
004cfe b854
004cff b83b
004d00 0000
004d01 0000
004d02 b0c3
004d03 b82b
004d04 0dc9
004d05 1dd5      	zzPOP zzD,zzE
                 
004d06 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d2: ; JP   NC nn
004d08 b998
004d09 b982
004d0a b854
004d0b b83b
004d0c 9601
004d0d b123
004d0e b82b      	LDRAM_PC_NODDR FROMRAM2
004d0f b998
004d10 b982
004d11 b854
004d12 b83b
004d13 9601
004d14 b013
004d15 b82b      	LDRAM_PC_NODDR FROMRAM1
004d16 fd40      	sbrc zzF,zzCF
004d17 940c 0200 	jmp zCMD_start
004d19 2f82      	mov zzPCl,FROMRAM2
004d1a 2d91      	mov zzPCh,FROMRAM1
                 
004d1b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d3: ; OUT  (n) A
004d1d b998
004d1e b982
004d1f b854
004d20 b83b
004d21 9601
004d22 b173
004d23 b82b      	LDRAM_PC_NODDR FROMRAM0
004d24 2f57      	mov zzTmp,FROMRAM0
004d25 9310 090e 	sts CDATA,zzA
004d27 940e 7208 	call PORTOUT
                 
004d29 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d4: ; CALL NC nn
004d2b b998
004d2c b982
004d2d b854
004d2e b83b
004d2f 9601
004d30 b123
004d31 b82b      	LDRAM_PC_NODDR FROMRAM2
004d32 b998
004d33 b982
004d34 b854
004d35 b83b
004d36 9601
004d37 b013
004d38 b82b      	LDRAM_PC_NODDR FROMRAM1
004d39 fd40      	sbrc zzF,zzCF
004d3a 940c 0200 	jmp zCMD_start
004d3c 19c9
004d3d 09d5
004d3e b9d8
004d3f b9c2
004d40 b995
004d41 b824
004d42 15d6
004d43 985d
004d44 f100
004d45 b82b
004d46 935f
004d47 e158
004d48 b955
004d49 eb5f
004d4a b954
004d4b e050
004d4c bd5d
004d4d e550
004d4e bd5c
004d4f 9859
004d50 915f
004d51 982c
004d52 939f
004d53 2f5d
004d54 940e 005f
004d56 e054
004d57 955a
004d58 f7f1
004d59 2f5c
004d5a 940e 005f
004d5c e054
004d5d 955a
004d5e f7f1
004d5f 915f
004d60 940e 005f
004d62 bc5c
004d63 9a59
004d64 b854
004d65 b82b
004d66 19c9
004d67 09d5
004d68 b9d8
004d69 b9c2
004d6a b985
004d6b b824
004d6c 15d6
004d6d 985d
004d6e f100
004d6f b82b
004d70 935f
004d71 e158
004d72 b955
004d73 eb5f
004d74 b954
004d75 e050
004d76 bd5d
004d77 e550
004d78 bd5c
004d79 9859
004d7a 915f
004d7b 982c
004d7c 938f
004d7d 2f5d
004d7e 940e 005f
004d80 e054
004d81 955a
004d82 f7f1
004d83 2f5c
004d84 940e 005f
004d86 e054
004d87 955a
004d88 f7f1
004d89 915f
004d8a 940e 005f
004d8c bc5c
004d8d 9a59
004d8e b854
004d8f b82b      	zzPUSH zzPCh,zzPCl
004d90 2f82      	mov zzPCl,FROMRAM2
004d91 2d91      	mov zzPCh,FROMRAM1
                 
004d92 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d5: ; PUSH  DE
004d94 19c9
004d95 09d5
004d96 b9d8
004d97 b9c2
004d98 b8c5
004d99 b824
004d9a 15d6
004d9b 985d
004d9c f100
004d9d b82b
004d9e 935f
004d9f e158
004da0 b955
004da1 eb5f
004da2 b954
004da3 e050
004da4 bd5d
004da5 e550
004da6 bd5c
004da7 9859
004da8 915f
004da9 982c
004daa 92cf
004dab 2f5d
004dac 940e 005f
004dae e054
004daf 955a
004db0 f7f1
004db1 2f5c
004db2 940e 005f
004db4 e054
004db5 955a
004db6 f7f1
004db7 915f
004db8 940e 005f
004dba bc5c
004dbb 9a59
004dbc b854
004dbd b82b
004dbe 19c9
004dbf 09d5
004dc0 b9d8
004dc1 b9c2
004dc2 b8d5
004dc3 b824
004dc4 15d6
004dc5 985d
004dc6 f100
004dc7 b82b
004dc8 935f
004dc9 e158
004dca b955
004dcb eb5f
004dcc b954
004dcd e050
004dce bd5d
004dcf e550
004dd0 bd5c
004dd1 9859
004dd2 915f
004dd3 982c
004dd4 92df
004dd5 2f5d
004dd6 940e 005f
004dd8 e054
004dd9 955a
004dda f7f1
004ddb 2f5c
004ddc 940e 005f
004dde e054
004ddf 955a
004de0 f7f1
004de1 915f
004de2 940e 005f
004de4 bc5c
004de5 9a59
004de6 b854
004de7 b82b      	zzPUSH zzD,zzE
                 
004de8 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d6: ; SUB  A n
004dea b998
004deb b982
004dec b854
004ded b83b
004dee 9601
004def b173
004df0 b82b      	LDRAM_PC_NODDR FROMRAM0
004df1 1b17      	sub zzA,FROMRAM0
                 
004df2 b75f      	in zzTmp, SREG
004df3 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004df4 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004df5 2b45      	or zzF, zzTmp ; combine flags
004df6 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d7: ; RST   10h
004df8 19c9
004df9 09d5
004dfa b9d8
004dfb b9c2
004dfc b995
004dfd b824
004dfe 15d6
004dff 985d
004e00 f100
004e01 b82b
004e02 935f
004e03 e158
004e04 b955
004e05 eb5f
004e06 b954
004e07 e050
004e08 bd5d
004e09 e550
004e0a bd5c
004e0b 9859
004e0c 915f
004e0d 982c
004e0e 939f
004e0f 2f5d
004e10 940e 005f
004e12 e054
004e13 955a
004e14 f7f1
004e15 2f5c
004e16 940e 005f
004e18 e054
004e19 955a
004e1a f7f1
004e1b 915f
004e1c 940e 005f
004e1e bc5c
004e1f 9a59
004e20 b854
004e21 b82b
004e22 19c9
004e23 09d5
004e24 b9d8
004e25 b9c2
004e26 b985
004e27 b824
004e28 15d6
004e29 985d
004e2a f100
004e2b b82b
004e2c 935f
004e2d e158
004e2e b955
004e2f eb5f
004e30 b954
004e31 e050
004e32 bd5d
004e33 e550
004e34 bd5c
004e35 9859
004e36 915f
004e37 982c
004e38 938f
004e39 2f5d
004e3a 940e 005f
004e3c e054
004e3d 955a
004e3e f7f1
004e3f 2f5c
004e40 940e 005f
004e42 e054
004e43 955a
004e44 f7f1
004e45 915f
004e46 940e 005f
004e48 bc5c
004e49 9a59
004e4a b854
004e4b b82b      	zzPUSH zzPCh,zzPCl
004e4c 2799      	clr zzPCh
004e4d e180      	ldi zzPCl,0x10
                 
004e4e 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d8: ; RET   C
004e50 ff40      	sbrs zzF,zzCF
004e51 940c 0200 	jmp zCMD_start
004e53 b9d8
004e54 b9c2
004e55 b854
004e56 b83b
004e57 0000
004e58 0000
004e59 b183
004e5a b82b
004e5b 0dc9
004e5c 1dd5
004e5d b9d8
004e5e b9c2
004e5f b854
004e60 b83b
004e61 0000
004e62 0000
004e63 b193
004e64 b82b
004e65 0dc9
004e66 1dd5      	zzPOP zzPCh,zzPCl
                 
004e67 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_d9: ; EXX   
004e69 9150 0907
004e6b 92e0 0907
004e6d 2ee5      	EX zzH,zzHe
004e6e 9150 0908
004e70 92f0 0908
004e72 2ef5      	EX zzL,zzLe
004e73 9150 0903
004e75 92a0 0903
004e77 2ea5      	EX zzB,zzBe
004e78 9150 0904
004e7a 9360 0904
004e7c 2f65      	EX zzC,zzCe
004e7d 9150 0905
004e7f 92c0 0905
004e81 2ec5      	EX zzD,zzDe
004e82 9150 0906
004e84 92d0 0906
004e86 2ed5      	EX zzE,zzEe
                 	
                 
004e87 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_da: ; JP   C nn
004e89 b998
004e8a b982
004e8b b854
004e8c b83b
004e8d 9601
004e8e b123
004e8f b82b      	LDRAM_PC_NODDR FROMRAM2
004e90 b998
004e91 b982
004e92 b854
004e93 b83b
004e94 9601
004e95 b013
004e96 b82b      	LDRAM_PC_NODDR FROMRAM1
004e97 ff40      	sbrs zzF,zzCF
004e98 940c 0200 	jmp zCMD_start
004e9a 2f82      	mov zzPCl,FROMRAM2
004e9b 2d91      	mov zzPCh,FROMRAM1
                 
004e9c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_db: ; IN   A (n)
004e9e b998
004e9f b982
004ea0 b854
004ea1 b83b
004ea2 9601
004ea3 b173
004ea4 b82b      	LDRAM_PC_NODDR FROMRAM0
004ea5 2f57      	mov zzTmp,FROMRAM0
004ea6 940e 7206 	call PORTIN
004ea8 2f15      	mov zzA,zzTmp
                 
004ea9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_dc: ; CALL C nn
004eab b998
004eac b982
004ead b854
004eae b83b
004eaf 9601
004eb0 b123
004eb1 b82b      	LDRAM_PC_NODDR FROMRAM2
004eb2 b998
004eb3 b982
004eb4 b854
004eb5 b83b
004eb6 9601
004eb7 b013
004eb8 b82b      	LDRAM_PC_NODDR FROMRAM1
004eb9 ff40      	sbrs zzF,zzCF
004eba 940c 0200 	jmp zCMD_start
004ebc 19c9
004ebd 09d5
004ebe b9d8
004ebf b9c2
004ec0 b995
004ec1 b824
004ec2 15d6
004ec3 985d
004ec4 f100
004ec5 b82b
004ec6 935f
004ec7 e158
004ec8 b955
004ec9 eb5f
004eca b954
004ecb e050
004ecc bd5d
004ecd e550
004ece bd5c
004ecf 9859
004ed0 915f
004ed1 982c
004ed2 939f
004ed3 2f5d
004ed4 940e 005f
004ed6 e054
004ed7 955a
004ed8 f7f1
004ed9 2f5c
004eda 940e 005f
004edc e054
004edd 955a
004ede f7f1
004edf 915f
004ee0 940e 005f
004ee2 bc5c
004ee3 9a59
004ee4 b854
004ee5 b82b
004ee6 19c9
004ee7 09d5
004ee8 b9d8
004ee9 b9c2
004eea b985
004eeb b824
004eec 15d6
004eed 985d
004eee f100
004eef b82b
004ef0 935f
004ef1 e158
004ef2 b955
004ef3 eb5f
004ef4 b954
004ef5 e050
004ef6 bd5d
004ef7 e550
004ef8 bd5c
004ef9 9859
004efa 915f
004efb 982c
004efc 938f
004efd 2f5d
004efe 940e 005f
004f00 e054
004f01 955a
004f02 f7f1
004f03 2f5c
004f04 940e 005f
004f06 e054
004f07 955a
004f08 f7f1
004f09 915f
004f0a 940e 005f
004f0c bc5c
004f0d 9a59
004f0e b854
004f0f b82b      	zzPUSH zzPCh,zzPCl
004f10 2f82      	mov zzPCl,FROMRAM2
004f11 2d91      	mov zzPCh,FROMRAM1
                 
004f12 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_de: ; SBC  A n
004f14 b998
004f15 b982
004f16 b854
004f17 b83b
004f18 9601
004f19 b173
004f1a b82b      	LDRAM_PC_NODDR FROMRAM0
004f1b bf4f      	out SREG,zzF
004f1c 9418      	sez
004f1d 0b17      	sbc zzA,FROMRAM0
                 
004f1e b75f      	in zzTmp, SREG
004f1f 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
004f20 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
004f21 2b45      	or zzF, zzTmp ; combine flags
004f22 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_df: ; RST   18h
004f24 19c9
004f25 09d5
004f26 b9d8
004f27 b9c2
004f28 b995
004f29 b824
004f2a 15d6
004f2b 985d
004f2c f100
004f2d b82b
004f2e 935f
004f2f e158
004f30 b955
004f31 eb5f
004f32 b954
004f33 e050
004f34 bd5d
004f35 e550
004f36 bd5c
004f37 9859
004f38 915f
004f39 982c
004f3a 939f
004f3b 2f5d
004f3c 940e 005f
004f3e e054
004f3f 955a
004f40 f7f1
004f41 2f5c
004f42 940e 005f
004f44 e054
004f45 955a
004f46 f7f1
004f47 915f
004f48 940e 005f
004f4a bc5c
004f4b 9a59
004f4c b854
004f4d b82b
004f4e 19c9
004f4f 09d5
004f50 b9d8
004f51 b9c2
004f52 b985
004f53 b824
004f54 15d6
004f55 985d
004f56 f100
004f57 b82b
004f58 935f
004f59 e158
004f5a b955
004f5b eb5f
004f5c b954
004f5d e050
004f5e bd5d
004f5f e550
004f60 bd5c
004f61 9859
004f62 915f
004f63 982c
004f64 938f
004f65 2f5d
004f66 940e 005f
004f68 e054
004f69 955a
004f6a f7f1
004f6b 2f5c
004f6c 940e 005f
004f6e e054
004f6f 955a
004f70 f7f1
004f71 915f
004f72 940e 005f
004f74 bc5c
004f75 9a59
004f76 b854
004f77 b82b      	zzPUSH zzPCh,zzPCl
004f78 2799      	clr zzPCh
004f79 e188      	ldi zzPCl,0x18
                 
004f7a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e0: ; RET   PO
004f7c fd43      	sbrc zzF,zzPF
004f7d 940c 0200 	jmp zCMD_start
004f7f b9d8
004f80 b9c2
004f81 b854
004f82 b83b
004f83 0000
004f84 0000
004f85 b183
004f86 b82b
004f87 0dc9
004f88 1dd5
004f89 b9d8
004f8a b9c2
004f8b b854
004f8c b83b
004f8d 0000
004f8e 0000
004f8f b193
004f90 b82b
004f91 0dc9
004f92 1dd5      	zzPOP zzPCh,zzPCl
                 
004f93 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e1: ; POP   IY
004f95 b9d8
004f96 b9c2
004f97 b854
004f98 b83b
004f99 0000
004f9a 0000
004f9b b0b3
004f9c b82b
004f9d 0dc9
004f9e 1dd5
004f9f b9d8
004fa0 b9c2
004fa1 b854
004fa2 b83b
004fa3 0000
004fa4 0000
004fa5 b133
004fa6 b82b
004fa7 0dc9
004fa8 1dd5      	zzPOP zzIYh,zzIYl
                 
004fa9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e2: ; JP   PO nn
004fab b998
004fac b982
004fad b854
004fae b83b
004faf 9601
004fb0 b123
004fb1 b82b      	LDRAM_PC_NODDR FROMRAM2
004fb2 b998
004fb3 b982
004fb4 b854
004fb5 b83b
004fb6 9601
004fb7 b013
004fb8 b82b      	LDRAM_PC_NODDR FROMRAM1
004fb9 fd43      	sbrc zzF,zzPF
004fba 940c 0200 	jmp zCMD_start
004fbc 2f82      	mov zzPCl,FROMRAM2
004fbd 2d91      	mov zzPCh,FROMRAM1
                 
004fbe 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e3: ; EX   (SP) IY
004fc0 2e1d      	mov FROMRAM1,zzSPh
004fc1 2f2c      	mov FROMRAM2,zzSPl
004fc2 b818
004fc3 b922
004fc4 b854
004fc5 b83b
004fc6 0000
004fc7 0000
004fc8 b173
004fc9 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
004fca 2d5b
004fcb 2eb7
004fcc 2f75      	EXR FROMRAM0,zzIYl
004fcd b818
004fce b922
004fcf b975
004fd0 b824
004fd1 1416
004fd2 985d
004fd3 f100
004fd4 b82b
004fd5 935f
004fd6 e158
004fd7 b955
004fd8 eb5f
004fd9 b954
004fda e050
004fdb bd5d
004fdc e550
004fdd bd5c
004fde 9859
004fdf 915f
004fe0 982c
004fe1 937f
004fe2 2d51
004fe3 940e 005f
004fe5 e054
004fe6 955a
004fe7 f7f1
004fe8 2f52
004fe9 940e 005f
004feb e054
004fec 955a
004fed f7f1
004fee 915f
004fef 940e 005f
004ff1 bc5c
004ff2 9a59
004ff3 b854
004ff4 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
004ff5 0d29
004ff6 1c15      	INC2 FROMRAM1,FROMRAM2
004ff7 b818
004ff8 b922
004ff9 b854
004ffa b83b
004ffb 0000
004ffc 0000
004ffd b173
004ffe b82b      	LDRAM FROMRAM1,FROMRAM2,FROMRAM0
004fff 2f53
005000 2f37
005001 2f75      	EXR FROMRAM0,zzIYh
005002 b818
005003 b922
005004 b975
005005 b824
005006 1416
005007 985d
005008 f100
005009 b82b
00500a 935f
00500b e158
00500c b955
00500d eb5f
00500e b954
00500f e050
005010 bd5d
005011 e550
005012 bd5c
005013 9859
005014 915f
005015 982c
005016 937f
005017 2d51
005018 940e 005f
00501a e054
00501b 955a
00501c f7f1
00501d 2f52
00501e 940e 005f
005020 e054
005021 955a
005022 f7f1
005023 915f
005024 940e 005f
005026 bc5c
005027 9a59
005028 b854
005029 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
                 	
                 
00502a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e4: ; CALL PO nn
00502c b998
00502d b982
00502e b854
00502f b83b
005030 9601
005031 b123
005032 b82b      	LDRAM_PC_NODDR FROMRAM2
005033 b998
005034 b982
005035 b854
005036 b83b
005037 9601
005038 b013
005039 b82b      	LDRAM_PC_NODDR FROMRAM1
00503a fd43      	sbrc zzF,zzPF
00503b 940c 0200 	jmp zCMD_start
00503d 19c9
00503e 09d5
00503f b9d8
005040 b9c2
005041 b995
005042 b824
005043 15d6
005044 985d
005045 f100
005046 b82b
005047 935f
005048 e158
005049 b955
00504a eb5f
00504b b954
00504c e050
00504d bd5d
00504e e550
00504f bd5c
005050 9859
005051 915f
005052 982c
005053 939f
005054 2f5d
005055 940e 005f
005057 e054
005058 955a
005059 f7f1
00505a 2f5c
00505b 940e 005f
00505d e054
00505e 955a
00505f f7f1
005060 915f
005061 940e 005f
005063 bc5c
005064 9a59
005065 b854
005066 b82b
005067 19c9
005068 09d5
005069 b9d8
00506a b9c2
00506b b985
00506c b824
00506d 15d6
00506e 985d
00506f f100
005070 b82b
005071 935f
005072 e158
005073 b955
005074 eb5f
005075 b954
005076 e050
005077 bd5d
005078 e550
005079 bd5c
00507a 9859
00507b 915f
00507c 982c
00507d 938f
00507e 2f5d
00507f 940e 005f
005081 e054
005082 955a
005083 f7f1
005084 2f5c
005085 940e 005f
005087 e054
005088 955a
005089 f7f1
00508a 915f
00508b 940e 005f
00508d bc5c
00508e 9a59
00508f b854
005090 b82b      	zzPUSH zzPCh,zzPCl
005091 2f82      	mov zzPCl,FROMRAM2
005092 2d91      	mov zzPCh,FROMRAM1
                 
005093 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e5: ; PUSH  IY
005095 19c9
005096 09d5
005097 b9d8
005098 b9c2
005099 b935
00509a b824
00509b 15d6
00509c 985d
00509d f100
00509e b82b
00509f 935f
0050a0 e158
0050a1 b955
0050a2 eb5f
0050a3 b954
0050a4 e050
0050a5 bd5d
0050a6 e550
0050a7 bd5c
0050a8 9859
0050a9 915f
0050aa 982c
0050ab 933f
0050ac 2f5d
0050ad 940e 005f
0050af e054
0050b0 955a
0050b1 f7f1
0050b2 2f5c
0050b3 940e 005f
0050b5 e054
0050b6 955a
0050b7 f7f1
0050b8 915f
0050b9 940e 005f
0050bb bc5c
0050bc 9a59
0050bd b854
0050be b82b
0050bf 19c9
0050c0 09d5
0050c1 b9d8
0050c2 b9c2
0050c3 b8b5
0050c4 b824
0050c5 15d6
0050c6 985d
0050c7 f100
0050c8 b82b
0050c9 935f
0050ca e158
0050cb b955
0050cc eb5f
0050cd b954
0050ce e050
0050cf bd5d
0050d0 e550
0050d1 bd5c
0050d2 9859
0050d3 915f
0050d4 982c
0050d5 92bf
0050d6 2f5d
0050d7 940e 005f
0050d9 e054
0050da 955a
0050db f7f1
0050dc 2f5c
0050dd 940e 005f
0050df e054
0050e0 955a
0050e1 f7f1
0050e2 915f
0050e3 940e 005f
0050e5 bc5c
0050e6 9a59
0050e7 b854
0050e8 b82b      	zzPUSH zzIYh,zzIYl
                 
0050e9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e6: ; AND  A n
0050eb b998
0050ec b982
0050ed b854
0050ee b83b
0050ef 9601
0050f0 b173
0050f1 b82b      	LDRAM_PC_NODDR FROMRAM0
0050f2 2317      	and zzA,FROMRAM0
                 
0050f3 b75f      	in zzTmp, SREG
0050f4 7856      	andi zzTmp, 	(_I_|_S_|_Z_|___|___|___|___) ; mask results flags
0050f5 ea40      	ldi zzF, 	(_I_|___|___|_H_|___|___|___)
0050f6 2b45      	or zzF, zzTmp ; combine flags
0050f7 e1b8
0050f8 2fa1
0050f9 915c
0050fa 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
0050fb 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e7: ; RST   20h
0050fd 19c9
0050fe 09d5
0050ff b9d8
005100 b9c2
005101 b995
005102 b824
005103 15d6
005104 985d
005105 f100
005106 b82b
005107 935f
005108 e158
005109 b955
00510a eb5f
00510b b954
00510c e050
00510d bd5d
00510e e550
00510f bd5c
005110 9859
005111 915f
005112 982c
005113 939f
005114 2f5d
005115 940e 005f
005117 e054
005118 955a
005119 f7f1
00511a 2f5c
00511b 940e 005f
00511d e054
00511e 955a
00511f f7f1
005120 915f
005121 940e 005f
005123 bc5c
005124 9a59
005125 b854
005126 b82b
005127 19c9
005128 09d5
005129 b9d8
00512a b9c2
00512b b985
00512c b824
00512d 15d6
00512e 985d
00512f f100
005130 b82b
005131 935f
005132 e158
005133 b955
005134 eb5f
005135 b954
005136 e050
005137 bd5d
005138 e550
005139 bd5c
00513a 9859
00513b 915f
00513c 982c
00513d 938f
00513e 2f5d
00513f 940e 005f
005141 e054
005142 955a
005143 f7f1
005144 2f5c
005145 940e 005f
005147 e054
005148 955a
005149 f7f1
00514a 915f
00514b 940e 005f
00514d bc5c
00514e 9a59
00514f b854
005150 b82b      	zzPUSH zzPCh,zzPCl
005151 2799      	clr zzPCh
005152 e280      	ldi zzPCl,0x20
                 
005153 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e8: ; RET   PE
005155 ff43      	sbrs zzF,zzPF
005156 940c 0200 	jmp zCMD_start
005158 b9d8
005159 b9c2
00515a b854
00515b b83b
00515c 0000
00515d 0000
00515e b183
00515f b82b
005160 0dc9
005161 1dd5
005162 b9d8
005163 b9c2
005164 b854
005165 b83b
005166 0000
005167 0000
005168 b193
005169 b82b
00516a 0dc9
00516b 1dd5      	zzPOP zzPCh,zzPCl
                 
00516c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_e9: ; JP   * IY
00516e 1055      	cpse ZERO,ZERO
00516f 940c 0200 	jmp zCMD_start
005171 2d8b      	mov zzPCl,zzIYl
005172 2f93      	mov zzPCh,zzIYh
                 
005173 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ea: ; JP   PE nn
005175 b998
005176 b982
005177 b854
005178 b83b
005179 9601
00517a b123
00517b b82b      	LDRAM_PC_NODDR FROMRAM2
00517c b998
00517d b982
00517e b854
00517f b83b
005180 9601
005181 b013
005182 b82b      	LDRAM_PC_NODDR FROMRAM1
005183 ff43      	sbrs zzF,zzPF
005184 940c 0200 	jmp zCMD_start
005186 2f82      	mov zzPCl,FROMRAM2
005187 2d91      	mov zzPCh,FROMRAM1
                 
005188 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_eb: ; EX   DE IY
00518a 2f53
00518b 2d3c
00518c 2ec5      	EXR zzD,zzIYh
00518d 2d5b
00518e 2cbd
00518f 2ed5      	EXR zzE,zzIYl
                 	
                 
005190 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ec: ; CALL PE nn
005192 b998
005193 b982
005194 b854
005195 b83b
005196 9601
005197 b123
005198 b82b      	LDRAM_PC_NODDR FROMRAM2
005199 b998
00519a b982
00519b b854
00519c b83b
00519d 9601
00519e b013
00519f b82b      	LDRAM_PC_NODDR FROMRAM1
0051a0 ff43      	sbrs zzF,zzPF
0051a1 940c 0200 	jmp zCMD_start
0051a3 19c9
0051a4 09d5
0051a5 b9d8
0051a6 b9c2
0051a7 b995
0051a8 b824
0051a9 15d6
0051aa 985d
0051ab f100
0051ac b82b
0051ad 935f
0051ae e158
0051af b955
0051b0 eb5f
0051b1 b954
0051b2 e050
0051b3 bd5d
0051b4 e550
0051b5 bd5c
0051b6 9859
0051b7 915f
0051b8 982c
0051b9 939f
0051ba 2f5d
0051bb 940e 005f
0051bd e054
0051be 955a
0051bf f7f1
0051c0 2f5c
0051c1 940e 005f
0051c3 e054
0051c4 955a
0051c5 f7f1
0051c6 915f
0051c7 940e 005f
0051c9 bc5c
0051ca 9a59
0051cb b854
0051cc b82b
0051cd 19c9
0051ce 09d5
0051cf b9d8
0051d0 b9c2
0051d1 b985
0051d2 b824
0051d3 15d6
0051d4 985d
0051d5 f100
0051d6 b82b
0051d7 935f
0051d8 e158
0051d9 b955
0051da eb5f
0051db b954
0051dc e050
0051dd bd5d
0051de e550
0051df bd5c
0051e0 9859
0051e1 915f
0051e2 982c
0051e3 938f
0051e4 2f5d
0051e5 940e 005f
0051e7 e054
0051e8 955a
0051e9 f7f1
0051ea 2f5c
0051eb 940e 005f
0051ed e054
0051ee 955a
0051ef f7f1
0051f0 915f
0051f1 940e 005f
0051f3 bc5c
0051f4 9a59
0051f5 b854
0051f6 b82b      	zzPUSH zzPCh,zzPCl
0051f7 2f82      	mov zzPCl,FROMRAM2
0051f8 2d91      	mov zzPCh,FROMRAM1
                 
0051f9 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ee: ; XOR  A n
0051fb b998
0051fc b982
0051fd b854
0051fe b83b
0051ff 9601
005200 b173
005201 b82b      	LDRAM_PC_NODDR FROMRAM0
005202 2717      	eor zzA,FROMRAM0
                 
005203 b74f      	in zzF, SREG
005204 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
005205 e1b8
005206 2fa1
005207 915c
005208 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
005209 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ef: ; RST   28h
00520b 19c9
00520c 09d5
00520d b9d8
00520e b9c2
00520f b995
005210 b824
005211 15d6
005212 985d
005213 f100
005214 b82b
005215 935f
005216 e158
005217 b955
005218 eb5f
005219 b954
00521a e050
00521b bd5d
00521c e550
00521d bd5c
00521e 9859
00521f 915f
005220 982c
005221 939f
005222 2f5d
005223 940e 005f
005225 e054
005226 955a
005227 f7f1
005228 2f5c
005229 940e 005f
00522b e054
00522c 955a
00522d f7f1
00522e 915f
00522f 940e 005f
005231 bc5c
005232 9a59
005233 b854
005234 b82b
005235 19c9
005236 09d5
005237 b9d8
005238 b9c2
005239 b985
00523a b824
00523b 15d6
00523c 985d
00523d f100
00523e b82b
00523f 935f
005240 e158
005241 b955
005242 eb5f
005243 b954
005244 e050
005245 bd5d
005246 e550
005247 bd5c
005248 9859
005249 915f
00524a 982c
00524b 938f
00524c 2f5d
00524d 940e 005f
00524f e054
005250 955a
005251 f7f1
005252 2f5c
005253 940e 005f
005255 e054
005256 955a
005257 f7f1
005258 915f
005259 940e 005f
00525b bc5c
00525c 9a59
00525d b854
00525e b82b      	zzPUSH zzPCh,zzPCl
00525f 2799      	clr zzPCh
005260 e288      	ldi zzPCl,0x28
                 
005261 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f0: ; RET   P
005263 fd42      	sbrc zzF,zzSF
005264 940c 0200 	jmp zCMD_start
005266 b9d8
005267 b9c2
005268 b854
005269 b83b
00526a 0000
00526b 0000
00526c b183
00526d b82b
00526e 0dc9
00526f 1dd5
005270 b9d8
005271 b9c2
005272 b854
005273 b83b
005274 0000
005275 0000
005276 b193
005277 b82b
005278 0dc9
005279 1dd5      	zzPOP zzPCh,zzPCl
                 
00527a 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f1: ; POP   AF
00527c b9d8
00527d b9c2
00527e b854
00527f b83b
005280 0000
005281 0000
005282 b173
005283 b82b
005284 0dc9
005285 1dd5
005286 b9d8
005287 b9c2
005288 b854
005289 b83b
00528a 0000
00528b 0000
00528c b113
00528d b82b
00528e 0dc9
00528f 1dd5      	zzPOP zzA,FROMRAM0
005290 e1ba      	ldi Xh,high(FZ2ATABLE)
005291 2fa7      	mov Xl,FROMRAM0
005292 914c      	ld zzF,X
                 
005293 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f2: ; JP   P nn
005295 b998
005296 b982
005297 b854
005298 b83b
005299 9601
00529a b123
00529b b82b      	LDRAM_PC_NODDR FROMRAM2
00529c b998
00529d b982
00529e b854
00529f b83b
0052a0 9601
0052a1 b013
0052a2 b82b      	LDRAM_PC_NODDR FROMRAM1
0052a3 fd42      	sbrc zzF,zzSF
0052a4 940c 0200 	jmp zCMD_start
0052a6 2f82      	mov zzPCl,FROMRAM2
0052a7 2d91      	mov zzPCh,FROMRAM1
                 
0052a8 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f3: ; DI    
0052aa e050
0052ab 9350 0909 	zzSET zzIFF1,0
0052ad e050
0052ae 9350 090a 	zzSET zzIFF2,0
                 
0052b0 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f4: ; CALL P nn
0052b2 b998
0052b3 b982
0052b4 b854
0052b5 b83b
0052b6 9601
0052b7 b123
0052b8 b82b      	LDRAM_PC_NODDR FROMRAM2
0052b9 b998
0052ba b982
0052bb b854
0052bc b83b
0052bd 9601
0052be b013
0052bf b82b      	LDRAM_PC_NODDR FROMRAM1
0052c0 fd42      	sbrc zzF,zzSF
0052c1 940c 0200 	jmp zCMD_start
0052c3 19c9
0052c4 09d5
0052c5 b9d8
0052c6 b9c2
0052c7 b995
0052c8 b824
0052c9 15d6
0052ca 985d
0052cb f100
0052cc b82b
0052cd 935f
0052ce e158
0052cf b955
0052d0 eb5f
0052d1 b954
0052d2 e050
0052d3 bd5d
0052d4 e550
0052d5 bd5c
0052d6 9859
0052d7 915f
0052d8 982c
0052d9 939f
0052da 2f5d
0052db 940e 005f
0052dd e054
0052de 955a
0052df f7f1
0052e0 2f5c
0052e1 940e 005f
0052e3 e054
0052e4 955a
0052e5 f7f1
0052e6 915f
0052e7 940e 005f
0052e9 bc5c
0052ea 9a59
0052eb b854
0052ec b82b
0052ed 19c9
0052ee 09d5
0052ef b9d8
0052f0 b9c2
0052f1 b985
0052f2 b824
0052f3 15d6
0052f4 985d
0052f5 f100
0052f6 b82b
0052f7 935f
0052f8 e158
0052f9 b955
0052fa eb5f
0052fb b954
0052fc e050
0052fd bd5d
0052fe e550
0052ff bd5c
005300 9859
005301 915f
005302 982c
005303 938f
005304 2f5d
005305 940e 005f
005307 e054
005308 955a
005309 f7f1
00530a 2f5c
00530b 940e 005f
00530d e054
00530e 955a
00530f f7f1
005310 915f
005311 940e 005f
005313 bc5c
005314 9a59
005315 b854
005316 b82b      	zzPUSH zzPCh,zzPCl
005317 2f82      	mov zzPCl,FROMRAM2
005318 2d91      	mov zzPCh,FROMRAM1
                 
005319 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f5: ; PUSH  AF
00531b e1b9      	ldi Xh,high(FA2ZTABLE)
00531c 2fa4      	mov Xl,zzF
00531d 917c      	ld FROMRAM0,X
00531e 19c9
00531f 09d5
005320 b9d8
005321 b9c2
005322 b915
005323 b824
005324 15d6
005325 985d
005326 f100
005327 b82b
005328 935f
005329 e158
00532a b955
00532b eb5f
00532c b954
00532d e050
00532e bd5d
00532f e550
005330 bd5c
005331 9859
005332 915f
005333 982c
005334 931f
005335 2f5d
005336 940e 005f
005338 e054
005339 955a
00533a f7f1
00533b 2f5c
00533c 940e 005f
00533e e054
00533f 955a
005340 f7f1
005341 915f
005342 940e 005f
005344 bc5c
005345 9a59
005346 b854
005347 b82b
005348 19c9
005349 09d5
00534a b9d8
00534b b9c2
00534c b975
00534d b824
00534e 15d6
00534f 985d
005350 f100
005351 b82b
005352 935f
005353 e158
005354 b955
005355 eb5f
005356 b954
005357 e050
005358 bd5d
005359 e550
00535a bd5c
00535b 9859
00535c 915f
00535d 982c
00535e 937f
00535f 2f5d
005360 940e 005f
005362 e054
005363 955a
005364 f7f1
005365 2f5c
005366 940e 005f
005368 e054
005369 955a
00536a f7f1
00536b 915f
00536c 940e 005f
00536e bc5c
00536f 9a59
005370 b854
005371 b82b      	zzPUSH zzA,FROMRAM0
                 
005372 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f6: ; OR   A n
005374 b998
005375 b982
005376 b854
005377 b83b
005378 9601
005379 b173
00537a b82b      	LDRAM_PC_NODDR FROMRAM0
00537b 2b17      	or zzA,FROMRAM0
                 
00537c b74f      	in zzF, SREG
00537d 7846      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|___) ; mask flags
00537e e1b8
00537f 2fa1
005380 915c
005381 2b45      	SET_P_FLAG zzA ;(___|___|___|_P_|___|___) ; set P flag
005382 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f7: ; RST   30h
005384 19c9
005385 09d5
005386 b9d8
005387 b9c2
005388 b995
005389 b824
00538a 15d6
00538b 985d
00538c f100
00538d b82b
00538e 935f
00538f e158
005390 b955
005391 eb5f
005392 b954
005393 e050
005394 bd5d
005395 e550
005396 bd5c
005397 9859
005398 915f
005399 982c
00539a 939f
00539b 2f5d
00539c 940e 005f
00539e e054
00539f 955a
0053a0 f7f1
0053a1 2f5c
0053a2 940e 005f
0053a4 e054
0053a5 955a
0053a6 f7f1
0053a7 915f
0053a8 940e 005f
0053aa bc5c
0053ab 9a59
0053ac b854
0053ad b82b
0053ae 19c9
0053af 09d5
0053b0 b9d8
0053b1 b9c2
0053b2 b985
0053b3 b824
0053b4 15d6
0053b5 985d
0053b6 f100
0053b7 b82b
0053b8 935f
0053b9 e158
0053ba b955
0053bb eb5f
0053bc b954
0053bd e050
0053be bd5d
0053bf e550
0053c0 bd5c
0053c1 9859
0053c2 915f
0053c3 982c
0053c4 938f
0053c5 2f5d
0053c6 940e 005f
0053c8 e054
0053c9 955a
0053ca f7f1
0053cb 2f5c
0053cc 940e 005f
0053ce e054
0053cf 955a
0053d0 f7f1
0053d1 915f
0053d2 940e 005f
0053d4 bc5c
0053d5 9a59
0053d6 b854
0053d7 b82b      	zzPUSH zzPCh,zzPCl
0053d8 2799      	clr zzPCh
0053d9 e380      	ldi zzPCl,0x30
                 
0053da 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f8: ; RET   M
0053dc ff42      	sbrs zzF,zzSF
0053dd 940c 0200 	jmp zCMD_start
0053df b9d8
0053e0 b9c2
0053e1 b854
0053e2 b83b
0053e3 0000
0053e4 0000
0053e5 b183
0053e6 b82b
0053e7 0dc9
0053e8 1dd5
0053e9 b9d8
0053ea b9c2
0053eb b854
0053ec b83b
0053ed 0000
0053ee 0000
0053ef b193
0053f0 b82b
0053f1 0dc9
0053f2 1dd5      	zzPOP zzPCh,zzPCl
                 
0053f3 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_f9: ; LD   SP IY
0053f5 2fd3      	mov zzSPh, zzIYh
0053f6 2dcb      	mov zzSPl, zzIYl
                 
0053f7 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_fa: ; JP   M nn
0053f9 b998
0053fa b982
0053fb b854
0053fc b83b
0053fd 9601
0053fe b123
0053ff b82b      	LDRAM_PC_NODDR FROMRAM2
005400 b998
005401 b982
005402 b854
005403 b83b
005404 9601
005405 b013
005406 b82b      	LDRAM_PC_NODDR FROMRAM1
005407 ff42      	sbrs zzF,zzSF
005408 940c 0200 	jmp zCMD_start
00540a 2f82      	mov zzPCl,FROMRAM2
00540b 2d91      	mov zzPCh,FROMRAM1
                 
00540c 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_fb: ; EI    
00540e e051
00540f 9350 0909 	zzSET zzIFF1,1
005411 e051
005412 9350 090a 	zzSET zzIFF2,1
                 
005414 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_fc: ; CALL M nn
005416 b998
005417 b982
005418 b854
005419 b83b
00541a 9601
00541b b123
00541c b82b      	LDRAM_PC_NODDR FROMRAM2
00541d b998
00541e b982
00541f b854
005420 b83b
005421 9601
005422 b013
005423 b82b      	LDRAM_PC_NODDR FROMRAM1
005424 ff42      	sbrs zzF,zzSF
005425 940c 0200 	jmp zCMD_start
005427 19c9
005428 09d5
005429 b9d8
00542a b9c2
00542b b995
00542c b824
00542d 15d6
00542e 985d
00542f f100
005430 b82b
005431 935f
005432 e158
005433 b955
005434 eb5f
005435 b954
005436 e050
005437 bd5d
005438 e550
005439 bd5c
00543a 9859
00543b 915f
00543c 982c
00543d 939f
00543e 2f5d
00543f 940e 005f
005441 e054
005442 955a
005443 f7f1
005444 2f5c
005445 940e 005f
005447 e054
005448 955a
005449 f7f1
00544a 915f
00544b 940e 005f
00544d bc5c
00544e 9a59
00544f b854
005450 b82b
005451 19c9
005452 09d5
005453 b9d8
005454 b9c2
005455 b985
005456 b824
005457 15d6
005458 985d
005459 f100
00545a b82b
00545b 935f
00545c e158
00545d b955
00545e eb5f
00545f b954
005460 e050
005461 bd5d
005462 e550
005463 bd5c
005464 9859
005465 915f
005466 982c
005467 938f
005468 2f5d
005469 940e 005f
00546b e054
00546c 955a
00546d f7f1
00546e 2f5c
00546f 940e 005f
005471 e054
005472 955a
005473 f7f1
005474 915f
005475 940e 005f
005477 bc5c
005478 9a59
005479 b854
00547a b82b      	zzPUSH zzPCh,zzPCl
00547b 2f82      	mov zzPCl,FROMRAM2
00547c 2d91      	mov zzPCh,FROMRAM1
                 
00547d 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_fe: ; CP   A n
00547f b998
005480 b982
005481 b854
005482 b83b
005483 9601
005484 b173
005485 b82b      	LDRAM_PC_NODDR FROMRAM0
005486 1717      	cp zzA,FROMRAM0
                 
005487 b75f      	in zzTmp, SREG
005488 7a5f      	andi zzTmp, 	(_I_|_S_|_Z_|_H_|_V_|___|_C_) ; mask results flags
005489 ec40      	ldi zzF, 	(_I_|___|___|___|___|_N_|___)
00548a 2b45      	or zzF, zzTmp ; combine flags
00548b 940c 0200 	jmp zCMD_start
                 
                 zCMDFD_ff: ; RST   38h
00548d 19c9
00548e 09d5
00548f b9d8
005490 b9c2
005491 b995
005492 b824
005493 15d6
005494 985d
005495 f100
005496 b82b
005497 935f
005498 e158
005499 b955
00549a eb5f
00549b b954
00549c e050
00549d bd5d
00549e e550
00549f bd5c
0054a0 9859
0054a1 915f
0054a2 982c
0054a3 939f
0054a4 2f5d
0054a5 940e 005f
0054a7 e054
0054a8 955a
0054a9 f7f1
0054aa 2f5c
0054ab 940e 005f
0054ad e054
0054ae 955a
0054af f7f1
0054b0 915f
0054b1 940e 005f
0054b3 bc5c
0054b4 9a59
0054b5 b854
0054b6 b82b
0054b7 19c9
0054b8 09d5
0054b9 b9d8
0054ba b9c2
0054bb b985
0054bc b824
0054bd 15d6
0054be 985d
0054bf f100
0054c0 b82b
0054c1 935f
0054c2 e158
0054c3 b955
0054c4 eb5f
0054c5 b954
0054c6 e050
0054c7 bd5d
0054c8 e550
0054c9 bd5c
0054ca 9859
0054cb 915f
0054cc 982c
0054cd 938f
0054ce 2f5d
0054cf 940e 005f
0054d1 e054
0054d2 955a
0054d3 f7f1
0054d4 2f5c
0054d5 940e 005f
0054d7 e054
0054d8 955a
0054d9 f7f1
0054da 915f
0054db 940e 005f
0054dd bc5c
0054de 9a59
0054df b854
0054e0 b82b      	zzPUSH zzPCh,zzPCl
0054e1 2799      	clr zzPCh
0054e2 e388      	ldi zzPCl,0x38
                 
0054e3 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_06: ; RLC   (IX+d)
0054e5 2f20      	mov FROMRAM2,zzIXl
0054e6 2c18      	mov FROMRAM1,zzIXh
0054e7 2755
0054e8 fd77
0054e9 9550
0054ea 0f27
0054eb 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0054ec b818
0054ed b922
0054ee b854
0054ef b83b
0054f0 0000
0054f1 0000
0054f2 b173
0054f3 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0054f4 fb77      	bst FROMRAM0,7
0054f5 0f77      	lsl FROMRAM0
0054f6 f970      	bld FROMRAM0,0
0054f7 2b77      	or FROMRAM0,FROMRAM0
                 
0054f8 b67f      	in _sreg, SREG
0054f9 b818
0054fa b922
0054fb b975
0054fc b824
0054fd 1416
0054fe 985d
0054ff f100
005500 b82b
005501 935f
005502 e158
005503 b955
005504 eb5f
005505 b954
005506 e050
005507 bd5d
005508 e550
005509 bd5c
00550a 9859
00550b 915f
00550c 982c
00550d 937f
00550e 2d51
00550f 940e 005f
005511 e054
005512 955a
005513 f7f1
005514 2f52
005515 940e 005f
005517 e054
005518 955a
005519 f7f1
00551a 915f
00551b 940e 005f
00551d bc5c
00551e 9a59
00551f b854
005520 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005521 be7f      	out SREG,_sreg
005522 b74f      	in zzF, SREG
005523 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005524 e1b8
005525 2fa7
005526 915c
005527 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005528 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_0e: ; RRC   (IX+d)
00552a 2f20      	mov FROMRAM2,zzIXl
00552b 2c18      	mov FROMRAM1,zzIXh
00552c 2755
00552d fd77
00552e 9550
00552f 0f27
005530 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005531 b818
005532 b922
005533 b854
005534 b83b
005535 0000
005536 0000
005537 b173
005538 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005539 fb70      	bst FROMRAM0,0
00553a 9576      	lsr FROMRAM0
00553b f977      	bld FROMRAM0,7
00553c 2b77      	or FROMRAM0,FROMRAM0
                 
00553d b67f      	in _sreg, SREG
00553e b818
00553f b922
005540 b975
005541 b824
005542 1416
005543 985d
005544 f100
005545 b82b
005546 935f
005547 e158
005548 b955
005549 eb5f
00554a b954
00554b e050
00554c bd5d
00554d e550
00554e bd5c
00554f 9859
005550 915f
005551 982c
005552 937f
005553 2d51
005554 940e 005f
005556 e054
005557 955a
005558 f7f1
005559 2f52
00555a 940e 005f
00555c e054
00555d 955a
00555e f7f1
00555f 915f
005560 940e 005f
005562 bc5c
005563 9a59
005564 b854
005565 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005566 be7f      	out SREG,_sreg
005567 b74f      	in zzF, SREG
005568 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005569 e1b8
00556a 2fa7
00556b 915c
00556c 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
00556d 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_16: ; RL    (IX+d)
00556f 2f20      	mov FROMRAM2,zzIXl
005570 2c18      	mov FROMRAM1,zzIXh
005571 2755
005572 fd77
005573 9550
005574 0f27
005575 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005576 b818
005577 b922
005578 b854
005579 b83b
00557a 0000
00557b 0000
00557c b173
00557d b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00557e bf4f      	out SREG,zzF
00557f 1f77      	rol FROMRAM0
                 
005580 b67f      	in _sreg, SREG
005581 b818
005582 b922
005583 b975
005584 b824
005585 1416
005586 985d
005587 f100
005588 b82b
005589 935f
00558a e158
00558b b955
00558c eb5f
00558d b954
00558e e050
00558f bd5d
005590 e550
005591 bd5c
005592 9859
005593 915f
005594 982c
005595 937f
005596 2d51
005597 940e 005f
005599 e054
00559a 955a
00559b f7f1
00559c 2f52
00559d 940e 005f
00559f e054
0055a0 955a
0055a1 f7f1
0055a2 915f
0055a3 940e 005f
0055a5 bc5c
0055a6 9a59
0055a7 b854
0055a8 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0055a9 be7f      	out SREG,_sreg
0055aa b74f      	in zzF, SREG
0055ab 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0055ac e1b8
0055ad 2fa7
0055ae 915c
0055af 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0055b0 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_1e: ; RR    (IX+d)
0055b2 2f20      	mov FROMRAM2,zzIXl
0055b3 2c18      	mov FROMRAM1,zzIXh
0055b4 2755
0055b5 fd77
0055b6 9550
0055b7 0f27
0055b8 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0055b9 b818
0055ba b922
0055bb b854
0055bc b83b
0055bd 0000
0055be 0000
0055bf b173
0055c0 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0055c1 bf4f      	out SREG,zzF
0055c2 9577      	ror FROMRAM0
                 
0055c3 b67f      	in _sreg, SREG
0055c4 b818
0055c5 b922
0055c6 b975
0055c7 b824
0055c8 1416
0055c9 985d
0055ca f100
0055cb b82b
0055cc 935f
0055cd e158
0055ce b955
0055cf eb5f
0055d0 b954
0055d1 e050
0055d2 bd5d
0055d3 e550
0055d4 bd5c
0055d5 9859
0055d6 915f
0055d7 982c
0055d8 937f
0055d9 2d51
0055da 940e 005f
0055dc e054
0055dd 955a
0055de f7f1
0055df 2f52
0055e0 940e 005f
0055e2 e054
0055e3 955a
0055e4 f7f1
0055e5 915f
0055e6 940e 005f
0055e8 bc5c
0055e9 9a59
0055ea b854
0055eb b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0055ec be7f      	out SREG,_sreg
0055ed b74f      	in zzF, SREG
0055ee 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0055ef e1b8
0055f0 2fa7
0055f1 915c
0055f2 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0055f3 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_26: ; SLA   (IX+d)
0055f5 2f20      	mov FROMRAM2,zzIXl
0055f6 2c18      	mov FROMRAM1,zzIXh
0055f7 2755
0055f8 fd77
0055f9 9550
0055fa 0f27
0055fb 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0055fc b818
0055fd b922
0055fe b854
0055ff b83b
005600 0000
005601 0000
005602 b173
005603 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005604 0f77      	lsl FROMRAM0
                 
005605 b67f      	in _sreg, SREG
005606 b818
005607 b922
005608 b975
005609 b824
00560a 1416
00560b 985d
00560c f100
00560d b82b
00560e 935f
00560f e158
005610 b955
005611 eb5f
005612 b954
005613 e050
005614 bd5d
005615 e550
005616 bd5c
005617 9859
005618 915f
005619 982c
00561a 937f
00561b 2d51
00561c 940e 005f
00561e e054
00561f 955a
005620 f7f1
005621 2f52
005622 940e 005f
005624 e054
005625 955a
005626 f7f1
005627 915f
005628 940e 005f
00562a bc5c
00562b 9a59
00562c b854
00562d b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00562e be7f      	out SREG,_sreg
00562f b74f      	in zzF, SREG
005630 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005631 e1b8
005632 2fa7
005633 915c
005634 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005635 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_2e: ; SRA   (IX+d)
005637 2f20      	mov FROMRAM2,zzIXl
005638 2c18      	mov FROMRAM1,zzIXh
005639 2755
00563a fd77
00563b 9550
00563c 0f27
00563d 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00563e b818
00563f b922
005640 b854
005641 b83b
005642 0000
005643 0000
005644 b173
005645 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005646 fb77      	bst FROMRAM0,7
005647 9576      	lsr FROMRAM0
005648 f977      	bld FROMRAM0,7
005649 2b77      	or FROMRAM0,FROMRAM0
                 
00564a b67f      	in _sreg, SREG
00564b b818
00564c b922
00564d b975
00564e b824
00564f 1416
005650 985d
005651 f100
005652 b82b
005653 935f
005654 e158
005655 b955
005656 eb5f
005657 b954
005658 e050
005659 bd5d
00565a e550
00565b bd5c
00565c 9859
00565d 915f
00565e 982c
00565f 937f
005660 2d51
005661 940e 005f
005663 e054
005664 955a
005665 f7f1
005666 2f52
005667 940e 005f
005669 e054
00566a 955a
00566b f7f1
00566c 915f
00566d 940e 005f
00566f bc5c
005670 9a59
005671 b854
005672 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005673 be7f      	out SREG,_sreg
005674 b74f      	in zzF, SREG
005675 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005676 e1b8
005677 2fa7
005678 915c
005679 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
00567a 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_36: ; SLL   (IX+d)
00567c 2f20      	mov FROMRAM2,zzIXl
00567d 2c18      	mov FROMRAM1,zzIXh
00567e 2755
00567f fd77
005680 9550
005681 0f27
005682 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005683 b818
005684 b922
005685 b854
005686 b83b
005687 0000
005688 0000
005689 b173
00568a b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00568b 0f77      	lsl FROMRAM0
00568c 9468      	set
00568d f970      	bld FROMRAM0,0
00568e 2b77      	or FROMRAM0,FROMRAM0
                 
00568f b67f      	in _sreg, SREG
005690 b818
005691 b922
005692 b975
005693 b824
005694 1416
005695 985d
005696 f100
005697 b82b
005698 935f
005699 e158
00569a b955
00569b eb5f
00569c b954
00569d e050
00569e bd5d
00569f e550
0056a0 bd5c
0056a1 9859
0056a2 915f
0056a3 982c
0056a4 937f
0056a5 2d51
0056a6 940e 005f
0056a8 e054
0056a9 955a
0056aa f7f1
0056ab 2f52
0056ac 940e 005f
0056ae e054
0056af 955a
0056b0 f7f1
0056b1 915f
0056b2 940e 005f
0056b4 bc5c
0056b5 9a59
0056b6 b854
0056b7 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0056b8 be7f      	out SREG,_sreg
0056b9 b74f      	in zzF, SREG
0056ba 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
0056bb e1b8
0056bc 2fa7
0056bd 915c
0056be 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
0056bf 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_3e: ; SRL   (IX+d)
0056c1 2f20      	mov FROMRAM2,zzIXl
0056c2 2c18      	mov FROMRAM1,zzIXh
0056c3 2755
0056c4 fd77
0056c5 9550
0056c6 0f27
0056c7 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0056c8 b818
0056c9 b922
0056ca b854
0056cb b83b
0056cc 0000
0056cd 0000
0056ce b173
0056cf b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0056d0 9576      	lsr FROMRAM0
                 
0056d1 b67f      	in _sreg, SREG
0056d2 b818
0056d3 b922
0056d4 b975
0056d5 b824
0056d6 1416
0056d7 985d
0056d8 f100
0056d9 b82b
0056da 935f
0056db e158
0056dc b955
0056dd eb5f
0056de b954
0056df e050
0056e0 bd5d
0056e1 e550
0056e2 bd5c
0056e3 9859
0056e4 915f
0056e5 982c
0056e6 937f
0056e7 2d51
0056e8 940e 005f
0056ea e054
0056eb 955a
0056ec f7f1
0056ed 2f52
0056ee 940e 005f
0056f0 e054
0056f1 955a
0056f2 f7f1
0056f3 915f
0056f4 940e 005f
0056f6 bc5c
0056f7 9a59
0056f8 b854
0056f9 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0056fa be7f      	out SREG,_sreg
0056fb b74f      	in zzF, SREG
0056fc 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
0056fd e1b8
0056fe 2fa7
0056ff 915c
005700 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005701 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_46: ; BIT  0 (IX+d)
005703 2f20      	mov FROMRAM2,zzIXl
005704 2c18      	mov FROMRAM1,zzIXh
005705 2755
005706 fd77
005707 9550
005708 0f27
005709 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00570a b818
00570b b922
00570c b854
00570d b83b
00570e 0000
00570f 0000
005710 b173
005711 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005712 2f57      	mov zzTmp,FROMRAM0
005713 7051      	andi zzTmp,1<<0
005714 94b8      	clv
005715 b75f      	in zzTmp,SREG
005716 fd51      	sbrc zzTmp,zzZF
005717 9438      	sev
                 
005718 b75f      	in zzTmp, SREG
005719 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
00571a 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00571b 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
00571c 2b45      	or zzF, zzTmp ; combine flags
00571d 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_4e: ; BIT  1 (IX+d)
00571f 2f20      	mov FROMRAM2,zzIXl
005720 2c18      	mov FROMRAM1,zzIXh
005721 2755
005722 fd77
005723 9550
005724 0f27
005725 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005726 b818
005727 b922
005728 b854
005729 b83b
00572a 0000
00572b 0000
00572c b173
00572d b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00572e 2f57      	mov zzTmp,FROMRAM0
00572f 7052      	andi zzTmp,1<<1
005730 94b8      	clv
005731 b75f      	in zzTmp,SREG
005732 fd51      	sbrc zzTmp,zzZF
005733 9438      	sev
                 
005734 b75f      	in zzTmp, SREG
005735 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005736 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005737 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005738 2b45      	or zzF, zzTmp ; combine flags
005739 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_56: ; BIT  2 (IX+d)
00573b 2f20      	mov FROMRAM2,zzIXl
00573c 2c18      	mov FROMRAM1,zzIXh
00573d 2755
00573e fd77
00573f 9550
005740 0f27
005741 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005742 b818
005743 b922
005744 b854
005745 b83b
005746 0000
005747 0000
005748 b173
005749 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00574a 2f57      	mov zzTmp,FROMRAM0
00574b 7054      	andi zzTmp,1<<2
00574c 94b8      	clv
00574d b75f      	in zzTmp,SREG
00574e fd51      	sbrc zzTmp,zzZF
00574f 9438      	sev
                 
005750 b75f      	in zzTmp, SREG
005751 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005752 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005753 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005754 2b45      	or zzF, zzTmp ; combine flags
005755 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_5e: ; BIT  3 (IX+d)
005757 2f20      	mov FROMRAM2,zzIXl
005758 2c18      	mov FROMRAM1,zzIXh
005759 2755
00575a fd77
00575b 9550
00575c 0f27
00575d 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00575e b818
00575f b922
005760 b854
005761 b83b
005762 0000
005763 0000
005764 b173
005765 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005766 2f57      	mov zzTmp,FROMRAM0
005767 7058      	andi zzTmp,1<<3
005768 94b8      	clv
005769 b75f      	in zzTmp,SREG
00576a fd51      	sbrc zzTmp,zzZF
00576b 9438      	sev
                 
00576c b75f      	in zzTmp, SREG
00576d 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
00576e 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00576f 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005770 2b45      	or zzF, zzTmp ; combine flags
005771 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_66: ; BIT  4 (IX+d)
005773 2f20      	mov FROMRAM2,zzIXl
005774 2c18      	mov FROMRAM1,zzIXh
005775 2755
005776 fd77
005777 9550
005778 0f27
005779 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00577a b818
00577b b922
00577c b854
00577d b83b
00577e 0000
00577f 0000
005780 b173
005781 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005782 2f57      	mov zzTmp,FROMRAM0
005783 7150      	andi zzTmp,1<<4
005784 94b8      	clv
005785 b75f      	in zzTmp,SREG
005786 fd51      	sbrc zzTmp,zzZF
005787 9438      	sev
                 
005788 b75f      	in zzTmp, SREG
005789 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
00578a 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
00578b 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
00578c 2b45      	or zzF, zzTmp ; combine flags
00578d 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_6e: ; BIT  5 (IX+d)
00578f 2f20      	mov FROMRAM2,zzIXl
005790 2c18      	mov FROMRAM1,zzIXh
005791 2755
005792 fd77
005793 9550
005794 0f27
005795 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005796 b818
005797 b922
005798 b854
005799 b83b
00579a 0000
00579b 0000
00579c b173
00579d b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00579e 2f57      	mov zzTmp,FROMRAM0
00579f 7250      	andi zzTmp,1<<5
0057a0 94b8      	clv
0057a1 b75f      	in zzTmp,SREG
0057a2 fd51      	sbrc zzTmp,zzZF
0057a3 9438      	sev
                 
0057a4 b75f      	in zzTmp, SREG
0057a5 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
0057a6 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0057a7 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
0057a8 2b45      	or zzF, zzTmp ; combine flags
0057a9 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_76: ; BIT  6 (IX+d)
0057ab 2f20      	mov FROMRAM2,zzIXl
0057ac 2c18      	mov FROMRAM1,zzIXh
0057ad 2755
0057ae fd77
0057af 9550
0057b0 0f27
0057b1 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0057b2 b818
0057b3 b922
0057b4 b854
0057b5 b83b
0057b6 0000
0057b7 0000
0057b8 b173
0057b9 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0057ba 2f57      	mov zzTmp,FROMRAM0
0057bb 7450      	andi zzTmp,1<<6
0057bc 94b8      	clv
0057bd b75f      	in zzTmp,SREG
0057be fd51      	sbrc zzTmp,zzZF
0057bf 9438      	sev
                 
0057c0 b75f      	in zzTmp, SREG
0057c1 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
0057c2 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0057c3 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
0057c4 2b45      	or zzF, zzTmp ; combine flags
0057c5 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_7e: ; BIT  7 (IX+d)
0057c7 2f20      	mov FROMRAM2,zzIXl
0057c8 2c18      	mov FROMRAM1,zzIXh
0057c9 2755
0057ca fd77
0057cb 9550
0057cc 0f27
0057cd 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0057ce b818
0057cf b922
0057d0 b854
0057d1 b83b
0057d2 0000
0057d3 0000
0057d4 b173
0057d5 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0057d6 2f57      	mov zzTmp,FROMRAM0
0057d7 7850      	andi zzTmp,1<<7
0057d8 94b8      	clv
0057d9 b75f      	in zzTmp,SREG
0057da fd51      	sbrc zzTmp,zzZF
0057db 9438      	sev
                 
0057dc b75f      	in zzTmp, SREG
0057dd 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
0057de 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
0057df 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
0057e0 2b45      	or zzF, zzTmp ; combine flags
0057e1 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_86: ; RES  0 (IX+d)
0057e3 2f20      	mov FROMRAM2,zzIXl
0057e4 2c18      	mov FROMRAM1,zzIXh
0057e5 2755
0057e6 fd77
0057e7 9550
0057e8 0f27
0057e9 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0057ea b818
0057eb b922
0057ec b854
0057ed b83b
0057ee 0000
0057ef 0000
0057f0 b173
0057f1 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0057f2 ef5e      	ldi zzTmp,~(1<<0)
0057f3 2375      	and FROMRAM0,zzTmp 
                 
0057f4 b67f      	in _sreg, SREG
0057f5 b818
0057f6 b922
0057f7 b975
0057f8 b824
0057f9 1416
0057fa 985d
0057fb f100
0057fc b82b
0057fd 935f
0057fe e158
0057ff b955
005800 eb5f
005801 b954
005802 e050
005803 bd5d
005804 e550
005805 bd5c
005806 9859
005807 915f
005808 982c
005809 937f
00580a 2d51
00580b 940e 005f
00580d e054
00580e 955a
00580f f7f1
005810 2f52
005811 940e 005f
005813 e054
005814 955a
005815 f7f1
005816 915f
005817 940e 005f
005819 bc5c
00581a 9a59
00581b b854
00581c b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00581d be7f      	out SREG,_sreg
00581e 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_8e: ; RES  1 (IX+d)
005820 2f20      	mov FROMRAM2,zzIXl
005821 2c18      	mov FROMRAM1,zzIXh
005822 2755
005823 fd77
005824 9550
005825 0f27
005826 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005827 b818
005828 b922
005829 b854
00582a b83b
00582b 0000
00582c 0000
00582d b173
00582e b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00582f ef5d      	ldi zzTmp,~(1<<1)
005830 2375      	and FROMRAM0,zzTmp 
                 
005831 b67f      	in _sreg, SREG
005832 b818
005833 b922
005834 b975
005835 b824
005836 1416
005837 985d
005838 f100
005839 b82b
00583a 935f
00583b e158
00583c b955
00583d eb5f
00583e b954
00583f e050
005840 bd5d
005841 e550
005842 bd5c
005843 9859
005844 915f
005845 982c
005846 937f
005847 2d51
005848 940e 005f
00584a e054
00584b 955a
00584c f7f1
00584d 2f52
00584e 940e 005f
005850 e054
005851 955a
005852 f7f1
005853 915f
005854 940e 005f
005856 bc5c
005857 9a59
005858 b854
005859 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00585a be7f      	out SREG,_sreg
00585b 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_96: ; RES  2 (IX+d)
00585d 2f20      	mov FROMRAM2,zzIXl
00585e 2c18      	mov FROMRAM1,zzIXh
00585f 2755
005860 fd77
005861 9550
005862 0f27
005863 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005864 b818
005865 b922
005866 b854
005867 b83b
005868 0000
005869 0000
00586a b173
00586b b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00586c ef5b      	ldi zzTmp,~(1<<2)
00586d 2375      	and FROMRAM0,zzTmp 
                 
00586e b67f      	in _sreg, SREG
00586f b818
005870 b922
005871 b975
005872 b824
005873 1416
005874 985d
005875 f100
005876 b82b
005877 935f
005878 e158
005879 b955
00587a eb5f
00587b b954
00587c e050
00587d bd5d
00587e e550
00587f bd5c
005880 9859
005881 915f
005882 982c
005883 937f
005884 2d51
005885 940e 005f
005887 e054
005888 955a
005889 f7f1
00588a 2f52
00588b 940e 005f
00588d e054
00588e 955a
00588f f7f1
005890 915f
005891 940e 005f
005893 bc5c
005894 9a59
005895 b854
005896 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005897 be7f      	out SREG,_sreg
005898 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_9e: ; RES  3 (IX+d)
00589a 2f20      	mov FROMRAM2,zzIXl
00589b 2c18      	mov FROMRAM1,zzIXh
00589c 2755
00589d fd77
00589e 9550
00589f 0f27
0058a0 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0058a1 b818
0058a2 b922
0058a3 b854
0058a4 b83b
0058a5 0000
0058a6 0000
0058a7 b173
0058a8 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0058a9 ef57      	ldi zzTmp,~(1<<3)
0058aa 2375      	and FROMRAM0,zzTmp 
                 
0058ab b67f      	in _sreg, SREG
0058ac b818
0058ad b922
0058ae b975
0058af b824
0058b0 1416
0058b1 985d
0058b2 f100
0058b3 b82b
0058b4 935f
0058b5 e158
0058b6 b955
0058b7 eb5f
0058b8 b954
0058b9 e050
0058ba bd5d
0058bb e550
0058bc bd5c
0058bd 9859
0058be 915f
0058bf 982c
0058c0 937f
0058c1 2d51
0058c2 940e 005f
0058c4 e054
0058c5 955a
0058c6 f7f1
0058c7 2f52
0058c8 940e 005f
0058ca e054
0058cb 955a
0058cc f7f1
0058cd 915f
0058ce 940e 005f
0058d0 bc5c
0058d1 9a59
0058d2 b854
0058d3 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0058d4 be7f      	out SREG,_sreg
0058d5 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_a6: ; RES  4 (IX+d)
0058d7 2f20      	mov FROMRAM2,zzIXl
0058d8 2c18      	mov FROMRAM1,zzIXh
0058d9 2755
0058da fd77
0058db 9550
0058dc 0f27
0058dd 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0058de b818
0058df b922
0058e0 b854
0058e1 b83b
0058e2 0000
0058e3 0000
0058e4 b173
0058e5 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0058e6 ee5f      	ldi zzTmp,~(1<<4)
0058e7 2375      	and FROMRAM0,zzTmp 
                 
0058e8 b67f      	in _sreg, SREG
0058e9 b818
0058ea b922
0058eb b975
0058ec b824
0058ed 1416
0058ee 985d
0058ef f100
0058f0 b82b
0058f1 935f
0058f2 e158
0058f3 b955
0058f4 eb5f
0058f5 b954
0058f6 e050
0058f7 bd5d
0058f8 e550
0058f9 bd5c
0058fa 9859
0058fb 915f
0058fc 982c
0058fd 937f
0058fe 2d51
0058ff 940e 005f
005901 e054
005902 955a
005903 f7f1
005904 2f52
005905 940e 005f
005907 e054
005908 955a
005909 f7f1
00590a 915f
00590b 940e 005f
00590d bc5c
00590e 9a59
00590f b854
005910 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005911 be7f      	out SREG,_sreg
005912 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_ae: ; RES  5 (IX+d)
005914 2f20      	mov FROMRAM2,zzIXl
005915 2c18      	mov FROMRAM1,zzIXh
005916 2755
005917 fd77
005918 9550
005919 0f27
00591a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00591b b818
00591c b922
00591d b854
00591e b83b
00591f 0000
005920 0000
005921 b173
005922 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005923 ed5f      	ldi zzTmp,~(1<<5)
005924 2375      	and FROMRAM0,zzTmp 
                 
005925 b67f      	in _sreg, SREG
005926 b818
005927 b922
005928 b975
005929 b824
00592a 1416
00592b 985d
00592c f100
00592d b82b
00592e 935f
00592f e158
005930 b955
005931 eb5f
005932 b954
005933 e050
005934 bd5d
005935 e550
005936 bd5c
005937 9859
005938 915f
005939 982c
00593a 937f
00593b 2d51
00593c 940e 005f
00593e e054
00593f 955a
005940 f7f1
005941 2f52
005942 940e 005f
005944 e054
005945 955a
005946 f7f1
005947 915f
005948 940e 005f
00594a bc5c
00594b 9a59
00594c b854
00594d b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00594e be7f      	out SREG,_sreg
00594f 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_b6: ; RES  6 (IX+d)
005951 2f20      	mov FROMRAM2,zzIXl
005952 2c18      	mov FROMRAM1,zzIXh
005953 2755
005954 fd77
005955 9550
005956 0f27
005957 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005958 b818
005959 b922
00595a b854
00595b b83b
00595c 0000
00595d 0000
00595e b173
00595f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005960 eb5f      	ldi zzTmp,~(1<<6)
005961 2375      	and FROMRAM0,zzTmp 
                 
005962 b67f      	in _sreg, SREG
005963 b818
005964 b922
005965 b975
005966 b824
005967 1416
005968 985d
005969 f100
00596a b82b
00596b 935f
00596c e158
00596d b955
00596e eb5f
00596f b954
005970 e050
005971 bd5d
005972 e550
005973 bd5c
005974 9859
005975 915f
005976 982c
005977 937f
005978 2d51
005979 940e 005f
00597b e054
00597c 955a
00597d f7f1
00597e 2f52
00597f 940e 005f
005981 e054
005982 955a
005983 f7f1
005984 915f
005985 940e 005f
005987 bc5c
005988 9a59
005989 b854
00598a b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00598b be7f      	out SREG,_sreg
00598c 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_be: ; RES  7 (IX+d)
00598e 2f20      	mov FROMRAM2,zzIXl
00598f 2c18      	mov FROMRAM1,zzIXh
005990 2755
005991 fd77
005992 9550
005993 0f27
005994 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005995 b818
005996 b922
005997 b854
005998 b83b
005999 0000
00599a 0000
00599b b173
00599c b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00599d e75f      	ldi zzTmp,~(1<<7)
00599e 2375      	and FROMRAM0,zzTmp 
                 
00599f b67f      	in _sreg, SREG
0059a0 b818
0059a1 b922
0059a2 b975
0059a3 b824
0059a4 1416
0059a5 985d
0059a6 f100
0059a7 b82b
0059a8 935f
0059a9 e158
0059aa b955
0059ab eb5f
0059ac b954
0059ad e050
0059ae bd5d
0059af e550
0059b0 bd5c
0059b1 9859
0059b2 915f
0059b3 982c
0059b4 937f
0059b5 2d51
0059b6 940e 005f
0059b8 e054
0059b9 955a
0059ba f7f1
0059bb 2f52
0059bc 940e 005f
0059be e054
0059bf 955a
0059c0 f7f1
0059c1 915f
0059c2 940e 005f
0059c4 bc5c
0059c5 9a59
0059c6 b854
0059c7 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0059c8 be7f      	out SREG,_sreg
0059c9 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_c6: ; SET  0 (IX+d)
0059cb 2f20      	mov FROMRAM2,zzIXl
0059cc 2c18      	mov FROMRAM1,zzIXh
0059cd 2755
0059ce fd77
0059cf 9550
0059d0 0f27
0059d1 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0059d2 b818
0059d3 b922
0059d4 b854
0059d5 b83b
0059d6 0000
0059d7 0000
0059d8 b173
0059d9 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0059da e051      	ldi zzTmp,1<<0
0059db 2b75      	or FROMRAM0,zzTmp
                 
0059dc b67f      	in _sreg, SREG
0059dd b818
0059de b922
0059df b975
0059e0 b824
0059e1 1416
0059e2 985d
0059e3 f100
0059e4 b82b
0059e5 935f
0059e6 e158
0059e7 b955
0059e8 eb5f
0059e9 b954
0059ea e050
0059eb bd5d
0059ec e550
0059ed bd5c
0059ee 9859
0059ef 915f
0059f0 982c
0059f1 937f
0059f2 2d51
0059f3 940e 005f
0059f5 e054
0059f6 955a
0059f7 f7f1
0059f8 2f52
0059f9 940e 005f
0059fb e054
0059fc 955a
0059fd f7f1
0059fe 915f
0059ff 940e 005f
005a01 bc5c
005a02 9a59
005a03 b854
005a04 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005a05 be7f      	out SREG,_sreg
005a06 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_ce: ; SET  1 (IX+d)
005a08 2f20      	mov FROMRAM2,zzIXl
005a09 2c18      	mov FROMRAM1,zzIXh
005a0a 2755
005a0b fd77
005a0c 9550
005a0d 0f27
005a0e 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005a0f b818
005a10 b922
005a11 b854
005a12 b83b
005a13 0000
005a14 0000
005a15 b173
005a16 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005a17 e052      	ldi zzTmp,1<<1
005a18 2b75      	or FROMRAM0,zzTmp
                 
005a19 b67f      	in _sreg, SREG
005a1a b818
005a1b b922
005a1c b975
005a1d b824
005a1e 1416
005a1f 985d
005a20 f100
005a21 b82b
005a22 935f
005a23 e158
005a24 b955
005a25 eb5f
005a26 b954
005a27 e050
005a28 bd5d
005a29 e550
005a2a bd5c
005a2b 9859
005a2c 915f
005a2d 982c
005a2e 937f
005a2f 2d51
005a30 940e 005f
005a32 e054
005a33 955a
005a34 f7f1
005a35 2f52
005a36 940e 005f
005a38 e054
005a39 955a
005a3a f7f1
005a3b 915f
005a3c 940e 005f
005a3e bc5c
005a3f 9a59
005a40 b854
005a41 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005a42 be7f      	out SREG,_sreg
005a43 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_d6: ; SET  2 (IX+d)
005a45 2f20      	mov FROMRAM2,zzIXl
005a46 2c18      	mov FROMRAM1,zzIXh
005a47 2755
005a48 fd77
005a49 9550
005a4a 0f27
005a4b 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005a4c b818
005a4d b922
005a4e b854
005a4f b83b
005a50 0000
005a51 0000
005a52 b173
005a53 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005a54 e054      	ldi zzTmp,1<<2
005a55 2b75      	or FROMRAM0,zzTmp
                 
005a56 b67f      	in _sreg, SREG
005a57 b818
005a58 b922
005a59 b975
005a5a b824
005a5b 1416
005a5c 985d
005a5d f100
005a5e b82b
005a5f 935f
005a60 e158
005a61 b955
005a62 eb5f
005a63 b954
005a64 e050
005a65 bd5d
005a66 e550
005a67 bd5c
005a68 9859
005a69 915f
005a6a 982c
005a6b 937f
005a6c 2d51
005a6d 940e 005f
005a6f e054
005a70 955a
005a71 f7f1
005a72 2f52
005a73 940e 005f
005a75 e054
005a76 955a
005a77 f7f1
005a78 915f
005a79 940e 005f
005a7b bc5c
005a7c 9a59
005a7d b854
005a7e b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005a7f be7f      	out SREG,_sreg
005a80 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_de: ; SET  3 (IX+d)
005a82 2f20      	mov FROMRAM2,zzIXl
005a83 2c18      	mov FROMRAM1,zzIXh
005a84 2755
005a85 fd77
005a86 9550
005a87 0f27
005a88 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005a89 b818
005a8a b922
005a8b b854
005a8c b83b
005a8d 0000
005a8e 0000
005a8f b173
005a90 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005a91 e058      	ldi zzTmp,1<<3
005a92 2b75      	or FROMRAM0,zzTmp
                 
005a93 b67f      	in _sreg, SREG
005a94 b818
005a95 b922
005a96 b975
005a97 b824
005a98 1416
005a99 985d
005a9a f100
005a9b b82b
005a9c 935f
005a9d e158
005a9e b955
005a9f eb5f
005aa0 b954
005aa1 e050
005aa2 bd5d
005aa3 e550
005aa4 bd5c
005aa5 9859
005aa6 915f
005aa7 982c
005aa8 937f
005aa9 2d51
005aaa 940e 005f
005aac e054
005aad 955a
005aae f7f1
005aaf 2f52
005ab0 940e 005f
005ab2 e054
005ab3 955a
005ab4 f7f1
005ab5 915f
005ab6 940e 005f
005ab8 bc5c
005ab9 9a59
005aba b854
005abb b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005abc be7f      	out SREG,_sreg
005abd 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_e6: ; SET  4 (IX+d)
005abf 2f20      	mov FROMRAM2,zzIXl
005ac0 2c18      	mov FROMRAM1,zzIXh
005ac1 2755
005ac2 fd77
005ac3 9550
005ac4 0f27
005ac5 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005ac6 b818
005ac7 b922
005ac8 b854
005ac9 b83b
005aca 0000
005acb 0000
005acc b173
005acd b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005ace e150      	ldi zzTmp,1<<4
005acf 2b75      	or FROMRAM0,zzTmp
                 
005ad0 b67f      	in _sreg, SREG
005ad1 b818
005ad2 b922
005ad3 b975
005ad4 b824
005ad5 1416
005ad6 985d
005ad7 f100
005ad8 b82b
005ad9 935f
005ada e158
005adb b955
005adc eb5f
005add b954
005ade e050
005adf bd5d
005ae0 e550
005ae1 bd5c
005ae2 9859
005ae3 915f
005ae4 982c
005ae5 937f
005ae6 2d51
005ae7 940e 005f
005ae9 e054
005aea 955a
005aeb f7f1
005aec 2f52
005aed 940e 005f
005aef e054
005af0 955a
005af1 f7f1
005af2 915f
005af3 940e 005f
005af5 bc5c
005af6 9a59
005af7 b854
005af8 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005af9 be7f      	out SREG,_sreg
005afa 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_ee: ; SET  5 (IX+d)
005afc 2f20      	mov FROMRAM2,zzIXl
005afd 2c18      	mov FROMRAM1,zzIXh
005afe 2755
005aff fd77
005b00 9550
005b01 0f27
005b02 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005b03 b818
005b04 b922
005b05 b854
005b06 b83b
005b07 0000
005b08 0000
005b09 b173
005b0a b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005b0b e250      	ldi zzTmp,1<<5
005b0c 2b75      	or FROMRAM0,zzTmp
                 
005b0d b67f      	in _sreg, SREG
005b0e b818
005b0f b922
005b10 b975
005b11 b824
005b12 1416
005b13 985d
005b14 f100
005b15 b82b
005b16 935f
005b17 e158
005b18 b955
005b19 eb5f
005b1a b954
005b1b e050
005b1c bd5d
005b1d e550
005b1e bd5c
005b1f 9859
005b20 915f
005b21 982c
005b22 937f
005b23 2d51
005b24 940e 005f
005b26 e054
005b27 955a
005b28 f7f1
005b29 2f52
005b2a 940e 005f
005b2c e054
005b2d 955a
005b2e f7f1
005b2f 915f
005b30 940e 005f
005b32 bc5c
005b33 9a59
005b34 b854
005b35 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005b36 be7f      	out SREG,_sreg
005b37 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_f6: ; SET  6 (IX+d)
005b39 2f20      	mov FROMRAM2,zzIXl
005b3a 2c18      	mov FROMRAM1,zzIXh
005b3b 2755
005b3c fd77
005b3d 9550
005b3e 0f27
005b3f 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005b40 b818
005b41 b922
005b42 b854
005b43 b83b
005b44 0000
005b45 0000
005b46 b173
005b47 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005b48 e450      	ldi zzTmp,1<<6
005b49 2b75      	or FROMRAM0,zzTmp
                 
005b4a b67f      	in _sreg, SREG
005b4b b818
005b4c b922
005b4d b975
005b4e b824
005b4f 1416
005b50 985d
005b51 f100
005b52 b82b
005b53 935f
005b54 e158
005b55 b955
005b56 eb5f
005b57 b954
005b58 e050
005b59 bd5d
005b5a e550
005b5b bd5c
005b5c 9859
005b5d 915f
005b5e 982c
005b5f 937f
005b60 2d51
005b61 940e 005f
005b63 e054
005b64 955a
005b65 f7f1
005b66 2f52
005b67 940e 005f
005b69 e054
005b6a 955a
005b6b f7f1
005b6c 915f
005b6d 940e 005f
005b6f bc5c
005b70 9a59
005b71 b854
005b72 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005b73 be7f      	out SREG,_sreg
005b74 940c 0200 	jmp zCMD_start
                 
                 zCMDDDCB_fe: ; SET  7 (IX+d)
005b76 2f20      	mov FROMRAM2,zzIXl
005b77 2c18      	mov FROMRAM1,zzIXh
005b78 2755
005b79 fd77
005b7a 9550
005b7b 0f27
005b7c 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005b7d b818
005b7e b922
005b7f b854
005b80 b83b
005b81 0000
005b82 0000
005b83 b173
005b84 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005b85 e850      	ldi zzTmp,1<<7
005b86 2b75      	or FROMRAM0,zzTmp
                 
005b87 b67f      	in _sreg, SREG
005b88 b818
005b89 b922
005b8a b975
005b8b b824
005b8c 1416
005b8d 985d
005b8e f100
005b8f b82b
005b90 935f
005b91 e158
005b92 b955
005b93 eb5f
005b94 b954
005b95 e050
005b96 bd5d
005b97 e550
005b98 bd5c
005b99 9859
005b9a 915f
005b9b 982c
005b9c 937f
005b9d 2d51
005b9e 940e 005f
005ba0 e054
005ba1 955a
005ba2 f7f1
005ba3 2f52
005ba4 940e 005f
005ba6 e054
005ba7 955a
005ba8 f7f1
005ba9 915f
005baa 940e 005f
005bac bc5c
005bad 9a59
005bae b854
005baf b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005bb0 be7f      	out SREG,_sreg
005bb1 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_06: ; RLC   (IY+d)
005bb3 2d2b      	mov FROMRAM2,zzIYl
005bb4 2e13      	mov FROMRAM1,zzIYh
005bb5 2755
005bb6 fd77
005bb7 9550
005bb8 0f27
005bb9 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005bba b818
005bbb b922
005bbc b854
005bbd b83b
005bbe 0000
005bbf 0000
005bc0 b173
005bc1 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005bc2 fb77      	bst FROMRAM0,7
005bc3 0f77      	lsl FROMRAM0
005bc4 f970      	bld FROMRAM0,0
005bc5 2b77      	or FROMRAM0,FROMRAM0
                 
005bc6 b67f      	in _sreg, SREG
005bc7 b818
005bc8 b922
005bc9 b975
005bca b824
005bcb 1416
005bcc 985d
005bcd f100
005bce b82b
005bcf 935f
005bd0 e158
005bd1 b955
005bd2 eb5f
005bd3 b954
005bd4 e050
005bd5 bd5d
005bd6 e550
005bd7 bd5c
005bd8 9859
005bd9 915f
005bda 982c
005bdb 937f
005bdc 2d51
005bdd 940e 005f
005bdf e054
005be0 955a
005be1 f7f1
005be2 2f52
005be3 940e 005f
005be5 e054
005be6 955a
005be7 f7f1
005be8 915f
005be9 940e 005f
005beb bc5c
005bec 9a59
005bed b854
005bee b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005bef be7f      	out SREG,_sreg
005bf0 b74f      	in zzF, SREG
005bf1 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005bf2 e1b8
005bf3 2fa7
005bf4 915c
005bf5 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005bf6 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_0e: ; RRC   (IY+d)
005bf8 2d2b      	mov FROMRAM2,zzIYl
005bf9 2e13      	mov FROMRAM1,zzIYh
005bfa 2755
005bfb fd77
005bfc 9550
005bfd 0f27
005bfe 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005bff b818
005c00 b922
005c01 b854
005c02 b83b
005c03 0000
005c04 0000
005c05 b173
005c06 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005c07 fb70      	bst FROMRAM0,0
005c08 9576      	lsr FROMRAM0
005c09 f977      	bld FROMRAM0,7
005c0a 2b77      	or FROMRAM0,FROMRAM0
                 
005c0b b67f      	in _sreg, SREG
005c0c b818
005c0d b922
005c0e b975
005c0f b824
005c10 1416
005c11 985d
005c12 f100
005c13 b82b
005c14 935f
005c15 e158
005c16 b955
005c17 eb5f
005c18 b954
005c19 e050
005c1a bd5d
005c1b e550
005c1c bd5c
005c1d 9859
005c1e 915f
005c1f 982c
005c20 937f
005c21 2d51
005c22 940e 005f
005c24 e054
005c25 955a
005c26 f7f1
005c27 2f52
005c28 940e 005f
005c2a e054
005c2b 955a
005c2c f7f1
005c2d 915f
005c2e 940e 005f
005c30 bc5c
005c31 9a59
005c32 b854
005c33 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005c34 be7f      	out SREG,_sreg
005c35 b74f      	in zzF, SREG
005c36 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005c37 e1b8
005c38 2fa7
005c39 915c
005c3a 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005c3b 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_16: ; RL    (IY+d)
005c3d 2d2b      	mov FROMRAM2,zzIYl
005c3e 2e13      	mov FROMRAM1,zzIYh
005c3f 2755
005c40 fd77
005c41 9550
005c42 0f27
005c43 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005c44 b818
005c45 b922
005c46 b854
005c47 b83b
005c48 0000
005c49 0000
005c4a b173
005c4b b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005c4c bf4f      	out SREG,zzF
005c4d 1f77      	rol FROMRAM0
                 
005c4e b67f      	in _sreg, SREG
005c4f b818
005c50 b922
005c51 b975
005c52 b824
005c53 1416
005c54 985d
005c55 f100
005c56 b82b
005c57 935f
005c58 e158
005c59 b955
005c5a eb5f
005c5b b954
005c5c e050
005c5d bd5d
005c5e e550
005c5f bd5c
005c60 9859
005c61 915f
005c62 982c
005c63 937f
005c64 2d51
005c65 940e 005f
005c67 e054
005c68 955a
005c69 f7f1
005c6a 2f52
005c6b 940e 005f
005c6d e054
005c6e 955a
005c6f f7f1
005c70 915f
005c71 940e 005f
005c73 bc5c
005c74 9a59
005c75 b854
005c76 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005c77 be7f      	out SREG,_sreg
005c78 b74f      	in zzF, SREG
005c79 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005c7a e1b8
005c7b 2fa7
005c7c 915c
005c7d 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005c7e 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_1e: ; RR    (IY+d)
005c80 2d2b      	mov FROMRAM2,zzIYl
005c81 2e13      	mov FROMRAM1,zzIYh
005c82 2755
005c83 fd77
005c84 9550
005c85 0f27
005c86 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005c87 b818
005c88 b922
005c89 b854
005c8a b83b
005c8b 0000
005c8c 0000
005c8d b173
005c8e b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005c8f bf4f      	out SREG,zzF
005c90 9577      	ror FROMRAM0
                 
005c91 b67f      	in _sreg, SREG
005c92 b818
005c93 b922
005c94 b975
005c95 b824
005c96 1416
005c97 985d
005c98 f100
005c99 b82b
005c9a 935f
005c9b e158
005c9c b955
005c9d eb5f
005c9e b954
005c9f e050
005ca0 bd5d
005ca1 e550
005ca2 bd5c
005ca3 9859
005ca4 915f
005ca5 982c
005ca6 937f
005ca7 2d51
005ca8 940e 005f
005caa e054
005cab 955a
005cac f7f1
005cad 2f52
005cae 940e 005f
005cb0 e054
005cb1 955a
005cb2 f7f1
005cb3 915f
005cb4 940e 005f
005cb6 bc5c
005cb7 9a59
005cb8 b854
005cb9 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005cba be7f      	out SREG,_sreg
005cbb b74f      	in zzF, SREG
005cbc 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005cbd e1b8
005cbe 2fa7
005cbf 915c
005cc0 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005cc1 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_26: ; SLA   (IY+d)
005cc3 2d2b      	mov FROMRAM2,zzIYl
005cc4 2e13      	mov FROMRAM1,zzIYh
005cc5 2755
005cc6 fd77
005cc7 9550
005cc8 0f27
005cc9 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005cca b818
005ccb b922
005ccc b854
005ccd b83b
005cce 0000
005ccf 0000
005cd0 b173
005cd1 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005cd2 0f77      	lsl FROMRAM0
                 
005cd3 b67f      	in _sreg, SREG
005cd4 b818
005cd5 b922
005cd6 b975
005cd7 b824
005cd8 1416
005cd9 985d
005cda f100
005cdb b82b
005cdc 935f
005cdd e158
005cde b955
005cdf eb5f
005ce0 b954
005ce1 e050
005ce2 bd5d
005ce3 e550
005ce4 bd5c
005ce5 9859
005ce6 915f
005ce7 982c
005ce8 937f
005ce9 2d51
005cea 940e 005f
005cec e054
005ced 955a
005cee f7f1
005cef 2f52
005cf0 940e 005f
005cf2 e054
005cf3 955a
005cf4 f7f1
005cf5 915f
005cf6 940e 005f
005cf8 bc5c
005cf9 9a59
005cfa b854
005cfb b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005cfc be7f      	out SREG,_sreg
005cfd b74f      	in zzF, SREG
005cfe 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005cff e1b8
005d00 2fa7
005d01 915c
005d02 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005d03 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_2e: ; SRA   (IY+d)
005d05 2d2b      	mov FROMRAM2,zzIYl
005d06 2e13      	mov FROMRAM1,zzIYh
005d07 2755
005d08 fd77
005d09 9550
005d0a 0f27
005d0b 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005d0c b818
005d0d b922
005d0e b854
005d0f b83b
005d10 0000
005d11 0000
005d12 b173
005d13 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005d14 fb77      	bst FROMRAM0,7
005d15 9576      	lsr FROMRAM0
005d16 f977      	bld FROMRAM0,7
005d17 2b77      	or FROMRAM0,FROMRAM0
                 
005d18 b67f      	in _sreg, SREG
005d19 b818
005d1a b922
005d1b b975
005d1c b824
005d1d 1416
005d1e 985d
005d1f f100
005d20 b82b
005d21 935f
005d22 e158
005d23 b955
005d24 eb5f
005d25 b954
005d26 e050
005d27 bd5d
005d28 e550
005d29 bd5c
005d2a 9859
005d2b 915f
005d2c 982c
005d2d 937f
005d2e 2d51
005d2f 940e 005f
005d31 e054
005d32 955a
005d33 f7f1
005d34 2f52
005d35 940e 005f
005d37 e054
005d38 955a
005d39 f7f1
005d3a 915f
005d3b 940e 005f
005d3d bc5c
005d3e 9a59
005d3f b854
005d40 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005d41 be7f      	out SREG,_sreg
005d42 b74f      	in zzF, SREG
005d43 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005d44 e1b8
005d45 2fa7
005d46 915c
005d47 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005d48 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_36: ; SLL   (IY+d)
005d4a 2d2b      	mov FROMRAM2,zzIYl
005d4b 2e13      	mov FROMRAM1,zzIYh
005d4c 2755
005d4d fd77
005d4e 9550
005d4f 0f27
005d50 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005d51 b818
005d52 b922
005d53 b854
005d54 b83b
005d55 0000
005d56 0000
005d57 b173
005d58 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005d59 0f77      	lsl FROMRAM0
005d5a 9468      	set
005d5b f970      	bld FROMRAM0,0
005d5c 2b77      	or FROMRAM0,FROMRAM0
                 
005d5d b67f      	in _sreg, SREG
005d5e b818
005d5f b922
005d60 b975
005d61 b824
005d62 1416
005d63 985d
005d64 f100
005d65 b82b
005d66 935f
005d67 e158
005d68 b955
005d69 eb5f
005d6a b954
005d6b e050
005d6c bd5d
005d6d e550
005d6e bd5c
005d6f 9859
005d70 915f
005d71 982c
005d72 937f
005d73 2d51
005d74 940e 005f
005d76 e054
005d77 955a
005d78 f7f1
005d79 2f52
005d7a 940e 005f
005d7c e054
005d7d 955a
005d7e f7f1
005d7f 915f
005d80 940e 005f
005d82 bc5c
005d83 9a59
005d84 b854
005d85 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005d86 be7f      	out SREG,_sreg
005d87 b74f      	in zzF, SREG
005d88 7847      	andi zzF, 	(_I_|_S_|_Z_|___|___|___|_C_) ; mask flags
005d89 e1b8
005d8a 2fa7
005d8b 915c
005d8c 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005d8d 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_3e: ; SRL   (IY+d)
005d8f 2d2b      	mov FROMRAM2,zzIYl
005d90 2e13      	mov FROMRAM1,zzIYh
005d91 2755
005d92 fd77
005d93 9550
005d94 0f27
005d95 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005d96 b818
005d97 b922
005d98 b854
005d99 b83b
005d9a 0000
005d9b 0000
005d9c b173
005d9d b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005d9e 9576      	lsr FROMRAM0
                 
005d9f b67f      	in _sreg, SREG
005da0 b818
005da1 b922
005da2 b975
005da3 b824
005da4 1416
005da5 985d
005da6 f100
005da7 b82b
005da8 935f
005da9 e158
005daa b955
005dab eb5f
005dac b954
005dad e050
005dae bd5d
005daf e550
005db0 bd5c
005db1 9859
005db2 915f
005db3 982c
005db4 937f
005db5 2d51
005db6 940e 005f
005db8 e054
005db9 955a
005dba f7f1
005dbb 2f52
005dbc 940e 005f
005dbe e054
005dbf 955a
005dc0 f7f1
005dc1 915f
005dc2 940e 005f
005dc4 bc5c
005dc5 9a59
005dc6 b854
005dc7 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005dc8 be7f      	out SREG,_sreg
005dc9 b74f      	in zzF, SREG
005dca 7843      	andi zzF, 	(_I_|___|_Z_|___|___|___|_C_) ; mask flags
005dcb e1b8
005dcc 2fa7
005dcd 915c
005dce 2b45      	SET_P_FLAG FROMRAM0 ;(___|___|___|_P_|___|___) ; set P flag
005dcf 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_46: ; BIT  0 (IY+d)
005dd1 2d2b      	mov FROMRAM2,zzIYl
005dd2 2e13      	mov FROMRAM1,zzIYh
005dd3 2755
005dd4 fd77
005dd5 9550
005dd6 0f27
005dd7 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005dd8 b818
005dd9 b922
005dda b854
005ddb b83b
005ddc 0000
005ddd 0000
005dde b173
005ddf b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005de0 2f57      	mov zzTmp,FROMRAM0
005de1 7051      	andi zzTmp,1<<0
005de2 94b8      	clv
005de3 b75f      	in zzTmp,SREG
005de4 fd51      	sbrc zzTmp,zzZF
005de5 9438      	sev
                 
005de6 b75f      	in zzTmp, SREG
005de7 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005de8 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005de9 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005dea 2b45      	or zzF, zzTmp ; combine flags
005deb 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_4e: ; BIT  1 (IY+d)
005ded 2d2b      	mov FROMRAM2,zzIYl
005dee 2e13      	mov FROMRAM1,zzIYh
005def 2755
005df0 fd77
005df1 9550
005df2 0f27
005df3 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005df4 b818
005df5 b922
005df6 b854
005df7 b83b
005df8 0000
005df9 0000
005dfa b173
005dfb b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005dfc 2f57      	mov zzTmp,FROMRAM0
005dfd 7052      	andi zzTmp,1<<1
005dfe 94b8      	clv
005dff b75f      	in zzTmp,SREG
005e00 fd51      	sbrc zzTmp,zzZF
005e01 9438      	sev
                 
005e02 b75f      	in zzTmp, SREG
005e03 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005e04 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005e05 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005e06 2b45      	or zzF, zzTmp ; combine flags
005e07 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_56: ; BIT  2 (IY+d)
005e09 2d2b      	mov FROMRAM2,zzIYl
005e0a 2e13      	mov FROMRAM1,zzIYh
005e0b 2755
005e0c fd77
005e0d 9550
005e0e 0f27
005e0f 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005e10 b818
005e11 b922
005e12 b854
005e13 b83b
005e14 0000
005e15 0000
005e16 b173
005e17 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005e18 2f57      	mov zzTmp,FROMRAM0
005e19 7054      	andi zzTmp,1<<2
005e1a 94b8      	clv
005e1b b75f      	in zzTmp,SREG
005e1c fd51      	sbrc zzTmp,zzZF
005e1d 9438      	sev
                 
005e1e b75f      	in zzTmp, SREG
005e1f 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005e20 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005e21 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005e22 2b45      	or zzF, zzTmp ; combine flags
005e23 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_5e: ; BIT  3 (IY+d)
005e25 2d2b      	mov FROMRAM2,zzIYl
005e26 2e13      	mov FROMRAM1,zzIYh
005e27 2755
005e28 fd77
005e29 9550
005e2a 0f27
005e2b 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005e2c b818
005e2d b922
005e2e b854
005e2f b83b
005e30 0000
005e31 0000
005e32 b173
005e33 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005e34 2f57      	mov zzTmp,FROMRAM0
005e35 7058      	andi zzTmp,1<<3
005e36 94b8      	clv
005e37 b75f      	in zzTmp,SREG
005e38 fd51      	sbrc zzTmp,zzZF
005e39 9438      	sev
                 
005e3a b75f      	in zzTmp, SREG
005e3b 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005e3c 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005e3d 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005e3e 2b45      	or zzF, zzTmp ; combine flags
005e3f 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_66: ; BIT  4 (IY+d)
005e41 2d2b      	mov FROMRAM2,zzIYl
005e42 2e13      	mov FROMRAM1,zzIYh
005e43 2755
005e44 fd77
005e45 9550
005e46 0f27
005e47 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005e48 b818
005e49 b922
005e4a b854
005e4b b83b
005e4c 0000
005e4d 0000
005e4e b173
005e4f b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005e50 2f57      	mov zzTmp,FROMRAM0
005e51 7150      	andi zzTmp,1<<4
005e52 94b8      	clv
005e53 b75f      	in zzTmp,SREG
005e54 fd51      	sbrc zzTmp,zzZF
005e55 9438      	sev
                 
005e56 b75f      	in zzTmp, SREG
005e57 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005e58 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005e59 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005e5a 2b45      	or zzF, zzTmp ; combine flags
005e5b 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_6e: ; BIT  5 (IY+d)
005e5d 2d2b      	mov FROMRAM2,zzIYl
005e5e 2e13      	mov FROMRAM1,zzIYh
005e5f 2755
005e60 fd77
005e61 9550
005e62 0f27
005e63 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005e64 b818
005e65 b922
005e66 b854
005e67 b83b
005e68 0000
005e69 0000
005e6a b173
005e6b b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005e6c 2f57      	mov zzTmp,FROMRAM0
005e6d 7250      	andi zzTmp,1<<5
005e6e 94b8      	clv
005e6f b75f      	in zzTmp,SREG
005e70 fd51      	sbrc zzTmp,zzZF
005e71 9438      	sev
                 
005e72 b75f      	in zzTmp, SREG
005e73 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005e74 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005e75 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005e76 2b45      	or zzF, zzTmp ; combine flags
005e77 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_76: ; BIT  6 (IY+d)
005e79 2d2b      	mov FROMRAM2,zzIYl
005e7a 2e13      	mov FROMRAM1,zzIYh
005e7b 2755
005e7c fd77
005e7d 9550
005e7e 0f27
005e7f 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005e80 b818
005e81 b922
005e82 b854
005e83 b83b
005e84 0000
005e85 0000
005e86 b173
005e87 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005e88 2f57      	mov zzTmp,FROMRAM0
005e89 7450      	andi zzTmp,1<<6
005e8a 94b8      	clv
005e8b b75f      	in zzTmp,SREG
005e8c fd51      	sbrc zzTmp,zzZF
005e8d 9438      	sev
                 
005e8e b75f      	in zzTmp, SREG
005e8f 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005e90 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005e91 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005e92 2b45      	or zzF, zzTmp ; combine flags
005e93 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_7e: ; BIT  7 (IY+d)
005e95 2d2b      	mov FROMRAM2,zzIYl
005e96 2e13      	mov FROMRAM1,zzIYh
005e97 2755
005e98 fd77
005e99 9550
005e9a 0f27
005e9b 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005e9c b818
005e9d b922
005e9e b854
005e9f b83b
005ea0 0000
005ea1 0000
005ea2 b173
005ea3 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005ea4 2f57      	mov zzTmp,FROMRAM0
005ea5 7850      	andi zzTmp,1<<7
005ea6 94b8      	clv
005ea7 b75f      	in zzTmp,SREG
005ea8 fd51      	sbrc zzTmp,zzZF
005ea9 9438      	sev
                 
005eaa b75f      	in zzTmp, SREG
005eab 785e      	andi zzTmp, 	(_I_|_S_|_Z_|___|_V_|___|___) ; mask results flags
005eac 7841      	andi zzF, 	(_I_|___|___|___|___|___|_C_) ; mask old flags
005ead 6a40      	ori zzF, 	(_I_|___|___|_H_|___|___|___) ; set flags
005eae 2b45      	or zzF, zzTmp ; combine flags
005eaf 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_86: ; RES  0 (IY+d)
005eb1 2d2b      	mov FROMRAM2,zzIYl
005eb2 2e13      	mov FROMRAM1,zzIYh
005eb3 2755
005eb4 fd77
005eb5 9550
005eb6 0f27
005eb7 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005eb8 b818
005eb9 b922
005eba b854
005ebb b83b
005ebc 0000
005ebd 0000
005ebe b173
005ebf b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005ec0 ef5e      	ldi zzTmp,~(1<<0)
005ec1 2375      	and FROMRAM0,zzTmp 
                 
005ec2 b67f      	in _sreg, SREG
005ec3 b818
005ec4 b922
005ec5 b975
005ec6 b824
005ec7 1416
005ec8 985d
005ec9 f100
005eca b82b
005ecb 935f
005ecc e158
005ecd b955
005ece eb5f
005ecf b954
005ed0 e050
005ed1 bd5d
005ed2 e550
005ed3 bd5c
005ed4 9859
005ed5 915f
005ed6 982c
005ed7 937f
005ed8 2d51
005ed9 940e 005f
005edb e054
005edc 955a
005edd f7f1
005ede 2f52
005edf 940e 005f
005ee1 e054
005ee2 955a
005ee3 f7f1
005ee4 915f
005ee5 940e 005f
005ee7 bc5c
005ee8 9a59
005ee9 b854
005eea b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005eeb be7f      	out SREG,_sreg
005eec 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_8e: ; RES  1 (IY+d)
005eee 2d2b      	mov FROMRAM2,zzIYl
005eef 2e13      	mov FROMRAM1,zzIYh
005ef0 2755
005ef1 fd77
005ef2 9550
005ef3 0f27
005ef4 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005ef5 b818
005ef6 b922
005ef7 b854
005ef8 b83b
005ef9 0000
005efa 0000
005efb b173
005efc b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005efd ef5d      	ldi zzTmp,~(1<<1)
005efe 2375      	and FROMRAM0,zzTmp 
                 
005eff b67f      	in _sreg, SREG
005f00 b818
005f01 b922
005f02 b975
005f03 b824
005f04 1416
005f05 985d
005f06 f100
005f07 b82b
005f08 935f
005f09 e158
005f0a b955
005f0b eb5f
005f0c b954
005f0d e050
005f0e bd5d
005f0f e550
005f10 bd5c
005f11 9859
005f12 915f
005f13 982c
005f14 937f
005f15 2d51
005f16 940e 005f
005f18 e054
005f19 955a
005f1a f7f1
005f1b 2f52
005f1c 940e 005f
005f1e e054
005f1f 955a
005f20 f7f1
005f21 915f
005f22 940e 005f
005f24 bc5c
005f25 9a59
005f26 b854
005f27 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005f28 be7f      	out SREG,_sreg
005f29 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_96: ; RES  2 (IY+d)
005f2b 2d2b      	mov FROMRAM2,zzIYl
005f2c 2e13      	mov FROMRAM1,zzIYh
005f2d 2755
005f2e fd77
005f2f 9550
005f30 0f27
005f31 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005f32 b818
005f33 b922
005f34 b854
005f35 b83b
005f36 0000
005f37 0000
005f38 b173
005f39 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005f3a ef5b      	ldi zzTmp,~(1<<2)
005f3b 2375      	and FROMRAM0,zzTmp 
                 
005f3c b67f      	in _sreg, SREG
005f3d b818
005f3e b922
005f3f b975
005f40 b824
005f41 1416
005f42 985d
005f43 f100
005f44 b82b
005f45 935f
005f46 e158
005f47 b955
005f48 eb5f
005f49 b954
005f4a e050
005f4b bd5d
005f4c e550
005f4d bd5c
005f4e 9859
005f4f 915f
005f50 982c
005f51 937f
005f52 2d51
005f53 940e 005f
005f55 e054
005f56 955a
005f57 f7f1
005f58 2f52
005f59 940e 005f
005f5b e054
005f5c 955a
005f5d f7f1
005f5e 915f
005f5f 940e 005f
005f61 bc5c
005f62 9a59
005f63 b854
005f64 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005f65 be7f      	out SREG,_sreg
005f66 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_9e: ; RES  3 (IY+d)
005f68 2d2b      	mov FROMRAM2,zzIYl
005f69 2e13      	mov FROMRAM1,zzIYh
005f6a 2755
005f6b fd77
005f6c 9550
005f6d 0f27
005f6e 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005f6f b818
005f70 b922
005f71 b854
005f72 b83b
005f73 0000
005f74 0000
005f75 b173
005f76 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005f77 ef57      	ldi zzTmp,~(1<<3)
005f78 2375      	and FROMRAM0,zzTmp 
                 
005f79 b67f      	in _sreg, SREG
005f7a b818
005f7b b922
005f7c b975
005f7d b824
005f7e 1416
005f7f 985d
005f80 f100
005f81 b82b
005f82 935f
005f83 e158
005f84 b955
005f85 eb5f
005f86 b954
005f87 e050
005f88 bd5d
005f89 e550
005f8a bd5c
005f8b 9859
005f8c 915f
005f8d 982c
005f8e 937f
005f8f 2d51
005f90 940e 005f
005f92 e054
005f93 955a
005f94 f7f1
005f95 2f52
005f96 940e 005f
005f98 e054
005f99 955a
005f9a f7f1
005f9b 915f
005f9c 940e 005f
005f9e bc5c
005f9f 9a59
005fa0 b854
005fa1 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005fa2 be7f      	out SREG,_sreg
005fa3 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_a6: ; RES  4 (IY+d)
005fa5 2d2b      	mov FROMRAM2,zzIYl
005fa6 2e13      	mov FROMRAM1,zzIYh
005fa7 2755
005fa8 fd77
005fa9 9550
005faa 0f27
005fab 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005fac b818
005fad b922
005fae b854
005faf b83b
005fb0 0000
005fb1 0000
005fb2 b173
005fb3 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005fb4 ee5f      	ldi zzTmp,~(1<<4)
005fb5 2375      	and FROMRAM0,zzTmp 
                 
005fb6 b67f      	in _sreg, SREG
005fb7 b818
005fb8 b922
005fb9 b975
005fba b824
005fbb 1416
005fbc 985d
005fbd f100
005fbe b82b
005fbf 935f
005fc0 e158
005fc1 b955
005fc2 eb5f
005fc3 b954
005fc4 e050
005fc5 bd5d
005fc6 e550
005fc7 bd5c
005fc8 9859
005fc9 915f
005fca 982c
005fcb 937f
005fcc 2d51
005fcd 940e 005f
005fcf e054
005fd0 955a
005fd1 f7f1
005fd2 2f52
005fd3 940e 005f
005fd5 e054
005fd6 955a
005fd7 f7f1
005fd8 915f
005fd9 940e 005f
005fdb bc5c
005fdc 9a59
005fdd b854
005fde b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
005fdf be7f      	out SREG,_sreg
005fe0 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_ae: ; RES  5 (IY+d)
005fe2 2d2b      	mov FROMRAM2,zzIYl
005fe3 2e13      	mov FROMRAM1,zzIYh
005fe4 2755
005fe5 fd77
005fe6 9550
005fe7 0f27
005fe8 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
005fe9 b818
005fea b922
005feb b854
005fec b83b
005fed 0000
005fee 0000
005fef b173
005ff0 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
005ff1 ed5f      	ldi zzTmp,~(1<<5)
005ff2 2375      	and FROMRAM0,zzTmp 
                 
005ff3 b67f      	in _sreg, SREG
005ff4 b818
005ff5 b922
005ff6 b975
005ff7 b824
005ff8 1416
005ff9 985d
005ffa f100
005ffb b82b
005ffc 935f
005ffd e158
005ffe b955
005fff eb5f
006000 b954
006001 e050
006002 bd5d
006003 e550
006004 bd5c
006005 9859
006006 915f
006007 982c
006008 937f
006009 2d51
00600a 940e 005f
00600c e054
00600d 955a
00600e f7f1
00600f 2f52
006010 940e 005f
006012 e054
006013 955a
006014 f7f1
006015 915f
006016 940e 005f
006018 bc5c
006019 9a59
00601a b854
00601b b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00601c be7f      	out SREG,_sreg
00601d 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_b6: ; RES  6 (IY+d)
00601f 2d2b      	mov FROMRAM2,zzIYl
006020 2e13      	mov FROMRAM1,zzIYh
006021 2755
006022 fd77
006023 9550
006024 0f27
006025 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
006026 b818
006027 b922
006028 b854
006029 b83b
00602a 0000
00602b 0000
00602c b173
00602d b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00602e eb5f      	ldi zzTmp,~(1<<6)
00602f 2375      	and FROMRAM0,zzTmp 
                 
006030 b67f      	in _sreg, SREG
006031 b818
006032 b922
006033 b975
006034 b824
006035 1416
006036 985d
006037 f100
006038 b82b
006039 935f
00603a e158
00603b b955
00603c eb5f
00603d b954
00603e e050
00603f bd5d
006040 e550
006041 bd5c
006042 9859
006043 915f
006044 982c
006045 937f
006046 2d51
006047 940e 005f
006049 e054
00604a 955a
00604b f7f1
00604c 2f52
00604d 940e 005f
00604f e054
006050 955a
006051 f7f1
006052 915f
006053 940e 005f
006055 bc5c
006056 9a59
006057 b854
006058 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
006059 be7f      	out SREG,_sreg
00605a 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_be: ; RES  7 (IY+d)
00605c 2d2b      	mov FROMRAM2,zzIYl
00605d 2e13      	mov FROMRAM1,zzIYh
00605e 2755
00605f fd77
006060 9550
006061 0f27
006062 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
006063 b818
006064 b922
006065 b854
006066 b83b
006067 0000
006068 0000
006069 b173
00606a b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00606b e75f      	ldi zzTmp,~(1<<7)
00606c 2375      	and FROMRAM0,zzTmp 
                 
00606d b67f      	in _sreg, SREG
00606e b818
00606f b922
006070 b975
006071 b824
006072 1416
006073 985d
006074 f100
006075 b82b
006076 935f
006077 e158
006078 b955
006079 eb5f
00607a b954
00607b e050
00607c bd5d
00607d e550
00607e bd5c
00607f 9859
006080 915f
006081 982c
006082 937f
006083 2d51
006084 940e 005f
006086 e054
006087 955a
006088 f7f1
006089 2f52
00608a 940e 005f
00608c e054
00608d 955a
00608e f7f1
00608f 915f
006090 940e 005f
006092 bc5c
006093 9a59
006094 b854
006095 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
006096 be7f      	out SREG,_sreg
006097 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_c6: ; SET  0 (IY+d)
006099 2d2b      	mov FROMRAM2,zzIYl
00609a 2e13      	mov FROMRAM1,zzIYh
00609b 2755
00609c fd77
00609d 9550
00609e 0f27
00609f 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0060a0 b818
0060a1 b922
0060a2 b854
0060a3 b83b
0060a4 0000
0060a5 0000
0060a6 b173
0060a7 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0060a8 e051      	ldi zzTmp,1<<0
0060a9 2b75      	or FROMRAM0,zzTmp
                 
0060aa b67f      	in _sreg, SREG
0060ab b818
0060ac b922
0060ad b975
0060ae b824
0060af 1416
0060b0 985d
0060b1 f100
0060b2 b82b
0060b3 935f
0060b4 e158
0060b5 b955
0060b6 eb5f
0060b7 b954
0060b8 e050
0060b9 bd5d
0060ba e550
0060bb bd5c
0060bc 9859
0060bd 915f
0060be 982c
0060bf 937f
0060c0 2d51
0060c1 940e 005f
0060c3 e054
0060c4 955a
0060c5 f7f1
0060c6 2f52
0060c7 940e 005f
0060c9 e054
0060ca 955a
0060cb f7f1
0060cc 915f
0060cd 940e 005f
0060cf bc5c
0060d0 9a59
0060d1 b854
0060d2 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0060d3 be7f      	out SREG,_sreg
0060d4 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_ce: ; SET  1 (IY+d)
0060d6 2d2b      	mov FROMRAM2,zzIYl
0060d7 2e13      	mov FROMRAM1,zzIYh
0060d8 2755
0060d9 fd77
0060da 9550
0060db 0f27
0060dc 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0060dd b818
0060de b922
0060df b854
0060e0 b83b
0060e1 0000
0060e2 0000
0060e3 b173
0060e4 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0060e5 e052      	ldi zzTmp,1<<1
0060e6 2b75      	or FROMRAM0,zzTmp
                 
0060e7 b67f      	in _sreg, SREG
0060e8 b818
0060e9 b922
0060ea b975
0060eb b824
0060ec 1416
0060ed 985d
0060ee f100
0060ef b82b
0060f0 935f
0060f1 e158
0060f2 b955
0060f3 eb5f
0060f4 b954
0060f5 e050
0060f6 bd5d
0060f7 e550
0060f8 bd5c
0060f9 9859
0060fa 915f
0060fb 982c
0060fc 937f
0060fd 2d51
0060fe 940e 005f
006100 e054
006101 955a
006102 f7f1
006103 2f52
006104 940e 005f
006106 e054
006107 955a
006108 f7f1
006109 915f
00610a 940e 005f
00610c bc5c
00610d 9a59
00610e b854
00610f b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
006110 be7f      	out SREG,_sreg
006111 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_d6: ; SET  2 (IY+d)
006113 2d2b      	mov FROMRAM2,zzIYl
006114 2e13      	mov FROMRAM1,zzIYh
006115 2755
006116 fd77
006117 9550
006118 0f27
006119 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00611a b818
00611b b922
00611c b854
00611d b83b
00611e 0000
00611f 0000
006120 b173
006121 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
006122 e054      	ldi zzTmp,1<<2
006123 2b75      	or FROMRAM0,zzTmp
                 
006124 b67f      	in _sreg, SREG
006125 b818
006126 b922
006127 b975
006128 b824
006129 1416
00612a 985d
00612b f100
00612c b82b
00612d 935f
00612e e158
00612f b955
006130 eb5f
006131 b954
006132 e050
006133 bd5d
006134 e550
006135 bd5c
006136 9859
006137 915f
006138 982c
006139 937f
00613a 2d51
00613b 940e 005f
00613d e054
00613e 955a
00613f f7f1
006140 2f52
006141 940e 005f
006143 e054
006144 955a
006145 f7f1
006146 915f
006147 940e 005f
006149 bc5c
00614a 9a59
00614b b854
00614c b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00614d be7f      	out SREG,_sreg
00614e 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_de: ; SET  3 (IY+d)
006150 2d2b      	mov FROMRAM2,zzIYl
006151 2e13      	mov FROMRAM1,zzIYh
006152 2755
006153 fd77
006154 9550
006155 0f27
006156 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
006157 b818
006158 b922
006159 b854
00615a b83b
00615b 0000
00615c 0000
00615d b173
00615e b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00615f e058      	ldi zzTmp,1<<3
006160 2b75      	or FROMRAM0,zzTmp
                 
006161 b67f      	in _sreg, SREG
006162 b818
006163 b922
006164 b975
006165 b824
006166 1416
006167 985d
006168 f100
006169 b82b
00616a 935f
00616b e158
00616c b955
00616d eb5f
00616e b954
00616f e050
006170 bd5d
006171 e550
006172 bd5c
006173 9859
006174 915f
006175 982c
006176 937f
006177 2d51
006178 940e 005f
00617a e054
00617b 955a
00617c f7f1
00617d 2f52
00617e 940e 005f
006180 e054
006181 955a
006182 f7f1
006183 915f
006184 940e 005f
006186 bc5c
006187 9a59
006188 b854
006189 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00618a be7f      	out SREG,_sreg
00618b 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_e6: ; SET  4 (IY+d)
00618d 2d2b      	mov FROMRAM2,zzIYl
00618e 2e13      	mov FROMRAM1,zzIYh
00618f 2755
006190 fd77
006191 9550
006192 0f27
006193 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
006194 b818
006195 b922
006196 b854
006197 b83b
006198 0000
006199 0000
00619a b173
00619b b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
00619c e150      	ldi zzTmp,1<<4
00619d 2b75      	or FROMRAM0,zzTmp
                 
00619e b67f      	in _sreg, SREG
00619f b818
0061a0 b922
0061a1 b975
0061a2 b824
0061a3 1416
0061a4 985d
0061a5 f100
0061a6 b82b
0061a7 935f
0061a8 e158
0061a9 b955
0061aa eb5f
0061ab b954
0061ac e050
0061ad bd5d
0061ae e550
0061af bd5c
0061b0 9859
0061b1 915f
0061b2 982c
0061b3 937f
0061b4 2d51
0061b5 940e 005f
0061b7 e054
0061b8 955a
0061b9 f7f1
0061ba 2f52
0061bb 940e 005f
0061bd e054
0061be 955a
0061bf f7f1
0061c0 915f
0061c1 940e 005f
0061c3 bc5c
0061c4 9a59
0061c5 b854
0061c6 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
0061c7 be7f      	out SREG,_sreg
0061c8 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_ee: ; SET  5 (IY+d)
0061ca 2d2b      	mov FROMRAM2,zzIYl
0061cb 2e13      	mov FROMRAM1,zzIYh
0061cc 2755
0061cd fd77
0061ce 9550
0061cf 0f27
0061d0 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
0061d1 b818
0061d2 b922
0061d3 b854
0061d4 b83b
0061d5 0000
0061d6 0000
0061d7 b173
0061d8 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
0061d9 e250      	ldi zzTmp,1<<5
0061da 2b75      	or FROMRAM0,zzTmp
                 
0061db b67f      	in _sreg, SREG
0061dc b818
0061dd b922
0061de b975
0061df b824
0061e0 1416
0061e1 985d
0061e2 f100
0061e3 b82b
0061e4 935f
0061e5 e158
0061e6 b955
0061e7 eb5f
0061e8 b954
0061e9 e050
0061ea bd5d
0061eb e550
0061ec bd5c
0061ed 9859
0061ee 915f
0061ef 982c
0061f0 937f
0061f1 2d51
0061f2 940e 005f
0061f4 e054
0061f5 955a
0061f6 f7f1
0061f7 2f52
0061f8 940e 005f
0061fa e054
0061fb 955a
0061fc f7f1
0061fd 915f
0061fe 940e 005f
006200 bc5c
006201 9a59
006202 b854
006203 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
006204 be7f      	out SREG,_sreg
006205 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_f6: ; SET  6 (IY+d)
006207 2d2b      	mov FROMRAM2,zzIYl
006208 2e13      	mov FROMRAM1,zzIYh
006209 2755
00620a fd77
00620b 9550
00620c 0f27
00620d 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00620e b818
00620f b922
006210 b854
006211 b83b
006212 0000
006213 0000
006214 b173
006215 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
006216 e450      	ldi zzTmp,1<<6
006217 2b75      	or FROMRAM0,zzTmp
                 
006218 b67f      	in _sreg, SREG
006219 b818
00621a b922
00621b b975
00621c b824
00621d 1416
00621e 985d
00621f f100
006220 b82b
006221 935f
006222 e158
006223 b955
006224 eb5f
006225 b954
006226 e050
006227 bd5d
006228 e550
006229 bd5c
00622a 9859
00622b 915f
00622c 982c
00622d 937f
00622e 2d51
00622f 940e 005f
006231 e054
006232 955a
006233 f7f1
006234 2f52
006235 940e 005f
006237 e054
006238 955a
006239 f7f1
00623a 915f
00623b 940e 005f
00623d bc5c
00623e 9a59
00623f b854
006240 b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
006241 be7f      	out SREG,_sreg
006242 940c 0200 	jmp zCMD_start
                 
                 zCMDFDCB_fe: ; SET  7 (IY+d)
006244 2d2b      	mov FROMRAM2,zzIYl
006245 2e13      	mov FROMRAM1,zzIYh
006246 2755
006247 fd77
006248 9550
006249 0f27
00624a 1e15      	ADDWS FROMRAM1,FROMRAM2,FROMRAM0
00624b b818
00624c b922
00624d b854
00624e b83b
00624f 0000
006250 0000
006251 b173
006252 b82b      	LDRAM_NODDR FROMRAM1,FROMRAM2,FROMRAM0
006253 e850      	ldi zzTmp,1<<7
006254 2b75      	or FROMRAM0,zzTmp
                 
006255 b67f      	in _sreg, SREG
006256 b818
006257 b922
006258 b975
006259 b824
00625a 1416
00625b 985d
00625c f100
00625d b82b
00625e 935f
00625f e158
006260 b955
006261 eb5f
006262 b954
006263 e050
006264 bd5d
006265 e550
006266 bd5c
006267 9859
006268 915f
006269 982c
00626a 937f
00626b 2d51
00626c 940e 005f
00626e e054
00626f 955a
006270 f7f1
006271 2f52
006272 940e 005f
006274 e054
006275 955a
006276 f7f1
006277 915f
006278 940e 005f
00627a bc5c
00627b 9a59
00627c b854
00627d b82b      	STRAM FROMRAM1,FROMRAM2,FROMRAM0
00627e be7f      	out SREG,_sreg
00627f 940c 0200 	jmp zCMD_start
                 
006281 0000      zCMD_END:	nop
                 
                 ;.ORG  0x4000
                 ;iz80_START:
                 ;izCMD_NONI: ; NONI == zCMDstart
                 ;izCMD_start:
                 ;	sbic	GPIOR0, 7		; check interrupt request
                 ;	call	EXTINTRPOC
                 ;#include "z80/z80_asm_icseg.asm"       ; interrupts enabled block
                 ;izCMD_END:	nop
                 
                 .ORG  0x7000                ; E0
                 
                 #include "extirq.inc"
                 
                 EXTINTRPOC_RETI:				; entry point for reti
007000 9250 09a8 	sts	IRQ_CMD, zero
007002 c00b      	rjmp	EXTINTRPOC_START
                 EXTINTRPOC:
007003 935f
007004 9150 3f2a
007006 fd56
007007 940e b008
007009 915f      	NOTIFY	NOTIFY_IRQ, DBG_IRQ
                 ;	rjmp	_extint_exit
                 
00700a 1989
00700b 0995      	DEC2	zzPCh, zzPCl			; restore oroginal PC for correct return
00700c 9290 09a8 	sts	IRQ_CMD, one			; irq start
                 
                 EXTINTRPOC_START:				; entry point
                 ;	rjmp	_extint_exit;!!!! debug !!!!!
                 
                 	; checking sources - CPD first
                 
                 ;	lds	temp, IRQ_CPD_FLAG		; process prevously stored first
00700e b55a      	in	temp, GPIOR1
                 
                 _extint_check_cpd_flags:			; GPIOR1
00700f fd50      	sbrc	temp, IRQ_V_KBD
007010 c027      	rjmp	_extint_exec0
007011 fd51      	sbrc	temp, IRQ_V_GPO
007012 c028      	rjmp	_extint_exec1
007013 fd52      	sbrc	temp, IRQ_V_CTC
007014 c029      	rjmp	_extint_exec2
007015 fd53      	sbrc	temp, IRQ_V_MUS
007016 c02a      	rjmp	_extint_exec3
007017 fd54      	sbrc	temp, IRQ_V_R1
007018 c02b      	rjmp	_extint_exec4
007019 fd55      	sbrc	temp, IRQ_V_R2
00701a c02c      	rjmp	_extint_exec5
00701b fd56      	sbrc	temp, IRQ_V_CTX
00701c c02d      	rjmp	_extint_exec6
00701d fd57      	sbrc	temp, IRQ_V_CRX
00701e c02e      	rjmp	_extint_exec7
                 
                 ;	rjmp	_extint_exit;!!!! debug !!!!!
                 
                 ;_extint_l0:
00701f b32e      	in	FROMRAM2, GPIOR0		; GPIOR0 = int requests for CPU
007020 9150 3f04 	lds	temp, INT_MASK+1		; interrupts from other devices
007022 2352      	and	temp, FROMRAM2
                 
007023 fd50      	sbrc	temp, IRQ_V_LAN 
007024 c02b      	rjmp	_extint_exec8
007025 fd51      	sbrc	temp, IRQ_V_CAN 
007026 c02c      	rjmp	_extint_exec9
007027 fd52      	sbrc	temp, IRQ_V_RTC
007028 c02d      	rjmp	_extint_exec10
007029 fd53      	sbrc	temp, IRQ_V_CPD
00702a c02e      	rjmp	_extint_exec11
00702b fd54      	sbrc	temp, IRQ_V_R4 
00702c c035      	rjmp	_extint_exec12
00702d fd56      	sbrc	temp, IRQ_V_TTX
00702e c03c      	rjmp	_extint_exec14
00702f fd57      	sbrc	temp, IRQ_V_TRX
007030 c03d      	rjmp	_extint_exec15
007031 fd55      	sbrc	temp, IRQ_V_DEBUG 		; z80 debug is processing last
007032 c032      	rjmp	_extint_exec13
                 
                 _extint_exit:
007033 bb5e      	out	GPIOR0, temp			; clear 
                 	; all requests are processed, return to normal operation
007034 e05a      	ldi	temp, high(zOPCODE__LBLS_L)
007035 bd5b      	out	GPIOR2, temp			; GPIOR2 contains high pointer to decode table
007036 940c 0200 	jmp	zCMD_start
                 ;	in 	Xh, GPIOR2			; high(zOPCODE__LBLS_L)
                 ;	jmp	zCMDP_decode
                 	
                 
                 
                 _extint_exec0:
007038 7f5e      	cbr	temp, 1<<IRQ_V_KBD
007039 e070      	ldi	FROMRAM0, IRQ_V_KBD
00703a c036      	rjmp	_extint_exec_clf
                 _extint_exec1:
00703b 7f5d      	cbr	temp, 1<<IRQ_V_GPO
00703c e071      	ldi	FROMRAM0, IRQ_V_GPO
00703d c033      	rjmp	_extint_exec_clf
                 _extint_exec2:
00703e 7f5b      	cbr	temp, 1<<IRQ_V_CTC
00703f e072      	ldi	FROMRAM0, IRQ_V_CTC
007040 c030      	rjmp	_extint_exec_clf
                 _extint_exec3:
007041 7f57      	cbr	temp, 1<<IRQ_V_MUS
007042 e073      	ldi	FROMRAM0, IRQ_V_MUS
007043 c02d      	rjmp	_extint_exec_clf
                 _extint_exec4:
007044 7e5f      	cbr	temp, 1<<IRQ_V_R1
007045 e074      	ldi	FROMRAM0, IRQ_V_R1
007046 c02a      	rjmp	_extint_exec_clf
                 _extint_exec5:
007047 7d5f      	cbr	temp, 1<<IRQ_V_R2
007048 e075      	ldi	FROMRAM0, IRQ_V_R2
007049 c027      	rjmp	_extint_exec_clf
                 _extint_exec6:
00704a 7b5f      	cbr	temp, 1<<IRQ_V_CTX
00704b e076      	ldi	FROMRAM0, IRQ_V_CTX
00704c c024      	rjmp	_extint_exec_clf
                 _extint_exec7:
00704d 775f      	cbr	temp, 1<<IRQ_V_CRX
00704e e077      	ldi	FROMRAM0, IRQ_V_CRX
00704f c021      	rjmp	_extint_exec_clf
                 
                 
                 _extint_exec8:
007050 98f0      	cbi	GPIOR0, IRQ_V_LAN
007051 e078      	ldi	FROMRAM0, 8+IRQ_V_LAN
007052 c01f      	rjmp	_extint_exec_clf0
                 _extint_exec9:
007053 98f1      	cbi	GPIOR0, IRQ_V_CAN
007054 e079      	ldi	FROMRAM0, 8+IRQ_V_CAN
007055 c01c      	rjmp	_extint_exec_clf0
                 _extint_exec10:
007056 98f2      	cbi	GPIOR0, IRQ_V_RTC
007057 e07a      	ldi	FROMRAM0, 8+IRQ_V_RTC
007058 c019      	rjmp	_extint_exec_clf0
                 _extint_exec11:                 		; CPD init, need to clarify
007059 98f3      	cbi	GPIOR0, IRQ_V_CPD
00705a 9120 3f03 	lds	FROMRAM2, INT_MASK+0		; interrupts from CPD
00705c e250
00705d 940e 720c 	nportin cpd_irqfl
00705f 2352      	and	temp, FROMRAM2			; check that allowed interrupt has occur, clear-on-read port
007060 bd5a      	out	GPIOR1, temp
                 ;	sts	IRQ_CPD_FLAG, temp		; store for next processing loop
007061 cfad      	rjmp	_extint_check_cpd_flags
                 _extint_exec12:
007062 98f4      	cbi	GPIOR0, IRQ_V_R4
007063 e07c      	ldi	FROMRAM0, 8+IRQ_V_R4
007064 c00d      	rjmp	_extint_exec_clf0
                 _extint_exec13:
                         ; Z80 debugging
007065 940e b009 	call	DEBUG_Z80			; PC -> next command
007067 e05a      	ldi	temp, high(zOPCODE__LBLS_L)
007068 2fb5      	mov 	Xh, temp
007069 940c 0201 	jmp	zCMDP_start			; command execute from zRAM
                 
                 _extint_exec14:
00706b 98f6      	cbi	GPIOR0, IRQ_V_TTX
00706c e07e      	ldi	FROMRAM0, 8+IRQ_V_TTX
00706d c003      	rjmp	_extint_exec_clf
                 _extint_exec15:
00706e 98f7      	cbi	GPIOR0, IRQ_V_TRX
00706f e07f      	ldi	FROMRAM0, 8+IRQ_V_TRX
007070 c001      	rjmp	_extint_exec_clf0
                 
                 
                 _extint_exec_clf:
007071 bd5a      	out	GPIOR1, temp
                 ;	sts	IRQ_CPD_FLAG, temp		; store cleared for next processing loop
                 
                 _extint_exec_clf0:
                 _extint_exec:
007072 ecef
007073 e3f6      	ldiw	Z, RTC_IRQ_BASE
007074 0fe7      	add	ZL, FROMRAM0
007075 1df5      	adc	ZH, zero			; irq cmd
007076 8170      	ld	FROMRAM0, Z			; loaded	= IRQ vector
                 
007077 3d7d      	cpi	FROMRAM0, 0xdd			; NMI vector
007078 f009      	breq	_extint_exec_nmi
007079 c05d      	rjmp	_extint_exec_mi
                 
                 _extint_exec_nmi:
00707a 9150 0909 	lds	temp, zzIFF1			; NMI int procedure
00707c 9350 090a 	sts	zzIFF2, temp
00707e 9250 0909 	sts	zzIFF1, zero
                 
007080 19c9
007081 09d5
007082 b9d8
007083 b9c2
007084 b995
007085 b824
007086 15d6
007087 985d
007088 f100
007089 b82b
00708a 935f
00708b e158
00708c b955
00708d eb5f
00708e b954
00708f e050
007090 bd5d
007091 e550
007092 bd5c
007093 9859
007094 915f
007095 982c
007096 939f
007097 2f5d
007098 940e 005f
00709a e054
00709b 955a
00709c f7f1
00709d 2f5c
00709e 940e 005f
0070a0 e054
0070a1 955a
0070a2 f7f1
0070a3 915f
0070a4 940e 005f
0070a6 bc5c
0070a7 9a59
0070a8 b854
0070a9 b82b
0070aa 19c9
0070ab 09d5
0070ac b9d8
0070ad b9c2
0070ae b985
0070af b824
0070b0 15d6
0070b1 985d
0070b2 f100
0070b3 b82b
0070b4 935f
0070b5 e158
0070b6 b955
0070b7 eb5f
0070b8 b954
0070b9 e050
0070ba bd5d
0070bb e550
0070bc bd5c
0070bd 9859
0070be 915f
0070bf 982c
0070c0 938f
0070c1 2f5d
0070c2 940e 005f
0070c4 e054
0070c5 955a
0070c6 f7f1
0070c7 2f5c
0070c8 940e 005f
0070ca e054
0070cb 955a
0070cc f7f1
0070cd 915f
0070ce 940e 005f
0070d0 bc5c
0070d1 9a59
0070d2 b854
0070d3 b82b      	zzPUSH 	zzPCh, zzPCl
0070d4 e686      	ldi 	zzPCl, 0x66
0070d5 e090      	ldi 	zzPCh, 0x00			; jmpt to 0x0066
0070d6 cf5c      	rjmp	_extint_exit
                 
                 _extint_exec_mi:	
0070d7 9150 0909 	lds	temp, zzIFF1			; MI int procedure
0070d9 3050      	cpi	temp, 0
0070da f409      	brne	_extint_exec_mi_enabled	
0070db cf24      	rjmp	EXTINTRPOC_RETI			; interrupts disabled - process and clear all requests for NMI
                 
                 _extint_exec_mi_enabled:
0070dc 9250 0909 	sts	zzIFF1, zero			; set INT processing state
0070de 9250 090a 	sts	zzIFF2, zero
                 
0070e0 9150 090b 	lds	temp, zzIM			; check int mode
0070e2 3052      	cpi	temp, 2
0070e3 f051      	breq	_extint_exec_im2
0070e4 3051      	cpi	temp, 1
0070e5 f031      	breq	_extint_exec_im1
                 
                 _extint_exec_im0:
0070e6 2fa7      	mov	XL, FROMRAM0			; data from IRQ VECTOR TABLE
                 _extint_exec_xl:
0070e7 e05a      	ldi	temp, high(zOPCODE__LBLS_L)
0070e8 2fb5      	mov 	Xh, temp
0070e9 bd5b      	out	GPIOR2, temp			; GPIOR2 contains high pointer to decode table
0070ea 940c 0208 	jmp	zCMDP_decode			; process command in XL - execute opcode
                 
                 _extint_exec_im1:
0070ec efaf      	ldi	XL, 0xFF			; RST 38 command
0070ed cff9      	rjmp	_extint_exec_xl
                 
                 _extint_exec_im2:
0070ee 19c9
0070ef 09d5
0070f0 b9d8
0070f1 b9c2
0070f2 b995
0070f3 b824
0070f4 15d6
0070f5 985d
0070f6 f100
0070f7 b82b
0070f8 935f
0070f9 e158
0070fa b955
0070fb eb5f
0070fc b954
0070fd e050
0070fe bd5d
0070ff e550
007100 bd5c
007101 9859
007102 915f
007103 982c
007104 939f
007105 2f5d
007106 940e 005f
007108 e054
007109 955a
00710a f7f1
00710b 2f5c
00710c 940e 005f
00710e e054
00710f 955a
007110 f7f1
007111 915f
007112 940e 005f
007114 bc5c
007115 9a59
007116 b854
007117 b82b
007118 19c9
007119 09d5
00711a b9d8
00711b b9c2
00711c b985
00711d b824
00711e 15d6
00711f 985d
007120 f100
007121 b82b
007122 935f
007123 e158
007124 b955
007125 eb5f
007126 b954
007127 e050
007128 bd5d
007129 e550
00712a bd5c
00712b 9859
00712c 915f
00712d 982c
00712e 938f
00712f 2f5d
007130 940e 005f
007132 e054
007133 955a
007134 f7f1
007135 2f5c
007136 940e 005f
007138 e054
007139 955a
00713a f7f1
00713b 915f
00713c 940e 005f
00713e bc5c
00713f 9a59
007140 b854
007141 b82b      	zzPUSH 	zzPCh, zzPCl
                 
007142 2fe7      	mov	ZL, FROMRAM0
007143 91f0 0900 	lds	ZH, zzI         		; Interrupt vector table ptr 
007145 b9f8
007146 b9e2
007147 b854
007148 b83b
007149 0000
00714a 0000
00714b b123
00714c b82b      	LDRAM	ZH, ZL, FROMRAM2
00714d 9631      	adiw	Z, 1
00714e b9f8
00714f b9e2
007150 b854
007151 b83b
007152 0000
007153 0000
007154 b013
007155 b82b      	LDRAM	ZH, ZL, FROMRAM1
007156 2f82      	mov 	zzPCl, FROMRAM2
007157 2d91      	mov 	zzPCh, FROMRAM1
                 
007158 ceda      	rjmp	_extint_exit
                 
                 
                 
                 ;EXTINTRPOC_RETI:
                 
                 ;EXTINTRPOC_RETN:
                 
                 DBG_NONE:
007159 9508      	ret
                 
                 
                 ; --------------------- BDOS, BIOS, PORTS -------------------------------
                 
                 .ORG  0x7200            ; E4
                 
007200 940c 720e BIOS:		jmp	BIOS_START
007202 940c 7217 BIOS_CMD:       jmp	BIOS_CMD_START
007204 940c 7fdd BDOS:		jmp	BDOS_START
007206 940c 8043 PORTIN: 	jmp	PORTIN_CMD
007208 940c 8088 PORTOUT:	jmp	PORTOUT_CMD
00720a 940c 8020 CPDPORTOUT:	jmp	CPDPORTOUT_CMD
00720c 940c 8007 CPDPORTIN:	jmp	CPDPORTIN_CMD
                 
                 ;.ORG ...
                 _BIOS_START:
                 #include "bios.inc"			; BIOS extended commands
                 
                         ldi	temp, @0
                 	sts	CURSOR_X, temp
                         ldi	temp, @1
                 	sts	CURSOR_Y, temp
                 	rcall	CURSOR_APPLY_XY
                 .ENDM
                 
                 .MACRO  CURSOR_SET2
                 	sts	CURSOR_X, @0
                 	sts	CURSOR_Y, @1
                 	rcall	CURSOR_APPLY_XY
                 .ENDM
                 
                 ;.EQU 	zzCURR_DISK_NO 		=	0xF2C8
                 ;.EQU 	zzCURR_TRACK_NUM 	=	0xF2C9
                 ;.EQU 	zzCURR_SECTOR_NUM 	=	0xF2CB
                 ;.EQU 	zzCURR_DMA_BUFER_ADDR 	=	0xF2CC
                 ;.EQU 	zzCURR_DPH_ADDR 	=	0xF2CE
                 .EQU 	zzDPH0			=	0xDEA0 
                 ;.EQU 	zzDPH1			=	0xDEB0 
                 ;.EQU 	zzDPH2 			=	0xDEC0 
                 ;.EQU 	zzDPH3 			=	0xDED0 
                 ;.EQU 	zzDBP0 			=	0xDEE0 
                 
                 .EQU 	zzKBD_BUF_COUNT		=	0xE188
                 .EQU 	zzKBD_BUF_PTR		=	0xE189
                 .EQU 	zzKBD_CURRCHAR		=	0xE18B
                 
                 BIOS_START:
00720e 9350 3f2e         sts	BIOS_LAST_CALL, temp
007210 935f
007211 9150 3f2a
007213 fd53
007214 940e b004
007216 915f      	NOTIFY	NOTIFY_BIOS, DBG_BIOS
                 
                 BIOS_CMD_START:
007217 3050
007218 f409
007219 c04c      	tcbe	0x00, BIOS_L00
00721a 3051
00721b f409
00721c c04a      	tcbe	0x01, BIOS_L01
00721d 3052
00721e f409
00721f c048      	tcbe	0x02, BIOS_L02		; CONST
007220 3053
007221 f409
007222 c056      	tcbe	0x03, BIOS_L03		; CONIN
007223 3054
007224 f409
007225 c0b4      	tcbe	0x04, BIOS_L04		; CONOUT
007226 3055
007227 f409
007228 c0f9      	tcbe	0x05, BIOS_L05		; LIST
007229 3056
00722a f409
00722b c104      	tcbe	0x06, BIOS_L06		; PUNCH
00722c 3057
00722d f409
00722e c10f      	tcbe	0x07, BIOS_L07		; READER
00722f 3058
007230 f409
007231 c11a      	tcbe	0x08, BIOS_L08		; HOME
007232 3059
007233 f409
007234 c118      	tcbe	0x09, BIOS_L09		; SELDISK
007235 305a
007236 f409
007237 c127      	tcbe	0x0a, BIOS_L0A		; SETTRK
007238 305b
007239 f409
00723a c129      	tcbe	0x0b, BIOS_L0B		; SETSEC
00723b 305c
00723c f409
00723d c12a      	tcbe	0x0c, BIOS_L0C		; SETDMA
00723e 305d
00723f f409
007240 c12c      	tcbe	0x0d, BIOS_L0D		; READ
007241 305e
007242 f409
007243 c17f      	tcbe	0x0e, BIOS_L0E		; WRITE
007244 305f
007245 f409
007246 c1b4      	tcbe	0x0f, BIOS_L0F		; LISTST
007247 3150
007248 f409
007249 c1c1      	tcbe	0x10, BIOS_L10		; SECTRN
                 	
                 	;!!! internal only calls !!!
00724a 3f50
00724b f409
00724c c1f5      	tcbe	0xf0, BIOS_Lf0		; CRISS: append to con buffer
00724d 3f51
00724e f409
00724f c208      	tcbe	0xf1, BIOS_Lf1		; CRISS: append to pr buffer
                 ;	tcbe	0xf8, ECON_REFRESH_SCREEN	; refresh screen via HW
007250 3f59
007251 f409
007252 c0b5      	tcbe	0xf9, BIOS_L04_CHAR_CHAROUT	; echo symbol without attr clear
007253 3f5a
007254 f409
007255 c211      	tcbe	0xfa, _ECON_CRT_ATTR	; CRISS: put attribute
007256 3f5b
007257 f409
007258 c210      	tcbe	0xfb, _ECON_GET_ATTR	; get attribute for curr char, return to temp
007259 3f5c
00725a f409
00725b c20e      	tcbe	0xfc, _ECON_SET_ATTR	; set attribute in zzC
00725c 3f5d
00725d f409
00725e c1b0      	tcbe	0xfd, BIOS_CRT_CHAR	; raw send char to CRT
00725f 3f5e
007260 f409
007261 c3af      	tcbe	0xfe, BIOS_SET_VIDEO_MODE ; SET VIDEO MODE
007262 3f5f
007263 f409
007264 c1a9      	tcbe	0xff, _BIOS_RESET	; RESET
007265 9508      	ret
                 
                 	; BOOT
                 BIOS_L00:
007266 9508      	ret
                 
                 
                 	; WBOOT
                 BIOS_L01:
007267 9508      	ret
                 
                 
                 	; CONST -------------------------------------------------------------------------
                 	; returns 0 if no char in CON, FF if char is ready
                 BIOS_L02:
                 	;checking inputs / CON_IOBYTE
007268 d481      	rcall	CON_GET_INPUTS
                 
007269 9150 37b7 	lds	temp, CON_BUF_CNT
00726b 3050      	cpi	temp, 0
00726c f449      	brne	BIOS_L02_2
                 
00726d 9150 3f01         lds	temp, CON_IOBYTE
00726f 7150              andi	temp, (1<<CON_IN_CON)		; check that CON is avilable - set Z flag if no
007270 f031      	breq	BIOS_L02_1			; temp=0 if CON is disabled, return no char state
                         
                 BIOS_L02_CON:
007271 e055
007272 940e 720c         nportin cpd_kchar
007274 3050      	cpi	temp, 0
007275 f009      	breq	BIOS_L02_1
                 BIOS_L02_2:
007276 ef5f      	ldi	temp, 0xff			; there is a char in the input
                 BIOS_L02_1:
007277 2f15      	mov	zzA, temp			; 0 if no char
007278 9508      	ret
                 
                 
                 	; CONIN  -------------------------------------------------------------------------
                 	; returns char from CON, wait if none
                 BIOS_L03:
                 	;checking inputs / CON_IOBYTE
007279 d470      	rcall	CON_GET_INPUTS
                 
                 	; !!!!! need to add initial setting of this bit!!!!
                 ;	sbrs	temp, CON_IN			; CON out requested?
                 ;	rjmp	BIOS_L03_L3
                 
00727a d45e              rcall	CON_BUF_READ
00727b 1115              cpse	zzA, zero
00727c 9508              ret					; char received not from the keyboard - return just zzA!
                 
00727d 9150 3f01         lds	temp, CON_IOBYTE
00727f 7150              andi	temp, (1<<CON_IN_CON)		; check that CON is avilable - set Z flag if no
007280 f051      	breq	BIOS_L03_L3			; 
                 
007281 e055
007282 940e 720c         nportin cpd_kchar
007284 1155      	cpse	temp, zero
007285 c007      	rjmp	BIOS_L03_L1			; char from keyboard received
                 
007286 9150 3f59         lds	temp, MS_MODE			; check mouse if any
007288 1155              cpse	temp, zero
                 ;	rcall	__delay_15ms
007289 940e 7f5b         call	BIOS_MOUSE_AUTOMODE		; if automode is on get mouse state - 10ms!!!!!
                 ;        nop
                 
                 BIOS_L03_L3:
00728b 9702              sbiw	zzPCl, 2			; repeat command - required for correct IRQ processing
00728c 9508              ret
                 
                 ;__delay_15ms:
                 ;       call	delay_5ms
                 ;        call	delay_5ms
                 ;        call	delay_5ms
                 ;	ret
                 
                 BIOS_L03_L1:
00728d 9350 3f16 	sts	CON_LAST_CHAR, temp		; store last char read
                 
00728f e054
007290 940e 720c 	nportin cpd_kactk
007292 9350 3f18 	sts	CON_LAST_KACT, temp		; store last char read
                 
007294 e053
007295 940e 720c 	nportin cpd_kmodk
007297 9350 3f17 	sts	CON_LAST_MODK, temp		; store last char read
                 
                 	; check Ctrl-Alt-Del and process if any
007299 7153      	andi	temp, (1<<CTRL)|(1<<SHIFT)|(1<<ALT)
00729a 3151      	cpi	temp, (1<<CTRL)|(1<<ALT)
00729b f581      	brne	BIOS_L03_L2
                 
00729c 9150 3f18 	lds	temp, CON_LAST_KACT
00729e 3651      	cpi	temp, 0x61			; DEL scan=97
00729f f039      	breq	BIOS_L03_L2_CAD
0072a0 3055      	cpi	temp, 0x05			; F1 scan=0x05
0072a1 f069      	breq	BIOS_L03_L2_F1F2
0072a2 3056      	cpi	temp, 0x06			; F2 scan=0x06
0072a3 f059      	breq	BIOS_L03_L2_F1F2
0072a4 3757      	cpi	temp, 0x77			; F10 scan=0x77
0072a5 f119      	breq	BIOS_L03_L2_NUMLOCK
                 
0072a6 c025      	rjmp	BIOS_L03_L2
                 
                 BIOS_L03_L2_CAD:
0072a7 940e c401 	call	CTRLALTDEL			; Ctrl-Alt-Del pressed
                 BIOS_L03_AFTER_CAD:
0072a9 9250 090f
0072ab e055
0072ac 940e 720a 	nportout cpd_kchar, zero                ; set kchar as read
0072ae cfdc      	rjmp	BIOS_L03_L3			; proceed with input
                 
                 BIOS_L03_L2_F1F2:				; switch user session
0072af 932f
0072b0 9120 3f02
0072b2 7120
0072b3 912f              cfmem	HW_FOUND, HW_FOUND_ROM		; check that ROM presents
0072b4 f3a1      	breq	BIOS_L03_AFTER_CAD		; ignore - no ROM
                 
0072b5 5055      	subi	temp, 0x05			; select eeprom bank
0072b6 f019      	breq	BIOS_L03_L2_F1F2_l1
0072b7 925f      	push	zero
0072b8 929f      	push	one
0072b9 c002      	rjmp	BIOS_L03_L2_F1F2_l2
                 
                 BIOS_L03_L2_F1F2_l1:
0072ba 929f      	push	one
0072bb 925f      	push	zero
                 
                 BIOS_L03_L2_F1F2_l2:
0072bc 940e c402 	call	CAD_STORE_STATE
                 ;	call	CAD_SET_EEPROM_SWAP_PROC
0072be 911f      	pop	zzA
0072bf 940e c673 	call	CAD_SET_EEPROM_RAM_ROM_PROC	; store RAM to ROM 
0072c1 911f      	pop	zzA
0072c2 940e c669 	call	CAD_SET_EEPROM_ROM_RAM_PROC	; read ROM to RAM and restore registers
0072c4 940e c469 	call	CAD_EXIT_NO_CRT			; start, no CRT restore
                 ;	sbiw	zzPCl, 2			; repeat BIOS 2 command 
                 
0072c6 940e 900a 	call	SD_LAST_RESET
                 ;	sts	SD_LASTADDRESS+3, FF
                 ;	sts	SD_LASTADDRESS+2, FF
                 ;	sts	SD_LASTADDRESS+1, FF
                 ;	sts	SD_LASTADDRESS+0, FF		; clear last_access - sdbuf was used
                 
                 ;	;!!! write code here!!!
0072c8 cfe0      	rjmp	BIOS_L03_AFTER_CAD		; clear and proceed with input
                 
                 BIOS_L03_L2_NUMLOCK:				; mouse auto mode
0072c9 940e 7f10 	call	BIOS_MOUSE_ONOFF		; start/stop mouse
                 ;	;!!! write code here!!!
0072cb cfdd      	rjmp	BIOS_L03_AFTER_CAD		; clear and proceed with input
                 
                 BIOS_L03_L2:
0072cc 9150 3f16 	lds	temp, CON_LAST_CHAR
                 
0072ce 2f15      	mov	zzA, temp			; store to return
0072cf 940e b500         call	HW_CONIN			; invoke hw compatibility processor
                 
0072d1 9250 090f
0072d3 e055
0072d4 940e 720a         nportout cpd_kchar, zero                ; set kchar as read
0072d6 2f51      	mov	temp, zzA
                 
0072d7 1155      	cpse	temp, zero
0072d8 9508      	ret
0072d9 cf9f      	rjmp	BIOS_L03			; if hw_conin returns 0 = forbidden key
                 
                 
                 
                 	; CONOUT -------------------------------------------------------------------------
                 	; char from zzC to CON
                 BIOS_L04:
0072da 935f
0072db 9150 3f2a
0072dd fd55
0072de 940e b007
0072e0 915f      	NOTIFY	NOTIFY_CON, DBG_CONOUT
                 
0072e1 934f              push	r20
0072e2 9140 3f01 	lds	r20, CON_IOBYTE			; check internal IOBYTE
0072e4 fd41      	sbrc	r20, CON_OUT_TTY		; TTY out requested?
0072e5 d357      	rcall	BIOS_L04_TTY_OUT
0072e6 fd42      	sbrc	r20, CON_OUT_LAN		; LAN out requested?
0072e7 d387      	rcall	BIOS_L04_LAN_OUT
0072e8 fd43      	sbrc	r20, CON_OUT_LST		; LST out requested?
0072e9 940e 8a42 	call	RS232_SEND			; was BIOS_L05
0072eb 7041      	andi	r20, (1<<CON_OUT_CON)		; check that CON is avilable
0072ec 914f      	pop	r20
                 
0072ed f409      	brne	BIOS_L04_CON			; flag is set - proceed with CON out
0072ee 9508      	ret					; otherwise return
                 
                 	;!!!!! need to add initial setting of this bit!!!!
                 ;	sbrs	temp, CON_OUT_CON		; CON out requested?
                 ;	ret
                 
                 BIOS_L04_CON:
0072ef 9150 091c 	lds	temp, CON_ESC			; check that ESC seq is processing
0072f1 1155      	cpse	temp, zero
0072f2 c2a7      	rjmp	BIOS04_PROCESS_ESC
                 
0072f3 2f56      	mov	temp, zzC
0072f4 3250      	cpi	temp, 32
0072f5 f428      	brsh	BIOS_L04_CHAR
                 
0072f6 315b      	cpi	temp, 27
0072f7 f409      	brne	BIOS_L04_SC			; special char
0072f8 c024      	rjmp	BIOS_L04_ESC			; start esc sequence processing
                 	
                 BIOS_L04_SC:
0072f9 940c b502 	jmp	HW_CONOUT_SC			; hw-dependent processing only
                 
                 ;	rjmp	BIOS_L04_SPECIAL		; special char
                 
                 BIOS_L04_CHAR:
                 ;        mov	temp, zzC
0072fb 940e b501         call	HW_CONOUT_CHAR			; process via HW layer first
                 	
0072fd 3060      	cpi	zzC, 0
0072fe f409      	brne	BIOS_L04_CHAR_L1
0072ff 9508      	ret					; if hw returns 0 stop processing
                 		
                 BIOS_L04_CHAR_L1:
007300 932f
007301 9120 3f05
007303 7420
007304 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007305 f011      	breq	BIOS_L04_CHAR_L2
007306 940e 78f6 	call	ECON_ATTR_CHAR			; process attributes if required
                 
                 BIOS_L04_CHAR_L2:
                 BIOS_L04_CHAR_CHAROUT:
007308 d106      	rcall	BIOS_CRT_CHAR			; echo char
007309 9150 3f06 	lds	temp, CURSOR_X
00730b 932f
00730c 9120 3f0a
00730e 1752
00730f 912f      	cpmem 	temp, CRT_CHARS			; last position?
007310 f008      	brlo	BIOS_L04_CHAR_L3		; no - just increment
                 
007311 c3e5      	rjmp	BIOS_L04_CRLF			; next line
                 
                 BIOS_L04_CHAR_L3:
007312 93ff
007313 93ef      	pushw	Z
007314 91e0 3f0d
007316 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
007318 9631      	adiw	Z, 1				; forward 1 char
007319 d201      	rcall	BIOS_ASSIGN_CURSOR
00731a 91ef
00731b 91ff      	popw	Z
00731c 9508      	ret
                 
                 BIOS_L04_ESC:	; ESC-codes - starting!
00731d 9290 091c 	sts	CON_ESC, one
00731f 9250 0924 	sts	CON_ESC_PAR, zero	; clear parameter
007321 9508      	ret
                 
                 
                 
                 	; LIST ----------------------------------------------------------------------------
                 	; char from C to LST/LPT
                 BIOS_L05:
007322 934f      	push	r20
007323 9140 3f58 	lds	r20, DEV_IOBYTE
007325 fd40      	sbrc	r20, LST_OUT_LPT
007326 d351      	rcall	BIOS_L05_LPT
007327 fd41      	sbrc	r20, LST_OUT_TTY
007328 d314      	rcall	BIOS_L05_TTY
007329 fd42      	sbrc	r20, LST_OUT_LAN
00732a d317      	rcall	BIOS_L05_LAN
00732b fd43      	sbrc	r20, LST_OUT_LST
00732c 940e 8a42 	call	RS232_SEND
00732e 914f      	pop	r20
00732f 9508      	ret
                 
                 ;	lds	temp, RTC_HW_DISABLE	; check that LST is enabled
                 ;	sbrc	temp, HW_DSBL_LST
                 ;	ret
                 
                 ;	nportin cpd_comtc
                 ;	cpi	temp, 0
                 ;	brne	BIOS_L05		; wait current char is transmitted
                 ;	nportout cpd_comtx, zzC		; char to send
                 ;	delay3	15
                 ;	nportout cpd_comtc, one		; force transmit action
                 ;	ret
                 
                 
                 	; PUNCH ----------------------------------------------------------------------------
                 	; char from C to punch - out to UART1
                 BIOS_L06:
007330 934f      	push	r20
007331 9140 3f48 	lds	r20, PR_IOBYTE
007333 fd40      	sbrc	r20, PRIO_OUT_CAN
007334 d30c      	rcall	BIOS_L06_CAN
007335 fd41      	sbrc	r20, PRIO_OUT_TTY
007336 d306      	rcall	BIOS_L06_TTY
007337 fd42      	sbrc	r20, PRIO_OUT_LAN
007338 d30d      	rcall	BIOS_L06_LAN
007339 fd43      	sbrc	r20, PRIO_OUT_LST
00733a 940e 8a42 	call	RS232_SEND
                 ;	rcall	BIOS_L05		; LIST command
00733c 914f      	pop	r20
00733d 9508      	ret
                 
                 
                 	; READER ----------------------------------------------------------------------------
                 	; read char from punch
                 BIOS_L07:
00733e 934f      	push	r20
00733f 9140 3f48 	lds	r20, PR_IOBYTE
007341 fd44      	sbrc	r20, PRIO_IN_CAN
007342 d30f      	rcall	BIOS_L07_CAN
007343 fd45      	sbrc	r20, PRIO_IN_TTY
007344 d305      	rcall	BIOS_L07_TTY
007345 fd46      	sbrc	r20, PRIO_IN_LAN
007346 d30c      	rcall	BIOS_L07_LAN
007347 fd47      	sbrc	r20, PRIO_IN_LST
007348 d30e      	rcall	BIOS_L07_LST		; LIST command
007349 914f      	pop	r20
                 
00734a d120      	rcall	PR_BUF_READ
                 _BIOS_L07_ret:
00734b 9508      	ret
                 
                 
                 	; HOME ----------------------------------------------------------------------------
                 	; Nothing to do
                 BIOS_L08:
00734c 9508      	ret
                 
                 
                 	; SELDSK
                 	; select disk from zzC, zzHL
                 BIOS_L09:
00734d 9360 3f0f 	sts	BIOS_DISK, zzC
00734f 2f16      	mov	zzA, zzC		; undocumented
                 
007350 93ff
007351 93ef      	pushw	Z
                 ;	ldiw	Z, zzCURR_DISK_NO
                 ;	STRAM	ZH, ZL, zzC
                 
007352 eae0
007353 edfe      	ldiw	Z, zzDPH0
007354 2f56      	mov	temp, zzC
007355 2b55      	or	temp, temp
007356 f019      	breq	BIOS_L09_L1
                 BIOS_L09_L2:
007357 9670      	adiw	Z, 16
007358 955a      	dec	temp
007359 f7e9      	brne	BIOS_L09_L2		; Z = DPH0+16*C
                 
                 BIOS_L09_L1:
00735a 2eef      	mov	zzH, ZH
00735b 2efe      	mov	zzL, ZL			; HL = DPH
                 
                 ;	ldiw	Z, zzCURR_DPH_ADDR
                 ;	STRAM	ZH, ZL, zzL
                 ;	adiw	Z, 1
                 ;	STRAM	ZH, ZL, zzH	
00735c 91ef
00735d 91ff      	popw	Z
                 
00735e 9508      	ret
                 
                 
                 	; SETTRK -------------------------------------------------------------------------------------------
                 	; Set track from zzBC
                 BIOS_L0A:
00735f 92a0 3f10 	sts	BIOS_TRACK, zzB
007361 9360 3f11 	sts	BIOS_TRACK+1, zzC
                 
                 ;	pushw	Z
                 ;	ldiw	Z, zzCURR_TRACK_NUM
                 ;	STRAM	ZH, ZL, zzC
                 ;	adiw	Z, 1
                 ;	STRAM	ZH, ZL, zzB
                 ;	popw	Z
007363 9508      	ret
                 
                 
                 	; SETSEC -------------------------------------------------------------------------------------------
                 	; Set sector from zzC
                 BIOS_L0B:
007364 9360 3f12 	sts	BIOS_SECTOR, zzC
007366 2f16      	mov	zzA, zzC			; undocumented
                 
                 ;	pushw	Z
                 ;	ldiw	Z, zzCURR_SECTOR_NUM
                 ;	STRAM	ZH, ZL, zzC
                 ;	popw	Z
007367 9508      	ret
                 
                 
                 	; SETDMA -------------------------------------------------------------------------------------------
                 	; Set DMA address from zzBC
                 BIOS_L0C:
007368 92a0 3f13 	sts	BIOS_DMA, zzB
00736a 9360 3f14 	sts	BIOS_DMA+1, zzC
                 
                 ;	pushw	Z
                 ;	ldiw	Z, zzCURR_DMA_BUFER_ADDR
                 ;	STRAM	ZH, ZL, zzC
                 ;	adiw	Z, 1
                 ;	STRAM	ZH, ZL, zzB
                 ;	popw	Z
00736c 9508      	ret
                 
                 
                 	; READ  -------------------------------------------------------------------------------------------
                 	; read sector, return error code to zzA
                 BIOS_L0D:
00736d 9150 3f15 	lds	temp, SD_TYPE
00736f 1155      	cpse	temp, zero
                 ;	brne
                 ;	lds	temp, HW_FOUND
                 ;	sbrc	temp, HW_FOUND_SDC	; when ROM is available but SD is absent start from ROM#A
007370 c002      	rjmp	BIOS_L0D_SDOK
007371 e052      	ldi	temp, 0x02		; device is not eady
007372 c047      	rjmp	BIOS_L0D_RET		; return
                 		
                 BIOS_L0D_SDOK:
007373 d238      	rcall	BIOS_SD_SETADDR
                 
007374 93ff
007375 93ef      	pushw	Z
007376 93bf
007377 93af      	pushw	X	
                 ;BIOS_L0D_STORE:
007378 e0a0
007379 e3b0      	ldiw	X, SD_BUF			; 512 bytes buffer address
                 
00737a 7053      	andi	temp, 0x03			; sector index 0-3
00737b f031      	breq	BIOS_L0D_TRANSFER
                 BIOS_L0D_L4:
00737c 9690      	adiw	X, 32
00737d 9690      	adiw	X, 32
00737e 9690      	adiw	X, 32                           ; X+=128
00737f 9690      	adiw	X, 32				; calculating start position to get data
007380 955a      	dec	temp
007381 f7d1      	brne	BIOS_L0D_L4
                 
                 BIOS_L0D_TRANSFER:	
007382 91f0 3f13 	lds	ZH, BIOS_DMA
007384 91e0 3f14 	lds	ZL, BIOS_DMA+1
                 	
                 ;	ldiw	Z, zzCURR_DMA_BUFER_ADDR
                 ;	LDRAM   ZH, ZL, temp
                 ;	push	temp	
                 ;	ldiw	Z, zzCURR_DMA_BUFER_ADDR+1
                 ;	LDRAM   ZH, ZL, temp
                 ;	mov	ZH, temp
                 ;	push	temp	
                 ;	pop	ZH
                 ;	pop	ZL				; RAM address of DMA buffer
                 
                 	;!!!!!!! rewirite with MCOPY!!!!
007386 931f      	push	zzA
007387 e850      	ldi	temp, 128			; bytes to transfer
                 BIOS_L0D_L3:
007388 911d      	ld	zzA, X+
007389 b9f8
00738a b9e2
00738b b915
00738c b824
00738d 15f6
00738e 985d
00738f f100
007390 b82b
007391 935f
007392 e158
007393 b955
007394 eb5f
007395 b954
007396 e050
007397 bd5d
007398 e550
007399 bd5c
00739a 9859
00739b 915f
00739c 982c
00739d 931f
00739e 2f5f
00739f 940e 005f
0073a1 e054
0073a2 955a
0073a3 f7f1
0073a4 2f5e
0073a5 940e 005f
0073a7 e054
0073a8 955a
0073a9 f7f1
0073aa 915f
0073ab 940e 005f
0073ad bc5c
0073ae 9a59
0073af b854
0073b0 b82b      	STRAM	ZH, ZL, zzA
0073b1 9631      	adiw	Z, 1
0073b2 955a      	dec	temp
0073b3 f6a1      	brne	BIOS_L0D_L3			; store sector to RAM
0073b4 911f      	pop	zzA
                 
0073b5 e050      	ldi	temp, 0				; success
                 
                 BIOS_L0D_NOSD:
                 ;        pop	zzA
0073b6 91af
0073b7 91bf      	popw	X
0073b8 91ef
0073b9 91ff      	popw	Z
                 
                 BIOS_L0D_RET:
0073ba 935f
0073bb 9150 3f2a
0073bd fd54
0073be 940e b006
0073c0 915f      	NOTIFY	NOTIFY_SD, DBG_SDERR
                 
0073c1 2f15      	mov	zzA, temp			; error code
0073c2 9508      	ret
                 
                 
                 	; WRITE -------------------------------------------------------------------------------------------
                 	; write sector to disk, return error code to zzA
                 BIOS_L0E:
                 ;	lds	temp, HW_FOUND
                 ;	sbrc	temp, HW_FOUND_SDC	; when ROM is available but SD is absent start from ROM#A
0073c3 9150 3f15 	lds	temp, SD_TYPE
0073c5 1155      	cpse	temp, zero
0073c6 c002      	rjmp	BIOS_L0E_SDOK
0073c7 e052      	ldi	temp, 0x02		; device is not eady
0073c8 c029      	rjmp	BIOS_L0E_RET		; return
                 
                 BIOS_L0E_SDOK:
0073c9 d1e2      	rcall	BIOS_SD_SETADDR
                 
0073ca 93ff
0073cb 93ef      	pushw	Z
0073cc 93bf
0073cd 93af      	pushw	X
                 
0073ce e0a0
0073cf e3b0      	ldiw	X, SD_BUF
0073d0 7053      	andi	temp, 0x03			; sector index 0-3
0073d1 f031      	breq	BIOS_L0E_TRANSFER
                 BIOS_L0E_L4:
0073d2 9690      	adiw	X, 32
0073d3 9690      	adiw	X, 32
0073d4 9690      	adiw	X, 32                           ; X+=128
0073d5 9690      	adiw	X, 32				; calculating start position to get data
0073d6 955a      	dec	temp
0073d7 f7d1      	brne	BIOS_L0E_L4
                 
                 BIOS_L0E_TRANSFER:	
0073d8 91f0 3f13 	lds	ZH, BIOS_DMA
0073da 91e0 3f14 	lds	ZL, BIOS_DMA+1
                 
                 ;	ldiw	Z, zzCURR_DMA_BUFER_ADDR
                 ;	LDRAM   ZH, ZL, temp
                 ;	push	temp	
                 ;	ldiw	Z, zzCURR_DMA_BUFER_ADDR+1
                 ;	LDRAM   ZH, ZL, temp
                 ;	mov	ZH, temp
                 ;	push	temp	
                 ;	pop	ZH
                 ;	pop	ZL				; RAM address of DMA buffer
                 
                 
                 	;!!!!!!! rewirite with MCOPY!!!!
0073dc 931f      	push	zzA
0073dd e850      	ldi	temp, 128			; bytes to transfer
                 BIOS_L0E_L3:
0073de b9f8
0073df b9e2
0073e0 b854
0073e1 b83b
0073e2 0000
0073e3 0000
0073e4 b113
0073e5 b82b              LDRAM   ZH, ZL, zzA
0073e6 931d      	st	X+, zzA
0073e7 9631      	adiw	Z, 1
0073e8 955a      	dec	temp
0073e9 f7a1      	brne	BIOS_L0E_L3			; store sector to RAM
0073ea 911f      	pop	zzA
                 
0073eb e050      	ldi	temp, 0				; success
0073ec 940e 9008 	call	SD_WRITE_DO			; store 512 bytes buffer
                 
                 BIOS_L0E_NOSD:
0073ee 91af
0073ef 91bf      	popw	X
0073f0 91ef
0073f1 91ff      	popw	Z
                 
                 BIOS_L0E_RET:
0073f2 935f
0073f3 9150 3f2a
0073f5 fd54
0073f6 940e b006
0073f8 915f      	NOTIFY	NOTIFY_SD, DBG_SDERR
                 
0073f9 2f15      	mov	zzA, temp			; error code
0073fa 9508      	ret
                 
                 
                 	; LISTST -------------------------------------------------------------------------------------------
                 	; printer status: always returns 0xff, also reads char from LST channel, it is stored in [LST_LAST_CHAR]
                 	;???? think carefully !!!
                 BIOS_L0F:
0073fb 934f      	push	r20
0073fc 9140 3f58 	lds	r20, DEV_IOBYTE
0073fe fd40      	sbrc	r20, LST_OUT_LPT
0073ff d2c0      	rcall	BIOS_L0F_LPT
007400 fd41      	sbrc	r20, LST_OUT_TTY
007401 d2c9      	rcall	BIOS_L0F_TTY
007402 fd42      	sbrc	r20, LST_OUT_LAN
007403 d2d0      	rcall	BIOS_L0F_LAN
007404 fd43      	sbrc	r20, LST_OUT_LST
007405 d2d0      	rcall	BIOS_L0F_LST
007406 914f      	pop	r20
                 ;	ret
                 
                 ;        call	RS232_RECEIVE
007407 ef1f      	ldi	zzA, 0xff	
007408 9350 3f19 	sts	LST_LAST_CHAR, temp
                 
                 ;	nportin	cpd_comst
                 ;	clr	zzA
                 ;	sbrs	temp, 7		; check RXC flag
                 ;	ret
                 ;	nportin	cpd_comrx
                 ;	mov	zzC, temp	
                 ;	ldi	zzA, 0xff	
                 ;	sts	LST_LAST_CHAR, zzC
00740a 9508      	ret
                 
                 
                 	; SECTRN -------------------------------------------------------------------------------------------
                 	; sectro translation
                 BIOS_L10:
                 	;HL = BC; no translation
00740b 2cea      	mov	zzH, zzB
00740c 2ef6      	mov	zzL, zzC
00740d 9508      	ret
                 
                 
                 _BIOS_RESET:
00740e c49b      	rjmp	BIOS_RESET
                 
                 
                 BIOS_CRT_CHAR:
00740f 93ff
007410 93ef      	pushw	Z
007411 91e0 3f0d
007413 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
007415 ef57      	ldi	temp, 0xf7			; RAM F8** address
007416 0ff5      	add	ZH, temp
007417 b9f8
007418 b9e2
007419 b965
00741a b824
00741b 15f6
00741c 985d
00741d f100
00741e b82b
00741f 935f
007420 e158
007421 b955
007422 eb5f
007423 b954
007424 e050
007425 bd5d
007426 e550
007427 bd5c
007428 9859
007429 915f
00742a 982c
00742b 936f
00742c 2f5f
00742d 940e 005f
00742f e054
007430 955a
007431 f7f1
007432 2f5e
007433 940e 005f
007435 e054
007436 955a
007437 f7f1
007438 915f
007439 940e 005f
00743b bc5c
00743c 9a59
00743d b854
00743e b82b      	STRAM	ZH, ZL, zzC			; store in RAM and send to CPD
00743f 91ef
007440 91ff      	popw	Z
007441 9508      	ret
                 
                 
                 
                 ; store zzC to con buf
                 BIOS_Lf0:
                 CON_BUF_ADD:
007442 3060      	cpi	zzC, 0
007443 f089      	breq	XXX_BUF_ADD_0
007444 9150 37b7 	lds	temp, CON_BUF_CNT
007446 3250      	cpi	temp, CON_BUF_LEN
007447 f458      	brsh	XXX_BUF_ADD_ovf		; buffer is overflowed, ignore
007448 ebe8
007449 e3f7      	ldiw	Z, CON_BUF
00744a 0fe5      	add	ZL, temp
00744b 1df5      	adc	ZH, zero
00744c 9553      	inc	temp
00744d 9350 37b7 	sts	CON_BUF_CNT, temp
                 ;	lds	temp, LAN_UDP_DATA	; only 1 byte message allowed
00744f 8360      	st	Z, zzC
                 XXX_BUF_ADD_1:
007450 9488      	clc				; 1 char stored
007451 9498      	clz
007452 9508      	ret
                 XXX_BUF_ADD_ovf:
007453 9408      	sec				; c==1 == overflow state 
007454 9508      	ret
                 XXX_BUF_ADD_0:
007455 9488      	clc				; no data stored 
007456 9418      	sez				; 
007457 9508      	ret
                 
                 ; store zzC to PR buf
                 BIOS_Lf1:
                 PR_BUF_ADD:
007458 3060      	cpi	zzC, 0
007459 f3d9      	breq	XXX_BUF_ADD_0
00745a 9150 3796 	lds	temp, PR_BUF_CNT
00745c 3250      	cpi	temp, PR_BUF_LEN
00745d f7a8      	brsh	XXX_BUF_ADD_ovf		; buffer is overflowed, ignore
00745e e9e7
00745f e3f7      	ldiw	Z, PR_BUF
007460 0fe5      	add	ZL, temp
007461 1df5      	adc	ZH, zero
007462 9553      	inc	temp
007463 9350 3796 	sts	PR_BUF_CNT, temp
                 ;	lds	temp, LAN_UDP_DATA              ; only 1 byte message allowed
007465 8360      	st	Z, zzC
007466 cfe9      	rjmp	XXX_BUF_ADD_1
                 ;PR_BUF_ADD_ret:
                 ;	ret
                 
                 
                 _ECON_CRT_ATTR:
007467 940c 7956 	jmp	ECON_CRT_ATTR
                 
                 
                 _ECON_GET_ATTR:
007469 c4b8      	rjmp	ECON_GET_ATTR	; get attribute for curr char, return to temp
                 
                 _ECON_SET_ATTR:	; set attribute in zzC
00746a c474      	rjmp	ECON_SET_ATTR	; set attribute in zzC
                 
                 ;_BIOS_CRT_CHAR:	; raw send char to CRT
                 ;	rjmp	BIOS_CRT_CHAR	; raw send char to CRT
                 
                 
                 
                 ; read data from PR buffer
                 PR_BUF_READ:
00746b e010      	ldi	zzA, 0
                 
00746c 9150 3796 	lds	temp, PR_BUF_CNT
00746e 3050      	cpi	temp, 0
00746f f059      	breq	PR_BUF_READ_ret		; get from buffer
                 
007470 e9e7
007471 e3f7      	ldiw	Z, PR_BUF
007472 8110      	ld	zzA, Z			; get data
007473 955a      	dec	temp
007474 9350 3796 	sts	PR_BUF_CNT, temp
007476 f021      	breq	PR_BUF_READ_ret		; get from buffer
                 ;	ldi	temp, PR_BUF_LEN-1
                 PR_BUF_READ_l1:
007477 8171      	ldd	FROMRAM0, Z+1
                 ;	sbiw	Z, 1			; goto previous char
007478 9371      	st	Z+, FROMRAM0
                 ;	adiw	Z, 2			; go ahead +2
007479 955a      	dec	temp
00747a f7e1      	brne	PR_BUF_READ_l1
                 PR_BUF_READ_ret:
00747b 9508      	ret
                 
                 
                 ; -------------------------------------------------------------------------------------------------------
                 	; scroll screen down 1 line
                 SCREEN_SCROOL_DOWN_RAM:
00747c 93bf
00747d 93af      	pushw	X
00747e 93df
00747f 93cf      	pushw	Y
007480 93ff
007481 93ef      	pushw	Z
007482 933f      	push	r19
                 
007483 91c0 3f0b
007485 91d0 3f0c 	ldw	Y, VIDEO_END
007487 ef57      	ldi	temp, 0xf7
007488 0fd5      	add	YH, temp
                 
007489 e0a0
00748a efb8      	ldiw	X, 0xF800			; start of videoram
00748b e0e0
00748c eff8      	ldiw	Z, 0xF800;+80			; starting from second line
00748d 9150 3f0a 	lds	temp, CRT_CHARS
00748f 0fe5      	add	ZL, temp
007490 1df5      	adc	ZH, zero
                 ;	LDRAM 	ZH, ZL, temp			; read char from zRAM
                 
                 ;SCREEN_SCROOL_DOWN_RAM_DO:
                 SSD_L1:
007491 b9f8
007492 b9e2
007493 b854
007494 b83b
007495 0000
007496 0000
007497 b153
007498 b82b      	LDRAM 	ZH, ZL, temp			; read char from zRAM
007499 b9b8
00749a b9a2
00749b b955
00749c b824
00749d 15b6
00749e 985d
00749f f100
0074a0 b82b
0074a1 935f
0074a2 e158
0074a3 b955
0074a4 eb5f
0074a5 b954
0074a6 e050
0074a7 bd5d
0074a8 e550
0074a9 bd5c
0074aa 9859
0074ab 915f
0074ac 982c
0074ad 935f
0074ae 2f5b
0074af 940e 005f
0074b1 e054
0074b2 955a
0074b3 f7f1
0074b4 2f5a
0074b5 940e 005f
0074b7 e054
0074b8 955a
0074b9 f7f1
0074ba 915f
0074bb 940e 005f
0074bd bc5c
0074be 9a59
0074bf b854
0074c0 b82b      	STRAM	XH, XL, temp
0074c1 9611      	adiw	X, 1
0074c2 9631      	adiw	Z, 1
                 
                 ;	cpi	XH, 0xfa ;!!!
                 ;	breq	SSD_L2 ;!!!
                 
0074c3 17ec      	cp	ZL, YL
0074c4 07fd      	cpc	ZH, YH
0074c5 f258      	brlo	SSD_L1				; loop
                 
0074c6 e230      	ldi	r19, ' '			; fill last line with spaces
                 SSD_L2:
0074c7 b9b8
0074c8 b9a2
0074c9 b935
0074ca b824
0074cb 15b6
0074cc 985d
0074cd f100
0074ce b82b
0074cf 935f
0074d0 e158
0074d1 b955
0074d2 eb5f
0074d3 b954
0074d4 e050
0074d5 bd5d
0074d6 e550
0074d7 bd5c
0074d8 9859
0074d9 915f
0074da 982c
0074db 933f
0074dc 2f5b
0074dd 940e 005f
0074df e054
0074e0 955a
0074e1 f7f1
0074e2 2f5a
0074e3 940e 005f
0074e5 e054
0074e6 955a
0074e7 f7f1
0074e8 915f
0074e9 940e 005f
0074eb bc5c
0074ec 9a59
0074ed b854
0074ee b82b      	STRAM	XH, XL, r19
0074ef 9611      	adiw	X, 1
0074f0 17ac      	cp	XL, YL
0074f1 07bd      	cpc	XH, YH
0074f2 f2a0      	brlo	SSD_L2				; loop
                 
0074f3 913f      	pop	r19
0074f4 91ef
0074f5 91ff      	popw	Z
0074f6 91cf
0074f7 91df      	popw	Y
0074f8 91af
0074f9 91bf      	popw	X                               ; restore registers
                 
0074fa 9508      	ret
                 
                 
                 ; -------------------------------------------------------------------------------------
                 
                 
                 
                 CURSOR_XY_PTR:
0074fb 93ff
0074fc 93ef      	pushw	Z
0074fd 937f      	push	FROMRAM0
0074fe 920f      	push	r0
0074ff 921f      	push	r1
007500 935f      	push	temp
                 
007501 9150 3f07 	lds	temp, CURSOR_Y
007503 955a      	dec	temp
                 ;	ldi	FROMRAM0, 80
007504 9170 3f0a 	lds	FROMRAM0, CRT_CHARS
007506 9f57      	mul	temp, FROMRAM0			; y*80
                 
007507 e0f1      	ldi	ZH, 1
007508 91e0 3f06 	lds	ZL, CURSOR_X
00750a 95ea      	dec	ZL				; pointer starts from 0
00750b 0de0      	add	ZL, r0
00750c 1df1      	adc	ZH, r1
                 
00750d 93e0 3f0d 	sts	VIDEO_CURSOR, ZL
00750f 93f0 3f0e 	sts	VIDEO_CURSOR+1, ZH
                 
007511 915f      	pop	temp
007512 901f      	pop	r1
007513 900f      	pop	r0
007514 917f      	pop	FROMRAM0
007515 91ef
007516 91ff      	popw	Z
007517 9508      	ret
                 
                 ; -------------------------------------------------------------------------------------
                 	; must be called after setting CURSOR_* in memory
                 CURSOR_APPLY_XY:
007518 dfe2      	rcall	CURSOR_XY_PTR
                 ;	pushw	Z
                 ;	ldi	ZH, 1
                 ;	lds	ZL, CURSOR_X
                 ;	dec	ZL				; pointer starts from 0
                 ;	lds	temp, CURSOR_Y
                 ;MCS_L02:
                 ;	cpi	temp, 1
                 ;	breq	MCS_L01
                 ;	adiw	Z, 40
                 ;	adiw	Z, 40				; next line
                 ;	dec	temp
                 ;	rjmp	MCS_L02
                 ;MCS_L01:
                 ;	sts	VIDEO_CURSOR, ZL
                 ;	sts	VIDEO_CURSOR+1, ZH
                 
007519 d01f      	rcall	BIOS_SETCPDCURSOR		; send cursor ro CPD and ret
                 ;	popw	Z
00751a 9508      	ret
                 
                 
                 	/*
                 ; -------------------------------------------------------------------------------------
                 	; send local videoram to CPD
                 SCREEN_SEND_CPD:
                 	pushw	Y
                 	pushw	Z
                 	ldw	Y, VIDEO_END
                 	ldiw	Z, 0x100
                 	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4		
                 	SPI_SELECT
                 SSC_L1:
                 	ld	temp, Z
                 	cpi	temp, 32
                 	brlo	SSC_L2				; ignore non-printed chars
                 
                 	ldi	temp, 0xf7
                 	add	temp, ZH
                 	call	DOSPI				; f8
                 	mov	temp, ZL
                 	call	DOSPI				; xx
                 	ld	temp, Z
                 	call	DOSPI				; char
                 SSC_L2:
                 	adiw	Z, 1
                 	cp	YL, ZL
                 	cpc	YH, ZH
                 	brne	SSC_L1				; send all videoram
                 	SPI_STOP
                 	popw	Z
                 	popw	Y
                 	ret
                 */	
                 
                 ;---------------------------------------------------------------------------------------
                 	; store cursor position, current CP ram ptr in ZH, ZL
                 BIOS_ASSIGN_CURSOR:
00751b 93e0 3f0d 	sts	VIDEO_CURSOR, ZL
00751d 93f0 3f0e 	sts	VIDEO_CURSOR+1, ZH              ; store new cursor pointer
                 
                 	; calculating new line and pos
00751f 932f      	push 	r18
007520 93df
007521 93cf      	pushw	Y                               ; save registers
007522 e0d1      	ldi	YH, 1
007523 e0c0      	ldi	YL, 0
                 ;	ldi	temp, 80
007524 9150 3f0a 	lds	temp, CRT_CHARS
                 	; calculating line
007526 2722      	clr	r18				; r18=0
                 BIOS_AC_L01:
007527 9523      	inc	r18                             ; lines in cursor position start from 1
007528 0fc5      	add	YL, temp
007529 1dd5      	adc	YH, zero	
00752a 17ce      	cp	YL, ZL
00752b 07df      	cpc	YH, ZH
00752c f3d0      	brlo	BIOS_AC_L01			; while Y<Z Y+=80
                 
00752d 9320 3f07 	sts	CURSOR_Y, r18                   ; store new cursor positions
                 
00752f 1bc5      	sub	YL, temp
007530 09d5      	sbc	YH, zero
                 ;	sbiw	Y, 40
                 ;	sbiw	Y, 40
                 
                 	; calculating position
007531 1bec      	sub	ZL, YL
007532 0bfd      	sbc	ZH, YH				; zl = Z-Y
007533 95e3      	inc	ZL
007534 93e0 3f06 	sts	CURSOR_X, ZL			; store new cursor positions
007536 91cf
007537 91df      	popw	Y
007538 912f      	pop	r18				; restore registers
                 ;	ret
                 	; calculating position
                 ;	clr	r18
                 ;BIOS_AC_L02:
                 ;	inc	r18                             ; lines in cursor position start from 1
                 ;	add	YL, one
                 ;	adc	YH, zero	
                 ;	cp	YL, ZL
                 ;	cpc	YH, ZH
                 ;	brlo	BIOS_AC_L02			; while Y<Z Y+=80
                 
                 ;	sts	CURSOR_X, r18			; store new cursor positions
                 ;	popw	Y
                 ;	pop	r18				; restore registers
                 
                 	; cursor position is in Z
                 BIOS_SETCPDCURSOR:
007539 93ff
00753a 93ef      	pushw	Z
00753b 935f      	push	temp
00753c 91e0 3f0d         lds	ZL, VIDEO_CURSOR
00753e 91f0 3f0e         lds	ZH, VIDEO_CURSOR+1
007540 9150 3f08 	lds	temp, CURSOR_STATUS             ; take cursor status
007542 2b5f      	or	temp, ZH			; return bit 7 set if cursor is off to hide it
007543 9350 090f
007545 e051
007546 940e 720a 	nportout cpd_vcurh, temp
007548 93e0 090f
00754a e052
00754b 940e 720a 	nportout cpd_vcurl, ZL
00754d 915f      	pop	temp
00754e 91ef
00754f 91ff      	popw	Z
007550 9508      	ret
                 
                 
                 
                 ; -------------------------------------------------------------------------------------
                 	; fill videoram with zzA
                 SCREEN_CLEAR_A:
                 /*
                 	push	FROMRAM0
                 	push	FROMRAM1
                 	push	zzC
                 	ldiw	X, 0xF800			; start of videoram
                 	lds	FROMRAM0, CRT_LINES
                 	lds	FROMRAM1, CRT_CHARS
                 _sc_clr_l1:
                 	ldi	zzC, 0
                 _sc_clr_l3:
                 ;	cp	zzC, FROMRAM1
                 ;	brsh	_sc_clr_l2			; end of line reached
                 	STRAM	XH, XL, zzA
                 _sc_clr_l2:
                 	adiw	X, 1
                 	inc	zzC
                 	cpi	zzC, FROMRAM1 ;80
                 	brne	_sc_clr_l3
                 	dec	FROMRAM0
                 	brne	_sc_clr_l1
                 
                 	pop	zzC
                 	pop	FROMRAM1	
                 	pop	FROMRAM0
                 	ret
                 */
                 	
007551 93bf
007552 93af      	pushw	x
007553 93df
007554 93cf      	pushw	Y
007555 91c0 3f0b
007557 91d0 3f0c 	ldw	Y, VIDEO_END
007559 ef57      	ldi	temp, 0xf7
00755a 0fd5      	add	YH, temp
00755b e0a0
00755c efb8      	ldiw	X, 0xF800			; start of videoram
                 SC_CLR_L1:
00755d b9b8
00755e b9a2
00755f b915
007560 b824
007561 15b6
007562 985d
007563 f100
007564 b82b
007565 935f
007566 e158
007567 b955
007568 eb5f
007569 b954
00756a e050
00756b bd5d
00756c e550
00756d bd5c
00756e 9859
00756f 915f
007570 982c
007571 931f
007572 2f5b
007573 940e 005f
007575 e054
007576 955a
007577 f7f1
007578 2f5a
007579 940e 005f
00757b e054
00757c 955a
00757d f7f1
00757e 915f
00757f 940e 005f
007581 bc5c
007582 9a59
007583 b854
007584 b82b      	STRAM	XH, XL, zzA
007585 9611      	adiw	X, 1
007586 17ac      	cp	XL, YL
007587 07bd      	cpc	XH, YH
007588 f2a0      	brlo	SC_CLR_L1			; loop
007589 91cf
00758a 91df      	popw	Y
00758b 91af
00758c 91bf      	popw	X
00758d 9508      	ret
                 
                 
                 
                 ; -------------------------------------------------------------------------------------
                 	; fill videoram with spaces
                 SCREEN_CLEAR:
00758e 931f      	push	zzA
00758f 9110 3f05 	lds	zzA, CRT_SETTINGS
007591 7017      	andi	zzA, 0x07			; active codepage
007592 3011      	cpi	zzA, 1				; graph mode?
007593 f411      	brne	_screen_clear_l1
007594 e010      	ldi	zzA, 0          		; for graph mode fill with 0
007595 c001      	rjmp	_screen_clear_l2
                 _screen_clear_l1:
007596 e210      	ldi	zzA, ' '			; text mode - fill with spaces
                 _screen_clear_l2:
007597 dfb9      	rcall	SCREEN_CLEAR_A
007598 911f      	pop	zzA
007599 9508      	ret
                 
                 
                 ; ----------------- process ESC code -------------------------
                 BIOS04_PROCESS_ESC:
00759a 3059              cpi	temp, 9
00759b f018              brlo	BIOS04_PROCESS_ESC_L0
00759c 9250 091c         sts	CON_ESC, zero			; stop processing = error, no processor!
00759e 9508              ret
                 BIOS04_PROCESS_ESC_L0:	
00759f e1ec
0075a0 e0f9      	ldiw	Z, CON_ESC
0075a1 0fe5      	add	ZL, temp
0075a2 1df5      	adc	ZH, zero
0075a3 8360      	st	Z, zzC				; store char to (CON_ESC+temp)
                 
0075a4 9553      	inc	temp				; total number of chars in the sequence
0075a5 2f25      	mov	FROMRAM2, temp			; save for restore
0075a6 2e15      	mov	FROMRAM1, temp			; save for restore
                 ;	sts	CON_ESC, zero			; for the case when call
0075a7 940e b503 	call	HW_CONOUT_ESC
0075a9 9320 091c 	sts	CON_ESC, FROMRAM2		; call returns 0 if request is processed
0075ab 9508      	ret
                 
                 
                 
                 ;--------------------------------------------------------------------------------
                 ; set SD_ADDRESS, read block if required, returns sector_num in temp
                 BIOS_SD_SETADDR:
0075ac 93ff
0075ad 93ef      	pushw	Z
0075ae 93bf
0075af 93af      	pushw	X
0075b0 931f      	push	zzA
                 
0075b1 9110 3f0f 	lds	zzA, BIOS_DISK
                 
                 ;	ldiw	Z, zzCURR_DISK_NO
                 ;	LDRAM   ZH, ZL, zzA		; zzA = selected disk 0 .. 15
0075b3 e1aa
0075b4 e3bf      	ldiw	X, SD_FDD_BASE
0075b5 0fa1      	add	XL, zzA
0075b6 1db5      	adc	XH, zero
0075b7 911c      	ld	zzA, X			; zzA = disk index 01..ff
0075b8 27bb      	clr	XH
0075b9 27aa      	clr	XL			; X = 0
0075ba 9516      	lsr	zzA			; shifting low zzA tetrade to high XH tetrade
0075bb 95b7      	ror	XH
0075bc 9516      	lsr	zzA
0075bd 95b7      	ror	XH
0075be 9516      	lsr	zzA
0075bf 95b7      	ror	XH
0075c0 9516      	lsr	zzA
0075c1 95b7      	ror	XH			; start block addr: zzA XH XL
                 
                 ;	lds	temp, BIOS_TRACK
0075c2 9150 3f11 	lds	temp, BIOS_TRACK+1
                 
                 ;	ldiw	Z, zzCURR_TRACK_NUM
                 ;	LDRAM   ZH, ZL, temp
0075c4 3050      	cpi	temp, 0
0075c5 f019      	breq	BIOS_SD_SETADDR_L1
                 BIOS_SD_SETADDR_L2:
0075c6 9654      	adiw	X, 20			; 20 SDblocks per track
0075c7 955a      	dec	temp
0075c8 f7e9      	brne	BIOS_SD_SETADDR_L2
                 
                 BIOS_SD_SETADDR_L1:
0075c9 9150 3f12 	lds	temp, BIOS_SECTOR
                 
                 ;	ldiw	Z, zzCURR_SECTOR_NUM
                 ;	LDRAM   ZH, ZL, temp
0075cb 935f      	push	temp			; store sector to return
0075cc 9556      	lsr	temp
0075cd 9556      	lsr	temp			; /4 - 512 sector address
0075ce 0fa5      	add	XL, temp
0075cf 1db5      	adc	XH, zero
                 
0075d0 935f
0075d1 9150 3f2a
0075d3 fd54
0075d4 940e b005
0075d6 915f      	NOTIFY	NOTIFY_SD, DBG_SD
                 ;	lds	temp, SYS_NOTIFY	
                 ;	sbrc	temp, 4				;!!! debug request
                 ;	call	DBG_SDREAD
                 
0075d7 9150 0932 	lds	temp, SD_LASTADDRESS    ; check that block is last accessed
0075d9 175a      	cp	temp, XL
0075da f469      	brne	BIOS_SD_SETADDR_READ512
0075db 9150 0933 	lds	temp, SD_LASTADDRESS+1
0075dd 175b      	cp	temp, XH
0075de f449      	brne	BIOS_SD_SETADDR_READ512
0075df 9150 0934 	lds	temp, SD_LASTADDRESS+2
0075e1 1751      	cp	temp, zzA
0075e2 f429      	brne	BIOS_SD_SETADDR_READ512
0075e3 9150 0935 	lds	temp, SD_LASTADDRESS+3
0075e5 1555      	cp	temp, zero
0075e6 f409      	brne	BIOS_SD_SETADDR_READ512
                 
                 ;	ret
0075e7 c01a      	rjmp	BIOS_SD_SETADDR_READY	; buffer already has been read!
                 
                 BIOS_SD_SETADDR_READ512:
0075e8 93a0 092a 	sts	SD_ADDRESS, XL		; set block address
0075ea 93b0 092b 	sts	SD_ADDRESS+1, XH	
0075ec 9310 092c 	sts	SD_ADDRESS+2, zzA
0075ee 9250 092d 	sts	SD_ADDRESS+3, zero
0075f0 940e 9004 	call	SD_READ_DO           	; read 512 SDblock
                 	
0075f2 9150 3f30 	lds	temp, SD_ERROR
0075f4 9350 3f32
0075f6 935f
0075f7 e35c
0075f8 9350 3f31
0075fa 915f
0075fb 935f
0075fc 9150 3f2a
0075fe fd54
0075ff 940e b00b
007601 915f      	NOTIFYt	NOTIFY_SD, '<'
                 	;!!! add error check!!!
                 
                 BIOS_SD_SETADDR_READY:
007602 93a0 092a 	sts	SD_ADDRESS, XL		; set block address for the use
007604 93b0 092b 	sts	SD_ADDRESS+1, XH	
007606 9310 092c 	sts	SD_ADDRESS+2, zzA
007608 9250 092d 	sts	SD_ADDRESS+3, zero
                 
                 ;BIOS_SD_SETADDR_READY:
00760a 915f      	pop	temp
00760b 911f      	pop	zzA
00760c 91af
00760d 91bf      	popw	X
00760e 91ef
00760f 91ff      	popw	Z
007610 9508      	ret
                 
                 
                 ; --------------------------------------------------
                 ; set video mode from active sttings
                 BIOS_SET_VIDEO_MODE:
007611 937f      	push	FROMRAM0
007612 935f      	push	temp
007613 9170 3f05 	lds	FROMRAM0, CRT_SETTINGS	
007615 9150 3f09         lds	temp, CRT_LINES
007617 0f55              lsl	temp
007618 0f55              lsl	temp
007619 0f55              lsl	temp
00761a 7077              andi	FROMRAM0, 0x07		; codepage
00761b 2b57              or	temp, FROMRAM0
00761c 9350 090f
00761e e050
00761f 940e 720a 	nportout cpd_vstat, temp	; set new settings
                 
007621 e850      	ldi	temp, 0x80
007622 1179              cpse	FROMRAM0, one		; is graphic mode?
007623 e050      	ldi	temp, 0			; enable cursor if not
007624 9350 3f08 	sts	CURSOR_STATUS, temp	; cursor status
007626 def1      	rcall	CURSOR_APPLY_XY		; set cursor
                 
                 	;set VIDEO_END
007627 920f      	push	r0
007628 921f      	push	r1
007629 9150 3f09 	lds	temp, CRT_LINES
                 ;	ldi	FROMRAM0, 80
00762b 9170 3f0a 	lds	FROMRAM0, CRT_CHARS
00762d 9f57      	mul	temp, FROMRAM0		; y*80
00762e 9413      	inc	r1			; +0x100
00762f 9200 3f0b 	sts	VIDEO_END, r0		; low
007631 9210 3f0c 	sts	VIDEO_END+1, r1		; high
007633 901f      	pop	r1
007634 900f      	pop	r0
                 
007635 9250 3f66 	sts	CON_WIN_X0, zero	; reset active window - no limits
                 ;	sts	CON_WIN_X0, one		; reset active window
                 ;	ldstt	CON_WIN_X1, CRT_CHARS
                 ;	sts	CON_WIN_Y0, one
                 ;	ldstt	CON_WIN_Y1, CRT_LINES
                 
                 	;???? add CLRSCR ????
                 
007637 e050
007638 940e b400 	EXEC_CLR_CMD CLR_CMD_DEFAULT	; reset CLR controller	
                 
00763a 915f      	pop	temp
00763b 917f      	pop	FROMRAM0
00763c 9508      	ret
                 
                 
                 
                 ; CON: write to 
                 BIOS_L04_TTY_OUT:
                 ; LST write to punch device
                 BIOS_L05_TTY:
                 ; PUNCH write to punch device
                 BIOS_L06_TTY:
00763d 2f56      	mov	temp, zzC
00763e 940e 893c 	call 	UART1_SEND
007640 9508      	ret
                 
                 ; CON: write to 
                 ;BIOS_L04_TTY_OUT:
                 ;	mov	temp, zzC
                 ;	call	UART1_SEND
                 ;	ret
                 
                 
                 
                 BIOS_L06_CAN:
                 	;!!!! code here
007641 9508      	ret
                 
                 
                 BIOS_L05_LAN:
007642 e759
007643 940e 9400 	EXEC_LAN_CMD LAN_FUNC_SEND_PRN	; CMDLAN_SEND_PR
007645 9508      	ret
                 
                 
                 BIOS_L06_LAN:
007646 e758
007647 940e 9400 	EXEC_LAN_CMD LAN_FUNC_SEND_PR	; CMDLAN_SEND_PR
007649 9508      	ret
                 
                 
                 ; READER read data from 
                 BIOS_L07_TTY:
00764a 9150 00c8         lds	temp, UCSR1A
00764c ff57              sbrs	temp, RXC1
00764d 9508              ret
00764e 9160 00ce         lds	zzC, UDR1
007650 de07              rcall	PR_BUF_ADD
007651 9508      	ret
                 
                 BIOS_L07_CAN:
                 	;!!!! code here
007652 9508      	ret
                 
                 
                 BIOS_L03_LAN:
                 BIOS_L07_LAN:
007653 e152
007654 940e 9400 	EXEC_LAN_CMD LAN_FUNC_PROCESS	; CMDLAN_PROCESS
007656 9508      	ret
                 
                 ; read data from LST
                 BIOS_L07_LST:			
007657 940e 8a55 	call	RS232_RECEIVE
                 ;	nportin	cpd_comst
                 ;	sbrs	temp, 7			; check RXC flag
                 ;	ret
                 ;	nportin	cpd_comrx
007659 2f65      	mov	zzC, temp	
00765a ddfd              rcall	PR_BUF_ADD
00765b 9508      	ret
                 
                 
                 ; CONIN input
                 BIOS_L03_TTY:
00765c 9150 00c8         lds	temp, UCSR1A
00765e ff57              sbrs	temp, RXC1
00765f 9508              ret
007660 9160 00ce         lds	zzC, UDR1
007662 dddf              rcall	CON_BUF_ADD
007663 9508      	ret
                 
                 ; read data from LST
                 BIOS_L03_LST:			
007664 e251
007665 940e 720c 	nportin	cpd_comst
007667 ff57      	sbrs	temp, 7			; check RXC flag
007668 9508      	ret
007669 e253
00766a 940e 720c 	nportin	cpd_comrx
00766c 2f65      	mov	zzC, temp	
00766d ddd4              rcall	CON_BUF_ADD
00766e 9508      	ret
                 
                 
                 ; conout write to 
                 BIOS_L04_LAN_OUT:
00766f e757
007670 940e 9400 	EXEC_LAN_CMD LAN_FUNC_SEND_SRV	; CMDLAN_SEND_SERVER
007672 9508      	ret
                 
                 BIOS_L04_CAN_OUT:
                 	;!!!! code here
007673 9508      	ret
                 
                 ; conout write to 
                 BIOS_L05_LAN_OUT:
007674 e759
007675 940e 9400 	EXEC_LAN_CMD LAN_FUNC_SEND_PRN	; CMDLAN_SEND_PRN
007677 9508      	ret
                 
                 
                 	;!!!!!! write output to LPT
                 BIOS_L05_LPT:
007678 e051
007679 9350 090f
00767b e058
00767c 940e 720a 	nportout_t cpd_twdti, 0b00000001	; strobe hi
00767e e750
00767f 9350 090f
007681 e057
007682 940e 720a 	nportout_t cpd_twcmd, 0b01110000	; write to DD1
007684 d034      	rcall	GPIO_WAIT
007685 f541      	brne	_bios_l05_lpt_ret
                 
007686 9360 090f
007688 e058
007689 940e 720a 	nportout cpd_twdti, zzC		; data
00768b e752
00768c 9350 090f
00768e e057
00768f 940e 720a 	nportout_t cpd_twcmd, 0b01110010	; write to DD2
007691 d027      	rcall	GPIO_WAIT
007692 f4d9      	brne	_bios_l05_lpt_ret
                 
007693 e050
007694 9350 090f
007696 e058
007697 940e 720a 	nportout_t cpd_twdti, 0b00000000	; strobe low
007699 e750
00769a 9350 090f
00769c e057
00769d 940e 720a 	nportout_t cpd_twcmd, 0b01110000	; write to DD1
00769f d019      	rcall	GPIO_WAIT
0076a0 f469      	brne	_bios_l05_lpt_ret
                 
0076a1 e051
0076a2 9350 090f
0076a4 e058
0076a5 940e 720a 	nportout_t cpd_twdti, 0b00000001	; strobe hi
0076a7 e750
0076a8 9350 090f
0076aa e057
0076ab 940e 720a 	nportout_t cpd_twcmd, 0b01110000	; write to DD1
0076ad d00b      	rcall	GPIO_WAIT
                 
                 ;	;!!!! code here !!!!!
                 _bios_l05_lpt_ret:
0076ae 9508      	ret
                 
                 
                 	; sends zzC to port temp
                 GPIO_SEND:
                 	; wait GPIO operation complete
0076af 9360 090f
0076b1 e058
0076b2 940e 720a 	nportout cpd_twdti, zzC		; data
0076b4 9350 090f
0076b6 e057
0076b7 940e 720a 	nportout cpd_twcmd, temp	; write
                 GPIO_WAIT:
0076b9 e057
0076ba 940e 720c 	nportin	cpd_twcmd
0076bc 3052      	cpi	temp, 0x02
0076bd f7d8      	brsh	GPIO_WAIT		; wait
0076be 1555      	cp	temp, zero		; set flag z if success
0076bf 9508      	ret
                 
                 
                 
                 	; read printer status from TTY
                 BIOS_L0F_LPT:
                 ;	nportout_t cpd_twdti, 0b00000001	; strobe hi
0076c0 e755
0076c1 9350 090f
0076c3 e057
0076c4 940e 720a 	nportout_t cpd_twcmd, 0b01110101	; READ DD3
0076c6 dff2      	rcall	GPIO_WAIT
0076c7 e058
0076c8 940e 720c 	nportin cpd_twdti
0076ca 9508      	ret
                 	
                 
                 BIOS_L0F_TTY:
0076cb 9150 00c8         lds	temp, UCSR1A
0076cd ff57              sbrs	temp, RXC1
0076ce c003              rjmp	_l0f_tty_l1
0076cf 9150 00ce         lds	temp, UDR1
0076d1 9508              ret
                 _l0f_tty_l1:
0076d2 e050      	ldi	temp, 0
0076d3 9508      	ret
                 
                 
                 BIOS_L0F_LAN:	
0076d4 e050      	ldi	temp, 0
0076d5 9508      	ret
                 
                 BIOS_L0F_LST:
0076d6 940e 8a55         call	RS232_RECEIVE
0076d8 9508              ret
                 
                 
                 	; read data from CON buffer
                 CON_BUF_READ:
0076d9 e010      	ldi	zzA, 0
                 
0076da 9150 37b7 	lds	temp, CON_BUF_CNT
0076dc 3050      	cpi	temp, 0
0076dd f059      	breq	CON_BUF_READ_ret	; get from buffer
                 
0076de ebe8
0076df e3f7      	ldiw	Z, CON_BUF
0076e0 8110      	ld	zzA, Z			; get data
0076e1 955a      	dec	temp
0076e2 9350 37b7 	sts	CON_BUF_CNT, temp
0076e4 f021      	breq	CON_BUF_READ_ret	; get from buffer
                 ;	ldi	temp, CON_BUF_LEN-1
                 CON_BUF_READ_l1:
0076e5 8171      	ldd	FROMRAM0, Z+1
                 ;	sbiw	Z, 1			; goto CONevious char
0076e6 9371      	st	Z+, FROMRAM0
                 ;	adiw	Z, 2			; go ahead +2
0076e7 955a      	dec	temp
0076e8 f7e1      	brne	CON_BUF_READ_l1
                 CON_BUF_READ_ret:
                 ;	mov	temp, zzA
0076e9 9508      	ret
                 
                 
                 	; get CON input data from available sources
                 CON_GET_INPUTS:
0076ea 936f              push	zzC
0076eb 934f              push	r20
0076ec 9140 3f01 	lds	r20, CON_IOBYTE		; check internal IOBYTE
0076ee fd45      	sbrc	r20, CON_IN_TTY		; TTY out requested?
0076ef df6c      	rcall	BIOS_L03_TTY
0076f0 fd46      	sbrc	r20, CON_IN_LAN		; LAN out requested?
0076f1 df61      	rcall	BIOS_L03_LAN
0076f2 fd47      	sbrc	r20, CON_IN_LST		; LST out requested?
0076f3 df70      	rcall	BIOS_L03_LST
                 ;	andi	r20, (1<<CON_IN_CON)	; check that CON is avilable - set Z flag if no
0076f4 914f              pop	r20
0076f5 916f      	pop	zzC
0076f6 9508      	ret
                 
                 
                 #include "bios_sc.inc"
                 
0076f7 9290 3f06         sts	CURSOR_X, one
0076f9 c003      	rjmp	BIOS_L04_LF
                 
                 
                 
                 BIOS_L04_ENTER:   ; CR
0076fa 9290 3f06         sts	CURSOR_X, one
0076fc ce1b      	rjmp	CURSOR_APPLY_XY
                 ;	ret
                 
                 
                 BIOS_L04_LF:
                 BIOS_L04_CR:   ; LF
0076fd 9150 3f07 	lds	temp, CURSOR_Y
0076ff 932f
007700 9120 3f09
007702 1752
007703 912f      	cpmem	temp, CRT_LINES
007704 f088      	brlo	BIOS_L04_CR_DN
                 
007705 932f
007706 9120 3f05
007708 7820
007709 912f      	cfmem	CRT_SETTINGS, CRT_SCROLL_DSBL	; check scroll enabled
00770a f451      	brne	BIOS_L04_CR_ret			; bit set = scroll disabled!
                 
                 ;	push	temp
00770b dd70      	rcall	SCREEN_SCROOL_DOWN_RAM		; just scroll, cursor lets the same
                 
                 ;	cfmem	CRT_SETTINGS, CRT_USE_CLR
                 ;	breq	BIOS_L04_CR_l1
00770c 940e 7e4d 	call	CRISS_CLR_SCROLL		; scroll colors pattern
                 ;BIOS_L04_CR_l1:
00770e 932f
00770f 9120 3f05
007711 7420
007712 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007713 f009      	breq	BIOS_L04_CR_ret
007714 d221      	rcall	ECON_ATTR_SCROLL		; process attributes if required
                 ;	pop	temp
                 BIOS_L04_CR_ret:
007715 ce02      	rjmp	CURSOR_APPLY_XY			; set cursor
                 ;	ret
                 
                 BIOS_L04_CR_DN:
007716 9553      	inc	temp
007717 9350 3f07 	sts	CURSOR_Y, temp
007719 cdfe      	rjmp	CURSOR_APPLY_XY			; next line
                 ;	ret
                 
                 
                 
                 BIOS_L04_BSP: 	; BackSpace
00771a 9150 3f06 	lds	temp, CURSOR_X
00771c 3052      	cpi	temp, 2
00771d f408      	brsh	BIOS_L04_BSP_DO
00771e 9508      	ret
                 BIOS_L04_BSP_DO:
00771f 955a      	dec	temp
007720 9350 3f06 	sts	CURSOR_X, temp
007722 cdf5      	rjmp	CURSOR_APPLY_XY
                 ;	ret
                 
                 
                 
                 BIOS_L04_CLRSCR:   ; CLR SCR ^L
007723 de6a      	rcall	SCREEN_CLEAR
                 
007724 940e 7e52 	call	CRISS_CLR_CLRSCR		; clear colors
                 
007726 932f
007727 9120 3f05
007729 7420
00772a 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
00772b f009      	breq	BIOS_L04_HOME
00772c d1a4      	rcall	ECON_ATTR_CLRSCR		; process attributes if required
                 
                 BIOS_L04_HOME:	; Corsor HOME
00772d 9290 3f06
00772f 9290 3f07
007731 dde6      	CURSOR_SET2 one, one
                 ;	rjmp	CURSOR_APPLY_XY		; is called from CURSOR_SET2
007732 9508      	ret
                 
                 
                 
                 BIOS_L04_BEEP:	; BEEP
007733 940e 8960 	call	SYSTEM_BEEP
007735 9508      	ret
                 
                 
                 
                 BIOS_L04_RIGHT: ; RIGHT
007736 9150 3f06 	lds	temp, CURSOR_X
007738 932f
007739 9120 3f0a
00773b 1752
00773c 912f      	cpmem	temp, CRT_CHARS
00773d f008      	brlo	BIOS_L04_RIGHT_DO
00773e 9508      	ret
                 BIOS_L04_RIGHT_DO:
00773f 9553      	inc	temp
007740 9350 3f06 	sts	CURSOR_X, temp
007742 cdd5      	rjmp	CURSOR_APPLY_XY
                 ;	rcall	CURSOR_APPLY_XY
                 ;	ret
                 
                 
                 
                 BIOS_L04_UP: 	; UP
007743 9150 3f07 	lds	temp, CURSOR_Y
007745 3052      	cpi	temp, 2
007746 f408      	brsh	BIOS_L04_UP_DO
007747 9508      	ret
                 BIOS_L04_UP_DO:
007748 955a      	dec	temp
007749 9350 3f07 	sts	CURSOR_Y, temp
00774b cdcc      	rjmp	CURSOR_APPLY_XY
                 ;	rcall	CURSOR_APPLY_XY
                 ;	ret
                 
                 
                 
                 BIOS_L04_CLRLN:	; clear current string
00774c 9290 3f06 	sts	CURSOR_X, one
00774e ddc9      	rcall	CURSOR_APPLY_XY			; goto pos = 1
00774f c051      	rjmp	BIOS_L04_CLREOL			; clear till the end of line
                 
                 
                 
                 BIOS_L04_CLRCUR:	; clear till end of screen
007750 93ff
007751 93ef      	pushw	Z				
007752 93bf
007753 93af      	pushw	X
007754 ef57      	ldi	temp, 0xf7			; RAM F8** address
007755 91e0 3f0d
007757 91f0 3f0e 	ldw	Z, VIDEO_CURSOR				
007759 0ff5      	add	ZH, temp
00775a 91a0 3f0b
00775c 91b0 3f0c 	ldw	X, VIDEO_END
00775e 0fb5      	add	XH, temp
                 BIOS_L04_CLRCUR_CL:
00775f e250      	ldi	temp, ' '                       ; char to fill
007760 b9f8
007761 b9e2
007762 b955
007763 b824
007764 15f6
007765 985d
007766 f100
007767 b82b
007768 935f
007769 e158
00776a b955
00776b eb5f
00776c b954
00776d e050
00776e bd5d
00776f e550
007770 bd5c
007771 9859
007772 915f
007773 982c
007774 935f
007775 2f5f
007776 940e 005f
007778 e054
007779 955a
00777a f7f1
00777b 2f5e
00777c 940e 005f
00777e e054
00777f 955a
007780 f7f1
007781 915f
007782 940e 005f
007784 bc5c
007785 9a59
007786 b854
007787 b82b      	STRAM	ZH, ZL, temp
007788 9631      	adiw	Z, 1
007789 17ea      	cp	ZL, XL
00778a 07fb      	cpc	ZH, XH
00778b f298      	brlo	BIOS_L04_CLRCUR_CL
00778c 91af
00778d 91bf      	popw	X
00778e 91ef
00778f 91ff      	popw	Z
                 
007790 932f
007791 9120 3f05
007793 7420
007794 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007795 f051      	breq	BIOS_L04_CLRCUR_L2
007796 93ff
007797 93ef      	pushw	Z
007798 91e0 3f0d
00779a 91f0 3f0e 	ldw	Z, VIDEO_CURSOR				
00779c d13d      	rcall	ECON_ATTR_CLR_Z			; clear attributes
00779d d158      	rcall	ECON_ATTR_CHAR			; set/restore attributes
00779e 91ef
00779f 91ff      	popw	Z
                 
                 BIOS_L04_CLRCUR_L2:	
0077a0 9508      	ret
                 
                 
                 
                 BIOS_L04_CLREOL:	; clear till end of line
0077a1 93df
0077a2 93cf      	pushw	Y				
0077a3 93ff
0077a4 93ef      	pushw	Z				
0077a5 936f      	push	zzC
                 
0077a6 ef57      	ldi	temp, 0xf7			; RAM F8** address
0077a7 91e0 3f0d
0077a9 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
0077ab 91c0 3f0d
0077ad 91d0 3f0e 	ldw	Y, VIDEO_CURSOR			; for ECON VIDEOBUF
0077af 0ff5      	add	ZH, temp
0077b0 9160 3f06 	lds	zzC, CURSOR_X
0077b2 956a      	dec	zzC				; for correct compare, zz=0..79
                 
                 BIOS_L04_CLREOL_CL:
0077b3 e250      	ldi	temp, ' '
0077b4 b9f8
0077b5 b9e2
0077b6 b955
0077b7 b824
0077b8 15f6
0077b9 985d
0077ba f100
0077bb b82b
0077bc 935f
0077bd e158
0077be b955
0077bf eb5f
0077c0 b954
0077c1 e050
0077c2 bd5d
0077c3 e550
0077c4 bd5c
0077c5 9859
0077c6 915f
0077c7 982c
0077c8 935f
0077c9 2f5f
0077ca 940e 005f
0077cc e054
0077cd 955a
0077ce f7f1
0077cf 2f5e
0077d0 940e 005f
0077d2 e054
0077d3 955a
0077d4 f7f1
0077d5 915f
0077d6 940e 005f
0077d8 bc5c
0077d9 9a59
0077da b854
0077db b82b      	STRAM	ZH, ZL, temp			; char to fill
                 
0077dc 932f
0077dd 9120 3f05
0077df 7420
0077e0 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
0077e1 f009      	breq	BIOS_L04_CLREOL_L2
0077e2 9259      	st	Y+, zero			; clear attribute
                 
                 BIOS_L04_CLREOL_L2:	
0077e3 9631      	adiw	Z, 1
0077e4 9563      	inc	zzC
0077e5 932f
0077e6 9120 3f0a
0077e8 1762
0077e9 912f      	cpmem	zzC, CRT_CHARS			; CON_CHARS
0077ea f240      	brlo	BIOS_L04_CLREOL_CL
                 
0077eb 932f
0077ec 9120 3f05
0077ee 7420
0077ef 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
0077f0 f009      	breq	BIOS_L04_CLREOL_L3
0077f1 d104      	rcall	ECON_ATTR_CHAR			; set/restore attributes
                 
                 BIOS_L04_CLREOL_L3:	
0077f2 916f      	pop	zzC
0077f3 91ef
0077f4 91ff      	popw	Z
0077f5 91cf
0077f6 91df      	popw	Y
0077f7 9508      	ret
                 
                 
                 BIOS_L04_CLRBOL:	; clear from start of line to cursor
0077f8 93df
0077f9 93cf      	pushw	Y				
0077fa 93ff
0077fb 93ef      	pushw	Z				
0077fc 936f      	push	zzC
                 
0077fd ef57      	ldi	temp, 0xf7			; RAM F8** address
0077fe 91e0 3f0d
007800 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
007802 91c0 3f0d
007804 91d0 3f0e 	ldw	Y, VIDEO_CURSOR			; for ECON VIDEOBUF
007806 0ff5      	add	ZH, temp
007807 9160 3f06 	lds	zzC, CURSOR_X
                 ;	dec	zzC				; for correct compare, zz=0..79
                 BIOS_L04_CLRBOL_CL:
007809 e250      	ldi	temp, ' '
00780a b9f8
00780b b9e2
00780c b955
00780d b824
00780e 15f6
00780f 985d
007810 f100
007811 b82b
007812 935f
007813 e158
007814 b955
007815 eb5f
007816 b954
007817 e050
007818 bd5d
007819 e550
00781a bd5c
00781b 9859
00781c 915f
00781d 982c
00781e 935f
00781f 2f5f
007820 940e 005f
007822 e054
007823 955a
007824 f7f1
007825 2f5e
007826 940e 005f
007828 e054
007829 955a
00782a f7f1
00782b 915f
00782c 940e 005f
00782e bc5c
00782f 9a59
007830 b854
007831 b82b      	STRAM	ZH, ZL, temp			; char to fill
                 
007832 932f
007833 9120 3f05
007835 7420
007836 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007837 f011      	breq	BIOS_L04_CLRBOL_L2
007838 8258      	st	Y, zero			; clear attribute
007839 9721      	sbiw	Y, 1
                 
                 BIOS_L04_CLRBOL_L2:	
00783a 9731      	sbiw	Z, 1
00783b 956a      	dec	zzC
                 ;	cpmem	zzC, CRT_CHARS			; CON_CHARS
00783c f661      	brne	BIOS_L04_CLRBOL_CL
                 
00783d 932f
00783e 9120 3f05
007840 7420
007841 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007842 f009      	breq	BIOS_L04_CLRBOL_L3
007843 d0b2      	rcall	ECON_ATTR_CHAR			; set/restore attributes
                 
                 BIOS_L04_CLRBOL_L3:	
007844 916f      	pop	zzC
007845 91ef
007846 91ff      	popw	Z
007847 91cf
007848 91df      	popw	Y
007849 9508      	ret
                 
                 
                 
                 BIOS_L04_CLR_BOS:	; clear from start of the screen to cursor
00784a 93df
00784b 93cf      	pushw	Y				
00784c 93ff
00784d 93ef      	pushw	Z				
                 ;	push	zzC
                 
00784e ef57      	ldi	temp, 0xf7			; RAM F8** address
00784f 91e0 3f0d
007851 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
007853 91c0 3f0d
007855 91d0 3f0e 	ldw	Y, VIDEO_CURSOR			; for ECON VIDEOBUF
007857 0ff5      	add	ZH, temp
                 ;	lds	zzC, CURSOR_X
                 ;	dec	zzC				; for correct compare, zz=0..79
                 BIOS_L04_CLRBOS_CL:
007858 e250      	ldi	temp, ' '
007859 b9f8
00785a b9e2
00785b b955
00785c b824
00785d 15f6
00785e 985d
00785f f100
007860 b82b
007861 935f
007862 e158
007863 b955
007864 eb5f
007865 b954
007866 e050
007867 bd5d
007868 e550
007869 bd5c
00786a 9859
00786b 915f
00786c 982c
00786d 935f
00786e 2f5f
00786f 940e 005f
007871 e054
007872 955a
007873 f7f1
007874 2f5e
007875 940e 005f
007877 e054
007878 955a
007879 f7f1
00787a 915f
00787b 940e 005f
00787d bc5c
00787e 9a59
00787f b854
007880 b82b      	STRAM	ZH, ZL, temp			; char to fill
                 
007881 932f
007882 9120 3f05
007884 7420
007885 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007886 f011      	breq	BIOS_L04_CLRBOS_L2
007887 8258      	st	Y, zero			; clear attribute
007888 9721      	sbiw	Y, 1
                 
                 BIOS_L04_CLRBOS_L2:	
007889 9731      	sbiw	Z, 1
                 ;	dec	zzC
                 ;	cpmem	zzC, CRT_CHARS			; CON_CHARS
00788a 3ff7      	cpi	ZH, 0xf7			; at the beginning of the screen here Z=f7FF
00788b f661      	brne	BIOS_L04_CLRBOS_CL
                 
00788c 932f
00788d 9120 3f05
00788f 7420
007890 912f      	cfmem	CRT_SETTINGS, CRT_USE_ATTR
007891 f009      	breq	BIOS_L04_CLRBOS_L3
007892 d063      	rcall	ECON_ATTR_CHAR			; set/restore attributes
                 
                 BIOS_L04_CLRBOS_L3:	
                 ;	pop	zzC
007893 91ef
007894 91ff      	popw	Z
007895 91cf
007896 91df      	popw	Y
007897 9508      	ret
                 
                 
                 
                 
                 BIOS_L04_TAB:	; TAB
007898 e250      	ldi	temp, ' '
007899 2f65      	mov	zzC, temp
00789a da60      	rcall	BIOS_L04_CHAR			; output ' '
00789b 9150 3f06 	lds	temp, CURSOR_X
00789d 955a      	dec	temp
00789e 7057      	andi	temp, 0x07                      ; check that TAB position reached
                 ;	cpi	temp, 0x07
00789f f7c1      	brne	BIOS_L04_TAB
0078a0 9508      	ret
                 
                 
                 
                 
                 BIOS_L04_CUROFF:	; cursor off
0078a1 935f
0078a2 e850
0078a3 9350 3f08
0078a5 915f              ststs	CURSOR_STATUS, 0x80
0078a6 cc92      	rjmp 	BIOS_SETCPDCURSOR
                 ;	ret
                 
                 
                 
                 
                 BIOS_L04_CURON:	; cursor on
0078a7 9250 3f08 	sts	CURSOR_STATUS, zero
0078a9 cc8f      	rjmp 	BIOS_SETCPDCURSOR
                 ;	ret
                 
                 #include "bios_attr.inc"
                 
                 BIOS_RESET:
0078aa 935f              push	temp
0078ab 937f              push	FROMRAM0
0078ac 920f              push	r0
0078ad 921f              push	r1
0078ae 93ff
0078af 93ef              pushw	Z
0078b0 9150 3f00 	lds	temp, HW_FLAG		; current platform
0078b2 e178      	ldi	FROMRAM0, 24		; hw descriptor block length
0078b3 9f57      	mul	temp, FROMRAM0
0078b4 e1e0
0078b5 e6fa      	ldiw2	Z, HW_OPTIONS
0078b6 0de0      	add	ZL, r0
0078b7 1df1      	adc	ZH, r1                  ; select HW platform descriptor address
0078b8 9670      	adiw	Z, 16			; skip title, goto parameters
0078b9 9157      	elpm	temp, Z+
0078ba 9350 3f09 	sts	CRT_LINES, temp		; codepage after restore
0078bc 9157      	elpm	temp, Z+
0078bd 9350 3f0a 	sts	CRT_CHARS, temp		; codepage after restore
0078bf 9157      	elpm	temp, Z+
0078c0 9350 3f05 	sts	CRT_SETTINGS, temp	; codepage after restore
0078c2 91ef
0078c3 91ff      	popw	Z
0078c4 901f      	pop	r1
0078c5 900f      	pop	r0
0078c6 917f      	pop	FROMRAM0
0078c7 915f      	pop	temp
                 
0078c8 9250 091c 	sts	CON_ESC, zero
0078ca 9250 0927 	sts	CON_ATTR_XOR, zero
0078cc 9250 0928 	sts	CON_ATTR_OR, zero
0078ce 9250 3f08 	sts	CURSOR_STATUS, zero	; show cursor
                 ;	sts	CURSOR_X, one
                 ;	sts	CURSOR_Y, one		; cursor home p
0078d0 dd40      	rcall	BIOS_SET_VIDEO_MODE
                 	; proceed to ECON_ATTR_CLRSCR
                 
                 
                 ECON_ATTR_CLRSCR:
0078d1 93ff
0078d2 93ef      	pushw	Z
0078d3 e0e0
0078d4 e0f1      	ldiw	Z, VIDEOBUF
0078d5 d004      	rcall	ECON_ATTR_CLR_Z
0078d6 91ef
0078d7 91ff      	popw	Z
0078d8 9508      	ret
                 
                 
                 
                 BIOS_ATTR_CLR_Z_L1:
0078d9 9251      	st	Z+, zero
                 ECON_ATTR_CLR_Z:
0078da 3de0      	cpi	ZL, low(VIDEOBUF_END)
0078db f7e9      	brne	BIOS_ATTR_CLR_Z_L1
0078dc 30f8      	cpi	ZH, high(VIDEOBUF_END)
0078dd f7d9      	brne	BIOS_ATTR_CLR_Z_L1
0078de 9508      	ret
                 
                 
                 
                 	; set attr value in zzC for current char
                 ECON_SET_ATTR:
0078df 93ff
0078e0 93ef      	pushw	Z
0078e1 935f      	push	temp
0078e2 91e0 3f0d
0078e4 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
0078e6 6860      	ori	zzC, 0x80		; set 7th bit == attr start point
0078e7 9361      	st	Z+, zzC			; set attribute
0078e8 776f      	andi	zzC, 0x7f		; clear 7th bit
0078e9 c004      	rjmp	ECON_SET_ATTR_L2
                 
                 ECON_SET_ATTR_L1:
0078ea 8150      	ld	temp, Z			; check attr value
0078eb 7850      	andi	temp, 0x80		; new attr?
0078ec f429      	brne 	ECON_SET_ATTR_L3	; yes = stop
0078ed 9361      	st	Z+, zzC		; set attribute
                 ECON_SET_ATTR_L2:
0078ee 3de0      	cpi	ZL, low(VIDEOBUF_END)
0078ef f7d1      	brne	ECON_SET_ATTR_L1
0078f0 30f8      	cpi	ZH, high(VIDEOBUF_END)
0078f1 f7c1      	brne	ECON_SET_ATTR_L1
                 
                 ECON_SET_ATTR_L3:
0078f2 915f      	pop	temp
0078f3 91ef
0078f4 91ff      	popw	Z
0078f5 9508      	ret
                 
                 
                 
                 
                 	; check that char replces attrribute
                 ECON_ATTR_CHAR:
0078f6 93ff
0078f7 93ef      	pushw	Z
0078f8 935f      	push	temp
0078f9 91e0 3f0d
0078fb 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
0078fd 8150      	ld	temp, Z
0078fe 7850      	andi	temp, 0x80		; is there active attribute?
0078ff f0f1      	breq	ECON_CHAR_ATTR_RET	; no - no attention
007900 8250      	st	Z, zero			; clear attr
007901 c003      	rjmp	ECON_CHAR_ATTR_L2
                 ECON_CHAR_ATTR_L1:
                 ;	st	Z-, zero
007902 9152      	ld	temp, -Z		; check attr
007903 7850      	andi	temp, 0x80
007904 f429      	brne	ECON_CHAR_ATTR_L3	; attribute found - process it!
                 ECON_CHAR_ATTR_L2:
007905 30e0      	cpi	ZL, low(VIDEOBUF)
007906 f7d9      	brne	ECON_CHAR_ATTR_L1
007907 30f1      	cpi	ZH, high(VIDEOBUF)
007908 f7c9      	brne	ECON_CHAR_ATTR_L1
007909 e050      	ldi	temp, 0
                 
                 ECON_CHAR_ATTR_L3:
00790a 93df
00790b 93cf      	pushw	Y
00790c 936f      	push	zzC
00790d 2f65      	mov	zzC, temp
00790e 91c0 3f0d
007910 91d0 3f0e 	ldw	Y, VIDEO_CURSOR		; save cursor
007912 93e0 3f0d
007914 93f0 3f0e 	stw	VIDEO_CURSOR, Z
007916 dfc8      	rcall	ECON_SET_ATTR
007917 93c0 3f0d
007919 93d0 3f0e 	stw	VIDEO_CURSOR, Y		; restore cursor
00791b 916f      	pop	zzC
00791c 91cf
00791d 91df      	popw	Y
                 
                 ECON_CHAR_ATTR_RET:
00791e 915f      	pop	temp
00791f 91ef
007920 91ff      	popw	Z
007921 9508      	ret
                 
                 
                 
                 	; return attr in temp
                 ECON_GET_ATTR:
007922 93ff
007923 93ef      	pushw	Z
007924 91e0 3f0d
007926 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
007928 8150      	ld	temp, Z
007929 fd57      	sbrc	temp, 7			; attr starts here? yes - return previous
00792a c003      	rjmp	ECON_GET_ATTR_L1
                 ECON_GET_ATTR_ret:
00792b 91ef
00792c 91ff      	popw	Z
00792d 9508      	ret
                 ECON_GET_ATTR_L1:
00792e 30f1      	cpi	ZH, high(VIDEOBUF)
00792f f421      	brne	ECON_GET_ATTR_L2
007930 30e0      	cpi	ZL, low(VIDEOBUF)
007931 f411      	brne	ECON_GET_ATTR_L2
007932 2755      	clr	temp			; first char - clear attributes
007933 cff7      	rjmp	ECON_GET_ATTR_ret
                 ECON_GET_ATTR_L2:
007934 9152      	ld	temp, -Z
007935 cff5      	rjmp	ECON_GET_ATTR_ret	; return previous char
                 
                 
                 	; scroll attr screen
                 ECON_ATTR_SCROLL:
007936 93ff
007937 93ef      	pushw	Z
007938 93df
007939 93cf      	pushw	Y
00793a 93bf
00793b 93af      	pushw	X
00793c 935f      	push	temp
00793d 936f      	push	zzC
00793e e5e0
00793f e0f1
007940 e8c0
007941 e0d7
007942 e0a0
007943 e0b1
007944 940e 89ac 	ZXYf	VIDEOBUF+80, VIDEOBUF, 24*80	; scroll attributes
                 
007946 e550      	ldi	temp, 80
007947 e7ef
007948 e0f8      	ldiw	Z, VIDEOBUF+24*80-1
007949 9161      	ld	zzC, Z+				; get attr value for last line
                 ECON_SCROLL_L1:
00794a 9361      	st	Z+, zzC
00794b 955a      	dec	temp
00794c f7e9      	brne	ECON_SCROLL_L1			; fill last line
                 
00794d 916f      	pop	zzC
00794e 915f      	pop	temp
00794f 91af
007950 91bf      	popw	X
007951 91cf
007952 91df      	popw	Y
007953 91ef
007954 91ff      	popw	Z
007955 9508      	ret
                 
                 
                 
                 ECON_CRT_ATTR:
007956 df88      	rcall	ECON_SET_ATTR			; set attr
007957 e36a      	ldi	zzC, ':'			;!!!! debug!!!!!!
007958 d9af      	rcall	BIOS_L04_CHAR_CHAROUT		; echo special char on the place of attribute
007959 9508      	ret
                 
                 
                 /*
                 ECON_REFRESH_SCREEN:
                 	pushw	Z
                 	push	zzC
                 	push	temp
                 	ldiw	Z, VIDEOBUF
                 	subi	ZH, -0xf7
                 ECON_REFRESH_SCREEN_L2:
                 	LDRAM	ZH, ZL, zzC			; get screen symbol
                 	push	zzC
                 	call	HW_CONOUT_CHAR
                 	pop	temp
                 	cp	temp, zzC
                 	breq	ECON_REFRESH_SCREEN_L1
                 	STRAM	ZH, ZL, zzC			; replace symbol
                 ECON_REFRESH_SCREEN_L1:
                 	add	ZL, one
                 	adc	ZH, zero
                 	cpi	ZL, low(VIDEOBUF_END)
                 	brne	ECON_REFRESH_SCREEN_L2
                 	cpi	ZH, high(VIDEOBUF_END)
                 	brne	ECON_REFRESH_SCREEN_L2
                 	pop	temp
                 	pop	zzC
                 	popw	Z
                 	ret
                 
                 #include "bios_esc.inc"
                 
00795a 2f56      	mov	temp, zzC
00795b 3354
00795c f409
00795d cf49      	tcbe	'4', BIOS_L04_CURON		; B4 cursor on
00795e 3356
00795f f409
007960 c004      	tcbe	'6', BIOS04_ESC_KAYPRO_B6	; store cursor popsition
007961 3553
007962 f409
007963 c2fb      	tcbe	'S', BIOS04_ESC_CRISS_BS	; store screen to VIDEOBUF
007964 9508      	ret
                 
                 BIOS04_ESC_CUR_STORE:
                 BIOS04_ESC_KAYPRO_B6:
007965 9150 3f06 	lds	temp, CURSOR_X
007967 9350 0925 	sts	CON_CPPOS_X, temp
007969 9150 3f07 	lds	temp, CURSOR_Y
00796b 9350 0926 	sts	CON_CPPOS_Y, temp
00796d 9508      	ret
                 
                 BIOS04_ESC_KAYPRO_C:
00796e 2f56      	mov	temp, zzC
00796f 3354
007970 f409
007971 cf2f      	tcbe	'4', BIOS_L04_CUROFF		; B4 cursor off
007972 3356
007973 f409
007974 c004      	tcbe	'6', BIOS04_ESC_KAYPRO_C6	; restore cursor position
007975 3553
007976 f409
007977 c302      	tcbe	'S', BIOS04_ESC_CRISS_CS	; restore screen from videobuf
007978 9508      	ret
                 
                 BIOS04_ESC_CUR_RESTORE:
                 BIOS04_ESC_KAYPRO_C6:
007979 9150 0925 	lds	temp, CON_CPPOS_X
00797b 9350 3f06 	sts	CURSOR_X, temp
00797d 9150 0926 	lds	temp, CON_CPPOS_Y
00797f 9350 3f07 	sts	CURSOR_Y, temp
007981 cb96      	rjmp	CURSOR_APPLY_XY
                 ;	ret
                 
                 	; #9 x = set x position
                 BIOS04_ESC_CRISS_09:
007982 932f
007983 9120 3f0a
007985 1762
007986 912f              cpmem	zzC, CRT_CHARS
                 ;	cpi	zzC, 81
007987 f009      	breq	_bios4_09_l1
007988 f418      	brsh	BIOS04_ESC_CRISS_09_ret
                 _bios4_09_l1:
007989 9360 3f06 	sts	CURSOR_X, zzC
00798b cb8c      	rjmp	CURSOR_APPLY_XY
                 BIOS04_ESC_CRISS_09_ret:
00798c 9508      	ret
                 
                 
                 	; '\' char - out char from #1..#30
                 BIOS04_ESC_CRISS_OUT:
00798d 940c 7300 	jmp	BIOS_L04_CHAR_L1		; just output char
                 ;	ret
                 
                 
                 	; 127+y, 127+x = cursor positioning
                 BIOS04_ESC_ROB_CUR:
00798f 9150 091d 	lds	temp, CON_ESC_C1
007991 575f      	subi	temp, 0x7f
007992 576f      	subi	zzC, 0x7f
                 
                 BIOS04_ESC_CUR_SET:				; temp = y, zzC = x
007993 932f
007994 9120 3f09
007996 1752
007997 912f              cpmem	temp, CRT_LINES
007998 f009              breq	_bios4_cur_set_l2
                 ;	cpi	temp, 26
007999 f460      	brsh	BIOS04_ESC_ROB_CUR_ret
                 _bios4_cur_set_l2:
00799a 932f
00799b 9120 3f0a
00799d 1762
00799e 912f              cpmem	zzC, CRT_CHARS
00799f f009              breq	_bios4_cur_set_l1
                 ;	cpi	zzC, 81
0079a0 f428      	brsh	BIOS04_ESC_ROB_CUR_ret
                 _bios4_cur_set_l1:
0079a1 9350 3f07 	sts	CURSOR_Y, temp
0079a3 9360 3f06 	sts	CURSOR_X, zzC
0079a5 cb72      	rjmp	CURSOR_APPLY_XY
                 BIOS04_ESC_ROB_CUR_ret:
0079a6 9508      	ret
                 
                 	; = row+32 col+32 = cursor positioning
                 BIOS04_ESC_KAYPRO_CUR:
0079a7 9150 091e 	lds	temp, CON_ESC_C2
0079a9 515f      	subi	temp, 31
0079aa 516f      	subi	zzC, 31
0079ab cfe7      	rjmp	BIOS04_ESC_CUR_SET
                 
                 
                 
                 	; Y line col - Position cursor
                 BIOS04_ESC_TRS_CUR:
0079ac 9150 091e 	lds	temp, CON_ESC_C2
0079ae 9553      	inc	temp
0079af 9563      	inc	zzC
0079b0 cfe2      	rjmp	BIOS04_ESC_CUR_SET
                 
                 
                 
                 
                 BIOS_ESC_KAYPRO_E:			; insert line
0079b1 9150 3f06         lds	temp, CURSOR_X
0079b3 935f              push	temp			; save to restore
0079b4 9290 3f06 	sts	CURSOR_X, one
0079b6 db44      	rcall	CURSOR_XY_PTR		; make pointer
                 			
0079b7 93bf
0079b8 93af      	pushw	X
0079b9 93df
0079ba 93cf      	pushw	Y
0079bb 93ff
0079bc 93ef      	pushw	Z
0079bd 933f      	push	r19
                 
0079be 9150 3f07         lds	temp, CURSOR_Y
0079c0 932f
0079c1 9120 3f09
0079c3 1752
0079c4 912f              cpmem	temp, CRT_LINES
0079c5 f008              brlo	_bios_esc_b_L4
0079c6 c04a              rjmp	_bios_esc_b_L3		; last line - just clear last ine
                 
                 _bios_esc_b_L4:
0079c7 ef57      	ldi	temp, 0xf7
                 
0079c8 91c0 3f0d
0079ca 91d0 3f0e 	ldw	Y, VIDEO_CURSOR
0079cc 0fd5      	add	YH, temp
                 ;	sbiw	Y, 1			; for correct brsh
                 
0079cd 91e0 3f0b
0079cf 91f0 3f0c 	ldw	Z, VIDEO_END		; copy to (backward)
0079d1 0ff5      	add	ZH, temp
                 
0079d2 91a0 3f0b
0079d4 91b0 3f0c 	ldw	X, VIDEO_END		; 
0079d6 0fb5      	add	XH, temp
0079d7 9150 3f0a 	lds	temp, CRT_CHARS
0079d9 1ba5      	sub	XL, temp
0079da 09b5      	sbc	XH, zero		; copy from
                 ;	sbiw	X, 40
                 ;	sbiw	X, 40			; copy from
                 
                 _bios_esc_b_L1:
0079db 9711      	sbiw	X, 1
0079dc 9731      	sbiw	Z, 1
0079dd 17ac      	cp	XL, YL
0079de 07bd      	cpc	XH, YH
0079df f188      	brlo	_bios_esc_b_L3
0079e0 b9b8
0079e1 b9a2
0079e2 b854
0079e3 b83b
0079e4 0000
0079e5 0000
0079e6 b133
0079e7 b82b      	LDRAM 	XH, XL, r19		; read char from zRAM
0079e8 b9f8
0079e9 b9e2
0079ea b935
0079eb b824
0079ec 15f6
0079ed 985d
0079ee f100
0079ef b82b
0079f0 935f
0079f1 e158
0079f2 b955
0079f3 eb5f
0079f4 b954
0079f5 e050
0079f6 bd5d
0079f7 e550
0079f8 bd5c
0079f9 9859
0079fa 915f
0079fb 982c
0079fc 933f
0079fd 2f5f
0079fe 940e 005f
007a00 e054
007a01 955a
007a02 f7f1
007a03 2f5e
007a04 940e 005f
007a06 e054
007a07 955a
007a08 f7f1
007a09 915f
007a0a 940e 005f
007a0c bc5c
007a0d 9a59
007a0e b854
007a0f b82b      	STRAM	ZH, ZL, r19
007a10 cfca      	rjmp	_bios_esc_b_L1		; loop
                 
                 _bios_esc_b_L3:
007a11 dd8f              rcall	BIOS_L04_CLREOL		; clr line
                 
                 BIOS_ESC_B_RE_RET:	
007a12 913f      	pop	r19
007a13 91ef
007a14 91ff      	popw	Z
007a15 91cf
007a16 91df      	popw	Y
007a17 91af
007a18 91bf      	popw	X                       ; restore registers
                 
007a19 915f      	pop	temp
007a1a 9350 3f06 	sts	CURSOR_X, temp
007a1c cade      	rjmp	CURSOR_XY_PTR		; just restore pointer, position not changed
                 	
                 ;	ret
                 
                 
                 
                 BIOS_ESC_KAYPRO_R:			; delete line
007a1d 9150 3f06         lds	temp, CURSOR_X
007a1f 935f              push	temp			; save to restore
007a20 9290 3f06 	sts	CURSOR_X, one
007a22 dad8      	rcall	CURSOR_XY_PTR		
                 
007a23 93bf
007a24 93af      	pushw	X
007a25 93df
007a26 93cf      	pushw	Y
007a27 93ff
007a28 93ef      	pushw	Z
007a29 933f      	push	r19
                 
007a2a 9150 3f07         lds	temp, CURSOR_Y
007a2c 932f
007a2d 9120 3f09
007a2f 1752
007a30 912f              cpmem	temp, CRT_LINES
007a31 f008              brlo	_bios_esc_e_L4
007a32 c04b              rjmp	_bios_esc_e_L3		; last line - just clear, for the case pf 25th line
                 
                 _bios_esc_e_L4:
007a33 ef57      	ldi	temp, 0xf7
                 
007a34 91c0 3f0b
007a36 91d0 3f0c 	ldw	Y, VIDEO_END		; end point for compare
007a38 0fd5      	add	YH, temp
007a39 9621      	adiw	Y, 1			; for correst brsh
                 
007a3a 91a0 3f0d
007a3c 91b0 3f0e 	ldw	X, VIDEO_CURSOR		; copy to
007a3e 0fb5      	add	XH, temp
                 
007a3f 91e0 3f0d
007a41 91f0 3f0e 	ldw	Z, VIDEO_CURSOR		; 
007a43 0ff5      	add	ZH, temp
007a44 9150 3f0a 	lds	temp, CRT_CHARS
007a46 1ba5      	sub	XL, temp
007a47 09b5      	sbc	XH, zero		; copy from
                 ;	adiw	Z, 40
                 ;	adiw	Z, 40			; copy from next line
                 
                 _bios_esc_e_L1:
007a48 17ec      	cp	ZL, YL
007a49 07fd      	cpc	ZH, YH
007a4a f598      	brsh	_bios_esc_e_L3
007a4b b9f8
007a4c b9e2
007a4d b854
007a4e b83b
007a4f 0000
007a50 0000
007a51 b133
007a52 b82b      	LDRAM 	ZH, ZL, r19		; read char from zRAM
007a53 b9b8
007a54 b9a2
007a55 b935
007a56 b824
007a57 15b6
007a58 985d
007a59 f100
007a5a b82b
007a5b 935f
007a5c e158
007a5d b955
007a5e eb5f
007a5f b954
007a60 e050
007a61 bd5d
007a62 e550
007a63 bd5c
007a64 9859
007a65 915f
007a66 982c
007a67 933f
007a68 2f5b
007a69 940e 005f
007a6b e054
007a6c 955a
007a6d f7f1
007a6e 2f5a
007a6f 940e 005f
007a71 e054
007a72 955a
007a73 f7f1
007a74 915f
007a75 940e 005f
007a77 bc5c
007a78 9a59
007a79 b854
007a7a b82b      	STRAM	XH, XL, r19
007a7b 9611      	adiw	X, 1
007a7c 9631      	adiw	Z, 1
007a7d cfca      	rjmp	_bios_esc_e_L1
                 
                 _bios_esc_e_L3:
007a7e 9150 3f07         lds	temp, CURSOR_Y
007a80 935f              push	temp
007a81 9150 3f09         lds	temp, CRT_LINES
007a83 9350 3f07         sts	CURSOR_Y, temp
007a85 da75      	rcall	CURSOR_XY_PTR		
                 
007a86 dd1a              rcall	BIOS_L04_CLREOL		; clr line
                 
007a87 915f              pop	temp
007a88 9350 3f07         sts	CURSOR_Y, temp		; restore cursor position
                 
007a8a cf87      	rjmp	BIOS_ESC_B_RE_RET	; clear last line
                 
                 
                 	; Z * - set mode, zzC = mode
                 BIOS04_ESC_CRISS_ZG:
007a8b 935f      	push	temp
007a8c 936f              push	zzC
007a8d 9566              lsr	zzC
007a8e 9566              lsr	zzC
007a8f 9566              lsr	zzC
007a90 9360 3f09 	sts	CRT_LINES, zzC	; store lines no
007a92 9310 3f0a 	sts	CRT_CHARS, zzA	; store chars no
007a94 916f      	pop	zzC
007a95 7067      	andi	zzC, 0x07
                 ;	lds	temp, CRT_SETTINGS
                 ;	andi	temp, 0b01000000	; preserve attr option
007a96 9360 3f05 	sts	CRT_SETTINGS, zzC	; store codepage
                 ;	nportout cpd_vstat, zzC	; change display mode
                 
007a98 9290 3f06
007a9a 9290 3f07
007a9c da7b      	CURSOR_SET2 one, one		; home cursor
007a9d daf0      	rcall	SCREEN_CLEAR		; clear screen
                 
007a9e db72      	rcall	BIOS_SET_VIDEO_MODE	; set video mode
007a9f 915f      	pop	temp
007aa0 9508      	ret
                 
                 
                 
                 .MACRO  SGM
                         cpi	temp, @0
                         brne	_sgm_not
                         ldi	zzA, @2
                 	ldi	zzC, ((@1)<<3)|(@3) 
                 ;	rcall 	BIOS04_ESC_CRISS_ZG
                 _sgm_not:
                 .ENDM
                 
                 	; G 0-3 - set ZG page 0,2,3,4
                 	; G 4 - set graph mode
                 	; G 5 - set 25 lines / 0
                 	; G S - set 24 lines special mode
                 	; G 6,7 - set 30*64 lines
                 	; G 8,9 - set 31*64 lines
                 	; G N - default text mode
                 	; G s - sleep
                 	; G w - wake up
                 BIOS04_ESC_TRS_GRMODE:
007aa1 3763              cpi	zzC, 's'		; sleep mode
007aa2 f459              brne	_etgrm_notsleepcmd
007aa3 e050
007aa4 940e 720c 	nportin cpd_vstat
007aa6 9350 0929 	sts	VSTAT_SAVED, temp	; store for wakeup
007aa8 9250 090f
007aaa e050
007aab 940e 720a 	nportout cpd_vstat, zero	; goto sleep mode
007aad 9508      	ret
                 
                 _etgrm_notsleepcmd:        
007aae 3767              cpi	zzC, 'w'		; sleep mode
007aaf f441              brne	_etgrm_notwakeupcmd
007ab0 9160 0929 	lds	zzC, VSTAT_SAVED	; restore saved settings
007ab2 9360 090f
007ab4 e050
007ab5 940e 720a 	nportout cpd_vstat, zzC		; goto sleep mode
007ab7 9508      	ret
                 
                 _etgrm_notwakeupcmd:
007ab8 931f              push	zzA
007ab9 2f56              mov	temp, zzC
007aba e010              ldi	zzA, 0
007abb 3350
007abc f411
007abd e510
007abe ec60      	SGM	'0', 24, 80, 0
007abf 3351
007ac0 f411
007ac1 e510
007ac2 ec62      	SGM	'1', 24, 80, 2
007ac3 3352
007ac4 f411
007ac5 e510
007ac6 ec63      	SGM	'2', 24, 80, 3
007ac7 3353
007ac8 f411
007ac9 e510
007aca ec64      	SGM	'3', 24, 80, 4
007acb 3354
007acc f411
007acd e510
007ace ec61      	SGM	'4', 24, 80, 1		; graph mode
007acf 3355
007ad0 f411
007ad1 e510
007ad2 ec68      	SGM	'5', 25, 80, 0		; 25 lines
007ad3 3553
007ad4 f411
007ad5 e510
007ad6 ec67      	SGM	'S', 24, 80, 7		; special mode!
007ad7 3356
007ad8 f411
007ad9 e410
007ada ef60      	SGM	'6', 30, 64, 0		; 30 lines 64 chars
007adb 3357
007adc f411
007add e410
007ade ef64      	SGM	'7', 30, 64, 4		; 30 lines 64 chars
007adf 3358
007ae0 f411
007ae1 e410
007ae2 ef68      	SGM	'8', 31, 64, 0		; 31 lines 64 chars
007ae3 3359
007ae4 f411
007ae5 e410
007ae6 ef6c      	SGM	'9', 31, 64, 4		; 31 lines 64 chars
007ae7 1115      	cpse	zzA, zero
007ae8 dfa2      	rcall	BIOS04_ESC_CRISS_ZG
007ae9 911f      	pop	zzA
                 
007aea 345e              cpi	temp, 'N'		; set default text mode = reset
007aeb f461              brne	_etgrm_ret
                 
007aec 931f      	push	zzA
007aed e210      	ldi	zzA, ' '		; fill with spaces in text mode
007aee da62      	rcall	SCREEN_CLEAR_A
007aef 911f      	pop	zzA
007af0 9250 3f08 	sts	CURSOR_STATUS, zero	; show cursor
007af2 9290 3f06 	sts	CURSOR_X, one
007af4 9290 3f07 	sts	CURSOR_Y, one
007af6 d1ff      	rcall	_bios_cw_err		; reset CRISS frame window
007af7 cdb2              rjmp	BIOS_RESET
                 _etgrm_ret:
007af8 9508      	ret
                 
                 
                 ;---------------------------------------------------------------
                 BIOS04_ESC_GETPIX:
007af9 920f      	push	r0
007afa 921f      	push	r1
                 
007afb 9150 091e 	lds	temp, CON_ESC_C2	; y
007afd 3651      	cpi	temp, 97		; y<=96
007afe f528      	brsh	_gpi_err
                 
007aff eff8      	ldi	ZH, 0xf8		; videram
                 ;	ldi	ZL, 80                  ; chars per line
007b00 91e0 3f0a 	lds	ZL, CRT_CHARS           ; chars per line
007b02 9556      	lsr	temp
007b03 9556      	lsr	temp			; div 4 - line received 
007b04 9f5e      	mul	temp, ZL
007b05 0df1      	add	ZH, r1
007b06 2de0      	mov	ZL, r0			; Y = y,0
                 
007b07 2f56      	mov	temp, zzC		; x
007b08 3a51      	cpi	temp, 161		; x<=160
007b09 f4d0      	brsh	_gpi_err
                 
007b0a 9556      	lsr	temp			; div 2 - pos received
007b0b 0fe5      	add	ZL, temp
007b0c 1df5      	adc	ZH, zero		; Y = pixel byte
                 
007b0d e011      	ldi	zzA, 1
007b0e 9150 091e 	lds	temp, CON_ESC_C2	; y
007b10 7053      	andi	temp, 0x03		; y mod 4
007b11 0f55      	lsl	temp			; temp *= 2
                 ;	inc	temp
007b12 fd60      	sbrc	zzC, 0			; zzC mod 2
007b13 9553      	inc	temp			; temp = bit number ; font > 1.12 !!!
                 
007b14 3050      	cpi	temp, 0
007b15 f019      	breq	_gpi_l1
                 _gpi_l2:
007b16 0f11      	lsl	zzA
007b17 955a      	dec	temp
007b18 f7e9      	brne	_gpi_l2
                 _gpi_l1:				; zzA = 1<<temp
007b19 b9f8
007b1a b9e2
007b1b b854
007b1c b83b
007b1d 0000
007b1e 0000
007b1f b153
007b20 b82b      	LDRAM   ZH, ZL, temp		; load byte from RAM to temp
                 _gpi_exit:				; zzA = 1<<temp
007b21 901f      	pop	r1
007b22 900f      	pop	r0
007b23 9508      	ret
                 _gpi_err:
007b24 e0f0      	ldi	ZH, 0
007b25 cffb      	rjmp	_gpi_exit
                 ;---------------------------------------------------------------
                 
                 
                 BIOS04_ESC_SETPIX:
007b26 3ff8      	cpi	ZH, 0xF8
007b27 f140      	brlo	_spix_l0		; check that address is correct
007b28 b9f8
007b29 b9e2
007b2a b955
007b2b b824
007b2c 15f6
007b2d 985d
007b2e f100
007b2f b82b
007b30 935f
007b31 e158
007b32 b955
007b33 eb5f
007b34 b954
007b35 e050
007b36 bd5d
007b37 e550
007b38 bd5c
007b39 9859
007b3a 915f
007b3b 982c
007b3c 935f
007b3d 2f5f
007b3e 940e 005f
007b40 e054
007b41 955a
007b42 f7f1
007b43 2f5e
007b44 940e 005f
007b46 e054
007b47 955a
007b48 f7f1
007b49 915f
007b4a 940e 005f
007b4c bc5c
007b4d 9a59
007b4e b854
007b4f b82b      	STRAM   ZH, ZL, temp		; get byte to temp
                 _spix_l0:
007b50 9508      	ret
                 
                 
                 ; --------------------------------------------------
                 ; set pixel YH = y, YL = x, FROMRAM2 = mode: L=set,x=toggle,D=clear
                 CRISS_PUTPIX_Y:
                 ;	call gmln_debug
                 	; putpixel
                 
007b51 935f      	push	temp
007b52 931f      	push	zzA
007b53 93ff
007b54 93ef      	pushw	Z
007b55 93d0 091e 	sts	CON_ESC_C2, YH		; y
007b57 2f6c      	mov	zzC, YL			; x
007b58 dfa0      	rcall	BIOS04_ESC_GETPIX
                 
                 	; set/change point
007b59 342c      	cpi	FROMRAM2, 'L'		; set?
007b5a f411      	brne	_gmln_l8
007b5b 2b51      	or	temp, zzA
007b5c c006      	rjmp	_gmln_l10
                 _gmln_l8:
007b5d 3728      	cpi	FROMRAM2, 'x'		; invert?
007b5e f411      	brne	_gmln_l9
007b5f 2751      	eor	temp, zzA
007b60 c002      	rjmp	_gmln_l10
                 _gmln_l9:
                 ;	cpi	FROMRAM2, 'D'		; clear?
                 ;	brne	_gmln_l9
007b61 9510      	com	zzA
007b62 2351      	and	temp, zzA
                 ;	rjmp	_gmln_l10
                 _gmln_l10:
007b63 dfc2      	rcall	BIOS04_ESC_SETPIX
007b64 91ef
007b65 91ff      	popw	Z
007b66 911f      	pop	zzA
007b67 915f      	pop	temp
007b68 9508      	ret
                 
                 ;GR_PIX_ORDER:	.DB	2,1,8,4,32,16,128,64
                 
                 	; * line col - put pixel
                 BIOS04_ESC_KAYPRO_PUTPIX:
007b69 93ff
007b6a 93ef      	pushw	Z
007b6b 931f      	push	zzA
007b6c df8c      	rcall	BIOS04_ESC_GETPIX
007b6d 2b51      	or	temp, zzA
007b6e dfb7      	rcall	BIOS04_ESC_SETPIX
007b6f 911f      	pop	zzA
007b70 91ef
007b71 91ff      	popw	Z
007b72 9508      	ret
                 	
                 	; ' ' line col - put pixel
                 BIOS04_ESC_KAYPRO_CLRPIX:
007b73 93ff
007b74 93ef      	pushw	Z
007b75 931f      	push	zzA
007b76 df82      	rcall	BIOS04_ESC_GETPIX
007b77 9510      	com	zzA
007b78 2351      	and	temp, zzA
007b79 dfac      	rcall	BIOS04_ESC_SETPIX
007b7a 911f      	pop	zzA
007b7b 91ef
007b7c 91ff      	popw	Z
007b7d 9508      	ret
                 
                 	; '#' line col - toggle pixel
                 BIOS04_ESC_CRISS_TGLPIX:
007b7e 93ff
007b7f 93ef      	pushw	Z
007b80 931f      	push	zzA
007b81 df77      	rcall	BIOS04_ESC_GETPIX
007b82 2751      	eor	temp, zzA
007b83 dfa2      	rcall	BIOS04_ESC_SETPIX
007b84 911f      	pop	zzA
007b85 91ef
007b86 91ff      	popw	Z
007b87 9508      	ret
                 
                 
                 BIOS04_ESC_CRISS_SWP:
007b88 9508      	ret
                 
                 	; windows and frames
                 BIOS04_ESC_CRISS_F:
                 BIOS04_ESC_CRISS_DF:
                 BIOS04_ESC_CRISS_VP:
                 BIOS04_ESC_CRISS_CLR:
007b89 9508      	ret
                 	
                 
                 BIOS04_ESC_KAYPRO_PUTLN:
                 BIOS04_ESC_KAYPRO_CLRLN:
                 BIOS04_ESC_CRISS_INVLN:
007b8a 931f      	push	zzA
007b8b 937f      	push	FROMRAM0
007b8c 932f      	push	FROMRAM2
007b8d 920f      	push	r0
007b8e 921f      	push	r1
007b8f 93bf
007b90 93af      	pushw	X
007b91 93df
007b92 93cf      	pushw	Y
007b93 93ff
007b94 93ef      	pushw	Z
007b95 91d0 091e 	lds	YH, CON_ESC_C2		; v1
007b97 91c0 091f 	lds	YL, CON_ESC_C3		; h1
007b99 91b0 0920 	lds	XH, CON_ESC_C4		; v2
007b9b 91a0 0921 	lds	XL, CON_ESC_C5		; h2
                 
                 ;	sts	CON_ESC, zero
                 ;	lds	zzC, CON_ESC_C1		; command to do
                 ;	ldi	temp, BIOS_FUNC_CONOUT
                 ;	call	BIOS
                 ;	rjmp	_gmln_end
                 
007b9d 17db      	cp	YH, XH
007b9e f028      	brlo	_gmln_l1
007b9f f041      	breq	_gmln_l2
007ba0 2f5d      	mov	temp, YH		; YH>XH
007ba1 1b5b      	sub	temp, XH
007ba2 efbf      	ldi	XH, -1			; IX=-1
007ba3 c006      	rjmp	_gmln_l3
                 _gmln_l1:
007ba4 2f5b      	mov	temp, XH		; YH<XH
007ba5 1b5d      	sub	temp, YH
007ba6 e0b1      	ldi	XH, 1			; IX=1
007ba7 c002      	rjmp	_gmln_l3
                 _gmln_l2:
007ba8 e050      	ldi	temp, 0			; XH=YH
007ba9 e0b0      	ldi	XH, 0			; IX=0
                 _gmln_l3:
007baa 2e15      	mov	r1, temp		; DY
                 
007bab 17ca      	cp	YL, XL			; X1,Y1
007bac f028      	brlo	_gmln_l4
007bad f041      	breq	_gmln_l5
007bae 2f5c      	mov	temp, YL		; YL>XL
007baf 1b5a      	sub	temp, XL
007bb0 efaf      	ldi	XL, -1			; IY = -1
007bb1 c006      	rjmp	_gmln_l6
                 _gmln_l4:
007bb2 2f5a      	mov	temp, XL		; XL<YL
007bb3 1b5c      	sub	temp, YL
007bb4 e0a1      	ldi	XL, 1			; IX = 1
007bb5 c002      	rjmp	_gmln_l6
                 _gmln_l5:
007bb6 e050      	ldi	temp, 0			; XL==YL
007bb7 e0a0      	ldi	XL, 0			; IY = 0
                 _gmln_l6:
007bb8 2e05      	mov	r0, temp		; DX
                 
007bb9 1401      	cp	r0, r1 			; DY, DX
007bba 2d51      	mov	temp, r1
007bbb f008      	brlo	_gmln_l7                ; DY<DX
007bbc 2d50      	mov	temp, r0
                 _gmln_l7:
007bbd 2f75      	mov	FROMRAM0, temp		; D
007bbe 9553      	inc	temp			; temp = D+1 = counter
                 
007bbf 9120 091d 	lds	FROMRAM2, CON_ESC_C1	; command to do
007bc1 27ff      	clr	ZH			; YR
007bc2 27ee      	clr	ZL			; XR
                 
                 _gmln_loop:	
007bc3 935f      	push	temp
007bc4 df8c      	rcall	CRISS_PUTPIX_Y
                 
                 	; calculate next pixel
007bc5 0df1      	add	ZH, r1			; YR:=YR+DY;
007bc6 0de0      	add	ZL, r0			; XR:=XR+DX;
                 	
007bc7 17f7      	cp	ZH, FROMRAM0
007bc8 f010      	brlo	_gmln_l11		; skip if less then
007bc9 1bf7      	sub	ZH, FROMRAM0		; YR:=YR-D
007bca 0fdb      	add	YH, XH			; Y1:=Y1+IY
                 _gmln_l11:
                 
007bcb 17e7      	cp	ZL, FROMRAM0
007bcc f010      	brlo	_gmln_l12		; skip if less then
007bcd 1be7      	sub	ZL, FROMRAM0		; XR:=XR-D
007bce 0fca      	add	YL, XL			; X1:=X1+IX
                 _gmln_l12:
                 
007bcf 915f      	pop	temp
007bd0 955a      	dec	temp
007bd1 f789      	brne	_gmln_loop
                 
                 _gmln_end:
007bd2 91ef
007bd3 91ff      	popw	Z
007bd4 91cf
007bd5 91df      	popw	Y
007bd6 91af
007bd7 91bf      	popw	X
007bd8 901f      	pop	r1
007bd9 900f      	pop	r0
007bda 912f      	pop	FROMRAM2
007bdb 917f      	pop	FROMRAM0
007bdc 911f      	pop	zzA
007bdd 9508      	ret
                 
                 
                 	; Z = DY:DX
                 CRISS_CIRCLE_CPLOT:
007bde 93df
007bdf 93cf      	pushw	Y
007be0 91d0 091f 	lds	YH, CON_ESC_C3	; y0
007be2 0fdf      	add	YH, ZH
007be3 91c0 0920 	lds	YL, CON_ESC_C4	; x0
007be5 0fce      	add	YL, ZL
007be6 df6a      	rcall	CRISS_PUTPIX_Y
007be7 91cf
007be8 91df      	popw	Y
007be9 9508      	ret	
                 
                 CRISS_CIRCLE_CPLOT8:
007bea 2ffb      	mov	ZH, XH
007beb 2fea      	mov	ZL, XL
007bec fd70      	sbrc	FROMRAM0, 0
007bed dff0      	rcall	CRISS_CIRCLE_CPLOT
007bee 2ffb      	mov	ZH, XH
007bef 95f1      	neg	ZH
007bf0 2fea      	mov	ZL, XL
007bf1 fd71      	sbrc	FROMRAM0, 1
007bf2 dfeb      	rcall	CRISS_CIRCLE_CPLOT
007bf3 2ffb      	mov	ZH, XH
007bf4 2fea      	mov	ZL, XL
007bf5 95e1      	neg	ZL
007bf6 fd72      	sbrc	FROMRAM0, 2
007bf7 dfe6      	rcall	CRISS_CIRCLE_CPLOT
007bf8 2ffb      	mov	ZH, XH
007bf9 95f1      	neg	ZH
007bfa 2fea      	mov	ZL, XL
007bfb 95e1      	neg	ZL
007bfc fd73      	sbrc	FROMRAM0, 3
007bfd dfe0      	rcall	CRISS_CIRCLE_CPLOT
007bfe 2ffa      	mov	ZH, XL
007bff 2feb      	mov	ZL, XH
007c00 fd74      	sbrc	FROMRAM0, 4
007c01 dfdc      	rcall	CRISS_CIRCLE_CPLOT
007c02 2ffa      	mov	ZH, XL
007c03 95f1      	neg	ZH
007c04 2feb      	mov	ZL, XH
007c05 fd75      	sbrc	FROMRAM0, 5
007c06 dfd7      	rcall	CRISS_CIRCLE_CPLOT
007c07 2ffa      	mov	ZH, XL
007c08 2feb      	mov	ZL, XH
007c09 95e1      	neg	ZL
007c0a fd76      	sbrc	FROMRAM0, 6
007c0b dfd2      	rcall	CRISS_CIRCLE_CPLOT
007c0c 2ffa      	mov	ZH, XL
007c0d 95f1      	neg	ZH
007c0e 2feb      	mov	ZL, XH
007c0f 95e1      	neg	ZL
007c10 fd77      	sbrc	FROMRAM0, 7
007c11 dfcc      	rcall	CRISS_CIRCLE_CPLOT
007c12 9508      	ret
                 
                 	; draw circle mask v h r
                 BIOS04_ESC_CRISS_CIRCLE:
007c13 931f      	push	zzA
007c14 937f      	push	FROMRAM0
007c15 932f      	push	FROMRAM2
                 ;	push	r0
                 ;	push	r1
007c16 93bf
007c17 93af      	pushw	X
007c18 93df
007c19 93cf      	pushw	Y
007c1a 93ff
007c1b 93ef      	pushw	Z
                 
007c1c e42c      	ldi	FROMRAM2, 'L'		; command to put pixel
007c1d 9170 091e 	lds	FROMRAM0, CON_ESC_C2	; mask
                 ;	lds	YH, CON_ESC_C3		; v
                 ;	lds	YL, CON_ESC_C4		; h
007c1f 91b0 0921 	lds	XH, CON_ESC_C5		; Y:=R
007c21 e0a0      	ldi	XL, 0			; X:=0
                 
007c22 2f5b      	mov	temp, XH
007c23 0f55      	add	temp, temp		; *2
007c24 e0d3      	ldi	YH, 3
007c25 1bd5      	sub	YH, temp		; D:=3-2*R;
                 
                 _criss_circle_while:
                 	;call	gmln_debug
                 	
007c26 17ab      	cp	XL, XH           	; WHILE X<Y DO BEGIN
007c27 f008      	brlo	_criss_circle_do
007c28 c012      	rjmp	_criss_circle_compl
                 
                 _criss_circle_do:
007c29 dfc0      	rcall	CRISS_CIRCLE_CPLOT8
                 
007c2a 2bdd      	or	YH, YH			; check D
007c2b f042      	brmi	_criss_circle_l1
007c2c 2f5a      	mov	temp, XL		; X
007c2d 1b5b      	sub	temp, XH		; X-Y
007c2e 0f55      	lsl	temp
007c2f 0f55      	lsl	temp			; *4
007c30 0fd5      	add	YH, temp
007c31 5fda      	subi	YH, -6 			; D:=D+4*(X-Y)+10
007c32 95ba      	dec	XH			; Y:=Y-1
007c33 c005      	rjmp	_criss_circle_l2
                 
                 _criss_circle_l1:
007c34 2f5a      	mov	temp, XL		; X
007c35 0f55      	lsl	temp
007c36 0f55      	lsl	temp			; X*4
007c37 0fd5      	add	YH, temp
007c38 5fda      	subi	YH, -6 			; D:=D+4*X+6
                 
                 _criss_circle_l2:
007c39 95a3      	inc	XL
007c3a cfeb      	rjmp	_criss_circle_while
                 
                 _criss_circle_compl:
007c3b 30b0      	cpi	XH, 0			; IF Y=0 THEN CPLOT(X,Y,XC,YC);
007c3c f409      	brne	_criss_circle_end
007c3d dfac      	rcall	CRISS_CIRCLE_CPLOT8
                 
                 _criss_circle_end:
007c3e 91ef
007c3f 91ff      	popw	Z
007c40 91cf
007c41 91df      	popw	Y
007c42 91af
007c43 91bf      	popw	X
                 ;	pop	r1
                 ;	pop	r0
007c44 912f      	pop	FROMRAM2
007c45 917f      	pop	FROMRAM0
007c46 911f      	pop	zzA
007c47 9508      	ret
                 
                 /*
                 gmln_debug:
                 	push	temp
                 	uDBGh	YH
                 	uDBGh	YL
                 	uDBGh	XH
                 	uDBGh	XL
                 	uDBGh	ZH
                 	uDBGh	ZL
                 	uDBGh	r1
                 	uDBGh	r0
                 	uDBGh	FROMRAM0
                 	uDBGh	FROMRAM2
                 	uDBGcr
                 	pop	temp
                 	ret
                 */
                 
                 ; disable scrolling
                 BIOS_L04_SCRLOFF:
007c48 9150 3f05 	lds	temp, CRT_SETTINGS
007c4a 6850      	sbr	temp, 1<<CRT_SCROLL_DSBL
007c4b 9350 3f05 	sts	CRT_SETTINGS, temp
007c4d 9508      	ret
                 
                 ; enable scrolling
                 BIOS_L04_SCRLON:
007c4e 9150 3f05 	lds	temp, CRT_SETTINGS
007c50 775f      	cbr	temp, 1<<CRT_SCROLL_DSBL
007c51 9350 3f05 	sts	CRT_SETTINGS, temp
007c53 9508      	ret
                 
                 ; stop processing ESC seq
                 BIOS_ESC_CANCEL:
007c54 9250 091c 	sts	CON_ESC, zero
007c56 2722      	clr	FROMRAM2		; if is called from the processor
007c57 9508      	ret
                 
                 BIOS04_ESC_CRISS_GPIO:
007c58 9150 091e 	lds	temp, CON_ESC_C2	; mask
007c5a da54      	rcall	GPIO_SEND		; send to GPIO
007c5b 9508      	ret
                 	
                 ; sends char to standard CON input
                 BIOS04_ESC_CRISS_SET_CON:
007c5c 940e 7442 	call	BIOS_Lf0
007c5e 9508      	ret
                 
                 ; save screen to VIDEOBUF
                 BIOS04_ESC_CRISS_BS:
007c5f 93ff
007c60 93ef      	pushw	Z
007c61 93bf
007c62 93af      	pushw	X
007c63 e0e0
007c64 e0f1      	ldiw	Z, VIDEOBUF
007c65 e0a0
007c66 efb8      	ldiw	X, 0xF800			; start of videoram
                 _bios04_bs_l1:
007c67 b9b8
007c68 b9a2
007c69 b854
007c6a b83b
007c6b 0000
007c6c 0000
007c6d b153
007c6e b82b      	LDRAM	XH, XL, temp
007c6f 9351      	st	Z+, temp
007c70 9611      	adiw	X, 1
007c71 3de0      	cpi	ZL, low(VIDEOBUF_END)
007c72 f7a1      	brne	_bios04_bs_l1
007c73 30f8      	cpi	ZH, high(VIDEOBUF_END)
007c74 f791      	brne	_bios04_bs_l1
007c75 91af
007c76 91bf      	popw	X
007c77 91ef
007c78 91ff      	popw	Z
007c79 9508      	ret
                 
                 ; load screen from VIDEOBUF
                 BIOS04_ESC_CRISS_CS:
007c7a 93ff
007c7b 93ef      	pushw	Z
007c7c 93bf
007c7d 93af      	pushw	X
007c7e e0e0
007c7f e0f1      	ldiw	Z, VIDEOBUF
007c80 e0a0
007c81 efb8      	ldiw	X, 0xF800			; start of videoram
                 _bios04_cs_l1:
007c82 9151      	ld	temp, Z+
007c83 b9b8
007c84 b9a2
007c85 b955
007c86 b824
007c87 15b6
007c88 985d
007c89 f100
007c8a b82b
007c8b 935f
007c8c e158
007c8d b955
007c8e eb5f
007c8f b954
007c90 e050
007c91 bd5d
007c92 e550
007c93 bd5c
007c94 9859
007c95 915f
007c96 982c
007c97 935f
007c98 2f5b
007c99 940e 005f
007c9b e054
007c9c 955a
007c9d f7f1
007c9e 2f5a
007c9f 940e 005f
007ca1 e054
007ca2 955a
007ca3 f7f1
007ca4 915f
007ca5 940e 005f
007ca7 bc5c
007ca8 9a59
007ca9 b854
007caa b82b      	STRAM	XH, XL, temp
007cab 9611      	adiw	X, 1
007cac 3de0      	cpi	ZL, low(VIDEOBUF_END)
007cad f6a1      	brne	_bios04_cs_l1
007cae 30f8      	cpi	ZH, high(VIDEOBUF_END)
007caf f691      	brne	_bios04_cs_l1
007cb0 91af
007cb1 91bf      	popw	X
007cb2 91ef
007cb3 91ff      	popw	Z
007cb4 9508      	ret
                 
                 
                 ; set screen output limits (output window)
                 BIOS04_ESC_CRISS_WIN:
007cb5 9150 091e 	lds	temp, CON_ESC_C2
007cb7 3051      	cpi	temp, 1
007cb8 f1e8      	brlo	_bios_cw_err
007cb9 932f
007cba 9120 3f0a
007cbc 1752
007cbd 912f      	cpmem	temp, CRT_CHARS
007cbe f009      	breq	_bios_cw_x0
007cbf f5b0      	brsh	_bios_cw_err
                 _bios_cw_x0:
007cc0 9350 3f66 	sts	CON_WIN_X0, temp
                 
007cc2 9150 091f 	lds	temp, CON_ESC_C3
007cc4 3051      	cpi	temp, 1
007cc5 f180      	brlo	_bios_cw_err
007cc6 932f
007cc7 9120 3f09
007cc9 1752
007cca 912f      	cpmem	temp, CRT_LINES
007ccb f009      	breq	_bios_cw_y0
007ccc f548      	brsh	_bios_cw_err
                 _bios_cw_y0:
007ccd 9350 3f67 	sts	CON_WIN_Y0, temp
                 
007ccf 9150 0920 	lds	temp, CON_ESC_C4
007cd1 932f
007cd2 9120 3f66
007cd4 1752
007cd5 912f      	cpmem	temp, CON_WIN_X0
007cd6 f0f8      	brlo	_bios_cw_err
007cd7 932f
007cd8 9120 3f0a
007cda 1752
007cdb 912f      	cpmem	temp, CRT_CHARS
007cdc f009      	breq	_bios_cw_x1
007cdd f4c0      	brsh	_bios_cw_err
                 _bios_cw_x1:
007cde 9350 3f68 	sts	CON_WIN_X1, temp
                 
007ce0 9150 0921 	lds	temp, CON_ESC_C5
007ce2 932f
007ce3 9120 3f67
007ce5 1752
007ce6 912f      	cpmem	temp, CON_WIN_Y0
007ce7 f070      	brlo	_bios_cw_err
007ce8 932f
007ce9 9120 3f09
007ceb 1752
007cec 912f      	cpmem	temp, CRT_LINES
007ced f009      	breq	_bios_cw_y1
007cee f438      	brsh	_bios_cw_err
                 _bios_cw_y1:
007cef 9350 3f69 	sts	CON_WIN_Y1, temp
                 
007cf1 9290 3f6a 	sts	CON_WIN_CUR_X, one
007cf3 9290 3f6b 	sts	CON_WIN_CUR_Y, one
007cf5 9508      	ret
                 _bios_cw_err:
007cf6 9250 3f66 	sts	CON_WIN_X0, zero
007cf8 9250 3f68 	sts	CON_WIN_X1, zero
007cfa 9250 3f67 	sts	CON_WIN_Y0, zero
007cfc 9250 3f69 	sts	CON_WIN_Y1, zero
007cfe 9508      	ret
                 
                 
                 ; output window controls
                 BIOS04_ESC_CRISS_WIN_CTRLS:
007cff 9150 3f66 	lds	temp, CON_WIN_X0
007d01 3050      	cpi	temp, 0
007d02 f409      	brne	_bios04_w_l1			; check that window is set
007d03 9508      	ret
                 _bios04_w_l1:
007d04 93ff
007d05 93ef      	pushw	Z
007d06 93bf
007d07 93af      	pushw	X
007d08 93df
007d09 93cf      	pushw	Y
007d0a 937f      	push	FROMRAM0
007d0b 921f      	push	FROMRAM1
007d0c 931f      	push	zzA
007d0d 2f56      	mov	temp, zzC
007d0e 3453
007d0f f409
007d10 c098      	tcbe	'C', BIOS_L04_WIN_CLR		; clear window (spaces)
007d11 3555
007d12 f409
007d13 c0cf      	tcbe	'U', BIOS_L04_WIN_SCROLL_UP	; scroll window UP
                 ;	tcbe	'D', BIOS_L04_WIN_SCROLL_DOWN	; 
                 ;	tcbe	'R', BIOS_L04_WIN_SCROLL_RIGHT	; 
                 ;	tcbe	'L', BIOS_L04_WIN_SCROLL_LEFT	; 
007d14 3456
007d15 f409
007d16 c09f      	tcbe	'F', BIOS_L04_WIN_DFRAME	; double frame
007d17 3656
007d18 f409
007d19 c09f      	tcbe	'f', BIOS_L04_WIN_SFRAME	; single frame
                 _bios04_w_ret:
007d1a 911f      	pop	zzA
007d1b 901f      	pop	FROMRAM1
007d1c 917f      	pop	FROMRAM0
007d1d 91cf
007d1e 91df      	popw	Y
007d1f 91af
007d20 91bf      	popw	X
007d21 91ef
007d22 91ff      	popw	Z
007d23 9508      	ret
                 
                 
                 ; write to RAM
                 _bios_04_w_stram_x_a:
007d24 935f      	push	temp
007d25 b9b8
007d26 b9a2
007d27 b915
007d28 b824
007d29 15b6
007d2a 985d
007d2b f100
007d2c b82b
007d2d 935f
007d2e e158
007d2f b955
007d30 eb5f
007d31 b954
007d32 e050
007d33 bd5d
007d34 e550
007d35 bd5c
007d36 9859
007d37 915f
007d38 982c
007d39 931f
007d3a 2f5b
007d3b 940e 005f
007d3d e054
007d3e 955a
007d3f f7f1
007d40 2f5a
007d41 940e 005f
007d43 e054
007d44 955a
007d45 f7f1
007d46 915f
007d47 940e 005f
007d49 bc5c
007d4a 9a59
007d4b b854
007d4c b82b              STRAM	XH, XL, zzA
007d4d 915f              pop	temp
007d4e 9508      	ret
                 
                 ; get frame start position in memory in X
                 _bios04_w_set_start:
007d4f e0a0
007d50 efb8      	ldiw	X, 0xF800		; video RAM
007d51 9150 3f67 	lds	temp, CON_WIN_Y0
007d53 3050      	cpi	temp, 0
007d54 f059      	breq	_bios04_wss_ret
                 _bios04_wss_l2:
007d55 955a      	dec	temp
007d56 f011      	breq	_bios04_wss_l1
007d57 d009      	rcall	_bios04_w_lf		; goto next line
007d58 cffc      	rjmp	_bios04_wss_l2
                 _bios04_wss_l1:
007d59 9150 3f66 	lds	temp, CON_WIN_X0
007d5b 3050      	cpi	temp, 0
007d5c f019      	breq	_bios04_wss_ret
007d5d 955a      	dec	temp
007d5e 0fa5      	add	XL, temp
007d5f 1db5      	adc	XH, zero		; start point
                 _bios04_wss_ret:
007d60 9508      	ret	
                 
                 ; set next line position in memory
                 _bios04_w_lf:
007d61 935f      	push	temp
007d62 9150 3f0a 	lds	temp, CRT_CHARS
007d64 0fa5      	add	XL, temp
007d65 1db5      	adc	XH, zero
007d66 915f      	pop	temp
007d67 9508      	ret
                 _bios04_w_lf_y:
007d68 935f      	push	temp
007d69 9150 3f0a 	lds	temp, CRT_CHARS
007d6b 0fc5      	add	YL, temp
007d6c 1dd5      	adc	YH, zero
007d6d 915f      	pop	temp
007d6e 9508      	ret
                 
                 
                 ; fill temp bytes from X with zzA
                 _bios04_w_fill:
007d6f 93bf
007d70 93af              pushw	X
007d71 d003              rcall	__bios04_w_fill
007d72 91af
007d73 91bf      	popw	X
007d74 9508      	ret
                 __bios04_w_fill:
007d75 dfae              rcall	_bios_04_w_stram_x_a	; STRAM	XH, XL, zzA
007d76 0da9      	add	XL, one
007d77 1db5      	adc	XH, zero		; inc
007d78 955a      	dec	temp
007d79 f7d9      	brne	__bios04_w_fill
007d7a 9508      	ret
                 
                 ; move temp bytes from Y to X 
                 _bios04_w_copy:
007d7b 3050      	cpi	temp, 0
007d7c f0c9      	breq	_bios04_wc_ret
007d7d 93bf
007d7e 93af      	pushw	X
007d7f 93df
007d80 93cf      	pushw	Y
007d81 931f              push	zzA
                 _bios04_wc_l3:
007d82 b9d8
007d83 b9c2
007d84 b854
007d85 b83b
007d86 0000
007d87 0000
007d88 b113
007d89 b82b              LDRAM	YH, YL, zzA
007d8a df99              rcall	_bios_04_w_stram_x_a	; STRAM	XH, XL, zzA
007d8b 0da9      	add	XL, one
007d8c 1db5      	adc	XH, zero		; inc
007d8d 0dc9      	add	YL, one
007d8e 1dd5      	adc	YH, zero		; inc
007d8f 955a      	dec	temp
007d90 f789      	brne	_bios04_wc_l3
007d91 911f      	pop	zzA
007d92 91cf
007d93 91df      	popw	Y
007d94 91af
007d95 91bf      	popw	X
                 _bios04_wc_ret:
007d96 9508      	ret
                 
                 ; get w width
                 _bios04_w_getw:
007d97 931f              push	zzA
007d98 9150 3f68 	lds	temp, CON_WIN_X1
007d9a 9110 3f66 	lds	zzA, CON_WIN_X0
007d9c 1b51      	sub	temp, zzA
007d9d 9553      	inc 	temp
007d9e 911f      	pop	zzA
007d9f 9508      	ret
                 
                 ; get w height
                 _bios04_w_geth:
007da0 931f              push	zzA
007da1 9150 3f69 	lds	temp, CON_WIN_Y1
007da3 9110 3f67 	lds	zzA, CON_WIN_Y0
007da5 1b51      	sub	temp, zzA
007da6 9553      	inc 	temp
007da7 911f      	pop	zzA
007da8 9508      	ret
                 
                 
                 ; clear window
                 BIOS_L04_WIN_CLR:
007da9 e210      	ldi	zzA, 32			; char to fill window
007daa dfa4      	rcall	_bios04_w_set_start
007dab dff4              rcall	_bios04_w_geth
007dac 3050              cpi	temp, 0
007dad f039              breq	_bios04_wclr_l4
                 _bios04_wclr_l1:
007dae 935f              push 	temp
007daf dfe7              rcall	_bios04_w_getw
007db0 dfbe              rcall	_bios04_w_fill
007db1 dfaf      	rcall	_bios04_w_lf
007db2 915f      	pop	temp
007db3 955a      	dec	temp
007db4 f7c9      	brne	_bios04_wclr_l1
                 _bios04_wclr_l4:
007db5 cf64      	rjmp	_bios04_w_ret		; return
                 
                 
                 ;!!! moved to bios_misc_data.inc
                 ;BIOS_L04_DFRAME_SYMBS:	.DB 201,205,187, 186,32,186, 200,205,188, 0
                 ;BIOS_L04_SFRAME_SYMBS:	.DB 218,196,191, 179,32,179, 192,196,217, 0
                 
                 ; clear window
                 BIOS_L04_WIN_DFRAME:
007db6 e3e6
007db7 e1ff      	ldiw2	Z, BIOS_L04_DFRAME_SYMBS
007db8 c003      	rjmp	BIOS_L04_WIN_FRAME
                 
                 BIOS_L04_WIN_SFRAME:
007db9 e4e0
007dba e1ff      	ldiw2	Z, BIOS_L04_SFRAME_SYMBS
007dbb c000      	rjmp	BIOS_L04_WIN_FRAME
                 
                 BIOS_L04_WIN_FRAME:
007dbc df92      	rcall	_bios04_w_set_start
007dbd dfe2              rcall	_bios04_w_geth
007dbe 3050              cpi	temp, 0
007dbf f081      	breq	_bios04_wfr_l4		; wrong settings
007dc0 d010              rcall	_bios04_wfr_line	; first line
007dc1 955a              dec	temp
007dc2 f069      	breq	_bios04_wfr_l4
007dc3 955a              dec	temp
007dc4 f041      	breq	_bios04_wfr_l3
                 _bios04_wfr_l2:
007dc5 93ff
007dc6 93ef              pushw	Z
007dc7 df99              rcall	_bios04_w_lf		; goto next line
007dc8 d008              rcall	_bios04_wfr_line	; body line
007dc9 91ef
007dca 91ff      	popw	Z
007dcb 955a              dec	temp
007dcc f7c1              brne	_bios04_wfr_l2
                 _bios04_wfr_l3:
007dcd 9633      	adiw	Z, 3			; skip body line settings
007dce df92              rcall	_bios04_w_lf		; goto next line
007dcf d001              rcall	_bios04_wfr_line	; last line
                 _bios04_wfr_l4:
007dd0 cf49      	rjmp	_bios04_w_ret		; return
                 
                 
                 _bios04_wfr_line:
007dd1 93bf
007dd2 93af      	pushw	X
007dd3 935f      	push	temp
007dd4 9117              elpm	zzA, Z+
007dd5 df4e              rcall	_bios_04_w_stram_x_a	; STRAM	XH, XL, zzA
007dd6 0da9              add	XL, one
007dd7 1db5              adc	XH, zero		; goto next char
007dd8 dfbe              rcall	_bios04_w_getw
007dd9 955a              dec	temp
007dda 955a              dec	temp
007ddb 9117              elpm	zzA, Z+
007ddc df98              rcall	__bios04_w_fill		; fill space
007ddd 9117              elpm	zzA, Z+
007dde df45              rcall	_bios_04_w_stram_x_a	; STRAM	XH, XL, zzA
007ddf 915f              pop	temp
007de0 91af
007de1 91bf              popw	X
007de2 9508      	ret
                 
                 ; scroll window UP
                 BIOS_L04_WIN_SCROLL_UP:
007de3 df6b      	rcall	_bios04_w_set_start
                 ;        rcall	_bios04_w_getw
                 ;        mov	FROMRAM1, temp
007de4 dfbb              rcall	_bios04_w_geth
007de5 3050              cpi	temp, 0
007de6 f089              breq	_bios04_wsu_ret
007de7 955a              dec	temp
007de8 f059              breq	_bios04_wsu_l3
007de9 01ed              movw	Y, X
007dea 9170 3f0a         lds	FROMRAM0, CRT_CHARS
                 _bios04_wsu_l2:
007dec 01de              movw	X, Y
007ded df7a              rcall	_bios04_w_lf_y		; goto next line
                 ;	add	YL, FROMRAM0		; goto next line
                 ;	adc	YH, zero
007dee 935f      	push	temp
                 ;	mov	temp, FROMRAM1
007def dfa7              rcall	_bios04_w_getw
007df0 df8a              rcall	_bios04_w_copy		; copy line
007df1 915f              pop	temp
007df2 955a              dec	temp			; lines counter
007df3 f7c1              brne	_bios04_wsu_l2
                 _bios04_wsu_l3:
                 ;	mov	temp, FROMRAM1
007df4 01de              movw	X, Y
007df5 dfa1              rcall	_bios04_w_getw
007df6 e210      	ldi	zzA, 32			; char to fill
007df7 df77              rcall	_bios04_w_fill
                 _bios04_wsu_ret:
007df8 cf21      	rjmp	_bios04_w_ret		; return
                 
                 
                 ; set relative cursor to output window
                 BIOS04_ESC_CRISS_CUR_WIN:
007df9 9150 3f66 	lds	temp, CON_WIN_X0
007dfb 3050      	cpi	temp, 0
007dfc f409      	brne	_bios04_y_l1		; check that window is set
007dfd 9508      	ret
                 _bios04_y_l1:
007dfe 931f      	push	zzA
                 
007dff 9110 091e 	lds	zzA, CON_ESC_C2		; y position 1..n
007e01 3011      	cpi	zzA, 1
007e02 f0d0      	brlo	_bios04_y_ret
007e03 df9c              rcall	_bios04_w_geth
007e04 1715              cp	zzA, temp
007e05 f009              breq	_bios04_y_l2
007e06 f4b0              brsh	_bios04_y_ret
                 _bios04_y_l2:
                 
007e07 2f16      	mov	zzA, zzC		; x position 1..n
007e08 3011      	cpi	zzA, 1
007e09 f098      	brlo	_bios04_y_ret
007e0a df8c              rcall	_bios04_w_getw
007e0b 1715              cp	zzA, temp
007e0c f009              breq	_bios04_y_l3
007e0d f478              brsh	_bios04_y_ret
                 _bios04_y_l3:
                 
007e0e 9150 091e 	lds	temp, CON_ESC_C2
007e10 9350 3f6b 	sts	CON_WIN_CUR_Y, temp
007e12 9360 3f6a 	sts	CON_WIN_CUR_X, zzC
007e14 9110 3f67 	lds	zzA, CON_WIN_Y0
007e16 951a      	dec	zzA
007e17 0f51      	add	temp, zzA		; screen y position
007e18 9110 3f66 	lds	zzA, CON_WIN_X0
007e1a 951a      	dec	zzA
007e1b 0f61      	add	zzC, zzA		; screen x position
007e1c db76      	rcall	BIOS04_ESC_CUR_SET	; set cusor
                 _bios04_y_ret:
007e1d 911f      	pop	zzA
007e1e 9508      	ret
                 
                 
                 ; plays melody
                 BIOS04_ESC_CRISS_MELODY:
007e1f 9150 0924 	lds	temp, CON_ESC_PAR	; load par
007e21 3f5f      	cpi	temp, 0xff
007e22 f091      	breq	_bios_04_melody_exec
                 _bios_04_melody_note:
007e23 3150      	cpi	temp, 16
007e24 f448      	brsh	_bios_04_melody_l1
007e25 9553      	inc	temp
007e26 9350 0924 	sts	CON_ESC_PAR, temp
                 ;	dec	temp
007e28 5f51      	subi	temp, -(cpd_mpbuf-1)	; temp+=cpd_mpbuf
007e29 9360 090f
007e2b 2f55
007e2c 940e 720a 	nportout_r temp, zzC		; save note
                 _bios_04_melody_l1:
007e2e 3064      	cpi	zzC, 0x04		; check for melody end code
007e2f f411      	brne	_bios_04_melody_proceed
007e30 9220 0924 	sts	CON_ESC_PAR, FF	; next byte is command
                 _bios_04_melody_proceed:
007e32 941a      	dec	FROMRAM1
007e33 2d21      	mov	FROMRAM2, FROMRAM1	; proceed with ESC processing
007e34 9508      	ret	
                 _bios_04_melody_exec:
007e35 9360 090f
007e37 e056
007e38 940e 720a 	nportout cpd_mpcmd, zzC		; sends command and stop processing
007e3a 9508      	ret
                 	
                 
                 CRISS_CLR_CHECK_VMODE:
007e3b 9150 3f09 	lds	temp, CRT_LINES	; read current video mode
007e3d 3158      	cpi	temp, 24
007e3e f021      	breq	_criss_clr_check_ret
007e3f 9220 08fe 	sts	PCMD_FE, FF	; set error mark
007e41 915f      	pop	temp
007e42 915f      	pop	temp		; ignore 1st level return
                 ;	ret			; no action - return to top-level routine
                 _criss_clr_check_ret:
007e43 9508      	ret
                 
                 BIOS04_ESC_CRISS_CLR_RAW:
007e44 dff6      	rcall	CRISS_CLR_CHECK_VMODE
007e45 935f      	push	temp
007e46 937f      	push	FROMRAM0
007e47 ef5f
007e48 940e b400 	EXEC_CLR_CMD CLR_CMD_RAW
007e4a 917f      	pop	FROMRAM0
007e4b 915f      	pop	temp
                 ;	ldi 	temp, 0xff
                 ;	call	CLR_CMD
007e4c 9508      	ret
                 
                 CRISS_CLR_SCROLL:
007e4d dfed      	rcall	CRISS_CLR_CHECK_VMODE
007e4e e057
007e4f 940e b400 	EXEC_CLR_CMD CLR_CMD_SCROLL
007e51 9508      	ret
                 
                 
                 CRISS_CLR_CLRSCR:
007e52 dfe8      	rcall	CRISS_CLR_CHECK_VMODE
007e53 e056
007e54 940e b400 	EXEC_CLR_CMD CLR_CMD_CLEAR_SCREEN
007e56 9508      	ret
                 
                 
                 ;SELPRGYBMCW
                 .MACRO	CLR_ESC_CMD
                         cpi	zzC, @0
                         brne	_criss_clr_cmd_l
                 	ldi	temp, @1
                 _criss_clr_cmd_l:
                 .ENDM
                 .MACRO	CLR_ESC_CMZ
                         cpi	zzC, @0
                         brne	_criss_clr_cmd_l
                 	ldi	temp, @1
                 	ldi	zzC, @2
                 _criss_clr_cmd_l:
                 .ENDM
                 
                 BIOS04_ESC_CRISS_CLR_CMD:	; CLR Clrscr, clrLn, Scroll
007e57 dfe3      	rcall	CRISS_CLR_CHECK_VMODE
007e58 346c      	cpi	zzC, 'L'
007e59 f181      	breq	_criss_clr_cmd_clrscr
007e5a e050              ldi	temp, CLR_CMD_DEFAULT
007e5b 3563
007e5c f409
007e5d e057              CLR_ESC_CMD 'S', CLR_CMD_SCROLL
007e5e 3465
007e5f f409
007e60 e056              CLR_ESC_CMD 'E', CLR_CMD_CLEAR_SCREEN
007e61 346c
007e62 f409
007e63 e055              CLR_ESC_CMD 'L', CLR_CMD_CLEAR_LINE
007e64 3560
007e65 f409
007e66 e058              CLR_ESC_CMD 'P', CLR_CMD_GOTO_PATTERN
007e67 3468
007e68 f411
007e69 e051
007e6a e060              CLR_ESC_CMZ 'H', CLR_CMD_USER_COLOR, CLR_CLR_BLACK
007e6b 3562
007e6c f411
007e6d e051
007e6e e061              CLR_ESC_CMZ 'R', CLR_CMD_USER_COLOR, CLR_CLR_RED
007e6f 3467
007e70 f411
007e71 e051
007e72 e062              CLR_ESC_CMZ 'G', CLR_CMD_USER_COLOR, CLR_CLR_GREEN
007e73 3569
007e74 f411
007e75 e051
007e76 e063              CLR_ESC_CMZ 'Y', CLR_CMD_USER_COLOR, CLR_CLR_YELLOW
007e77 3462
007e78 f411
007e79 e051
007e7a e064              CLR_ESC_CMZ 'B', CLR_CMD_USER_COLOR, CLR_CLR_BLUE
007e7b 346d
007e7c f411
007e7d e051
007e7e e065              CLR_ESC_CMZ 'M', CLR_CMD_USER_COLOR, CLR_CLR_MAGENTA
007e7f 3463
007e80 f411
007e81 e051
007e82 e066              CLR_ESC_CMZ 'C', CLR_CMD_USER_COLOR, CLR_CLR_CYAN
007e83 3567
007e84 f411
007e85 e051
007e86 e067              CLR_ESC_CMZ 'W', CLR_CMD_USER_COLOR, CLR_CLR_WHITE
007e87 940e b400 	call	CLR_CMD
007e89 9508      	ret
                 _criss_clr_cmd_clrscr:
007e8a 940e 758e 	call	SCREEN_CLEAR
007e8c 940c 772d 	jmp	BIOS_L04_HOME
                 
                 
                 BIOS04_ESC_CRISS_CLR_OUT:	; colored output
007e8e dfac      	rcall	CRISS_CLR_CHECK_VMODE
007e8f 7067      	andi	zzC, 0x07		; mask unused bits
007e90 936f      	push	zzC
007e91 9250 0920 	sts	CON_ESC_C4, zero	; x shift
                 _criss_clr_out_l0:
007e93 9160 3f06 	lds	zzC, CURSOR_X
007e95 956a      	dec	zzC
007e96 9150 0920 	lds	temp, CON_ESC_C4
007e98 0f65      	add	zzC, temp
                 ;	cpmem	zzC, CRT_CHARS
007e99 3560      	cpi	zzC, 80			;!!!!! change to line width !!!!
007e9a f578      	brsh	_criss_clr_out_ret	; out of line width
007e9b e053
007e9c 940e b400 	EXEC_CLR_CMD CLR_CMD_SET_X
007e9e ef5a
007e9f 955a
007ea0 f7f1      	delay3	750
                 
007ea1 9160 3f07 	lds	zzC, CURSOR_Y
007ea3 956a      	dec	zzC
007ea4 e054
007ea5 940e b400 	EXEC_CLR_CMD CLR_CMD_SET_Y
007ea7 ef5a
007ea8 955a
007ea9 f7f1      	delay3	750
                 
007eaa 9150 091e 	lds	temp, CON_ESC_C2	; length
007eac 3050      	cpi	temp, 0
007ead f0e1      	breq	_criss_clr_out_ret	; nothing to do
007eae 3151      	cpi	temp, 16+1		
007eaf f458      	brsh	_criss_clr_out_l1
                 
007eb0 955a      	dec	temp
007eb1 0f55      	lsl	temp
007eb2 0f55      	lsl	temp
007eb3 0f55      	lsl	temp
007eb4 916f      	pop	zzC
007eb5 936f      	push	zzC			; color
007eb6 2b65      	or	zzC, temp		; build pattern
007eb7 e052
007eb8 940e b400 	EXEC_CLR_CMD CLR_CMD_PATTERN
007eba c00f      	rjmp	_criss_clr_out_ret
                 
                 _criss_clr_out_l1:
007ebb 5150      	subi	temp, 16
007ebc 9350 091e 	sts	CON_ESC_C2, temp	; new length
007ebe 916f      	pop	zzC
007ebf 936f      	push	zzC			; color
007ec0 6768      	ori	zzC, 0x78		; length=16
007ec1 e052
007ec2 940e b400 	EXEC_CLR_CMD CLR_CMD_PATTERN
007ec4 9150 0920 	lds	temp, CON_ESC_C4
007ec6 5f50      	subi	temp, -16
007ec7 9350 0920 	sts	CON_ESC_C4, temp	; x shift +=16
007ec9 cfc9      	rjmp	_criss_clr_out_l0
                 
                 _criss_clr_out_ret:
007eca 916f              pop	zzC
007ecb 9508      	ret
                 
                 
                 	; '|' char - out char to the screen without storing it in ZRAM
                 	;!!!!!!! must be rewritten via direct output via SPI !!!!!!
                 BIOS04_ESC_CRISS_VGA_OUT:
007ecc 93ff
007ecd 93ef      	pushw	Z
007ece 91e0 3f0d
007ed0 91f0 3f0e 	ldw	Z, VIDEO_CURSOR
007ed2 ef57      	ldi	temp, 0xf7			; RAM F8** address
007ed3 0ff5      	add	ZH, temp
007ed4 b9f8
007ed5 b9e2
007ed6 b854
007ed7 b83b
007ed8 0000
007ed9 0000
007eda b153
007edb b82b      	LDRAM	ZH, ZL, temp			; store in RAM and send to CPD
007edc 935f      	push	temp				; symbol to restore
007edd b9f8
007ede b9e2
007edf b965
007ee0 b824
007ee1 15f6
007ee2 985d
007ee3 f100
007ee4 b82b
007ee5 935f
007ee6 e158
007ee7 b955
007ee8 eb5f
007ee9 b954
007eea e050
007eeb bd5d
007eec e550
007eed bd5c
007eee 9859
007eef 915f
007ef0 982c
007ef1 936f
007ef2 2f5f
007ef3 940e 005f
007ef5 e054
007ef6 955a
007ef7 f7f1
007ef8 2f5e
007ef9 940e 005f
007efb e054
007efc 955a
007efd f7f1
007efe 915f
007eff 940e 005f
007f01 bc5c
007f02 9a59
007f03 b854
007f04 b82b      	STRAM	ZH, ZL, zzC			; store in RAM and send to CPD
007f05 916f      	pop	zzC
007f06 b9f8
007f07 b9e2
007f08 b965
007f09 b824
007f0a 985d
007f0b 0000
007f0c b82b      	STRAM_RAMONLY	ZH, ZL, zzC		; store in RAM only
007f0d 91ef
007f0e 91ff      	popw	Z
007f0f 9508      	ret
                 
                 #include "bios_mice.inc"
                 
007f10 9150 3f59 	lds	temp, MS_MODE
007f12 1155      	cpse	temp, zero
007f13 c02a      	rjmp	BIOS_MOUSE_OFF
007f14 c001      	rjmp	BIOS_MOUSE_ON
007f15 9508      	ret
                 
                 
                 
                 BIOS_MOUSE_ON:
007f16 e05b
007f17 940e 720c 	nportin	cpd_sysrq
007f19 fd56      	sbrc	temp, CPD_SYSRQ_MICE	; is mouse active?
007f1a 9508      	ret				; if active just ignore
007f1b ee50
007f1c 9350 090f
007f1e e057
007f1f 940e 720a 	nportout_t cpd_twcmd, 0xE0	; mice init command
007f21 d0b6      	rcall	delay_5ms
                 ;	rcall	delay_2ms
007f22 e05b
007f23 940e 720c 	nportin	cpd_sysrq
007f25 ff56      	sbrs	temp, CPD_SYSRQ_MICE	; is mouse active?
007f26 9508      	ret				; no mouse detected - just ignore
007f27 9290 3f59 	sts	MS_MODE, one		; set mouse active
007f29 e050
007f2a 9350 090f
007f2c e058
007f2d 940e 720a 	nportout_t cpd_twdti, 0		; clear button state
007f2f e050
007f30 9350 090f
007f32 e059
007f33 940e 720a 	nportout_t cpd_micex, 0		; clear pos
007f35 e050
007f36 9350 090f
007f38 e05a
007f39 940e 720a 	nportout_t cpd_micey, 0		; clear pos
007f3b 940e 8960 	call	SYSTEM_BEEP		; welcome beep
007f3d 9508      	ret
                 
                 
                 
                 BIOS_MOUSE_OFF:
                 ;	call	SYSTEM_BEEP		; welcome beep
007f3e ee54
007f3f 9350 090f
007f41 e057
007f42 940e 720a 	nportout_t cpd_twcmd, 0xE4	; mice stop command
007f44 9250 3f59 	sts	MS_MODE, zero		; set mouse inactive
007f46 9508      	ret
                 
                 
                 ;MS_MODE:	.BYTE	1		; Mouse settings for auto mode
                 ;MS_STEP_X:	.BYTE	1
                 ;MS_STEP_Y:	.BYTE	1
                 ;MS_MOVE_UP:	.BYTE	1		; shift up returns this character
                 ;MS_MOVE_DOWN:	.BYTE	1
                 ;MS_MOVE_RIGHT:	.BYTE	1
                 ;MS_MOVE_LEFT:	.BYTE	1
                 ;MS_BTN_LEFT_P:	.BYTE	1		; left button returns character
                 ;MS_BTN_LEFT_U:	.BYTE	1		; left button returns character
                 ;MS_BTN_MID_P:	.BYTE	1		; mid button returns character
                 ;MS_BTN_MID_U:	.BYTE	1		; mid button returns character
                 ;MS_BTN_RIGHT_P:	.BYTE	1		; right button returns character
                 ;MS_BTN_RIGHT_U:	.BYTE	1		; right button returns character
                 
                 BIOS_MOUSE_INIT:
007f47 93ff
007f48 93ef      	pushw	Z
007f49 93bf
007f4a 93af      	pushw	X
007f4b 937f      	push	FROMRAM0
007f4c e5a9
007f4d e3bf      	ldiw	X, MOUSE_SETTINGS
007f4e e2e8
007f4f e1ff      	ldiw	Z, BIOS_MOUSE_INIT_DATA*2
007f50 e05d      	ldi	temp, 13
                 _BIOS_MOUSE_INIT_LOOP:
007f51 9177      	elpm	FROMRAM0, Z+
007f52 937d      	st	X+, FROMRAM0
007f53 955a      	dec	temp
007f54 f7e1      	brne	_BIOS_MOUSE_INIT_LOOP
007f55 917f      	pop	FROMRAM0
007f56 91af
007f57 91bf      	popw	X
007f58 91ef
007f59 91ff      	popw	Z
007f5a 9508      	ret
                 
                 
                 
                 BIOS_MOUSE_AUTOMODE:
007f5b 9150 3f59 	lds	temp, MS_MODE
007f5d 1159      	cpse	temp, one
007f5e 9508      	ret				; no mouse activated
                 
007f5f e05b
007f60 940e 720c 	nportin	cpd_sysrq		; check that mouse is active
007f62 ff56      	sbrs	temp, CPD_SYSRQ_MICE	; is mouse active?
007f63 cfda      	rjmp	BIOS_MOUSE_OFF		; mouse read error - stop mouse
                 
                 ;_BIOS_MOUSE_AUTOMODE_CHECK_KBD:
                 ;	nportin	cpd_kmodk		; check that keyboard is not processed
                 ;	sbrc	temp, 7
                 ;	rjmp	_BIOS_MOUSE_AUTOMODE_CHECK_KBD
                 					
007f64 ee51
007f65 9350 090f
007f67 e057
007f68 940e 720a 	nportout_t cpd_twcmd, 0xE1	; mice read command
007f6a d06d      	rcall	delay_5ms
007f6b d06c      	rcall	delay_5ms
007f6c d06b      	rcall	delay_5ms
007f6d e057
007f6e 940e 720c 	nportin	cpd_twcmd
007f70 1155      	cpse	temp, zero
007f71 cfcc      	rjmp	BIOS_MOUSE_OFF		; mouse read error - stop mouse
                 
                 	; process auto mouse
007f72 936f      	push	zzC
007f73 931f      	push	zzA
                 
                 _ms_amode_check_x:
007f74 e059
007f75 940e 720c 	nportin	cpd_micex
007f77 2f15      	mov	zzA, temp
007f78 fd17      	sbrc	zzA, 7			; is negative?
007f79 9551      	neg	temp			; abs(temp)
007f7a 9160 3f5a 	lds	zzC, MS_STEP_X
007f7c 1756      	cp	temp, zzC
007f7d f088      	brlo	_ms_amode_check_y	; not exceed tolerance
007f7e 2f51      	mov	temp, zzA		; restore temp
007f7f fd17      	sbrc	zzA, 7			; is negative?
007f80 9561      	neg	zzC
007f81 1b56      	sub	temp, zzC
007f82 9350 090f
007f84 e059
007f85 940e 720a 	nportout cpd_micex, temp	; store updated value
007f87 9160 3f5f 	lds	zzC, MS_MOVE_LEFT
007f89 fd17      	sbrc	zzA, 7			; is negative?
007f8a 9160 3f5e 	lds	zzC, MS_MOVE_RIGHT
007f8c ef50
007f8d 940e 7200 	BIOS_CALL BIOS_FUNC_CONBUF_APPEND
                 
                 _ms_amode_check_y:
007f8f e05a
007f90 940e 720c 	nportin	cpd_micey
007f92 2f15      	mov	zzA, temp
007f93 fd17      	sbrc	zzA, 7			; is negative?
007f94 9551      	neg	temp			; abs(temp)
007f95 9160 3f5b 	lds	zzC, MS_STEP_Y
007f97 1756      	cp	temp, zzC
007f98 f088      	brlo	_ms_amode_check_btn	; not exceed tolerance
007f99 2f51      	mov	temp, zzA		; restore temp
007f9a fd17      	sbrc	zzA, 7			; is negative?
007f9b 9561      	neg	zzC
007f9c 1b56      	sub	temp, zzC
007f9d 9350 090f
007f9f e05a
007fa0 940e 720a 	nportout cpd_micey, temp	; store updated value
007fa2 9160 3f5c 	lds	zzC, MS_MOVE_UP
007fa4 fd17      	sbrc	zzA, 7			; is negative?
007fa5 9160 3f5d 	lds	zzC, MS_MOVE_DOWN
007fa7 ef50
007fa8 940e 7200 	BIOS_CALL BIOS_FUNC_CONBUF_APPEND
                 
                 _ms_amode_check_btn:
007faa e058
007fab 940e 720c 	nportin	cpd_twdti		; read buttons
007fad 2f15      	mov	zzA, temp
007fae 9512      	swap	zzA
007faf 2715      	eor	zzA, temp		; get btns state change
                 
                 _ms_amode_check_btn_0:
007fb0 ff10      	sbrs	zzA, 0			; left button
007fb1 c008      	rjmp	_ms_amode_check_btn_1
007fb2 9160 3f60 	lds	zzC, MS_BTN_LEFT_P
007fb4 ff50      	sbrs	temp, 0			; is pressed
007fb5 9160 3f61 	lds	zzC, MS_BTN_LEFT_U
007fb7 ef50
007fb8 940e 7200 	BIOS_CALL BIOS_FUNC_CONBUF_APPEND
                 _ms_amode_check_btn_1:
007fba ff11      	sbrs	zzA, 1			; left button
007fbb c008      	rjmp	_ms_amode_check_btn_2
007fbc 9160 3f64 	lds	zzC, MS_BTN_RIGHT_P
007fbe ff51      	sbrs	temp, 1			; is pressed
007fbf 9160 3f65 	lds	zzC, MS_BTN_RIGHT_U
007fc1 ef50
007fc2 940e 7200 	BIOS_CALL BIOS_FUNC_CONBUF_APPEND
                 _ms_amode_check_btn_2:
007fc4 ff12      	sbrs	zzA, 2			; left button
007fc5 c008      	rjmp	_ms_amode_check_ret
007fc6 9160 3f62 	lds	zzC, MS_BTN_MID_P
007fc8 ff52      	sbrs	temp, 2			; is pressed
007fc9 9160 3f63 	lds	zzC, MS_BTN_MID_U
007fcb ef50
007fcc 940e 7200 	BIOS_CALL BIOS_FUNC_CONBUF_APPEND
                 
                 _ms_amode_check_ret:
007fce 911f      	pop	zzA
007fcf 916f      	pop	zzC
007fd0 9508      	ret
                 
                 
                 	; temp = temp
                 _MS_AMODE_ADJ:
007fd1 2b55      	or	temp, temp
                 	
                 
                 DELAY_25US:
007fd2 935f      	push	temp
007fd3 ea56
007fd4 955a
007fd5 f7f1      	delay3	498
007fd6 915f      	pop	temp
007fd7 9508      	ret
                 
                 DELAY_5MS:
007fd8 ec58      	ldi	temp, 200
                 _DELAY_MS_LOOP:
007fd9 dff8      	rcall	delay_25us
007fda 955a      	dec	temp
007fdb f7e9      	brne 	_DELAY_MS_LOOP
007fdc 9508      	ret
                 
                 BIOS_END:
                 
                 ;.ORG ...
                 _BDOS_START:
                 #include "bdos.inc"			; BDOS extended commands
                 
007fdd 9360 3f40         sts	BDOS_LAST_CALL, zzC
007fdf 935f
007fe0 9150 3f2a
007fe2 fd52
007fe3 940e b003
007fe5 915f      	NOTIFY	NOTIFY_BDOS, DBG_BDOS
                 
                 	; decode function no in zzC, using ccbe macro
007fe6 306b
007fe7 f409
007fe8 c006      	ccbe	BDOS_0B_CONSTA, BDOS_0B_CONSTA_F
007fe9 3066
007fea f409
007feb c009      	ccbe	BDOS_06_DCONIO, BDOS_06_DCONIO_F
                 
007fec ec9a      	ldi	zzPCh, 0xCA
007fed eb8f      	ldi	zzPCl, 0xBF		;!!!! just for the beginning and trap bdos calls !!!!
007fee 9508      	ret
                 
                 
                 
                 ;CONSOLE STAT   NONE            LSB(A)=1 IF CHAR READY
                 BDOS_0B_CONSTA_F:
007fef e052
007ff0 940e 7200 	BIOS_CALL BIOS_FUNC_CONST
007ff2 1115      	cpse	zzA, zero
007ff3 e011      	ldi	zzA, 0x01		; must return 01 if char is ready
007ff4 9508      	ret
                 
                 
                 
                 ; DIRECT CON I/O -7 CHAR IN E  I/O STATUS IN A
                 ; IF E=0FEH,
                 ; INPUT IF E=0FFH
                 BDOS_06_DCONIO_F:
007ff5 14d2      	cp	zzE, FF
007ff6 f039      	breq	BDOS_06_DCONIO_F_L1
                 
007ff7 936f      	push	zzC
007ff8 2d6d      	mov	zzC, zzE
007ff9 e054
007ffa 940e 7200 	BIOS_CALL BIOS_FUNC_CONOUT	; output char
007ffc 916f      	pop	zzC
007ffd c008      	rjmp	BDOS_06_DCONIO_F_RET
                 
                 BDOS_06_DCONIO_F_L1:
007ffe e052
007fff 940e 7200 	BIOS_CALL BIOS_FUNC_CONST	; check char
008001 1515      	cp	zzA, zero
008002 f019      	breq	BDOS_06_DCONIO_F_RET
008003 e053
008004 940e 7200 	BIOS_CALL BIOS_FUNC_CONIN	; read char
                 
                 BDOS_06_DCONIO_F_RET:
008006 9508      	ret
                 BDOS_END:
                 
                 ;.ORG ...
                 PORTS_START:
                 #include "ports.inc"                    ; i/o ports processing commands
                 
                 CPDPORTIN_CMD:
008007 935f
008008 e158
008009 b955
00800a eb5f
00800b b954
00800c e050
00800d bd5d
00800e e550
00800f bd5c
008010 9859
008011 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
008012 982c      	SPI_SELECT
008013 735f      	andi	temp, 0x3f	; just for the case clear 7,6 bits
008014 940e 005f 	call 	DOSPI		; send port number
008016 e05f
008017 955a
008018 f7f1      	delay3	45		; !!!!!! decrease !!!!!!
008019 ef5f      	ldi	temp, 0xff
00801a 940e 005f 	call	DOSPI		; get port value into temp
00801c bc5c
00801d 9a59
00801e b854      	SPI_STOP
00801f 9508      	ret
                 
                 
                 ; output to native CPD port
                 ; temp - port, value = (CDATA+1) 	
                 CPDPORTOUT_CMD:
008020 3d56              cpi	temp, 214	; MUSIC port
008021 f439              brne	_CPDPORTOUT_CMD_DO
008022 937f              push	FROMRAM0
008023 9170 36c0         lds	FROMRAM0, RTC_HW_DISABLE
008025 7078              andi	FROMRAM0, (1<<HW_DSBL_MUS)
008026 917f              pop	FROMRAM0
008027 f009              breq	_CPDPORTOUT_CMD_DO	; ok - not disabled
008028 9508              ret			; MUS is disabled, no output
                 _CPDPORTOUT_CMD_DO:
008029 935f
00802a e158
00802b b955
00802c eb5f
00802d b954
00802e e050
00802f bd5d
008030 e550
008031 bd5c
008032 9859
008033 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
008034 982c      	SPI_SELECT
008035 6450              ori	temp, (1<<6)	; set PORTWRITE flag
008036 940e 005f 	call 	DOSPI		; send port number
008038 e055
008039 955a
00803a f7f1      	delay3	15
00803b 9150 090f 	lds	temp, CDATA+1	; read data from CDATA+1 (data to output)
00803d 940e 005f 	call 	DOSPI		; send value to store
00803f bc5c
008040 9a59
008041 b854      	SPI_STOP
008042 9508      	ret
                 
                 	
                 
                 ; temp - port, return to temp
                 ; >0xf4 - CPU local, >0xd0 - CPD, <0xd0 - processed by HW
                 PORTIN_CMD:
008043 3f54              cpi	temp, 0xf4
008044 f480              brsh	CPU_SPECIAL_IN 	; CPU system port
008045 3d50              cpi	temp, 0xd0
008046 f460              brsh	CPD_PORTIN_CMD 	; CPD system port
                 
008047 9350 0910         sts	CDATA+2, temp
008049 935f      	push	temp
00804a 9150 3f2a 	lds	temp, SYS_NOTIFY	
00804c fd51      	sbrc	temp, 1		; debug ESCAPE
00804d 940e b001 	call	DBG_PORT_IN
00804f 915f      	pop	temp
                 
008050 940c b504         jmp	HW_PORTIN	; Z80 port from HW
                 
008052 9508              ret
                 
                 
                 CPD_PORTIN_CMD:
008053 5d50      	subi	temp, 0xd0
008054 cfb2              rjmp	CPDPORTIN_CMD
                 
                 
                 ; special CPU ports
                 CPU_SPECIAL_IN:
008055 e0f8      	ldi	ZH, 0x08		; high(PORTS_DATABLOCK)
008056 2fe5      	mov	ZL, temp
008057 8150      	ld	temp, Z			; temp = z = port value
                 
008058 3fee              cpi	ZL, low(PCMD_FE)
008059 f408              brsh	CPU_SPECIAL_IN_RET	; cmd ports returns value
                 
00805a ffe0      	sbrs	ZL, 0			; check that data is accessed
                 ;CPU_SPECIAL_IN_PTR:
                 CPU_SPECIAL_IN_RET:
00805b 9508      	ret				; no - return current ptr
                 CPU_SPECIAL_IN_DATA:
00805c 95ea      	dec	ZL			; choose ptr port (-1)
00805d 8150      	ld	temp, Z			; z = ptr to data in BUF
                 
00805e 9553      	inc	temp 
00805f 8350      	st	Z, temp			; store incremented value
008060 955a      	dec	temp			; restore original value
                 
008061 3fe4              cpi	ZL, low(PSVR_RQ)
008062 f0b1              breq	CPU_SPECIAL_IN_SVR 	; CPU system port SVR access
008063 3fe6              cpi	ZL, low(PVAR_RQ)
008064 f079              breq	CPU_SPECIAL_IN_VAR 	; CPU system port VAR access
008065 3fe8              cpi	ZL, low(PCAN_RQ)
008066 f0b9              breq	CPU_SPECIAL_IN_CAN 	; CPU system port CAN access
008067 3fea              cpi	ZL, low(PLAN_RQ)
008068 f0d1              breq	CPU_SPECIAL_IN_LAN 	; CPU system port LAN access
                 ;        ret
                 
                 CPU_SPECIAL_IN_SPI:
008069 3856              cpi	temp, PSPI_BUF_MAXLEN
00806a f430              brsh	CPU_SPECIAL_IN_OVF
00806b efe0
00806c e3f6              ldiw	Z, PSPI_BUF
                 ;        rjmp	CPU_SPECIAL_IN_READ_BUF
                 CPU_SPECIAL_IN_READ_BUF:
00806d 0fe5      	add	ZL, temp
00806e 1df5      	adc	ZH, zero
00806f 8150      	ld	temp, Z			; read data from buffer
008070 9508      	ret
                 
                 CPU_SPECIAL_IN_OVF:
008071 8350      	st	Z, temp			; restore original value
008072 e050      	ldi	temp, 0			; return 0 on overflow
008073 9508      	ret
                 
                 CPU_SPECIAL_IN_VAR:
008074 3f5e              cpi	temp, SHARABLE_MAXLEN
008075 f7d8              brsh	CPU_SPECIAL_IN_OVF
008076 e0e0
008077 e3ff              ldiw	Z, SHARABLE
008078 cff4              rjmp	CPU_SPECIAL_IN_READ_BUF
                 
                 CPU_SPECIAL_IN_SVR:
008079 3153              cpi	temp, SV_DATABLOCK_END-SV_DATABLOCK+1
00807a f7b0              brsh	CPU_SPECIAL_IN_OVF
00807b e3e6
00807c e0f9              ldiw	Z, SV_DATABLOCK
00807d cfef              rjmp	CPU_SPECIAL_IN_READ_BUF
                 
                 CPU_SPECIAL_IN_CAN:
00807e 3254              cpi	temp, CAN_DATABLOCK_END-CAN_DATABLOCK+1
00807f f788              brsh	CPU_SPECIAL_IN_OVF
008080 e8e0
008081 e0f9              ldiw	Z, CAN_DATABLOCK
008082 cfea              rjmp	CPU_SPECIAL_IN_READ_BUF
                 
                 CPU_SPECIAL_IN_LAN:
008083 3359              cpi	temp, LAN_DATABLOCK_END-LAN_DATABLOCK+1
008084 f760              brsh	CPU_SPECIAL_IN_OVF
008085 e4e8
008086 e0f9              ldiw	Z, LAN_DATABLOCK
008087 cfe5              rjmp	CPU_SPECIAL_IN_READ_BUF
                 
                 
                 
                 ; temp - port, value = (CDATA)
                 PORTOUT_CMD:
008088 3f54              cpi	temp, 0xf4
008089 f4b0              brsh	CPU_SPECIAL_OUT	; CPU system port
00808a 3d50              cpi	temp, 0xd0
00808b f460              brsh	CPD_PORTOUT_CMD	; CPD system port
                 
00808c 9350 0910         sts	CDATA+2, temp
00808e 935f      	push	temp
00808f 9150 3f2a 	lds	temp, SYS_NOTIFY	
008091 fd51      	sbrc	temp, 1		; debug ESCAPE
008092 940e b002 	call	DBG_PORT_OUT
008094 915f      	pop	temp
                 
008095 940c b505         jmp	HW_PORTOUT	; Z80 port from HW
008097 9508              ret
                 
                 
                 CPD_PORTOUT_CMD:
008098 5d50      	subi	temp, 0xd0
008099 935f      	push	temp
00809a 9150 090e 	lds	temp, CDATA
00809c 9350 090f 	sts	CDATA+1, temp	; set value for output
00809e 915f      	pop	temp
00809f cf80              rjmp	CPDPORTOUT_CMD
                 
                 
                 ; special CPU ports
                 CPU_SPECIAL_OUT:
0080a0 3f5e              cpi	temp, low(PCMD_FE)
0080a1 f1b1              breq	CPU_SPECIAL_OUT_CMD_FE	; cmd ports works only for out
0080a2 3f5f              cpi	temp, low(PCMD_FF)
0080a3 f1a9              breq	CPU_SPECIAL_OUT_CMD_FF	; cmd ports works only for out
                 
0080a4 e0f8      	ldi	ZH, 0x08
0080a5 2fe5      	mov	ZL, temp
0080a6 9150 090e 	lds	temp, CDATA		; get data
0080a8 8350      	st	Z, temp			; set port value
                 
0080a9 ffe0      	sbrs	ZL, 0			; check that data is accessed
0080aa 9508      	ret				; no - return current ptr
                 CPU_SPECIAL_OUT_DATA:
0080ab 95ea      	dec	ZL			; choose ptr port (-1)
0080ac 8150      	ld	temp, Z			; z = ptr to data in BUF
                 
0080ad 9553      	inc	temp 
0080ae 8350      	st	Z, temp			; store incremented value
0080af 955a      	dec	temp			; restore original value
                 
0080b0 3fe4              cpi	ZL, low(PSVR_RQ)
0080b1 f0b9              breq	CPU_SPECIAL_OUT_SVR 	; CPU system port SVR access
0080b2 3fe6              cpi	ZL, low(PVAR_RQ)
0080b3 f081              breq	CPU_SPECIAL_OUT_VAR 	; CPU system port VAR access
0080b4 3fe8              cpi	ZL, low(PCAN_RQ)
0080b5 f0c1              breq	CPU_SPECIAL_OUT_CAN 	; CPU system port CAN access
0080b6 3fea              cpi	ZL, low(PLAN_RQ)
0080b7 f0d9              breq	CPU_SPECIAL_OUT_LAN 	; CPU system port LAN access
                 
                 CPU_SPECIAL_OUT_SPI:
0080b8 3856              cpi	temp, PSPI_BUF_MAXLEN
0080b9 f440              brsh	CPU_SPECIAL_OUT_OVF
0080ba efe0
0080bb e3f6              ldiw	Z, PSPI_BUF
                 
                 CPU_SPECIAL_OUT_WRITE_BUF:
0080bc 0fe5      	add	ZL, temp
0080bd 1df5      	adc	ZH, zero
0080be 9150 090e 	lds	temp, CDATA		; get data
0080c0 8350      	st	Z, temp			; write data to buffer
0080c1 9508      	ret
                 
                 CPU_SPECIAL_OUT_OVF:
0080c2 8350      	st	Z, temp			; restore original value
                 ;	ldi	temp, 0			; return 0 on overflow
0080c3 9508      	ret
                 
                 CPU_SPECIAL_OUT_VAR:
0080c4 3f5e              cpi	temp, SHARABLE_MAXLEN
0080c5 f7e0              brsh	CPU_SPECIAL_OUT_OVF
0080c6 e0e0
0080c7 e3ff              ldiw	Z, SHARABLE
0080c8 cff3              rjmp	CPU_SPECIAL_OUT_WRITE_BUF
                 
                 CPU_SPECIAL_OUT_SVR:
0080c9 3153              cpi	temp, SV_DATABLOCK_END-SV_DATABLOCK+1
0080ca f7b8              brsh	CPU_SPECIAL_OUT_OVF
0080cb e3e6
0080cc e0f9              ldiw	Z, SV_DATABLOCK
0080cd cfee              rjmp	CPU_SPECIAL_OUT_WRITE_BUF
                 
                 CPU_SPECIAL_OUT_CAN:
0080ce 3254              cpi	temp, CAN_DATABLOCK_END-CAN_DATABLOCK+1
0080cf f790              brsh	CPU_SPECIAL_OUT_OVF
0080d0 e8e0
0080d1 e0f9              ldiw	Z, CAN_DATABLOCK
0080d2 cfe9              rjmp	CPU_SPECIAL_OUT_WRITE_BUF
                 
                 CPU_SPECIAL_OUT_LAN:
0080d3 3359              cpi	temp, LAN_DATABLOCK_END-LAN_DATABLOCK+1
0080d4 f768              brsh	CPU_SPECIAL_OUT_OVF
0080d5 e4e8
0080d6 e0f9              ldiw	Z, LAN_DATABLOCK
0080d7 cfe4              rjmp	CPU_SPECIAL_OUT_WRITE_BUF
                 
                 
                         ; special commands with external devices
                 CPU_SPECIAL_OUT_CMD_FE:
0080d8 c004              rjmp	_CPU_SPECIAL_OUT_CMD_FE
                 
                 
                         ; special commands logic
                 CPU_SPECIAL_OUT_CMD_FF:
0080d9 d056              rcall	_CPU_SPECIAL_OUT_CMD_FF
0080da 9350 08ff         sts	PCMD_FF, temp
0080dc 9508              ret
                 
                 
                         ; special commands with external devices
                 _CPU_SPECIAL_OUT_CMD_FE:
0080dd 9150 090e         lds	temp, CDATA
0080df 3050      	cpi	temp, fe_spi_base	; 0
0080e0 f409      	brne	_CPU_SPECIAL_OUT_CMD_FE_l0	
0080e1 c024      	rjmp	SPCMD_EXEC_SPI
                 _CPU_SPECIAL_OUT_CMD_FE_l0:
0080e2 3051      	cpi	temp, fe_sd_base	; 1
0080e3 f051      	breq	SPCMD_SD_INIT
0080e4 3150      	cpi	temp, fe_can_base	;16
0080e5 f078      	brlo	SPCMD_EEPROM
0080e6 3350      	cpi	temp, fe_lan_base	;48
0080e7 f080      	brlo	SPCMD_CAN
0080e8 3550      	cpi	temp, fe_rtc_base	;80
0080e9 f088      	brlo	SPCMD_LAN
0080ea 3650      	cpi	temp, fe_res_base	;96
0080eb f090      	brlo	SPCMD_RTC
0080ec 940c bacf 	jmp	USER_PORT_FE		; for commands >0x80 user exit
                 ;	ret;
                 
                 
                 SPCMD_SD_INIT:
0080ee 940e 9000 	call	SD_INIT
0080f0 9150 3f15 	lds	temp, SD_TYPE
0080f2 9350 08fe 	sts	PCMD_FE, temp
0080f4 9508      	ret
                 
                 
                 	; EEPROM access shares SPI buffer
                 	;.EQU	ROM_BUF_ADDR_ROM = PSPI_BUF
                 	;.EQU	ROM_BUF_ADDR_RAM = PSPI_BUF+2
                 	;.EQU	ROM_BUF_ADDR_LENGTH = PSPI_BUF+2
                 SPCMD_EEPROM:
0080f5 5052      	subi	temp, fe_eeprom_base
                 ;	cfmem	HW_FOUND, HW_FOUND_ROM
                 ;	breq	SPCMD_notfound
0080f6 940c b302 	jmp	EEPROM_CMD
                 
                 
                 SPCMD_CAN:
0080f8 5150      	subi	temp, fe_can_base
                 ;	cfmem	HW_FOUND, HW_FOUND_CAN
                 ;	breq	SPCMD_notfound
0080f9 940c a402 	jmp	CAN_CMD
                 
                 
                 SPCMD_LAN:
0080fb 5350      	subi	temp, fe_lan_base
                 ;	cfmem	HW_FOUND, HW_FOUND_LAN
                 ;	breq	SPCMD_notfound
0080fc 940c 9400 	jmp	LAN_CMD
                 
                 
                 SPCMD_RTC:
0080fe 5550      	subi	temp, fe_rtc_base
                 ;	cfmem	HW_FOUND, HW_FOUND_RTC
                 ;	breq	SPCMD_notfound
0080ff 940c b30f 	jmp	RTC_CMD
                 
                 
                 
                 SPCMD_notfound:
008101 9250 0081         sts     TCCR1B, zero 		; stop aux timer just for the case
008103 9220 08fe 	sts	PCMD_FE, FF		; error mark
008105 9508      	ret
                 
                 
                 
                 
                 SPCMD_EXEC_SPI:
008106 9150 36f1 	lds	temp, PSPI_SPEED
008108 935f      	push	temp
008109 9150 36f0 	lds	temp, PSPI_ADDR
                 ;	push	temp
00810b 705f
00810c 6150
00810d b955
00810e eb5f
00810f b954
008110 915f
008111 935f
008112 9552
008113 7051
008114 bd5d
008115 915f
008116 705f
008117 6550
008118 bd5c
008119 9859      	SPI_INIT_STACK			; init SPI Macros
                 
                 	; access pre-selected SPI module
00811a 931f      	push	zzA
00811b 9110 08fc 	lds	zzA, PSPI_RQ		; buf length (set after buffer fill outs)
00811d 5012      	subi	zzA, 2			; remove addr and prescaler from data block
00811e efe2
00811f e3f6      	ldiw	Z, PSPI_BUF_DATA	; select SPI buffer
008120 982c      	SPI_SELECT			; select device
                 CSP_SPI_EXEC_L1:
008121 3010      	cpi	zzA, 0
008122 f031      	breq	CSP_SPI_EXEC_END
008123 951a      	dec	zzA
008124 8150      	ld	temp, Z
008125 940e 005f 	call	DOSPI
008127 9351      	st	Z+, temp		; store response
008128 cff8      	rjmp	CSP_SPI_EXEC_L1
                 CSP_SPI_EXEC_END:
008129 9350 08fe 	sts	PCMD_FE, temp		; last received value as port value
00812b bc5c
00812c 9a59
00812d b854      	SPI_STOP
00812e 911f      	pop	zzA
00812f 9508      	ret
                 
                 
                 
                 _CPU_SPECIAL_OUT_CMD_FF:
008130 9150 090e         lds	temp, CDATA		; data to output
                 
008132 9170 09a4 	lds	FROMRAM0, PORT_FF_CCMD	; command is processed?
008134 3270      	cpi	FROMRAM0, 32
008135 f0e1      	breq	_pReg			; return Register value
008136 3271      	cpi	FROMRAM0, 33
008137 f111      	breq	_pRegW8			; write 8bit AVR Register
008138 3272      	cpi	FROMRAM0, 34
008139 f191      	breq	_pRegW16		; write 16bit AVR Register
                 ;	sts	PORT_FF_CCMD, zero
                 
                 ;        sts	PCMD_FF, temp
00813a 3250              cpi	temp, 32
00813b f080              brlo	_pfloat			; floating point operation
00813c 3253
00813d f409
00813e c017      	tcbe	35, _pVersionL		; return Version Low 
00813f 3254
008140 f409
008141 c016      	tcbe	36, _pVersionH		; return Version Hi 
                 ;        rjmp	_pff_start_ccmd
                 ;	ret
                 
                 _pff_start_ccmd:
008142 9350 09a4 	sts	PORT_FF_CCMD, temp
008144 9250 090f 	sts	CDATA+1, zero		; clear par counter
008146 9508      	ret
                 
                 _pff_stop_ccmd:
008147 9350 08fe 	sts	PCMD_FE, temp
008149 9250 09a4 	sts	PORT_FF_CCMD, zero
00814b 9508      	ret
                 	
                 _pfloat:
00814c 9250 09a4 	sts	PORT_FF_CCMD, zero	; clear request
00814e 9350 3f33 	sts	FLIB_CMD, temp
008150 940c bad0 	jmp	FLOAT
                 
                 _pReg:
008152 2fe5      	mov	ZL, temp
008153 e0f0      	ldi	ZH, 0
008154 8150      	ld	temp, Z			; read AVR register value
008155 cff1      	rjmp	_pff_stop_ccmd
                 
                 _pVersionL:
008156 e452      	ldi	temp, 66		; version low value
008157 cfef      	rjmp	_pff_stop_ccmd
                 
                 _pVersionH:
008158 e054      	ldi	temp, 4			; version hi value
008159 cfed      	rjmp	_pff_stop_ccmd
                 
                 ; write 8bit AVR register
                 _pRegW8:
00815a 9150 090f 	lds	temp, CDATA+1		; par counter
00815c 3051      	cpi	temp, 1
00815d f038      	brlo	_pRegW8_s1
00815e 91e0 0910 	lds	ZL, CDATA+2		; stored register address
008160 e0f0      	ldi	ZH, 0
008161 9150 090e 	lds	temp, CDATA		; value
008163 8350      	st	Z, temp			; assign value
008164 cfe2      	rjmp	_pff_stop_ccmd
                 _pRegW8_s1:
008165 9150 090e 	lds	temp, CDATA
008167 9350 0910 	sts	CDATA+2, temp		; first parameter - register address
008169 9290 090f 	sts	CDATA+1, one
00816b 9508      	ret
                 
                 ; write 16bit AVR register
                 _pRegW16:
00816c 9150 090f 	lds	temp, CDATA+1		; par counter
00816e 3051      	cpi	temp, 1
00816f f058      	brlo	_pRegW16_s1
008170 f089      	breq	_pRegW16_s2
008171 91e0 0910 	lds	ZL, CDATA+2		; stored register address
008173 e0f0      	ldi	ZH, 0
008174 9150 0911 	lds	temp, CDATA+3		; Hi value
008176 9351      	st	Z+, temp		; assign Hi value first
008177 9150 090e 	lds	temp, CDATA		; Low value
008179 8350      	st	Z, temp			; assign Low value
00817a cfcc      	rjmp	_pff_stop_ccmd
                 _pRegW16_s1:
00817b 9150 090e 	lds	temp, CDATA		; 
00817d 9350 0910 	sts	CDATA+2, temp		; first parameter - register address
00817f 9290 090f 	sts	CDATA+1, one		; increment counter
008181 9508      	ret
                 _pRegW16_s2:
008182 9150 090e 	lds	temp, CDATA		; 
008184 9350 0911 	sts	CDATA+3, temp		; second parameter - hi byte of value
008186 e052      	ldi	temp, 2
008187 9350 090f 	sts	CDATA+1, temp		; inc counter
008189 9508      	ret
                 ;#include "svideo.inc" 			; svideo-adapter ports processing commands
                 PORTS_END:
                 
                 ; --------------------- WELCOME, TOOLS --------------------
                 
                 .ORG 0x08800		; 1 10
                 
008800 940c 8806 INITPROC:	jmp	INITPROC_CMD
008802 940c 8898 z80INITPROC:	jmp	z80INITPROC_CMD
008804 940c 8a60 DOSTART:	jmp	DOSTART_CMD
                 
                 INITPROC_START:
                 #include  "init.inc"			; initializing
                 
                     	; PORT directions
                 
                 	; D: bus decoder,  buzzer, RAM WE, OE
008806 ef5f
008807 b95b      	_out	PORTD, 0xFF 	  			; spi disabled, memory not selected
008808 e352
008809 b95a      	_out	DDRD, (1<<PD1)|(1<<PD4)|(1<<PD5)	; SPIE, WE, OE
                 
                     	; address bus to out
00880a ef5f
00880b b951      	_out	DDRA, 0xff        	; low adress bus
00880c ef5f
00880d b957      	_out	DDRC, 0xff        	; high address bus
                 
00880e e050
00880f b954      	_out	DDRB, 0           	; data port to in
                 
008810 e051
008811 bf5b      	_out	RAMPZ, 1		; elpm reads from high memory
                 
                 	; external interrupts settings
008812 ec54
008813 9350 0073 	_outm	PCMSK3, (1<<PCINT30)|(1<<PCINT31)|(1<<PCINT26)	; ext interrupts: D7- LAN, D6 - RTC, D0 - CPD
008815 e058
008816 9350 0068 	_outm	PCICR, (1<<PCIE3)	;
                 
                 	; power save settings
008818 e853
008819 9350 0064 	_outm	PRR0, (1<<PRTWI)|(1<<PRADC)|(1<<PRUSART0)	; Power reduction: disable TWI, UART0, ADC
                 
                 	; mesage from CPD
                 ;	_outm	UBRR0H, 0
                 ;	_outm	UBRR0L, 21		; 21 = 57600 at 20MHz 
                 ;	_outm	UCSR0C, (1<<UCSZ01) | (1<<UCSZ00)	; 8 bit no parity 1 stop bit
                 ;	_outm	UCSR0B, (1<<RXEN0) | (1<<RXCIE0)	; Rx and RxInt enabled
                 
                 	; external incoming UART
00881b e050
00881c 9350 00cd 	_outm	UBRR1H, 0
00881e e05a
00881f 9350 00cc 	_outm	UBRR1L, 10		; 21 = 57600 at 20MHz 10=115200
008821 e056
008822 9350 00ca 	_outm	UCSR1C, (1<<UCSZ11) | (1<<UCSZ10)	; 8 bit no parity 1 stop bit
008824 e958
008825 9350 00c9 	_outm	UCSR1B, (1<<RXEN1) | (1<<TXEN1) | (1<<RXCIE1)	; Rx and RxInt enabled
                 
008827 ee5f
008828 2e35      	_ldi	RAMOE, 	~(1<<PD4)	; /OE
008829 ed5f
00882a 2e45      	_ldi	RAMWE,  ~(1<<PD5)	; /WE
00882b ef5d
00882c 2e05      	_ldi	SPIMODE,~(1<<PD1) 	; /SPIE
00882d e050
00882e 2e55      	_ldi	ZERO, 	0		; 0
00882f e051
008830 2e95      	_ldi	ONE, 	1		; 1
008831 ef5f
008832 2e25      	_ldi	FF, 	0xff		; Videoram start for cp
008833 ef58
008834 2e65      	_ldi	VIDEORAM, 0xf8
                 
                 	; init AVR RAM with 0
008835 e0d1      	ldi	YH, 1
008836 e0c0      	ldi	YL, 0 
008837 2455      	clr	zero
008838 e450      	ldi	temp, high(STACK)
                 L_INIT_4:
008839 9259      	st	Y+, zero
00883a 38c0      	cpi	YL, low(STACK)
00883b 07d5      	cpc	YH, temp
00883c f7e1      	brne	L_INIT_4
                 
                 
00883d 9290 3f06 	sts	CURSOR_X, one           ; cursor X position, 1-80
00883f 9290 3f07 	sts	CURSOR_Y, one		; cursor Y position, 1-25
008841 9250 3f08 	sts	CURSOR_STATUS, zero     ; =0 if cursor is on, 0x80 if is off
                 
008843 e158      	ldi	temp, 24
008844 9350 3f09 	sts	CRT_LINES, temp
008846 e550      	ldi	temp, 80
008847 9350 3f0a 	sts	CRT_CHARS, temp
008849 9250 3f05 	sts	CRT_SETTINGS, zero	
                 
00884b e850      	ldi	temp, low(0x100+24*80)
00884c 9350 3f0b 	sts	VIDEO_END, temp
00884e e058      	ldi	temp, high(0x100+24*80)
00884f 9350 3f0c 	sts	VIDEO_END+1, temp	; end of video ram starting from 0x100	
                 
008851 9250 3f0d 	sts	VIDEO_CURSOR, zero
008853 9290 3f0e 	sts	VIDEO_CURSOR+1, one	; cursor position in videoram = 0x100
                 
008855 9250 3f0f 	sts	BIOS_DISK, zero	
008857 9250 3f10 	sts	BIOS_TRACK, zero
008859 9250 3f12 	sts	BIOS_SECTOR, zero
00885b 9250 3f13 	sts	BIOS_DMA, zero
                 
00885d 9250 091c 	sts	CON_ESC, zero		; count chars in ESC-sequence
                 ;	sts	CON_ESC_C5, zero	; ATTRIBUTES
                 
00885f e151      	ldi	temp, (1<<CON_OUT_CON) | (1<<CON_IN_CON)
008860 9350 3f01 	sts	CON_IOBYTE, temp	; IOBYTE xxxx0000 = outputs, 0000xxxx = inputs
008862 9250 3f48 	sts	PR_IOBYTE, zero
                 
008864 e058      	ldi	temp, (1<<LST_OUT_LST)
008865 9350 36e4 	sts	RTC_DEV_IOBYTE, temp	; LST channel
                 
008867 e150      	ldi	temp, (1<<SDC_SRC_SDC)
008868 9350 36e4 	sts	RTC_DEV_IOBYTE, temp	; SDC channel
                 
00886a 9250 3f03 	sts	INT_MASK, zero		; interrupt mask
00886c 9250 3f04 	sts	INT_MASK+1, zero	; interrupt mask
                 
00886e 9250 3f00 	sts	HW_FLAG, zero		; CRISS
                 
008870 940e 7f47 	call	BIOS_MOUSE_INIT		; init automouse settings
                 
                 ;	ldi	temp, 0x11		; CON only output
                 ;	sts	CON_IOBYTE, temp
                 ;	sts	PR_IOBYTE, zero
                 
                 ;	_outm	TWBR, 0x88		; used as internal IOBYTE
008872 ba5e      	out	GPIOR0, zero		; IRQ handling - IRQ flags for CPU IRQs
008873 bc5a      	out	GPIOR1, zero            ; IRQ handling - IRQ flags for CPU IRQs - stored CPD requests
                 ;	out	GPIOR2, zero		; opcode table pointer z80_init.inc
                 
                         ; internal timer accessible from z-prog
008874 e050
008875 9350 00b6 	_outm	ASSR, 0
008877 ec50
008878 9350 00b3 	_outm	OCR2A, 192		; 0.01 s
00887a e052
00887b 9350 00b0 	_outm	TCCR2A, (1<<WGM21)	; CTC mode
00887d e052
00887e 9350 0070 	_outm	TIMSK2, (1<<OCIE2A)	; oerflow interrupt
008880 e057
008881 9350 00b1 	_outm	TCCR2B, (1<<CS20)|(1<<CS21)|(1<<CS22)		; timer 2 fclk/1024
008883 e050
008884 9350 00b2 	_outm	TCNT2, 0
                 
                 	; init RAM with ' '
008886 e0d0      	ldi	YH, 0
008887 e0c0      	ldi	YL, 0 
008888 e220      	ldi	r18, ' '
                 L_INIT_3:
008889 b9d8
00888a b9c2
00888b b925
00888c ef5f
00888d b954
00888e 985d
00888f 9a5d      	_STRAM	YH, YL, r18
008890 9621      	adiw	Y, 1
008891 15c5      	cp	YL, zero
008892 05d5      	cpc	YH, zero
008893 f7a9      	brne	L_INIT_3
                 
008894 27cc      	clr	YL
008895 27dd      	clr	YH
008896 2722      	clr	r18
                 
008897 9508      	ret
                 #include  "z80init.inc"			; initializing z80 data
                 
                 
                 z80INITPROC_CMD:
                 	; load opcodes jumps and other data data into the RAM
008898 e0a0      	ldi	Xl, low(RAMOPCODES)
008899 e0ba      	ldi 	Xh, high(RAMOPCODES)
00889a e0e0      	ldi	Zl, 0
                 ;	ldi 	Zh, 0
00889b eaf0      	ldi 	Zh, high(ROMDATA*2)
                 INIT_ML1LOOP:
00889c 9157      	elpm	temp, Z+
00889d 935d      	st	X+, temp
00889e 30a0      	cpi	Xl, low(RAMOPCODESEND)
00889f e25b      	ldi	temp, high(RAMOPCODESEND)
0088a0 07b5      	cpc 	Xh, temp
0088a1 f7d1      	brne 	INIT_ML1LOOP
                 
                 	; load irq calls
0088a2 e0a0      	ldi	Xl, low(IRQOPCODES)
0088a3 e2bb      	ldi 	Xh, high(IRQOPCODES)
0088a4 e053      	ldi	temp, low(EXTINTRPOC)
                 INIT_ML2LOOP:
0088a5 935d      	st	X+, temp
0088a6 30a0      	cpi	Xl, 0
0088a7 f7e9      	brne 	INIT_ML2LOOP
                 
0088a8 e750      	ldi	temp, high(EXTINTRPOC)
                 INIT_ML2LOOP_l:
0088a9 935d      	st	X+, temp
0088aa 30a0      	cpi	Xl, 0
0088ab f7e9      	brne 	INIT_ML2LOOP_l
                 
0088ac e05a      	ldi	temp, high(zOPCODE__LBLS_L)
0088ad bd5b      	out	GPIOR2, temp		; GPIOR2 contains high pointer to decode table
                 
                 	; reset z80 registers
0088ae e050
0088af 2f15      	_ldi	zzA, 0
0088b0 e050
0088b1 2f45      	_ldi	zzF, 0
0088b2 e050
0088b3 2ea5      	_ldi	zzB, 0
0088b4 e050
0088b5 2f65      	_ldi	zzC, 0
0088b6 e050
0088b7 2ec5      	_ldi	zzD, 0
0088b8 e050
0088b9 2ed5      	_ldi	zzE, 0
0088ba e050
0088bb 2ee5      	_ldi	zzH, 0
0088bc e050
0088bd 2ef5      	_ldi	zzL, 0
0088be e050
0088bf 2f05      	_ldi	zzIXl, 0
0088c0 e050
0088c1 2e85      	_ldi	zzIXh, 0
0088c2 e050
0088c3 2eb5      	_ldi	zzIYl, 0
0088c4 e050
0088c5 2f35      	_ldi	zzIYh, 0
                 
                 	; reset memory stored registers
0088c6 9250 0900 	sts	zzI, zero
0088c8 9250 0901 	sts	zzAe, zero
0088ca 9250 0902 	sts	zzFe, zero
0088cc 9250 0903 	sts	zzBe, zero
0088ce 9250 0904 	sts	zzCe, zero
0088d0 9250 0905 	sts	zzDe, zero
0088d2 9250 0906 	sts	zzEe, zero
0088d4 9250 0907 	sts	zzHe, zero
0088d6 9250 0908 	sts	zzLe, zero
0088d8 9250 0909 	sts	zzIFF1, zero
0088da 9250 090a 	sts	zzIFF2, zero
0088dc 9250 090b 	sts	zzIM, zero
0088de 9250 090c 	sts	zzRhb, zero
                 
0088e0 e052
0088e1 bd55      	_out	TCCR0B, (1<<CS01)		; timer for zzR fclk/8
                 
0088e2 9508      	ret
                 INITPROC_END:
                 
                 ;.ORG ...
                 COMMONS:
                 #include "commons.inc"                  ; misc procedures for start.inc
                 
                 ; output predefined string to directly to CPD
                 DO_PUTS:
0088e3 91d7      	elpm	YH, Z+
0088e4 91c7      	elpm	YL, Z+
                 DPS_CHAR:
0088e5 9137      	elpm	r19, Z+
0088e6 2b33      	or 	r19, r19
0088e7 f019      	breq 	DPS_END
0088e8 940e 88ec 	call	DPS_CHAROUT
0088ea cffa      	rjmp 	DPS_CHAR
                 DPS_END:
0088eb 9508      	ret
                     
                 
                 ; output single char (r19) to CPD
                 DPS_CHAROUT:
0088ec 2f5d      	mov	temp, YH
0088ed 940e 005f 	call 	DOSPI 
0088ef 2f5c      	mov	temp, YL
0088f0 940e 005f 	call 	DOSPI
0088f2 2f53      	mov	temp, r19
0088f3 940e 005f 	call	DOSPI
0088f5 9621      	adiw	Y, 1
0088f6 9508      	ret
                 
                 
                 ; outpu in8 as hex (r18)
                 STR_PUTHEX:
                 	; higher half-byte
0088f7 2f32      	mov	r19, r18
0088f8 9536      	lsr	r19
0088f9 9536      	lsr	r19
0088fa 9536      	lsr	r19
0088fb 9536      	lsr	r19			; >>4
0088fc 303a      	cpi	r19, 10
0088fd f010      	brlo  	str_tl_01    
0088fe e257      	ldi	temp, 'a'-'0'-10
0088ff 0f35      	add	r19, temp
                 str_tl_01:
008900 e350      	ldi	temp, '0'
008901 0f35      	add   	r19, temp
008902 940e 88ec 	call  	DPS_CHAROUT
                 
                 	; lower half-byte
008904 2f32      	mov   	r19, r18
008905 703f      	andi	r19, 0x0f
008906 303a      	cpi	r19, 10
008907 f010      	brlo  	str_tl_02
008908 e257      	ldi	temp, 'a'-'0'-10
008909 0f35      	add	r19, temp
                 str_tl_02:
00890a e350      	ldi	temp, '0'
00890b 0f35      	add	r19, temp
00890c 940e 88ec 	call	DPS_CHAROUT
                 
00890e 9508      	ret
                 
                 
                 
                 ; ------------------------------------------------------------------------------
                 STR_OUT: 
00890f 935f              push	temp
008910 932f      	push	r18
                 STR_OUT_L2: 
008911 9167      	elpm	zzC, Z+
008912 3060      	cpi	zzC, 0
008913 f019      	breq	STR_OUT_L1
                 ;	mov	zzC, temp
008914 e054      	ldi	temp, 0x04
008915 d09f      	rcall	COM_BIOS_CMD
008916 cffa      	rjmp	STR_OUT_L2
                 STR_OUT_L1:
008917 912f      	pop	r18
008918 915f      	pop	temp
008919 9508      	ret
                 
                 
                 
                 ; ------------------------------------------------------------------------------
                 STR_OUT_RAM: 
00891a 9151      	ld	temp, Z+
00891b 3050      	cpi	temp, 0
00891c f409      	brne	STR_OUT_RAM_L1
00891d 9508      	ret
                 STR_OUT_RAM_L1:
00891e 2f65      	mov	zzC, temp
00891f e054      	ldi	temp, 0x04
008920 d094      	rcall	COM_BIOS_CMD
008921 cff8      	rjmp	STR_OUT_RAM
                 
                 
                 
                 ; ------------------------------------------------------------------------------
                 ; outpu in8 as hex (r18)
                 STR_HEXOUT:
                 	; higher half-byte
008922 2f32      	mov	r19, r18
008923 9536      	lsr	r19
008924 9536      	lsr	r19
008925 9536      	lsr	r19
008926 9536      	lsr	r19			; >>4
008927 303a      	cpi	r19, 10
008928 f010      	brlo  	str_ho_01    
008929 e257      	ldi	temp, 'a'-'0'-10
00892a 0f35      	add	r19, temp
                 str_ho_01:
00892b e350      	ldi	temp, '0'
00892c 0f35      	add   	r19, temp
00892d 2f63      	mov	zzC, r19
00892e e054      	ldi	temp, 0x04
00892f d085      	rcall	COM_BIOS_CMD
                 ;	call  	DPS_CHAROUT
                 
                 	; lower half-byte
008930 2f32      	mov   	r19, r18
008931 703f      	andi	r19, 0x0f
008932 303a      	cpi	r19, 10
008933 f010      	brlo  	str_ho_02
008934 e257      	ldi	temp, 'a'-'0'-10
008935 0f35      	add	r19, temp
                 str_ho_02:
008936 e350      	ldi	temp, '0'
008937 0f35      	add	r19, temp
008938 2f63      	mov	zzC, r19
008939 e054      	ldi	temp, 0x04
00893a d07a      	rcall	COM_BIOS_CMD
                 ;	call	DPS_CHAROUT
                 
00893b 9508      	ret
                 
                 
                 
                 ; --------------------------------------------------------------------------------------
                 ; send temp via uart1
                 UART1_SEND:
00893c 935f      	push	temp
                 US1:	
00893d 9150 00c8     	lds	temp, UCSR1A
00893f ff55      	sbrs	temp, UDRE1
008940 cffc      	rjmp	US1
008941 915f      	pop	temp
008942 9350 00ce 	sts	UDR1, temp
008944 9508      	ret
                 
                 
                 
                 ; ------------------------------------------------------------------------------
                 ; outpu in8 as hex (temp)
                 UART1_HEXOUT:
                 	; higher half-byte
008945 933f      	push	r19
008946 935f      	push	temp
008947 2f35      	mov	r19, temp
008948 9536      	lsr	r19
008949 9536      	lsr	r19
00894a 9536      	lsr	r19
00894b 9536      	lsr	r19			; >>4
00894c 303a      	cpi	r19, 10
00894d f010      	brlo  	uart1_ho_01    
00894e e257      	ldi	temp, 'a'-'0'-10
00894f 0f35      	add	r19, temp
                 uart1_ho_01:
008950 e350      	ldi	temp, '0'
008951 0f53      	add   	temp, r19
008952 940e 893c 	call	UART1_SEND
                 	; lower half-byte
008954 913f      	pop	r19
008955 703f      	andi	r19, 0x0f
008956 303a      	cpi	r19, 10
008957 f010      	brlo  	uart1_ho_02
008958 e257      	ldi	temp, 'a'-'0'-10
008959 0f35      	add	r19, temp
                 uart1_ho_02:
00895a e350      	ldi	temp, '0'
00895b 0f53      	add	temp, r19
00895c 940e 893c 	call	UART1_SEND
00895e 913f      	pop	r19
00895f 9508      	ret
                 
                 
                 
                 SYSTEM_BEEP:
008960 9150 36c0 	lds	temp, RTC_HW_DISABLE		; check that buzzer enabled
008962 fd50      	sbrc	temp, HW_DSBL_BUZ
008963 9508      	ret
                 
                 	; setup timeout timer
008964 e055              ldi     temp, (1<<CS12)|(1<<CS10)  	; fclk/1024 
008965 9350 0081         sts     TCCR1B, temp 			; start timer
                 
                 	; init timeout timer, time in ms
008967 e05f              ldi	temp, ((200)*76/1000)
008968 9350 0089         sts	OCR1AH, temp
00896a 9250 0088         sts	OCR1AL, zero
00896c 9250 0085         sts	TCNT1H, zero
00896e 9250 0084         sts	TCNT1L, zero
008970 9ab1              sbi	TIFR1, OCF1A  ; clear oc1a flag
                 
008971 935f
008972 e15b
008973 b955
008974 eb5f
008975 b954
008976 e050
008977 bd5d
008978 e551
008979 bd5c
00897a 9859
00897b 915f              SPI_INIT SPI_SLAVE_BUZ, SPI_FCK_DIV_16
00897c 982c              SPI_SELECT
                 SYSTEM_BEEP_W:
00897d 9bb1              sbis    TIFR1, OCF1A
00897e cffe              rjmp	SYSTEM_BEEP_W
00897f bc5c
008980 9a59
008981 b854              SPI_STOP
008982 9250 0081 	sts     TCCR1B, zero
008984 9508      	ret
                 
                 
                 ; --------------------------------------------------------------------------------------
                 ; convert BCD to hex
                 BCD_to_HEX:
008985 931f              push	zzA
008986 920f      	push	r0
008987 921f      	push	r1
008988 935f      	push	temp
008989 7f50      	andi    temp,0xf0    ; Mask the register, as the MSB
00898a 9552      	swap    temp         ; Change tetrad places
00898b e01a      	ldi     zzA,10       ; Write to the auxiliary register 10 value
00898c 9f51      	mul     temp,zzA     ; Multiply the value of r16 register 10, the result is stored in the registers r1, r0
00898d 915f      	pop     temp         ; get the stored value from the stack
00898e 705f          	andi    temp,0x0f    ; Mask the register r16, as the LSB
00898f 0d50          	add     temp,r0      ; Adds the r16 register with register r0, the result is a binary number from 0 to 99
008990 901f      	pop	r1
008991 900f      	pop	r0
008992 911f      	pop	zzA
008993 9508      	ret
                 
                 
                 ; convert HEX to BCD
                 HEX_to_BCD:
008994 931f      	push	zzA
008995 2711      	clr     zzA            ; clear register help
                 HEX_to_BCD_l: 
008996 505a      	subi    temp,10        ; temp = temp  10
008997 f010      	brcs    HEX_to_BCD_2   ; Abort if the transfer set
008998 9513      	inc     zzA            ; Increment r17	
008999 cffc      	rjmp    HEX_to_BCD_l   ; We pass on the testing cycle again
                 HEX_to_BCD_2: 
00899a 5f56      	subi    temp,-10       ; compensate a negative value in r16
00899b 9512      	swap    zzA            ; Change tetrad places
00899c 2b51      	or	temp,zzA       ; Combine the received values in a packed BCD
00899d 911f      	pop	zzA
00899e 9508      	ret
                 
                 
                 ; move Y btes from Z to X backward
                 LAN_ZXYb:
00899f 0fec
0089a0 1fdd      	addw	Z, Y
0089a1 0fac
0089a2 1fdd      	addw	X, Y			; start from end
                 _lan_zxyb_l0:				; moving data block to desirep position
0089a3 30d0      	cpi	YH, 0
0089a4 f411      	brne	_lan_zxyb_l2
0089a5 30c0      	cpi	YL, 0
0089a6 f021      	breq	_lan_zxyb_l1
                 _lan_zxyb_l2:
0089a7 9152      	ld	temp, -Z
0089a8 935e      	st	-X, temp
0089a9 9721      	sbiw	Y, 1
0089aa cff8      	rjmp	_lan_zxyb_l0
                 _lan_zxyb_l1:
0089ab 9508      	ret
                 
                 
                 	; move Y btes from Z to X
                 LAN_ZXYf:
                 _lan_zxyf_l0:				; moving data block to desirep position
0089ac 30d0      	cpi	YH, 0
0089ad f411      	brne	_lan_zxyf_l2
0089ae 30c0      	cpi	YL, 0
0089af f021      	breq	_lan_zxyf_l1
                 _lan_zxyf_l2:
0089b0 9151      	ld	temp, Z+
0089b1 935d      	st	X+, temp
0089b2 9721      	sbiw	Y, 1
0089b3 cff8      	rjmp	_lan_zxyf_l0
                 _lan_zxyf_l1:
0089b4 9508      	ret
                 
                 
                 	; call to BIOS, safe registers
                 COM_BIOS_CMD:
0089b5 93ff
0089b6 93ef              pushw	Z
0089b7 932f      	push	r18
0089b8 933f      	push	r19
0089b9 935f      	push	temp
0089ba 940e 7202 	call	BIOS_CMD
0089bc 915f      	pop	temp
0089bd 913f      	pop	r19
0089be 912f      	pop	r18
0089bf 91ef
0089c0 91ff      	popw	Z
0089c1 9508      	ret
                 
                 
                 	; copy TEMP bytes from X (AVR) to Z (RAM)
                 MCOPY_AVR_RAM:
0089c2 931f      	push	zzA
                 MCOPY_AVR_RAM_L1:
0089c3 911d      	ld	zzA, X+
0089c4 b9f8
0089c5 b9e2
0089c6 b915
0089c7 b824
0089c8 15f6
0089c9 985d
0089ca f100
0089cb b82b
0089cc 935f
0089cd e158
0089ce b955
0089cf eb5f
0089d0 b954
0089d1 e050
0089d2 bd5d
0089d3 e550
0089d4 bd5c
0089d5 9859
0089d6 915f
0089d7 982c
0089d8 931f
0089d9 2f5f
0089da 940e 005f
0089dc e054
0089dd 955a
0089de f7f1
0089df 2f5e
0089e0 940e 005f
0089e2 e054
0089e3 955a
0089e4 f7f1
0089e5 915f
0089e6 940e 005f
0089e8 bc5c
0089e9 9a59
0089ea b854
0089eb b82b      	STRAM	ZH, ZL, zzA
0089ec 9631      	adiw	Z, 1
0089ed 955a      	dec	temp
0089ee f6a1      	brne	MCOPY_AVR_RAM_L1			; store data to RAM
0089ef 911f      	pop	zzA
0089f0 9508      	ret
                 
                 
                 	; copy Y bytes from X (AVR) to Z (RAM)
                 MCOPY_AVR_RAM_Y:
0089f1 931f      	push	zzA
0089f2 9621      	adiw	Y, 1
0089f3 c02a      	rjmp	MCOPY_AVR_RAM_Y_L2			; check for Y=0
                 MCOPY_AVR_RAM_Y_L1:
0089f4 911d      	ld	zzA, X+
0089f5 b9f8
0089f6 b9e2
0089f7 b915
0089f8 b824
0089f9 15f6
0089fa 985d
0089fb f100
0089fc b82b
0089fd 935f
0089fe e158
0089ff b955
008a00 eb5f
008a01 b954
008a02 e050
008a03 bd5d
008a04 e550
008a05 bd5c
008a06 9859
008a07 915f
008a08 982c
008a09 931f
008a0a 2f5f
008a0b 940e 005f
008a0d e054
008a0e 955a
008a0f f7f1
008a10 2f5e
008a11 940e 005f
008a13 e054
008a14 955a
008a15 f7f1
008a16 915f
008a17 940e 005f
008a19 bc5c
008a1a 9a59
008a1b b854
008a1c b82b      	STRAM	ZH, ZL, zzA
008a1d 9631      	adiw	Z, 1
                 MCOPY_AVR_RAM_Y_L2:
008a1e 9721      	sbiw	Y, 1
008a1f f6a1      	brne	MCOPY_AVR_RAM_Y_L1			; store data to RAM
008a20 911f      	pop	zzA
008a21 9508      	ret
                 
                 
                 	; copy TEMP bytes from Z (RAM) to X (AVR) 
                 MCOPY_RAM_AVR:
008a22 931f      	push	zzA
                 MCOPY_RAM_AVR_L1:
008a23 b9f8
008a24 b9e2
008a25 b854
008a26 b83b
008a27 0000
008a28 0000
008a29 b113
008a2a b82b              LDRAM   ZH, ZL, zzA
008a2b 931d      	st	X+, zzA
008a2c 9631      	adiw	Z, 1
008a2d 955a      	dec	temp
008a2e f7a1      	brne	MCOPY_RAM_AVR_L1			; store data to AVR
008a2f 911f      	pop	zzA
008a30 9508      	ret
                 
                 
                 	; copy Y bytes from Z (RAM) to X (AVR) 
                 MCOPY_RAM_AVR_Y:
008a31 931f      	push	zzA
008a32 9621      	adiw	Y, 1
008a33 c00a      	rjmp	MCOPY_RAM_AVR_Y_L2			; check for Y=0
                 MCOPY_RAM_AVR_Y_L1:
008a34 b9f8
008a35 b9e2
008a36 b854
008a37 b83b
008a38 0000
008a39 0000
008a3a b113
008a3b b82b              LDRAM   ZH, ZL, zzA
008a3c 931d      	st	X+, zzA
008a3d 9631      	adiw	Z, 1
                 MCOPY_RAM_AVR_Y_L2:
008a3e 9721      	sbiw	Y, 1
008a3f f7a1      	brne	MCOPY_RAM_AVR_Y_L1			; store data to AVR
008a40 911f      	pop	zzA
008a41 9508      	ret
                 
                 
                 	; sending zzC to RS-232 interface
                 RS232_SEND:
008a42 e05f
008a43 940e 720c 	nportin cpd_comtc
008a45 3050      	cpi	temp, 0
008a46 f7d9      	brne	RS232_SEND		; wait current char is transmitted
008a47 9360 090f
008a49 e252
008a4a 940e 720a 	nportout cpd_comtx, zzC		; char to send
008a4c e055
008a4d 955a
008a4e f7f1      	delay3	15
008a4f 9290 090f
008a51 e05f
008a52 940e 720a 	nportout cpd_comtc, one		; force transmit action
008a54 9508      	ret
                 
                 
                 	; returns data from RS-232 interface, 0 if no data	
                 RS232_RECEIVE:
008a55 e251
008a56 940e 720c 	nportin	cpd_comst
008a58 ff57      	sbrs	temp, 7			; check RXC flag
008a59 c004      	rjmp	_RS232_RECEIVE_NO
008a5a e253
008a5b 940e 720c 	nportin	cpd_comrx
                 ;	mov	zzC, temp	
008a5d 9508      	ret
                 _RS232_RECEIVE_NO:
008a5e 2755      	clr	temp
008a5f 9508      	ret
                 
                 
                 	; returns in temp char received (if any) of RS-232 interface	
                 ;RS232_STATUS:
                 ;	nportin	cpd_comst
                 ;	sbrs	temp, 7			; check RXC flag
                 ;	ret
                 ;	nportin	cpd_comrx
                 ;	mov	zzC, temp	
                 ;	ret
                 COMMONS_END:
                 
                 ;.ORG ...
                 DOSTART_START:
                 #include "start.inc"			; welcome screen and startup testing
                 
                 ; STARTUP welcome and BAT 
                 ; called as subroutine, must be ended with ret
                 ; ---------------------------------------------------------------------------------------------------------------
                 
                 .MACRO 	SET_FOUND
                 	lds	temp, HW_FOUND
                 	sbr	temp, 1<<@0
                 	sts	HW_FOUND, temp
                 .ENDM
                 
                 DOSTART_CMD:
                 ; ------- START DELAY approx 500 ms
                 
008a60 935f
008a61 e15f
008a62 b955
008a63 eb5f
008a64 b954
008a65 e050
008a66 bd5d
008a67 e550
008a68 bd5c
008a69 9859
008a6a 915f      	SPI_INIT  SPI_SLAVE_LED, SPI_FCK_DIV_4		; System LED on
008a6b 982c      	SPI_SELECT
                 							; start delay to init PDC
008a6c e050
008a6d 9350 0085 	_outm  	TCNT1H, 0
008a6f e050
008a70 9350 0084 	_outm  	TCNT1L, 0
008a72 e055
008a73 9350 0081 	_outm  	TCCR1B, (1<<CS12)|(1<<CS10)
                 L1:
008a75 9150 0084 	lds	temp, TCNT1L
008a77 9150 0085 	lds	temp, TCNT1H
008a79 3850      	cpi	temp, 0x80
008a7a f3d0      	brlo  	L1
                 
008a7b e050
008a7c 9350 0081 	_outm  	TCCR1B, 0
008a7e bc5c
008a7f 9a59
008a80 b854      	SPI_STOP					; System LED off
                 
                 ; --------  output sync sequence
                 
008a81 935f
008a82 e158
008a83 b955
008a84 eb5f
008a85 b954
008a86 e050
008a87 bd5d
008a88 e550
008a89 bd5c
008a8a 9859
008a8b 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
008a8c 982c      	SPI_SELECT
008a8d e13e      	ldi	r19, 30
                 L2:
008a8e e850      	ldi	temp, 0x80 			; sync request
008a8f 940e 005f 	call	DOSPI 
008a91 953a      	dec	r19
008a92 f7d9      	brne	L2
008a93 bc5c
008a94 9a59
008a95 b854      	SPI_STOP
                 
                 ; ---------- check CPD and debug mode (if ESC key pressed during startup)
                 
008a96 e055
008a97 940e 720c 	nportin	cpd_kchar
008a99 2f45      	mov	zzF, temp			; save CPD state
008a9a 3f5f      	cpi	temp, 0xFF			; CPD NOT present?
008a9b f061      	breq	_dostart_normal			; start in TTY control mode
                 
                 ;_dostart_cpd_ok:	
                 ;	lds	temp, CON_IOBYTE
                 ;	sbr	temp, (1<<CON_OUT_CON) | (1<<CON_IN_CON)	; if CPD installed CON I/O is always ON
                 ;	sts	CON_IOBYTE, temp
                 _dostart_esc_mode:
008a9c 9150 3f02
008a9e 6850
008a9f 9350 3f02 	SET_FOUND HW_FOUND_CPD			; set CPD found
                 
008aa1 315b      	cpi	temp, 27			; check debug mode start request
008aa2 f429      	brne	_dostart_normal
                 
                 _dostart_tty_mode:
008aa3 9150 3f01 	lds	temp, CON_IOBYTE
008aa5 6252      	sbr	temp, (1<<CON_OUT_TTY) | (1<<CON_IN_TTY)	; using UART for 
                 ;	cbr	temp, (1<<CON_OUT_CON) | (1<<CON_IN_CON)	; if CPD not installed CON I/O is always OFF
008aa6 9350 3f01 	sts	CON_IOBYTE, temp
                 
                 _dostart_normal:
                 ; output welcome message from MCU
                 
008aa8 e1fb
008aa9 efe0
008aaa 940e 890f 	con_puts MSG_WELCOME0
                 
                 
                 STARTLOOP:
                 
                 ; -------- RAM test
                 
008aac e1fc
008aad e6ec
008aae 940e 890f 	con_puts MSG_RAMTEST
                 
                 	; RAM test starts here
008ab0 e0d0      	ldi	YH, 0
008ab1 e0c0      	ldi	YL, 0 
008ab2 e030      	ldi	r19, 0
                 
                 L3:
008ab3 b9d8
008ab4 b9c2
008ab5 b9c5
008ab6 b824
008ab7 15d6
008ab8 985d
008ab9 f100
008aba b82b
008abb 935f
008abc e158
008abd b955
008abe eb5f
008abf b954
008ac0 e050
008ac1 bd5d
008ac2 e550
008ac3 bd5c
008ac4 9859
008ac5 915f
008ac6 982c
008ac7 93cf
008ac8 2f5d
008ac9 940e 005f
008acb e054
008acc 955a
008acd f7f1
008ace 2f5c
008acf 940e 005f
008ad1 e054
008ad2 955a
008ad3 f7f1
008ad4 915f
008ad5 940e 005f
008ad7 bc5c
008ad8 9a59
008ad9 b854
008ada b82b      	STRAM	YH, YL, YL
008adb e050
008adc b954      	_out	DDRB, 0			; Data port to in
008add 2f5c      	mov	temp, YL
008ade 9550      	com	temp              	; inv temp
008adf b955      	out	PORTB, temp		; to change pullups
                 
008ae0 b9d8
008ae1 b9c2
008ae2 b854
008ae3 b83b
008ae4 0000
008ae5 0000
008ae6 b153
008ae7 b82b      	LDRAM	YH, YL, temp
                 
008ae8 17c5      	cp	YL, temp                ; check that read value = written one
008ae9 f009      	breq  	L4			; proceed if ok
008aea e031      	ldi	r19, 1			; set error flag
                 L4:
008aeb 9621      	adiw	Y,1
008aec 3fd8      	cpi	YH, 0xf8
008aed f228      	brlo	L3			; do not corrupt videram
                 
008aee 3030      	cpi	r19, 0			; check error flag == 0
008aef f029      	breq  	L5
008af0 e1fc
008af1 e8ec
008af2 940e 890f 	con_puts MSG_FAILED
008af4 c009      	rjmp  	L6
                 L5:
008af5 e1fc
008af6 e7ee
008af7 940e 890f 	con_puts MSG_PASSED
                 
008af9 9150 3f02 	lds	temp, HW_FOUND
008afb 6051      	sbr	temp, 1<<HW_FOUND_RAM
008afc 9350 3f02 	sts	HW_FOUND, temp
                 L6:
                 
                 
                 /*
                 ; ----------- check IRQ controller status
                 	con_puts MSG_IRQCTRL
                 
                     	; access IRQ controller chip
                 	SPI_INIT SPI_SLAVE_IRQ, SPI_FCK_DIV_4		; 
                 	SPI_SELECT
                 	iSPI 	0b01000001	; address byte
                 	iSPI	0x05		; IOCON
                 	iSPI	0xff		; for read op
                     	SPI_STOP		; stop IRQ access
                 
                     	cpi	temp, 0xff
                     	brne	L_STR_IRQFOUND          ; ok, data read
                 
                 	con_puts MSG_IRQNOTFOUND
                 	rjmp	L_STR_IRQCHECK_END
                 
                 L_STR_IRQFOUND:
                 	con_puts MSG_IRQFOUND	
                 
                 ;	mov    	r18, temp
                 ;	call	STR_HEXOUT		; output revid
                 ;	con_puts MSG_LANINITING
                 
                 	lds	temp, HW_FOUND
                 	sbr	temp, 1<<HW_FOUND_IRQ
                 	sts	HW_FOUND, temp
                 
                 ;	call	IRQ_INIT
                 L_STR_IRQCHECK_END:
                 ; -----------------------------------------
                 */
                 
                 
                 ; ----------- check EXT controller status
008afe e1fe
008aff e6e4
008b00 940e 890f 	con_puts MSG_EXTCTRL
                 
                 ;	cbi	DDRD, PD6	; pin to input
                 ;l_ext_wait_d6:
                 ;	sbis	PIND, PD6
                 ;	rjmp	l_ext_wait_d6	; wait RTC int clear just for the case
                 
008b02 9150 3f02 	lds	temp, HW_FOUND
008b04 6052      	sbr	temp, 1<<HW_FOUND_EXT
008b05 9350 3f02 	sts	HW_FOUND, temp	; pretend that CLR is installed
                 
008b07 e050      	ldi	temp, CLR_CMD_DEFAULT
008b08 940e b400 	call	CLR_CMD		; trying to reset CLR MCU
008b0a 9150 08fe 	lds	temp, PCMD_FE	; check response
                 
                     	; access IRQ controller chip
                 ;	SPI_INIT SPI_SLAVE_EXT, SPI_FCK_DIV_4		; select channel
                 ;	SPI_SELECT
                 ;	nop
                 ;	nop
                 ;	nop
                 ;	nop
                 ;	in	temp, PIND	; read status
                 ;   	SPI_STOP		; stop EXT check access
                 
                 ;    	sbrs	temp, 6
008b0c 3f5f      	cpi	temp, 0xFF	; 0xFF == error, no response
008b0d f069      	breq	L_STR_EXT_NOT_FOUND
                 
008b0e ff54      	sbrs	temp, 4		; bit 4 always on check valid response
008b0f c00b      	rjmp	L_STR_EXT_NOT_FOUND
                     	
008b10 fd53      	sbrc	temp, 3		; bits 3, 5,6,7 must be 0 - check valid response
008b11 c009      	rjmp	L_STR_EXT_NOT_FOUND
                     	
008b12 fd55      	sbrc	temp, 5		; check valid response
008b13 c007      	rjmp	L_STR_EXT_NOT_FOUND
                     	
008b14 fd56      	sbrc	temp, 6		; check valid response
008b15 c005      	rjmp	L_STR_EXT_NOT_FOUND
                     	
008b16 fd57      	sbrc	temp, 7		; check valid response
008b17 c003      	rjmp	L_STR_EXT_NOT_FOUND
                     	
008b18 3150      	cpi	temp, 0x10	; 0x10 == error, black default color is not allowed
008b19 f009      	breq	L_STR_EXT_NOT_FOUND
                 
008b1a c00a          	rjmp	L_STR_EXTFOUND	; Ok, EXT CLR version
                 
                 L_STR_EXT_NOT_FOUND:
008b1b 9150 3f02 	lds	temp, HW_FOUND
008b1d 7f5d      	cbr	temp, 1<<HW_FOUND_EXT
008b1e 9350 3f02 	sts	HW_FOUND, temp
                 
008b20 e1fe
008b21 e7e4
008b22 940e 890f 	con_puts MSG_EXTNOTFOUND
008b24 c009      	rjmp	L_STR_EXTCHECK_END
                 
                 
                 L_STR_EXTFOUND:
008b25 e1fe
008b26 e8e0
008b27 940e 890f 	con_puts MSG_EXTFOUND	
                 
008b29 9150 3f02 	lds	temp, HW_FOUND
008b2b 6052      	sbr	temp, 1<<HW_FOUND_EXT
008b2c 9350 3f02 	sts	HW_FOUND, temp
                 
                 ;	call	IRQ_INIT
                 L_STR_EXTCHECK_END:
                 ; -----------------------------------------
                 
                 
                 
                 ; ----------- check CPD status
                 L_STR_CPDCHECK:
008b2e 9150 3f02 	lds	temp, HW_FOUND
008b30 ff57      	sbrs	temp, HW_FOUND_CPD
008b31 c004      	rjmp	L_STR_RTCCHECK
008b32 e1fe
008b33 edec
008b34 940e 890f 	con_puts MSG_CPDFOUND
                 
                 
                 
                 ; ----------- check RTC status
                 L_STR_RTCCHECK:
008b36 e1fc
008b37 e9ea
008b38 940e 890f 	con_puts MSG_RTCDATA
                 
                     	; access RTC chip
008b3a 935f
008b3b e15a
008b3c b955
008b3d eb5f
008b3e b954
008b3f e050
008b40 bd5d
008b41 e556
008b42 bd5c
008b43 9859
008b44 915f      	SPI_INIT SPI_SLAVE_RTC, SPI_FCK_DIV_16_CPHA	; /16, RTC supports fck till 2 MHz
008b45 982c      	SPI_SELECT
008b46 e05a
008b47 955a
008b48 f7f1      	delay3	30			; 1us delay	
008b49 e05f
008b4a 940e 005f 	iSPI	0x0f
008b4c 940e 005f 	call	DOSPI			; read control register
                 ;	SPI_DESELECT
008b4e bc5c
008b4f 9a59
008b50 b854          	SPI_STOP		    	; stop RTC access
                 
008b51 3f5f          	cpi	temp, 0xff
008b52 f459          	brne	L_STR_RTCFOUND          ; ok, data read
                 
008b53 bc5c
008b54 9a59
008b55 b854          	SPI_STOP		    	; stop RTC access
008b56 e1fc
008b57 eae0
008b58 940e 890f     	con_puts MSG_RTCNOTFOUND        ; not foud message
                 ;    	ldi	temp, (1<<CON_OUT_CON) | (1<<CON_IN_CON)
                  ;   	sts	RTC_IOBYTE, temp
                 
008b5a e058          	ldi	temp, (1<<LST_OUT_LST)
008b5b 9350 36e4  	sts	RTC_DEV_IOBYTE, temp
                    	
008b5d c046          	rjmp	L_STR_RTCCHECK_END
                 
                 L_STR_RTCFOUND:				; display control registers
008b5e 935f              push	temp
                 
008b5f 9150 3f02 	lds	temp, HW_FOUND
008b61 6058      	sbr	temp, 1<<HW_FOUND_RTC
008b62 9350 3f02 	sts	HW_FOUND, temp
                 
008b64 915f      	pop	temp
008b65 935f              push	temp
                 
008b66 7850      	andi	temp, 0x80		; check that RTC stopped = first run
008b67 f019      	breq	_str_rtc_L10
                 
008b68 e053      	ldi	temp, 3
008b69 940e b30f 	call	RTC_CMD			; clear RTC ROM
                 
                 _str_rtc_L10:
008b6b 912f              pop	r18
008b6c 940e 8922 	call	STR_HEXOUT		; echo control register
008b6e e250
008b6f 2f65
008b70 e054
008b71 940e 7202 	con_putc ' '
                 
008b73 940e b30e 	call	RTC_INIT		; start clock
                 
008b75 e050              ldi	temp, 0
008b76 940e b30f         call	RTC_CMD			; read date/time
                 
008b78 e4a1
008b79 e3bf      	ldiw	X, RTC_SECS
008b7a e047      	ldi	r20, 7
                 _str_rtc_L9:
008b7b 912d      	ld    	r18, X+
008b7c 940e 8922 	call	STR_HEXOUT		; echo date/time
008b7e e35a
008b7f 2f65
008b80 e054
008b81 940e 7202 	con_putc ':'
008b83 954a      	dec	r20
008b84 f7b1      	brne  	_str_rtc_L9
                 
008b85 e057              ldi	temp, 7
008b86 940e b30f         call	RTC_CMD			; read ROM
                 
008b88 e1fc
008b89 ebe2
008b8a 940e 890f 	con_puts MSG_RTCLOADED		; ram loaded message
                 
                 ;	ldstt	CON_IOBYTE, RTC_IOBYTE
                 ;	ldstt	PR_IOBYTE,  RTC_PR_IOBYTE
                 
008b8c e9e2
008b8d e3f6
008b8e e0c6
008b8f e0d0
008b90 e5aa
008b91 e0b9
008b92 940e 89ac 	ZXYf	RTC_LAN_MY_MAC, LAN_MAC_MY, 6
008b94 e9e8
008b95 e3f6
008b96 e0c4
008b97 e0d0
008b98 e5a2
008b99 e0b9
008b9a 940e 89ac 	ZXYf	RTC_LAN_MY_IP, LAN_IP_MY, 4
008b9c ebe2
008b9d e3f6
008b9e e0cc
008b9f e0d0
008ba0 e4aa
008ba1 e3bf
008ba2 940e 89ac 	ZXYf	RTC_PNC_MAC, PR_SRV_MAC, 6+4+2	
                 ;	ZXYf	RTC_PRN_PORT, PRN_SRV_PORT, 4	; RND and RSD ports
                 	
                 L_STR_RTCCHECK_END:
                 
                 
                 
                 ; ----------  get LAN controller status
                 L_STR_LANCHECK:
008ba4 e1fc
008ba5 ecee
008ba6 940e 890f 	con_puts MSG_LANSTATUS		; display message
                 
008ba8 935f
008ba9 e159
008baa b955
008bab eb5f
008bac b954
008bad e050
008bae bd5d
008baf e550
008bb0 bd5c
008bb1 9859
008bb2 915f      	SPI_INIT SPI_SLAVE_LAN, SPI_FCK_DIV_4
008bb3 982c
008bb4 e55f
008bb5 940e 005f
008bb7 e053
008bb8 940e 005f
008bba 9a2c      	LAN_CREG_WRITE LAN_ECON1, LAN_BANK3
008bbb 982c
008bbc e152
008bbd 940e 005f
008bbf ef5f
008bc0 940e 005f
008bc2 9a2c      	LAN_ETH_REG_READ LAN_EREVID
008bc3 bc5c
008bc4 9a59
008bc5 b854          	SPI_STOP		    	; stop LAN access
                 
008bc6 3f5f          	cpi	temp, 0xff
008bc7 f429          	brne	L_STR_LANFOUND          ; ok, data read
                 
008bc8 e1fc
008bc9 eae0
008bca 940e 890f 	con_puts MSG_RTCNOTFOUND
008bcc c018      	rjmp	L_STR_LANCHECK_END
                 
                 L_STR_LANFOUND:
008bcd 935f              push	temp
                 
008bce 9150 3f02 	lds	temp, HW_FOUND
008bd0 6250      	sbr	temp, 1<<HW_FOUND_LAN
008bd1 9350 3f02 	sts	HW_FOUND, temp
                 
008bd3 e1fc
008bd4 eee0
008bd5 940e 890f 	con_puts MSG_LANPRES	
                 
008bd7 912f      	pop    	r18
008bd8 940e 8922 	call	STR_HEXOUT		; output revid
                 
008bda e1fc
008bdb efe0
008bdc 940e 890f 	con_puts MSG_LANINITING
                 
008bde e050      	ldi	temp, LAN_FUNC_INIT	; 0
008bdf 9120 3f02 	lds	r18, HW_FOUND
008be1 fd23      	sbrc	r18, HW_FOUND_RTC
008be2 e051      	ldi	temp, LAN_FUNC_INIT_CUSTOM	; 1
008be3 940e 9400 	call	LAN_CMD			; init LAN
                 
                 L_STR_LANCHECK_END:   
                 
                 
                 
                 ; ----------  get CAN controller status
                 L_STR_CANCHECK:
008be5 935f
008be6 e15f
008be7 b955
008be8 eb5f
008be9 b954
008bea e050
008beb bd5d
008bec e550
008bed bd5c
008bee 9859
008bef 915f      	SPI_INIT SPI_SLAVE_CAN, SPI_FCK_DIV_4
008bf0 982c              SPI_SELECT
008bf1 eb50
008bf2 940e 005f 	iSPI	CAN_CMD_RXSTAT
008bf4 ef5f
008bf5 940e 005f 	iSPI	0xff			; read response
008bf7 9a2c              SPI_DESELECT
008bf8 bc5c
008bf9 9a59
008bfa b854          	SPI_STOP		    	; stop LAN access
                 
008bfb 3f5f          	cpi	temp, 0xff
008bfc f049          	breq	L_STR_CANCHECK_END	; no CAN
                 
008bfd e1fe
008bfe ece4
008bff 940e 890f 	con_puts MSG_CAN
                 
008c01 9150 3f02 	lds	temp, HW_FOUND
008c03 6450      	sbr	temp, 1<<HW_FOUND_CAN
008c04 9350 3f02 	sts	HW_FOUND, temp
                 
                 L_STR_CANCHECK_END:
                 
                 
                 
                 ; ---------- get EEPROM status
                 L_STR_ROMCHECK:
                 
008c06 e1fe
008c07 e1e0
008c08 940e 890f 	con_puts MSG_ROMCHECK
                 
008c0a 935f
008c0b e15c
008c0c b955
008c0d eb5f
008c0e b954
008c0f e050
008c10 bd5d
008c11 e550
008c12 bd5c
008c13 9859
008c14 915f      	SPI_INIT SPI_SLAVE_ROM, SPI_FCK_DIV_4
008c15 982c      	SPI_SELECT
008c16 e055
008c17 940e 005f 	iSPI	0b00000101		; RDSR
008c19 ef5f
008c1a 940e 005f 	iSPI	0xff                    ; READ
008c1c bc5c
008c1d 9a59
008c1e b854          	SPI_STOP		    	; stop access
                 
008c1f 3f5f          	cpi	temp, 0xff
008c20 f429          	brne	L_STR_ROMFOUND          ; ok, data read
                 
008c21 e1fc
008c22 eae0
008c23 940e 890f 	con_puts MSG_RTCNOTFOUND
008c25 c017      	rjmp	L_STR_ROMCHECK_END
                 
                 L_STR_ROMFOUND:
008c26 935f              push	temp
008c27 e1fe
008c28 e1ea
008c29 940e 890f 	con_puts MSG_ROMFOUND
                 
008c2b 912f      	pop    	r18
008c2c 940e 8922 	call	STR_HEXOUT		; output revid
008c2e e05d
008c2f 2f65
008c30 e054
008c31 940e 7202 	con_putc 13
008c33 e05a
008c34 2f65
008c35 e054
008c36 940e 7202 	con_putc 10
                 
008c38 9150 3f02 	lds	temp, HW_FOUND
008c3a 6150      	sbr	temp, 1<<HW_FOUND_ROM
008c3b 9350 3f02 	sts	HW_FOUND, temp
                 L_STR_ROMCHECK_END:
                 
                 
                 
                 ; ---------- get sd controller status
                 L_STR_SDCHECK:
                 
008c3d e1fd
008c3e e0e2
008c3f 940e 890f 	con_puts MSG_SDSTATUS
                 	
008c41 940e 9000 	call  SD_INIT			; trying to init SD card
                 
008c43 2f25      	mov	r18, temp
008c44 940e 8922 	call  	STR_HEXOUT            	; show response
008c46 e250
008c47 2f65
008c48 e054
008c49 940e 7202 	con_putc ' '
008c4b 9120 3f15 	lds	r18, SD_TYPE
008c4d 940e 8922 	call  	STR_HEXOUT            	; show response
008c4f e250
008c50 2f65
008c51 e054
008c52 940e 7202 	con_putc ' '
008c54 9120 092e 	lds	r18, SD_RSP
008c56 940e 8922 	call  	STR_HEXOUT            	; show response
008c58 9120 092f 	lds	r18, SD_RSP+1
008c5a 940e 8922 	call  	STR_HEXOUT            	; show response
008c5c 9120 0930 	lds	r18, SD_RSP+2
008c5e 940e 8922 	call  	STR_HEXOUT            	; show response
008c60 9120 0931 	lds	r18, SD_RSP+3
008c62 940e 8922 	call  	STR_HEXOUT            	; show response
                 	  
008c64 e05d
008c65 2f65
008c66 e054
008c67 940e 7202 	con_putc 13
008c69 e05a
008c6a 2f65
008c6b e054
008c6c 940e 7202 	con_putc 10
                 
                 ;	lds	temp, SD_TYPE
                 ;	cpi	temp, 0
                 ;	brne	
                 
                 
                 
                 ; ------------- select OS load source
                 L_STR_OSLOAD:
008c6e 9150 3f02         lds	temp, HW_FOUND
008c70 ff50              sbrs	temp, HW_FOUND_RAM
008c71 c005              rjmp	L_STR_OSLOAD_NOOS	; No RAM, no booting
                 
008c72 7150              andi	temp, (1<<HW_FOUND_ROM)
008c73 9140 3f15 	lds	r20, SD_TYPE
008c75 2b54      	or	temp, r20		; check that any boot sources are available
008c76 f451      	brne	L_STR_OSLOAD_GO
                 
                 L_STR_OSLOAD_NOOS:
008c77 e1fe
008c78 efea
008c79 940e 890f 	con_puts MSG_NOOS		; screen message
                 L_STR_OSLOAD_NOOS_PROMPT:
008c7b e053      	ldi	temp, 3
008c7c 940e 7202 	call	BIOS_CMD		; CONIN
008c7e 3050      	cpi	temp, 0
008c7f f3d9      	breq	L_STR_OSLOAD_NOOS_PROMPT; BIOS(3) sets zzPC-=2 and returns
                 
008c80 cf85      	rjmp	L_STR_ROMCHECK		; recheck SD and ROM
                 
                 L_STR_OSLOAD_GO:	
008c81 e1fd
008c82 e2e2
008c83 940e 890f 	con_puts MSG_SELECTOS		; screen message
                 
008c85 9150 3f02 	lds	temp, HW_FOUND
008c87 ff54      	sbrs	temp, HW_FOUND_ROM
008c88 c004      	rjmp	L_STR_OSLOAD_CHECK_SD
                 
008c89 e1fd
008c8a e4e0
008c8b 940e 890f 	con_puts MSG_BOOTROM		; ROM present - boot option screen message
                 
                 L_STR_OSLOAD_CHECK_SD:
008c8d 9150 3f15 	lds	temp, SD_TYPE
008c8f 3050      	cpi	temp, 0x00
008c90 f409      	brne	L_STR_OSLOAD_START
                 
                 ;	lds	temp, HW_FOUND
                 ;	cbr	temp, 1<<HW_FOUND_SDC	; set that SD card is not found
                 ;	sts	HW_FOUND, temp
                 	
008c91 c066      	rjmp	L_STR_KP		; No card inserted
                 
                 L_STR_OSLOAD_START:
                 
                 ;	lds	temp, HW_FOUND
                 ;	sbr	temp, 1<<HW_FOUND_SDC	; set that SD card is found
                 ;	sts	HW_FOUND, temp
                 
008c92 e050      	ldi	temp, 0x00
                 ;	add	temp, r20		;!!!!!!! check !!!!!!!
008c93 9350 092a 	sts	SD_ADDRESS, temp
008c95 e058      	ldi	temp, 0x08
008c96 9350 092b 	sts	SD_ADDRESS+1, temp
008c98 e050      	ldi	temp, 0x00
008c99 9350 092c 	sts	SD_ADDRESS+2, temp
008c9b e050      	ldi	temp, 0x00
008c9c 9350 092d 	sts	SD_ADDRESS+3, temp
008c9e 940e 9004 	call	SD_READ_DO		; load SD card name
                 
008ca0 e1fd
008ca1 efe2
008ca2 940e 890f 	con_puts MSG_SDFOUND
                 
008ca4 e3f0
008ca5 e0e0
008ca6 940e 891a 	con_puts_ram SD_BUF		; display PB name	
008ca8 e05d
008ca9 2f65
008caa e054
008cab 940e 7202 	con_putc 13
008cad e05a
008cae 2f65
008caf e054
008cb0 940e 7202 	con_putc 10
                 
008cb2 ef4f      	ldi	r20, 255
008cb3 2733      	clr	r19			; counter for number of images available
                 L_STR_SDPL:
008cb4 9543      	inc	r20
008cb5 304a      	cpi	r20, 9+1		; # of boot image - 0..9 range
008cb6 f008      	brlo	L_STR_SDPL_L1
008cb7 c040      	rjmp	L_STR_KP
                 
                 L_STR_SDPL_L1:
008cb8 ef50      	ldi	temp, 0xF0
008cb9 0f54      	add	temp, r20
008cba 9350 092a 	sts	SD_ADDRESS, temp
008cbc e058      	ldi	temp, 0x08
008cbd 9350 092b 	sts	SD_ADDRESS+1, temp
008cbf e050      	ldi	temp, 0x00
008cc0 9350 092c 	sts	SD_ADDRESS+2, temp
008cc2 e050      	ldi	temp, 0x00
008cc3 9350 092d 	sts	SD_ADDRESS+3, temp
008cc5 940e 9004 	call	SD_READ_DO
                 
008cc7 3050      	cpi	temp, 0
008cc8 f579      	brne	L_STR_KP
                 
008cc9 9150 3000 	lds	temp, SD_BUF
008ccb 3050      	cpi	temp, 0
008ccc f339      	breq	L_STR_SDPL		; no preload block
                 
008ccd 9533      	inc	r19			; increment counter
008cce 2e84      	mov	r8, r20			; store no for the "single choice"
008ccf e250
008cd0 2f65
008cd1 e054
008cd2 940e 7202 	con_putc ' '
008cd4 e350      	ldi	temp, '0' 
008cd5 2f65      	mov	zzC, temp
008cd6 0f64      	add	zzC, r20
008cd7 e054      	ldi	temp, 0x04
008cd8 940e 7202 	call	BIOS_CMD		; out n = 
008cda e250
008cdb 2f65
008cdc e054
008cdd 940e 7202 	con_putc ' '
008cdf e35d
008ce0 2f65
008ce1 e054
008ce2 940e 7202 	con_putc '='
008ce4 e250
008ce5 2f65
008ce6 e054
008ce7 940e 7202 	con_putc ' '
                 
008ce9 e3f0
008cea e0e0
008ceb 940e 891a 	con_puts_ram SD_BUF		; display PB name	
008ced e05d
008cee 2f65
008cef e054
008cf0 940e 7202 	con_putc 13
008cf2 e05a
008cf3 2f65
008cf4 e054
008cf5 940e 7202 	con_putc 10
008cf7 cfbc      	rjmp	L_STR_SDPL
                 	; options from SD
                 
                 L_STR_KP:
008cf8 9150 3f02         lds	temp, HW_FOUND
008cfa fd57              sbrc	temp, HW_FOUND_CPD
008cfb c006              rjmp	L_STR_OSLOAD_STD	; CPD presents, standard bootinig
                 
008cfc 3031      	cpi	r19, 1			; only 1 option available?
008cfd f051      	breq	L_STR_OSLOAD_SD_ONLY_1_DO
008cfe ff54              sbrs	temp, HW_FOUND_ROM
008cff cf06      	rjmp	L_STR_ROMCHECK		; recheck SD and ROM
                 L_STR_START_ROM_A:
008d00 e431      	ldi	r19, 'A'		; select bank A
008d01 c0bd      	rjmp	L_STR_KP_6		; Boot from the ROM#A
                 	
                 L_STR_OSLOAD_STD:
008d02 9150 3f02 	lds	temp, HW_FOUND
008d04 fd54      	sbrc	temp, HW_FOUND_ROM
008d05 c009      	rjmp	L_STR_QUERY		; ROM presents - request in any case
                 
                 L_STR_OSLOAD_SD_ONLY_1:
008d06 3031      	cpi	r19, 1			; only 1 option available?
008d07 f439      	brne	L_STR_QUERY
                 
                 L_STR_OSLOAD_SD_ONLY_1_DO:
008d08 e1fe
008d09 eae0
008d0a 940e 890f 	con_puts MSG_ONLYIMG		; display message
                 
008d0c e330      	ldi	r19, '0'
008d0d 0d38      	add	r19, r8			; r19 = selected option
008d0e c029      	rjmp	L_STR_KP_3		; process it!
                 
                 L_STR_QUERY:
                 ;	lds	temp, HW_FOUND
                 ;	sbrc	temp, HW_FOUND_SDC	; when ROM is available but SD is absent start from ROM#A
                 ;	rjmp	L_STR_QUERY_L1
                 
                 L_STR_QUERY_L1:	
008d0f e1fd
008d10 e6e0
008d11 940e 890f 	con_puts MSG_SELKEY
008d13 2733      	clr	r19			; buffer for command
                 
                 L_STR_KP_2:
008d14 e053      	ldi	temp, 3
008d15 940e 7202 	call	BIOS_CMD		; CONIN
                 
008d17 3050      	cpi	temp, 0
008d18 f3d9      	breq	L_STR_KP_2		; BIOS(3) sets zzPC-=2 and returns
                 
                 ;	cpi	temp, 32
                 ;	brlo	L_STR_KP_2
                 
008d19 305d      	cpi	temp, 13
008d1a f0e9      	breq	L_STR_KP_3
                 
008d1b 3030      	cpi	r19, 0
008d1c f099      	breq	L_STR_KP_4		; no symbol entered
                 
008d1d 3058      	cpi	temp, 8			; Backspace
008d1e f7a9      	brne	L_STR_KP_2		; ignore if no
                 
008d1f e058
008d20 2f65
008d21 e054
008d22 940e 7202 	con_putc 8
008d24 e250
008d25 2f65
008d26 e054
008d27 940e 7202 	con_putc ' '
008d29 e058
008d2a 2f65
008d2b e054
008d2c 940e 7202 	con_putc 8			; clear char
008d2e e030      	ldi	r19, 0		
                 
008d2f cfe4      	rjmp	L_STR_KP_2
                 
                 L_STR_KP_4:
008d30 3250      	cpi	temp, ' '
008d31 f310      	brlo	L_STR_KP_2
                 
008d32 2f35      	mov	r19, temp
                 
008d33 2f65      	mov	zzC, temp
008d34 e054      	ldi	temp, 0x04
008d35 940e 7202 	call	BIOS_CMD      		; echo input
008d37 cfdc      	rjmp	L_STR_KP_2
                 
                 L_STR_KP_3:
008d38 e05d
008d39 2f65
008d3a e054
008d3b 940e 7202 	con_putc 13			; CR
008d3d e05a
008d3e 2f65
008d3f e054
008d40 940e 7202 	con_putc 10			; LF
                 
008d42 3330      	cpi	r19, '0'
008d43 f408      	brsh	L_STR_KP_5
008d44 cef8      	rjmp	L_STR_SDCHECK           ; reload and reinit SD
                 
                 L_STR_KP_5:
                 
008d45 3631      	cpi	r19, 'a'
008d46 f069      	breq	L_STR_KP_6_1_1
008d47 3632      	cpi	r19, 'b'
008d48 f059      	breq	L_STR_KP_6_1_1
008d49 3431      	cpi	r19, 'A'
008d4a f051      	breq	L_STR_KP_6_1
008d4b 3432      	cpi	r19, 'B'
008d4c f041      	breq	L_STR_KP_6_1
                 
008d4d 3339      	cpi	r19, '9'
008d4e f038      	brlo	L_STR_KP_7
                 
008d4f e1fd
008d50 e8ee
008d51 940e 890f 	con_puts MSG_LOADBAD
008d53 cfa4      	rjmp	L_STR_KP
                 
                 L_STR_KP_6_1_1:
008d54 5230      	subi	r19, 0x20		; upcase
                 L_STR_KP_6_1:
008d55 c069      	rjmp	L_STR_KP_6  		; to provide relative jump
                 
                 
                 L_STR_KP_7:		
008d56 9150 3f15 	lds	temp, SD_TYPE
008d58 3050      	cpi	temp, 0x00
008d59 f429      	brne	L_STR_KP_8		; No card inserted
                 L_STR_KP_7_1:
008d5a e1fd
008d5b ebe8
008d5c 940e 890f 	con_puts MSG_LOADNOSD
008d5e cede      	rjmp	L_STR_SDCHECK		;L_STR_KP
                 
                 	; load from SD card
                 L_STR_KP_8:				; load from SD-card		
008d5f e1fd
008d60 e7ec
008d61 940e 890f 	con_puts MSG_LOADING
008d63 2f63      	mov	zzC, r19
008d64 e054      	ldi	temp, 0x04
008d65 940e 7202 	call	BIOS_CMD      		; echo
008d67 e1fd
008d68 eae8
008d69 940e 890f 	con_puts MSG_LOADSD
                 
008d6b 5330      	subi	r19, '0'		; block address starts from 0 now
008d6c e0c0
008d6d e0d9      	ldiw	Y, 0x0900		; start address of preloads on SD
                 ;	ldi	r18, 0x80		; sector number increment
008d6e 3030      	cpi	r19,0
008d6f f029      	breq	L_STR_KP_9
                 L_STR_KP_10:
008d70 e850              ldi	temp, 0x80
008d71 0fc5      	add	YL, temp
008d72 1dd5      	adc	YH, zero
008d73 953a      	dec	r19
008d74 f7d9      	brne	L_STR_KP_10		; Y = Y+0x80*r19
                 L_STR_KP_9:		
008d75 e73c              ldi	r19, 0x80-4		; blocks to read (except videoram)
008d76 e0e0
008d77 e0f0              ldiw	Z, 0			; start address in zRAM
                 
                 L_STR_KP_12:		
008d78 93c0 092a 	sts	SD_ADDRESS, YL
008d7a 93d0 092b 	sts	SD_ADDRESS+1, YH
008d7c 9250 092c 	sts	SD_ADDRESS+2, zero
008d7e 9250 092d 	sts	SD_ADDRESS+3, zero
008d80 940e 9004 	call	SD_READ_DO           	; read block
                 ;	call	SD_READ           	; read block
                 
008d82 e0a0      	ldi	XL, low(SD_BUF)
008d83 e3b0      	ldi	XH, high(SD_BUF)
                 L_STR_KP_11:		   		; strore buf in RAM
008d84 915d      	ld	temp, X+
008d85 b9f8
008d86 b9e2
008d87 b955
008d88 b824
008d89 15f6
008d8a 985d
008d8b f100
008d8c b82b
008d8d 935f
008d8e e158
008d8f b955
008d90 eb5f
008d91 b954
008d92 e050
008d93 bd5d
008d94 e550
008d95 bd5c
008d96 9859
008d97 915f
008d98 982c
008d99 935f
008d9a 2f5f
008d9b 940e 005f
008d9d e054
008d9e 955a
008d9f f7f1
008da0 2f5e
008da1 940e 005f
008da3 e054
008da4 955a
008da5 f7f1
008da6 915f
008da7 940e 005f
008da9 bc5c
008daa 9a59
008dab b854
008dac b82b      	STRAM	ZH, ZL, temp
008dad 9631      	adiw	Z, 1
008dae 30a0      	cpi	XL, low(SD_BUF_END)		
008daf e352      	ldi	temp, high(SD_BUF_END)
008db0 07b5      	cpc	XH, temp
008db1 f290      	brlo	L_STR_KP_11
                 
008db2 2f53      	mov	temp, r19
008db3 7053      	andi	temp, 0x03
008db4 f429      	brne	L_STR_KP_13
008db5 e25e
008db6 2f65
008db7 e054
008db8 940e 7202 	con_putc '.'			; display progress
                 L_STR_KP_13:
                 
                 ;	ldi	temp, 0x80
                 ;	add     YL, temp
008dba 0dc9      	add     YL, one
008dbb 1dd5      	adc	YH, zero		; Y++ = next block
008dbc 953a      	dec	r19
008dbd f059      	breq	L_STR_LOADED
008dbe cfb9      	rjmp	L_STR_KP_12		; read next block if not END
                 
                 L_STR_KP_6:		
                 ;        con_puts MSG_LOADEPROM		; screen message
                 	;reading from EPROM 
                 
008dbf 5431      	subi	r19, 'A'		; select eeprom bank
008dc0 2f13      	mov	zzA, r19
008dc1 940e c669 	call	CAD_SET_EEPROM_ROM_RAM_PROC	; read ROM to RAM and restore registers
008dc3 940e 900a 	call	SD_LAST_RESET
008dc5 940e c469 	call	CAD_EXIT_NO_CRT		; start, no CRT restore
008dc7 9702      	sbiw	zzPCl, 2		; repeat BIOS 2 command 
008dc8 c012      	rjmp	L_STR_PREPARE
                 ;	ret
                 
                 L_STR_LOADED:
008dc9 e1fd
008dca ede2
008dcb 940e 890f         con_puts MSG_STARTING
                 
008dcd ef5e              ldi	temp, BIOS_FUNC_SET_VIDEOMODE
008dce 940e 7200         call	BIOS			; set display mode
008dd0 ef5f              ldi	temp, BIOS_FUNC_CRT_RESET
008dd1 940e 7200         call	BIOS			; reset attr buffer
                 
                 L_STR_START_100:
008dd3 2dd9      	mov	zzSPh, one
008dd4 2dc5      	mov	zzSPl, zero
008dd5 2d99      	mov	zzPCH, one
008dd6 2d85      	mov	zzPCl, zero		; starting from 0x100
008dd7 2711      	clr	zzA
008dd8 2766      	clr	zzC
008dd9 24cc      	clr	zzD
008dda 2744      	clr	zzF
                 
                 L_STR_PREPARE:	
                 	; set IObytes
008ddb 9170 3f01 	lds	FROMRAM0, CON_IOBYTE
008ddd 9150 3691 	lds	temp, RTC_IOBYTE	; RTC settings
008ddf 2b75      	or	FROMRAM0, temp		; combine with RTC settings
008de0 9150 3f02 	lds	temp, HW_FOUND
008de2 ff57      	sbrs	temp, HW_FOUND_CPD
008de3 7e7e      	cbr	FROMRAM0, ((1<<CON_IN_CON)|(1<<CON_OUT_CON))	; clear std i/o channels if no CPD
008de4 9370 3f01 	sts	CON_IOBYTE, FROMRAM0
                 
008de6 9150 36c2
008de8 9350 3f48 	ldstt	PR_IOBYTE,  RTC_PR_IOBYTE
008dea 9150 36e4
008dec 9350 3f58 	ldstt	DEV_IOBYTE,  RTC_DEV_IOBYTE
                 
008dee 9250 090f
008df0 e055
008df1 940e 720a 	nportout cpd_kchar, zero	; clear input
                 
008df3 9adb      	sbi	PCIFR, PCIF3		; clear interrupt request if any
008df4 9478      	sei				; enable interrupts
                 
008df5 e05a      	ldi	temp, high(zOPCODE__LBLS_L)
008df6 bd5b      	out	GPIOR2, temp		; GPIOR2 contains high pointer to decode table
                 
008df7 9508      	ret				; return back from the call
                 
                 
                 START_END:
                 
                 #include "start_msg.inc"		; startup messages
                 
008df8 0a0d
008df9 0a0d
008dfa 0a0d
008dfb 0a0d      MSG_WELCOME0:	.DB	13,10,13,10,13,10,13,10
008dfc 5243
008dfd 5349
008dfe 2053
008dff 5043
008e00 4d2f
008e01 6d20
008e02 6961
008e03 206e
008e04 5043
008e05 2055
008e06 6f6d
008e07 7564
008e08 656c
008e09 202c
008e0a 6328
008e0b 2029
008e0c 6749
008e0d 726f
008e0e 5320
008e0f 202e
008e10 6552
008e11 6873
008e12 7465
008e13 696e
008e14 6f6b
008e15 2076
008e16 0a0d      		.DB   	"CRISS CP/M main CPU module, (c) Igor S. Reshetnikov ",13,10 
008e17 6556
008e18 7372
008e19 6f69
008e1a 206e
008e1b 2e34
008e1c 3636
008e1d 4520
008e1e 5458
008e1f 4120
008e20 5256
008e21 5a20
008e22 3038
008e23 202b
008e24 6d45
008e25 6c75
008e26 7461
008e27 726f
008e28 0a0d                      .DB	"Version 4.66 EXT AVR Z80+ Emulator",13,10
                 ;		.DB   	"Supported externals: SD card, Real time clock, Ethernet LAN ",13,10 
008e29 5043
008e2a 4d2f
008e2b 3220
008e2c 322e
008e2d 6320
008e2e 6d6f
008e2f 6170
008e30 6974
008e31 6c62
008e32 2065
008e33 0a0d      		.DB   	"CP/M 2.2 compatible ",13,10
008e34 0a0d
008e35 0000      		.DB	13,10,0,0
                 
008e36 3436
008e37 204b
008e38 4152
008e39 204d
008e3a 4554
008e3b 5453
008e3c 2e20
008e3d 2e2e
008e3e 0020      MSG_RAMTEST:	.DB   	"64K RAM TEST ... ",0
008e3f 6150
008e40 7373
008e41 6465
008e42 202c
008e43 6b4f
008e44 0d2e
008e45 000a      MSG_PASSED:	.DB   	"Passed, Ok.",13,10,0 
008e46 6146
008e47 6c69
008e48 6465
008e49 2120
008e4a 2121
008e4b 0d20
008e4c 000a      MSG_FAILED:	.DB   	"Failed !!! ",13,10,0 
                 
008e4d 5452
008e4e 3a43
008e4f 0020      MSG_RTCDATA:	.DB	"RTC: ",0
008e50 6843
008e51 7069
008e52 6e20
008e53 746f
008e54 6620
008e55 756f
008e56 646e
008e57 0d2e
008e58 000a      MSG_RTCNOTFOUND:.DB	"Chip not found.",13,10,0
008e59 0a0d
008e5a 5452
008e5b 2043
008e5c 4152
008e5d 204d
008e5e 6573
008e5f 7474
008e60 6e69
008e61 7367
008e62 6c20
008e63 616f
008e64 6564
008e65 0d64
008e66 000a      MSG_RTCLOADED:	.DB	13,10,"RTC RAM settings loaded",13,10,0
                 
008e67 414c
008e68 204e
008e69 6f63
008e6a 746e
008e6b 6f72
008e6c 6c6c
008e6d 7265
008e6e 203a
008e6f 0000      MSG_LANSTATUS:	.DB   	"LAN controller: ",0,0 
008e70 6f46
008e71 6e75
008e72 2c64
008e73 5220
008e74 5645
008e75 4449
008e76 203a
008e77 0000      MSG_LANPRES:	.DB	"Found, REVID: ",0,0
008e78 202c
008e79 6e49
008e7a 7469
008e7b 6169
008e7c 696c
008e7d 6973
008e7e 676e
008e7f 0d2e
008e80 000a      MSG_LANINITING:	.DB	", Initialising.",13,10,0
                 
008e81 4453
008e82 6320
008e83 7261
008e84 2064
008e85 7473
008e86 726f
008e87 6761
008e88 3a65
008e89 4920
008e8a 696e
008e8b 6974
008e8c 6c61
008e8d 7369
008e8e 6e69
008e8f 2e67
008e90 0020      MSG_SDSTATUS:	.DB	"SD card storage: Initialising. ",0 
                 
008e91 0a0d
008e92 6f4c
008e93 6461
008e94 6e69
008e95 2067
008e96 534f
008e97 6920
008e98 616d
008e99 6567
008e9a 7320
008e9b 756f
008e9c 6372
008e9d 3a65
008e9e 0d20
008e9f 000a      MSG_SELECTOS:	.DB	13,10,"Loading OS image source: ",13,10,0 
008ea0 4120
008ea1 6f20
008ea2 2072
008ea3 2042
008ea4 203d
008ea5 5045
008ea6 4f52
008ea7 204d
008ea8 6c62
008ea9 636f
008eaa 206b
008eab 2031
008eac 726f
008ead 3220
008eae 0a0d
008eaf 0000      MSG_BOOTROM:	.DB	" A or B = EPROM block 1 or 2",13,10,0,0
                 
008eb0 6c50
008eb1 6165
008eb2 6573
008eb3 7320
008eb4 6c65
008eb5 6365
008eb6 2074
008eb7 6f62
008eb8 746f
008eb9 6f20
008eba 7470
008ebb 6f69
008ebc 3a6e
008ebd 0020      MSG_SELKEY:	.DB	"Please select boot option: ",0 
                 
008ebe 0a0d
008ebf 6f4c
008ec0 6461
008ec1 6e69
008ec2 2067
008ec3 6c62
008ec4 636f
008ec5 206b
008ec6 0000      MSG_LOADING:	.DB	13,10,"Loading block ",0,0 
008ec7 6142
008ec8 2064
008ec9 6f6c
008eca 6461
008ecb 6e69
008ecc 2067
008ecd 6c62
008ece 636f
008ecf 206b
008ed0 6e69
008ed1 6564
008ed2 0d78
008ed3 000a      MSG_LOADBAD:	.DB	"Bad loading block index",13,10,0 
008ed4 6620
008ed5 6f72
008ed6 206d
008ed7 4453
008ed8 632d
008ed9 7261
008eda 0d64
008edb 000a      MSG_LOADSD:	.DB	" from SD-card",13,10,0 
008edc 6156
008edd 696c
008ede 2064
008edf 4453
008ee0 632d
008ee1 7261
008ee2 2064
008ee3 6f6e
008ee4 2074
008ee5 6f66
008ee6 6e75
008ee7 0d64
008ee8 000a      MSG_LOADNOSD:	.DB	"Valid SD-card not found",13,10,0 
                 
                 ;MSG_LOADEPROM:	.DB	"Loading OS image from onboard EPROM",13,10,0 
008ee9 0a0d
008eea 7453
008eeb 7261
008eec 6974
008eed 676e
008eee 6620
008eef 6f72
008ef0 206d
008ef1 6461
008ef2 7264
008ef3 7365
008ef4 2073
008ef5 7830
008ef6 3031
008ef7 0d30
008ef8 0000      MSG_STARTING:	.DB	13,10,"Starting from address 0x100",13,0,0 
                 
008ef9 6f46
008efa 6e75
008efb 2064
008efc 6f62
008efd 746f
008efe 6261
008eff 656c
008f00 5320
008f01 2044
008f02 6163
008f03 6472
008f04 202c
008f05 4449
008f06 203a
008f07 0000      MSG_SDFOUND:	.DB	"Found bootable SD card, ID: ",0,0		
                 ;		.DB	0,0,0,0
                 
008f08 4545
008f09 5250
008f0a 4d4f
008f0b 203a
008f0c 0000      MSG_ROMCHECK:	.DB	"EEPROM: ",0,0		
008f0d 6f46
008f0e 6e75
008f0f 2c64
008f10 5320
008f11 4552
008f12 3a47
008f13 0020      MSG_ROMFOUND:	.DB	"Found, SREG: ",0
                 
008f14 5249
008f15 2051
008f16 6f63
008f17 746e
008f18 6f72
008f19 6c6c
008f1a 7265
008f1b 0020      MSG_IRQCTRL:	.DB	"IRQ controller ",0		
008f1c 6f6e
008f1d 2074
008f1e 6f66
008f1f 6e75
008f20 0d64
008f21 000a      MSG_IRQNOTFOUND:.DB	"not found",13,10,0
008f22 6f66
008f23 6e75
008f24 2c64
008f25 4320
008f26 4952
008f27 5353
008f28 5020
008f29 4f52
008f2a 3520
008f2b 2a2e
008f2c 6420
008f2d 7465
008f2e 6365
008f2f 6574
008f30 0d64
008f31 000a      MSG_IRQFOUND:	.DB	"found, CRISS PRO 5.* detected",13,10,0		
                 
008f32 5845
008f33 2054
008f34 6f63
008f35 746e
008f36 6f72
008f37 6c6c
008f38 7265
008f39 0020      MSG_EXTCTRL:	.DB	"EXT controller ",0		
008f3a 6f6e
008f3b 2074
008f3c 6f66
008f3d 6e75
008f3e 0d64
008f3f 000a      MSG_EXTNOTFOUND:.DB	"not found",13,10,0
008f40 6f66
008f41 6e75
008f42 2c64
008f43 4320
008f44 4952
008f45 5353
008f46 4320
008f47 524c
008f48 3620
008f49 2a2e
008f4a 6420
008f4b 7465
008f4c 6365
008f4d 6574
008f4e 0d64
008f4f 000a      MSG_EXTFOUND:	.DB	"found, CRISS CLR 6.* detected",13,10,0		
                 
008f50 6e4f
008f51 796c
008f52 6f20
008f53 656e
008f54 6920
008f55 616d
008f56 6567
008f57 6620
008f58 756f
008f59 646e
008f5a 202c
008f5b 6f6c
008f5c 6461
008f5d 6e69
008f5e 2067
008f5f 7469
008f60 0d2e
008f61 000a      MSG_ONLYIMG:	.DB	"Only one image found, loading it.",13,10,0		
                 
008f62 4143
008f63 204e
008f64 6f63
008f65 746e
008f66 6f72
008f67 6c6c
008f68 7265
008f69 6620
008f6a 756f
008f6b 646e
008f6c 0d2e
008f6d 000a      MSG_CAN:	.DB	"CAN controller found.",13,10,0		
                 
008f6e 6550
008f6f 6972
008f70 6870
008f71 7265
008f72 6c61
008f73 6320
008f74 6e6f
008f75 7274
008f76 6c6f
008f77 656c
008f78 2072
008f79 6f66
008f7a 6e75
008f7b 0d64
008f7c 000a      MSG_CPDFOUND:	.DB	"Peripheral controller found",13,10,0
008f7d 6f4e
008f7e 6220
008f7f 6f6f
008f80 2074
008f81 6f73
008f82 7275
008f83 6563
008f84 6620
008f85 756f
008f86 646e
008f87 202c
008f88 6572
008f89 6c70
008f8a 6361
008f8b 2065
008f8c 4453
008f8d 632d
008f8e 7261
008f8f 3a64
008f90 0d20
008f91 000a      MSG_NOOS:	.DB	"No boot source found, replace SD-card: ",13,10,0
008f92 0000
008f93 0000      MSG_END:	.DB	0,0,0,0
                 #include "bios_mice_data.inc"		; automouse settings
008f94 2000
008f95 0520
008f96 1318
008f97 0004
008f98 0020
008f99 0000
008f9a 001b      
                 #include "bios_misc_data.inc"		; misc bios data
                 
                 ; windowed output settings
008f9b cdc9
008f9c babb
008f9d ba20
008f9e cdc8
008f9f 00bc      BIOS_L04_DFRAME_SYMBS:	.DB 201,205,187, 186,32,186, 200,205,188, 0
008fa0 c4da
008fa1 b3bf
008fa2 b320
008fa3 c4c0
008fa4 00d9      BIOS_L04_SFRAME_SYMBS:	.DB 218,196,191, 179,32,179, 192,196,217, 0
                 
                 ; --------------------- onboard devices ---------------------------------------
                 
                 ; --------------------- SD --------------------
                 
                 .ORG 0x09000            ; 1 20-26
                 SD_START:
                 #include "sd.inc"			; sd card routines
                 
009000 940c 9032 	jmp	_SD_INIT
                 SD_READ:
009002 940c 90e6 	jmp	_SD_READ
                 SD_READ_DO:
009004 940c 90ec 	jmp	_SD_READ_DO
                 SD_WRITE:
009006 940c 9183 	jmp	_SD_WRITE
                 SD_WRITE_DO:
009008 940c 9189 	jmp	_SD_WRITE_DO
                 SD_LAST_RESET:
00900a 9220 0935 	sts	SD_LASTADDRESS+3, FF
00900c 9220 0934 	sts	SD_LASTADDRESS+2, FF
00900e 9220 0933 	sts	SD_LASTADDRESS+1, FF
009010 9220 0932 	sts	SD_LASTADDRESS+0, FF
009012 9508              ret
                 
                 .MACRO  SD_CMD
                         ldi     ZH, high((@0)*2)
                         ldi     ZL, low((@0)*2)
                         call	SD_EXEC_CMD
                 .ENDM
                 
                 ; init timeout timer, time in ms
                 .MACRO  SD_INTT_TIMER
                         push   	temp
                         ldi	temp, ((@0)*76/1000)
                         sts	OCR1AH, temp
                         sts	OCR1AL, zero
                         sts	TCNT1H, zero
                         sts	TCNT1L, zero
                         sbi	TIFR1, OCF1A  ; clear oc1a flag
                         pop	temp
                 .ENDM
                 
                 ; send SD single command, retry till timeout
                 .MACRO  SD_S_CMD
                 ;        call  SD_WAKEUP
                 ;        SPI_INIT SPI_SLAVE_SD, SPI_FCK_DIV_16
                         SPI_SELECT
                         SD_INTT_TIMER  @0      		; timeout
                 SD_I_L1:
                         SD_CMD  @1
                         sbic    TIFR1, OCF1A      	
                         rjmp    @2                      ; timeout occured
                         sbrc    temp, 7
                         rjmp    SD_I_L1
                 
                         SPI_DESELECT
                 ;        SPI_STOP
                 .ENDM
                 
                 ; send SD single command, retry till timeout
                 .MACRO  SD_S_CMD_E
                 ;        call  SD_WAKEUP
                 ;        SPI_INIT SPI_SLAVE_SD, SPI_FCK_DIV_16
                         SPI_SELECT
                         SD_INTT_TIMER  @0      		; timeout
                 SD_I_L1:
                         SD_CMD  @1
                         sbic    TIFR1, OCF1A      	
                         rjmp    @2                      ; timeout occured
                 ;        sbrc    temp, 7
                 ;        rjmp    SD_I_L1
                 
                 	cpi	temp, @3
                 	brne	SD_I_L1
                 
                         SPI_DESELECT
                 ;        SPI_STOP
                 .ENDM
                 
                 
                 ; send SD A command, retry till timeout
                 .MACRO  SD_A_CMD
                 ;        call  SD_WAKEUP
                 ;        SPI_INIT SPI_SLAVE_SD, SPI_FCK_DIV_16
                         SPI_SELECT
                         SD_INTT_TIMER    @0      	; timeout
                 SD_I_L1:
                         SD_CMD  CMD55
                         sbic    TIFR1, OCF1A      	; timeout occured
                         rjmp    @2
                         cpi     temp, 1
                         brne    SD_I_L1
                 
                 SD_I_L2:
                         SD_CMD  @1
                         sbic    TIFR1, OCF1A      	; timeout occured
                         rjmp    @2
                         cpi     temp, 0
                         brne    SD_I_L1
                 
                         SPI_DESELECT
                 ;        SPI_STOP
                 .ENDM
                 
                 
                 ; ------------------------------------------------  initial reset
                 SD_WAKEUP:        
009013 ef5f              ldi	temp, 0xff
009014 940e 005f         call	DOSPI
009016 ef5f              ldi	temp, 0xff
009017 940e 005f         call	DOSPI
009019 ef5f              ldi	temp, 0xff
00901a 940e 005f         call	DOSPI
00901c ef5f              ldi	temp, 0xff
00901d 940e 005f         call	DOSPI
00901f ef5f              ldi	temp, 0xff
009020 940e 005f         call	DOSPI
009022 ef5f              ldi	temp, 0xff
009023 940e 005f         call	DOSPI
009025 ef5f              ldi	temp, 0xff
009026 940e 005f         call	DOSPI
009028 ef5f              ldi	temp, 0xff
009029 940e 005f         call	DOSPI
00902b ef5f              ldi	temp, 0xff
00902c 940e 005f         call	DOSPI
00902e ef5f              ldi	temp, 0xff
00902f 940e 005f         call	DOSPI
009031 9508              ret
                 
                 ; ------------------------------------------------  INIT SD CARD
                 _SD_INIT:        
                 
                 	; reset base addresses for disks
009032 93ff
009033 93ef      	pushw	Z
009034 e051      	ldi	temp, 1
009035 e1ea
009036 e3ff      	ldiw	Z, SD_FDD_BASE
                 SD_BASE_L1:
009037 9351      	st	Z+, temp
009038 9553      	inc 	temp
009039 3151      	cpi	temp, 17
00903a f7e1      	brne	SD_BASE_L1
00903b 91ef
00903c 91ff      	popw	Z
                 
                 	; setup timeout timer
00903d e055              ldi     temp, (1<<CS12)|(1<<CS10)  	; fclk/1024 
00903e 9350 0081         sts     TCCR1B, temp 			; start timer
                 
009040 935f
009041 e15d
009042 b955
009043 eb5f
009044 b954
009045 e050
009046 bd5d
009047 e551
009048 bd5c
009049 9859
00904a 915f              SPI_INIT SPI_SLAVE_SD, SPI_FCK_DIV_16
00904b 940e 9013         call	SD_WAKEUP                       ; 80 pulses to start
                 
00904d 9250 092e         sts	SD_RSP, zero
00904f 9250 092f         sts	SD_RSP+1, zero
009051 9250 0930         sts	SD_RSP+2, zero
009053 9250 0931         sts	SD_RSP+3, zero
                 
009055 9250 3f15         sts	SD_TYPE, zero
                 
                 ;__l1:   SD_S_CMD 500, CMD00, __l1		; DEBUG!!!!
009057 982c
009058 935f
009059 e256
00905a 9350 0089
00905c 9250 0088
00905e 9250 0085
009060 9250 0084
009062 9ab1
009063 915f
009064 e2f5
009065 e6e8
009066 940e 9275
009068 99b1
009069 c076
00906a fd57
00906b cff8
00906c 9a2c              SD_S_CMD 500, CMD00, SD_INIT_END	; GO_IDLE_STATE
                 
00906d 982c
00906e 935f
00906f e355
009070 9350 0089
009072 9250 0088
009074 9250 0085
009076 9250 0084
009078 9ab1
009079 915f
00907a e2f5
00907b e7e2
00907c 940e 9275
00907e 99b1
00907f c060
009080 fd57
009081 cff8
009082 9a2c              SD_S_CMD 700, CMD08, SD_INIT_END        ; SEND_IF_COND
                 
009083 9350 3f15 	sts	SD_TYPE, temp			; store card type: 1 = SD2, 4 or 5 = SD1, error otherwise
                 
009085 3051
009086 f409
009087 c009      	tcbe	0x01, SD_START_OK
009088 3054
009089 f409
00908a c006      	tcbe	0x04, SD_START_OK
00908b 3055
00908c f409
00908d c003      	tcbe	0x05, SD_START_OK
                 
                 ;        cpi     temp, 0x01
                 ;	breq    SD_SD2				; SD type 2
                 
                 ;	cpi     temp, 0x04
                 ;	breq    SD_SD1				; unknown command == SD type 1
                 ;	cpi     temp, 0x05
                 ;	breq    SD_SD1				; unknown command == SD type 1
                 
00908e 9250 3f15 	sts	SD_TYPE, zero			; No valid SD card present
009090 c04f      	rjmp    SD_INIT_END        		; ERROR = no valid card
                 
                 SD_START_OK:
009091 982c
009092 935f
009093 e05f
009094 9350 0089
009096 9250 0088
009098 9250 0085
00909a 9250 0084
00909c 9ab1
00909d 915f
00909e e2f5
00909f e9ea
0090a0 940e 9275
0090a2 99b1
0090a3 c03c
0090a4 fd57
0090a5 cff8
0090a6 9a2c              SD_S_CMD 200, CMD58, SD_INIT_END        ; SEND_IF_COND
0090a7 982c
0090a8 935f
0090a9 e45c
0090aa 9350 0089
0090ac 9250 0088
0090ae 9250 0085
0090b0 9250 0084
0090b2 9ab1
0090b3 915f
0090b4 e2f5
0090b5 e9e0
0090b6 940e 9275
0090b8 99b1
0090b9 c026
0090ba 3051
0090bb f7c1
0090bc e2f5
0090bd eae4
0090be 940e 9275
0090c0 99b1
0090c1 c01e
0090c2 3050
0090c3 f781
0090c4 9a2c              SD_A_CMD 1000, ACMD41, SD_INIT_END	; SD_SEND_OP_COND
0090c5 982c
0090c6 935f
0090c7 e05f
0090c8 9350 0089
0090ca 9250 0088
0090cc 9250 0085
0090ce 9250 0084
0090d0 9ab1
0090d1 915f
0090d2 e2f5
0090d3 e9ea
0090d4 940e 9275
0090d6 99b1
0090d7 c008
0090d8 fd57
0090d9 cff8
0090da 9a2c              SD_S_CMD 200, CMD58, SD_INIT_END        ; SEND_IF_COND
0090db 9150 092e 	lds	temp, SD_RSP
0090dd 9350 3f2f 	sts	SD_CCS, temp			; store for CCS bit
                 ;        SD_A_CMD 500, ACMD410, SD_INIT_END	; SD_SEND_OP_COND
0090df c000              rjmp    SD_INIT_OK
                 /*
                 SD_SD1:
                         SD_S_CMD 200, CMD58, SD_INIT_END        ; SEND_IF_COND
                         SD_A_CMD 500, ACMD410, SD_INIT_END	; SD_SEND_OP_COND
                         rjmp    SD_INIT_OK
                 
                 SD_SD2:
                         SD_S_CMD 200, CMD58, SD_INIT_END        ; SEND_IF_COND
                         SD_A_CMD 1000, ACMD41, SD_INIT_END	; SD_SEND_OP_COND
                 ;        ldi	temp, 0x42
                         rjmp    SD_INIT_OK
                 */
                 ; SD init OK
                 SD_INIT_OK:
                 
                 ; SD init Failed
                 SD_INIT_END:
0090e0 bc5c
0090e1 9a59
0090e2 b854              SPI_STOP
0090e3 9250 0081         sts   	TCCR1B, zero
                 
0090e5 cf24              rjmp	SD_LAST_RESET
                 
                 ;	sts	SD_LASTADDRESS+3, FF
                 ;	sts	SD_LASTADDRESS+2, FF
                 ;	sts	SD_LASTADDRESS+1, FF
                 ;	sts	SD_LASTADDRESS, FF
                  
                 ;       ret
                 ; -----------------------------------------------------------------------------------------------------
                 
                 
                 
                 
                 ; read from SD card -----------------------------------------------------------------------------------
                 _SD_READ:
0090e6 940e 9000 	call	SD_INIT
0090e8 3050      	cpi	temp, 0x00
0090e9 f011      	breq	_SD_READ_DO
0090ea ef5f      	ldi	temp, 0xff			; error code
0090eb 9508      	ret
                 
                 _SD_READ_DO:
0090ec 93bf
0090ed 93af      	pushw	X
0090ee 933f      	push	r19
                 
0090ef 9150 092d 	lds	temp, SD_ADDRESS+3 
0090f1 9350 0935 	sts	SD_LASTADDRESS+3, temp
0090f3 9150 092c 	lds	temp, SD_ADDRESS+2 
0090f5 9350 0934 	sts	SD_LASTADDRESS+2, temp
0090f7 9150 092b 	lds	temp, SD_ADDRESS+1 
0090f9 9350 0933 	sts	SD_LASTADDRESS+1, temp
0090fb 9150 092a 	lds	temp, SD_ADDRESS 
0090fd 9350 0932 	sts	SD_LASTADDRESS, temp		; storing last access address
                 
0090ff 9150 3f2f 	lds	temp, SD_CCS
009101 ff56      	sbrs	temp, 6				; CCS bit from OCR register
009102 940e 9255 	call	SD_ADDRESS_SHIFT                ; Not HDC card, address translation required
                 
009104 9350 3f32
009106 935f
009107 e752
009108 9350 3f31
00910a 915f
00910b 935f
00910c 9150 3f2a
00910e fd54
00910f 940e b00b
009111 915f      	NOTIFYt NOTIFY_SD, 'r'
                 
                 SD_READ_L1:
009112 e055              ldi     temp, (1<<CS12)|(1<<CS10)  	; fclk/1024 
009113 9350 0081         sts     TCCR1B, temp 			; start timer
                 
009115 935f
009116 e15d
009117 b955
009118 eb5f
009119 b954
00911a e050
00911b bd5d
00911c e551
00911d bd5c
00911e 9859
00911f 915f              SPI_INIT SPI_SLAVE_SD, SPI_FCK_DIV_16
009120 982c              SPI_SELECT
                 
009121 e551      	ldi	temp, 0x40+17			; read command
009122 940e 005f 	call	DOSPI
009124 9150 092d 	lds	temp, SD_ADDRESS+3 
009126 940e 005f 	call	DOSPI
009128 9150 092c 	lds	temp, SD_ADDRESS+2
00912a 940e 005f 	call	DOSPI
00912c 9150 092b 	lds	temp, SD_ADDRESS+1
00912e 940e 005f 	call	DOSPI
009130 9150 092a 	lds	temp, SD_ADDRESS+0
009132 940e 005f 	call	DOSPI
009134 ef5f      	ldi	temp, 0xff			; CRC
009135 940e 005f 	call	DOSPI
                 
                 	; read R1 response
009137 ef3f              ldi	r19, 255
                 SD_READ_L2:
009138 ef5f              ldi     temp, 0xff
009139 940e 005f         call    DOSPI
00913b ff57              sbrs    temp, 7
00913c c002              rjmp    SD_READ_L3             		; response received
00913d 953a              dec     r19
00913e f7c9              brne    SD_READ_L2
                 SD_READ_L3:
00913f 9350 3f32
009141 935f
009142 e652
009143 9350 3f31
009145 915f
009146 935f
009147 9150 3f2a
009149 fd54
00914a 940e b00b
00914c 915f      	NOTIFYt NOTIFY_SD, 'b'
                         
00914d 3050              cpi	temp, 0
00914e f009              breq	SD_READ_L4
                 
                 ;        ldi	temp, 0xfe			; error code
00914f c027              rjmp	SD_READ_END
                 
                 	; waiting for 0xfe
                 SD_READ_L4:
009150 935f
009151 e45c
009152 9350 0089
009154 9250 0088
009156 9250 0085
009158 9250 0084
00915a 9ab1
00915b 915f      	SD_INTT_TIMER 1000
                 SD_READ_L5:
00915c ef5f              ldi     temp, 0xff
00915d 940e 005f         call    DOSPI
00915f 3f5e              cpi	temp, 0xfe
009160 f019              breq	SD_READ_L6
009161 99b1              sbic    TIFR1, OCF1A      	
009162 c013              rjmp    SD_READ_ERR             	; timeout - error
009163 cff8              rjmp	SD_READ_L5
                 
                 SD_READ_L6:
009164 e0a0      	ldi	XL, low(SD_BUF)
009165 e3b0      	ldi	XH, high(SD_BUF)
                 SD_READ_L7:
009166 ef5f              ldi     temp, 0xff
009167 940e 005f         call    DOSPI
009169 935d      	st	X+, temp
                 ;	adiw	X, 1
00916a 30a0      	cpi	XL, low(SD_BUF_END)
00916b e352      	ldi	temp, high(SD_BUF_END)
00916c 07b5      	cpc	XH, temp
00916d f3c0      	brlo	SD_READ_L7			; read 512 bytes
                 
                 ;	jmp	SD_READ_END
                 
00916e ef5f              ldi     temp, 0xff
00916f 940e 005f         call    DOSPI
009171 ef5f              ldi     temp, 0xff
009172 940e 005f         call    DOSPI				; read CRC
                 
009174 e050              ldi	temp, 0
009175 c001              rjmp	SD_READ_END			; OK, exiting
                 
                 SD_READ_ERR:
009176 ef5d      	ldi	temp, 0xfd			; error code
                 
                 SD_READ_END:
009177 bc5c
009178 9a59
009179 b854      	SPI_STOP
00917a 9250 0081         sts   	TCCR1B, zero
                 
00917c 9350 3f30         sts	SD_ERROR, temp
00917e 2755      	clr	temp				;!!! DEBUG !!!!! doesn't report error to CPM
                 
00917f 913f              pop	r19
009180 91af
009181 91bf      	popw	X
009182 9508      	ret
                 ; -----------------------------------------------------------------------------------------------------
                 
                 
                 
                 
                 ; write to SD card ------------------------------------------------------------------------------------
                 _SD_WRITE:
009183 940e 9000 	call	SD_INIT
009185 3050      	cpi	temp, 0x00
009186 f011      	breq	_SD_WRITE_DO
009187 ef5f      	ldi	temp, 0xff			; error code
009188 9508      	ret
                 
                 _SD_WRITE_DO:
009189 93bf
00918a 93af      	pushw	X
00918b 933f      	push	r19
                 
00918c 9150 092d 	lds	temp, SD_ADDRESS+3 
00918e 9350 0935 	sts	SD_LASTADDRESS+3, temp
009190 9150 092c 	lds	temp, SD_ADDRESS+2 
009192 9350 0934 	sts	SD_LASTADDRESS+2, temp
009194 9150 092b 	lds	temp, SD_ADDRESS+1 
009196 9350 0933 	sts	SD_LASTADDRESS+1, temp
009198 9150 092a 	lds	temp, SD_ADDRESS 
00919a 9350 0932 	sts	SD_LASTADDRESS, temp		; storing last access address
                 
00919c 9150 3f2f 	lds	temp, SD_CCS
00919e ff56      	sbrs	temp, 6				; CCS bit from OCR register
00919f 940e 9255 	call	SD_ADDRESS_SHIFT                ; Not HDC card, address translation required
                 
0091a1 9350 3f32
0091a3 935f
0091a4 e757
0091a5 9350 3f31
0091a7 915f
0091a8 935f
0091a9 9150 3f2a
0091ab fd54
0091ac 940e b00b
0091ae 915f      	NOTIFYt NOTIFY_SD, 'w'
                 
0091af e055              ldi     temp, (1<<CS12)|(1<<CS10)  	; fclk/1024 
0091b0 9350 0081         sts     TCCR1B, temp 			; start timer
                 
0091b2 935f
0091b3 e15d
0091b4 b955
0091b5 eb5f
0091b6 b954
0091b7 e050
0091b8 bd5d
0091b9 e551
0091ba bd5c
0091bb 9859
0091bc 915f              SPI_INIT SPI_SLAVE_SD, SPI_FCK_DIV_16
0091bd 982c              SPI_SELECT
                 
0091be e558      	ldi	temp, 0x40+24			; single block write command
0091bf 940e 005f 	call	DOSPI
0091c1 9150 092d 	lds	temp, SD_ADDRESS+3 
0091c3 940e 005f 	call	DOSPI
0091c5 9150 092c 	lds	temp, SD_ADDRESS+2
0091c7 940e 005f 	call	DOSPI
0091c9 9150 092b 	lds	temp, SD_ADDRESS+1
0091cb 940e 005f 	call	DOSPI
0091cd 9150 092a 	lds	temp, SD_ADDRESS+0
0091cf 940e 005f 	call	DOSPI
0091d1 ef5f      	ldi	temp, 0xff			; CRC
0091d2 940e 005f 	call	DOSPI
                 
                 	; read R1 response
0091d4 ef3f              ldi	r19, 255
                 SD_WRITE_L2:
0091d5 ef5f              ldi     temp, 0xff
0091d6 940e 005f         call    DOSPI
0091d8 ff57              sbrs    temp, 7
0091d9 c002              rjmp    SD_WRITE_L3            		; response received
0091da 953a              dec     r19
0091db f7c9              brne    SD_WRITE_L2
                 
                 SD_WRITE_L3:
0091dc 9350 3f32
0091de 935f
0091df e652
0091e0 9350 3f31
0091e2 915f
0091e3 935f
0091e4 9150 3f2a
0091e6 fd54
0091e7 940e b00b
0091e9 915f      	NOTIFYt NOTIFY_SD, 'b'
                 
0091ea 3050              cpi	temp, 0
0091eb f009              breq	SD_WRITE_L5
                 
0091ec c05c              rjmp	SD_WRITE_END                    ; temp = error code
                 
                 SD_WRITE_L5:
0091ed ef5e              ldi     temp, 0xfe			; data start token
0091ee 940e 005f         call    DOSPI
                 SD_WRITE_L6:
0091f0 e0a0      	ldi	XL, low(SD_BUF)
0091f1 e3b0      	ldi	XH, high(SD_BUF)
                 SD_WRITE_L7:
0091f2 915d      	ld	temp, X+
0091f3 940e 005f         call    DOSPI
0091f5 30a0      	cpi	XL, low(SD_BUF_END)
0091f6 e352      	ldi	temp, high(SD_BUF_END)
0091f7 07b5      	cpc	XH, temp
0091f8 f3c8      	brlo	SD_WRITE_L7			; send 512 bytes
                 
0091f9 ef5f              ldi     temp, 0xff
0091fa 940e 005f         call    DOSPI
0091fc ef5f              ldi     temp, 0xff
0091fd 940e 005f         call    DOSPI				; send CRC
                 
                 	; waiting for the response
0091ff 935f
009200 e45c
009201 9350 0089
009203 9250 0088
009205 9250 0085
009207 9250 0084
009209 9ab1
00920a 915f      	SD_INTT_TIMER 1000
                 SD_WRITE_L8:
00920b ef5f              ldi     temp, 0xff
00920c 940e 005f         call    DOSPI
00920e ff54              sbrs	temp, 4   			; Resp: 00101 = ok, 01011 - crc error, 01101 - write error
00920f c003              rjmp	SD_WRITTEN
009210 99b1              sbic    TIFR1, OCF1A      	
009211 c036              rjmp    SD_WRITE_ERR             	; timeout - error
009212 cff8              rjmp	SD_WRITE_L8
                 
                 SD_WRITTEN:
                 
009213 9350 3f32
009215 935f
009216 e653
009217 9350 3f31
009219 915f
00921a 935f
00921b 9150 3f2a
00921d fd54
00921e 940e b00b
009220 915f      	NOTIFYt NOTIFY_SD, 'c'
                 	
009221 705e      	andi	temp, 0x0e
009222 3054      	cpi	temp, 0x04
009223 f521      	brne	SD_WRITE_ERR			; write error
                 
                 	; waiting for the busy state expires
009224 935f
009225 e45c
009226 9350 0089
009228 9250 0088
00922a 9250 0085
00922c 9250 0084
00922e 9ab1
00922f 915f      	SD_INTT_TIMER 1000
                 SD_WRITE_L9:
009230 ef5f              ldi     temp, 0xff
009231 940e 005f         call    DOSPI
009233 1155              cpse	temp, zero   			; Resp: 0 = busy, ff = completed
009234 c003              rjmp	SD_WRITTEN2
009235 99b1              sbic    TIFR1, OCF1A      	
009236 c011              rjmp    SD_WRITE_ERR             	; timeout - error
009237 cff8              rjmp	SD_WRITE_L9
                 
                 SD_WRITTEN2:
009238 9350 3f32
00923a 935f
00923b e654
00923c 9350 3f31
00923e 915f
00923f 935f
009240 9150 3f2a
009242 fd54
009243 940e b00b
009245 915f      	NOTIFYt NOTIFY_SD, 'd'
                 
009246 e050              ldi	temp, 0
                         ;!!!! add write check (CMD13) command execution !!!
009247 c001              rjmp	SD_WRITE_END			; OK, exiting
                 
                 SD_WRITE_ERR:
009248 ef5d      	ldi	temp, 0xfd			; error code
                 
                 SD_WRITE_END:
009249 bc5c
00924a 9a59
00924b b854      	SPI_STOP
00924c 9250 0081         sts   	TCCR1B, zero
                 
00924e 9350 3f30         sts	SD_ERROR, temp
009250 2755      	clr	temp				;!!!!! DEBUG !!!!! doesn't report error to CPM
                 
009251 913f              pop	r19
009252 91af
009253 91bf      	popw	X
009254 9508      	ret
                 ; -----------------------------------------------------------------------------------------------------
                 
                 
                 ; SD-card Library SUBROUTINES
                 
                 
                 ; ----------------- address << 9 ------------------------------------------
                 SD_ADDRESS_SHIFT:
009255 935f      	push	temp
009256 9150 092c 	lds	temp, SD_ADDRESS+2
009258 9350 092d 	sts	SD_ADDRESS+3, temp
00925a 9150 092b 	lds	temp, SD_ADDRESS+1
00925c 9350 092c 	sts	SD_ADDRESS+2, temp
00925e 9150 092a 	lds	temp, SD_ADDRESS
009260 9350 092b 	sts	SD_ADDRESS+1, temp
009262 9250 092a 	sts	SD_ADDRESS, zero		; <<8
                 
009264 9150 092b 	lds	temp, SD_ADDRESS+1
009266 0f55      	lsl	temp
009267 9350 092b 	sts	SD_ADDRESS+1, temp
009269 9150 092c 	lds	temp, SD_ADDRESS+2
00926b 1f55      	rol	temp
00926c 9350 092c 	sts	SD_ADDRESS+2, temp
00926e 9150 092d 	lds	temp, SD_ADDRESS+3
009270 1f55      	rol	temp
009271 9350 092d 	sts	SD_ADDRESS+3, temp		; <<1
                 
009273 915f      	pop 	temp            		
009274 9508      	ret
                 
                 
                 ; ----------------------------------- execute prepared command, address in Z
                 SD_EXEC_CMD:
009275 932f              push	r18
009276 933f              push	r19
                 
009277 9127              elpm	r18, Z+            	; get number of retries
                 SDE_L4:
                         ; send command
009278 9157              elpm	temp, Z+
009279 940e 005f         call    DOSPI
00927b 9157              elpm    temp, Z+
00927c 940e 005f         call    DOSPI
00927e 9157              elpm    temp, Z+
00927f 940e 005f         call    DOSPI
009281 9157              elpm    temp, Z+
009282 940e 005f         call    DOSPI
009284 9157              elpm    temp, Z+
009285 940e 005f         call    DOSPI
009287 9157              elpm    temp, Z+
009288 940e 005f         call    DOSPI
                 
00928a 9137              elpm    r19, Z+			; get number of chars to wait response
                 SDE_L2:
00928b ef5f              ldi     temp, 0xff
00928c 940e 005f         call    DOSPI
00928e ff57              sbrs    temp, 7
00928f c006              rjmp    SDE_L1             	; response received
009290 953a              dec     r19
009291 f7c9              brne    SDE_L2
                 
009292 9737              sbiw    Z, 7      		; rewind pointer
009293 952a              dec     r18
009294 f719              brne    SDE_L4
                 
009295 c013              rjmp    SDE_END
                 
                         ; response received, read additional data if any
                 SDE_L1: 
009296 3052              cpi	temp, 2			; skip additional data if error
009297 f488              brsh    SDE_END
                 
009298 9137              elpm	r19, Z+
009299 2b33              or      r19, r19    		; =0?
00929a f071              breq    SDE_END
00929b 935f              push    temp            	; save temp
00929c 93af              push    XL            	
00929d 93bf              push    XH
00929e e0b9              ldi	XH, high(SD_RSP)            	
00929f e2ae              ldi	XL, low(SD_RSP)            	
                 SDE_L3:
0092a0 ef5f              ldi     temp, 0xff
0092a1 940e 005f         call    DOSPI      		; read response
0092a3 935d              st	X+, temp
0092a4 953a              dec     r19
0092a5 f7d1              brne    SDE_L3
                 
0092a6 91bf              pop	XH
0092a7 91af              pop	XL
0092a8 915f              pop     temp			; restore temp = R1 response
                 
                 SDE_END:
0092a9 935f      	push 	temp
0092aa e830              ldi	r19, 128		; dummy FFs to let SD card time to prepare itself
                 SDE_L5:
0092ab ef5f              ldi     temp, 0xff
0092ac 940e 005f         call    DOSPI      		
0092ae 953a              dec     r19
0092af f7d9              brne    SDE_L5
0092b0 915f      	pop 	temp
                 
0092b1 913f              pop     r19
0092b2 912f              pop     r18
0092b3 9508              ret
                 
                 
                 ; -------------------------------------- COMMANDS ------------------------------------------------------------
                 
                 .EQU	SD_R0	= 0
                 .EQU	SD_R2	= 1
                 .EQU	SD_R7	= 4
                 .EQU	SD_R3	= 4
                 
                        ; number of retries, ;timeout value (OCRH=n/76 s), 5*data, chars wait responce, length of valid response, 
0092b4 4020
0092b5 0000
0092b6 0000
0092b7 ff95
0092b8 0000      CMD00:  	.DB    32,  0x40+0 , 0x00, 0x00, 0x00, 0x00, 0x95, 255, SD_R0, 0
0092b9 4804
0092ba 0000
0092bb aa01
0092bc ff87
0092bd 0004      CMD08:  	.DB    4,   0x40+8 , 0x00, 0x00, 0x01, 0xaa, 0x87, 255, SD_R7, 0
0092be 4d80
0092bf 0000
0092c0 0000
0092c1 ff87
0092c2 0001      CMD13:  	.DB    128, 0x40+13, 0x00, 0x00, 0x00, 0x00, 0x87, 255, SD_R2, 0
0092c3 4180
0092c4 0000
0092c5 0000
0092c6 ff87
0092c7 0000      CMD01:  	.DB    128, 0x40+1 , 0x00, 0x00, 0x00, 0x00, 0x87, 255, SD_R0, 0
0092c8 7780
0092c9 0000
0092ca 0000
0092cb ff87
0092cc 0000      CMD55:  	.DB    128, 0x40+55, 0x00, 0x00, 0x00, 0x00, 0x87, 255, SD_R0, 0
0092cd 7a10
0092ce 0000
0092cf 0000
0092d0 ff87
0092d1 0004      CMD58:  	.DB    16,  0x40+58, 0x00, 0x00, 0x00, 0x00, 0x87, 255, SD_R3, 0
0092d2 6980
0092d3 0040
0092d4 0000
0092d5 ff87
0092d6 0000      ACMD41:  	.DB    128, 0x40+41, 0x40, 0x00, 0x00, 0x00, 0x87, 255, SD_R0, 0
0092d7 6980
0092d8 0000
0092d9 0000
0092da ff87
0092db 0000      ACMD410: 	.DB    128, 0x40+41, 0x00, 0x00, 0x00, 0x00, 0x87, 255, SD_R0, 0
                 ;#include "sd_cmd.inc"
                 SD_END:
                 
                 ; !!! Ethernet !!!
                 .ORG 0x09400            ; 1 28-47
                 LAN_START:
                 #include "lan.inc"			; lan access routines
                 
                 ;	jmp	_LAN_CMD		; exec port cmd command
                 _LAN_CMD:
009400 9170 3f02 	lds	FROMRAM0, HW_FOUND
009402 ff75      	sbrs	FROMRAM0, HW_FOUND_LAN
009403 940c 8101 	jmp	SPCMD_notfound
                 
009405 9170 36c0 	lds	FROMRAM0, RTC_HW_DISABLE	; check that LAN is enabled
009407 fd75      	sbrc	FROMRAM0, HW_DSBL_LAN
009408 940c 8101 	jmp	SPCMD_notfound
                 
00940a 93bf
00940b 93af      	pushw	X
00940c 93df
00940d 93cf      	pushw	Y
00940e 93ff
00940f 93ef      	pushw	Z
009410 933f      	push	r19
009411 937f      	push	FROMRAM0
009412 921f      	push	FROMRAM1
009413 932f      	push	FROMRAM2
                 
                 	; commands that doesn't access chip
009414 e836      	ldi	r19, low(_LAN_CMD_end)
009415 933f      	push	r19	
009416 e934      	ldi	r19, high(_LAN_CMD_end)
009417 933f      	push	r19				; address for RET
009418 3052
009419 f409
00941a c089              tcbe	2,  _LAN_COPY_RAM_BUF		;!!ok
00941b 3053
00941c f409
00941d c093              tcbe	3,  _LAN_COPY_BUF_RAM		;!!ok
00941e 305b
00941f f409
009420 c09d      	tcbe	11, _LAN_IP_CRC			;!!ok
009421 305f
009422 f409
009423 c129      	tcbe	15, _LAN_BUILD_USER_ETH_FRAME	;!!ok
009424 305c
009425 f409
009426 c13f      	tcbe	12, _LAN_BUILD_USER_IP_FRAME	;!!ok
009427 305d
009428 f409
009429 c14b      	tcbe	13, _LAN_BUILD_USER_UDP_FRAME	;!!ok
00942a 305e
00942b f409
00942c c1a7      	tcbe	14, _LAN_BUILD_ARP_RESP		;!!ok
00942d 3150
00942e f409
00942f c1c1      	tcbe	16, _LAN_CHECK_FRAME_TYPE	;!!ok
009430 3153
009431 f409
009432 c1aa      	tcbe	19, _LAN_GET_UDP_DATA		;!!ok
009433 3154
009434 f409
009435 c167      	tcbe	20, _LAN_BUILD_ARP_REQUEST	;!!ok
009436 3156
009437 f409
009438 c173      	tcbe	22, _LAN_BUILD_PING_REQUEST	;!!ok
009439 3157
00943a f409
00943b c185      	tcbe	23, _LAN_BUILD_PING_RESPONSE	;!!ok
00943c 3155
00943d f409
00943e c198      	tcbe	21, _LAN_SEND_UDP		;!!ok		; build and send UDP 
00943f 3158
009440 f409
009441 c198      	tcbe	24, _LAN_SEND_TCP		;!!todo!!!; build and send TCP 
009442 913f      	pop	r19
009443 913f      	pop	r19				; clear stack if command didn't match
                 
                 _LAN_CMD_P2:
                 	; commands that work with the chip
009444 e833      	ldi	r19, low(_LAN_CMD_ret)
009445 933f      	push	r19	
009446 e934      	ldi	r19, high(_LAN_CMD_ret)
009447 933f      	push	r19				; address for RET
                 
009448 935f
009449 e159
00944a b955
00944b eb5f
00944c b954
00944d e051
00944e bd5d
00944f e550
009450 bd5c
009451 9859
009452 915f              SPI_INIT SPI_SLAVE_LAN, LAN_SPI_SETTINGS	; SPI_FCK_DIV_4	; start SPI
                 
009453 3152
009454 f409
009455 c19d      	tcbe	18, _LAN_PROCESS_MESSAGES	; !!ok
                 	; internal system commands
009456 3757
009457 f409
009458 c19c      	tcbe	119, _LAN_SEND_CON		; send zzC to SERVER CON
009459 3758
00945a f409
00945b c19b      	tcbe	120, _LAN_SEND_PR		; send zzC to PR-SRV
00945c 3759
00945d f409
00945e c19a      	tcbe	121, _LAN_SEND_PRN		; send zzC to PRN-SRV
00945f 375a
009460 f409
009461 c199      	tcbe	122, _LAN_SEND_RSD		; send zzC to RSD-SRV
                 
009462 3050
009463 f409
009464 c034              tcbe	LAN_FUNC_INIT,        _LAN_INIT	;!!ok 0
009465 3051
009466 f409
009467 c038              tcbe	LAN_FUNC_INIT_CUSTOM, _LAN_INIT_BUF	;!!ok 1
009468 3054
009469 f409
00946a c067              tcbe	4,  _LAN_GET_ETH_REG		;!!ok
00946b 3055
00946c f409
00946d c070              tcbe	5,  _LAN_GET_MX_REG		;!!ok
00946e 3058
00946f f409
009470 c07c      	tcbe	8,  _LAN_GET_EPKTCNT		;!!ok
009471 3059
009472 f409
009473 c0bc      	tcbe	9,  _LAN_UPDATE_REG		;!!ok
009474 305a
009475 f409
009476 c089      	tcbe	10, _LAN_GET_PHY_REG		;!!ok
009477 3151
009478 f409
009479 c07d      	tcbe	17, _LAN_GET_ESTAT		;!!ok
00947a 3056
00947b f409
00947c c0c1              tcbe	6,  _LAN_SEND_USER_PACKET	;!!ok
00947d 3057
00947e f409
00947f c0c1              tcbe	7,  _LAN_RECEIVE_USER_PACKET	;!!ok
009480 913f      	pop	r19
009481 913f      	pop	r19			; clear stack if wrong command
009482 ef5d      	ldi	temp, 0xfd		; wrong command
                 _LAN_CMD_ret:
009483 bc5c
009484 9a59
009485 b854              SPI_STOP
                 _LAN_CMD_end:
009486 9350 08fe 	sts	PCMD_FE, temp		; store response
                 
009488 912f      	pop	FROMRAM2
009489 901f      	pop	FROMRAM1
00948a 917f      	pop	FROMRAM0
00948b 913f              pop	r19
00948c 91ef
00948d 91ff      	popw	Z
00948e 91cf
00948f 91df      	popw	Y
009490 91af
009491 91bf      	popw	X
009492 9508      	ret
                 
                 
                 ; 10 us delay
                 LAN_WAIT_10us:
009493 935f
009494 e456
009495 955a
009496 f7f1
009497 915f      	_LAN_WAIT_10us
009498 9508      	ret
                 
                 
                 ; init LAN chip for default values
                 _LAN_INIT:
009499 d163      	rcall	_LAN_INIT_DO
00949a 9250 3796 	sts	PR_BUF_CNT, zero
00949c 9250 37b7 	sts	CON_BUF_CNT, zero
00949e e050      	ldi	temp, 0
00949f 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ;init LAN chip and set MY MAC address
                 _LAN_INIT_BUF:
0094a0 d15c      	rcall	_LAN_INIT_DO		; base init
0094a1 d260      	rcall	_LAN_SET_MY_MAC		; set MAC
0094a2 e051      	ldi	temp, 1
0094a3 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ; copy zRAM to LAN_BUF
                 _LAN_COPY_RAM_BUF:	
0094a4 e0a0
0094a5 e3b2      	ldiw	X, LAN_BUF		; address to store to
0094a6 91e0 094e
0094a8 91f0 094f 	ldw	Z, LAN_MBUF_OUT		; address to read from
0094aa 91c0 0950
0094ac 91d0 0951 	ldw	Y, LAN_MBUF_OUT_L	; number of bytes to read from
0094ae 940e 8a31 	call	MCOPY_RAM_AVR_Y
0094b0 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 ; copy LAN_BUF to zRAM
                 _LAN_COPY_BUF_RAM:
0094b1 e0a0
0094b2 e3b2      	ldiw	X, LAN_BUF		; address to store to
0094b3 91e0 094a
0094b5 91f0 094b 	ldw	Z, LAN_MBUF_IN		; address to read from
0094b7 91c0 094c
0094b9 91d0 094d 	ldw	Y, LAN_MBUF_IN_L	; number of bytes to read from
0094bb 940e 89f1 	call	MCOPY_AVR_RAM_Y
0094bd 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ;calculates CRC starting from LAN_BUF+(LAN_PAR) with (LAN_UPD_DATA) length, returns result to (LAN_UPD_DATA)
                 _LAN_IP_CRC:
0094be 93df
0094bf 93cf      	pushw	Y
0094c0 91e0 0948
0094c2 91f0 0949 	ldw	Z, LAN_PAR		; offset
0094c4 91c0 096b
0094c6 91d0 096c 	ldw	Y, LAN_UPD_DATA
0094c8 e352      	ldi	temp, high(LAN_BUF)
0094c9 0ff5      	add	ZH, temp		; convert local address to ram address
                 					; low(LAN_BUF) === 0
0094ca d2d7      	rcall	_LAN_IPCRC
0094cb 93e0 096b
0094cd 93f0 096c 	stw	LAN_UPD_DATA, Z
0094cf 91cf
0094d0 91df      	popw	Y
0094d1 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 ; return chip register value
                 _LAN_GET_ETH_REG:
0094d2 d2b7      	rcall	_LAN_CMD_PAR_PREPARE
0094d3 935f      	push	temp
0094d4 982c
0094d5 915f
0094d6 6050
0094d7 940e 005f
0094d9 ef5f
0094da 940e 005f
0094dc 9a2c      	LAN_ETH_REG_READ_S
0094dd 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ; return chip MX register value
                 _LAN_GET_MX_REG:
0094de d2ab      	rcall	_LAN_CMD_PAR_PREPARE
0094df 935f      	push	temp
0094e0 982c
0094e1 915f
0094e2 6050
0094e3 940e 005f
0094e5 ef5f
0094e6 940e 005f
0094e8 ef5f
0094e9 940e 005f
0094eb 9a2c      	LAN_Mx_REG_READ_S
0094ec 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 
                 _LAN_GET_EPKTCNT:
0094ed d271      	rcall	LAN_SELECT_BANK_1
0094ee 982c
0094ef e159
0094f0 940e 005f
0094f2 ef5f
0094f3 940e 005f
0094f5 9a2c      	LAN_ETH_REG_READ LAN_EPKTCNT		; check that there is unread packet
0094f6 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 
                 _LAN_GET_ESTAT:
0094f7 982c
0094f8 e15d
0094f9 940e 005f
0094fb ef5f
0094fc 940e 005f
0094fe 9a2c      	LAN_ETH_REG_READ LAN_ESTAT		; check status
0094ff 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 
                 ; return chip MX register value
                 _LAN_GET_PHY_REG:
009500 d289      	rcall	_LAN_CMD_PAR_PREPARE
009501 935f      	push	temp
                 
009502 982c
009503 e554
009504 940e 005f
009506 915f
009507 940e 005f
009509 9a2c      	LAN_CREG_WRITE_C_S LAN_MIREGADR, LAN_REG_WRITE	; address
00950a 982c
00950b e952
00950c 940e 005f
00950e e051
00950f 940e 005f
009511 9a2c      	LAN_CREG_WRITE_C LAN_MICMD, 0b00000001, LAN_REG_BFS
009512 df80      	DELAY_10us
                 ;	LAN_ETH_REG_READ LAN_MISTAT
009513 982c
009514 eb52
009515 940e 005f
009517 e051
009518 940e 005f
00951a 9a2c      	LAN_CREG_WRITE_C LAN_MICMD, 0b00000001, LAN_REG_BFC
00951b 982c
00951c e158
00951d 940e 005f
00951f ef5f
009520 940e 005f
009522 9a2c      	LAN_ETH_REG_READ LAN_MIRDL
009523 9350 096b 	sts	LAN_UPD_DATA, temp
009525 982c
009526 e159
009527 940e 005f
009529 ef5f
00952a 940e 005f
00952c 9a2c      	LAN_ETH_REG_READ LAN_MIRDH
00952d 9350 096c 	sts	LAN_UPD_DATA+1, temp
00952f 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 
                 _LAN_UPDATE_REG:
009530 d259      	rcall	_LAN_CMD_PAR_PREPARE
009531 9170 096c 	lds	FROMRAM0, LAN_UPD_DATA+1	; operation
009533 7e70      	andi	FROMRAM0, 0b11100000		; mask unused bits
009534 2b57      	or	temp, FROMRAM0			; make command
009535 982c              SPI_SELECT
009536 940e 005f 	call	DOSPI
009538 9150 096b 	lds	temp, LAN_UPD_DATA		; value to store
00953a 940e 005f 	call	DOSPI
00953c 9a2c      	SPI_DESELECT
00953d 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ; sends buf0 packet
                 _LAN_SEND_USER_PACKET:
00953e d557      	rcall	_LAN_SET_USER
00953f d6bb      	rcall	LAN_SEND_PACKET
009540 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ;rceives buf0 packet
                 _LAN_RECEIVE_USER_PACKET:
009541 d554      	rcall	_LAN_SET_USER
009542 d757      	rcall	LAN_RECEIVE_PACKET
009543 d7ce      	rcall	LAN_RECEIVE_PACKET_NEXT		; set processed and go to next packet
009544 9150 365a
009546 9350 094c
009548 9150 365b
00954a 9350 094d 	ldstt2	LAN_MBUF_IN_L, LAN_OP_BUF_LEN	; store received data length
00954c 9508      	ret	; rjmp	_LAN_CMD_ret
                 
                 
                 ; build ETH frame from the RAM (DATA)
                 _LAN_BUILD_USER_ETH_FRAME:
00954d e0ae
00954e e3b2      	ldiw	X, LAN_ETH_DATA		; address to store to (ETH DATA)
00954f 91e0 094e
009551 91f0 094f 	ldw	Z, LAN_MBUF_OUT		; address to read from
009553 91c0 0950
009555 91d0 0951 	ldw	Y, LAN_MBUF_OUT_L	; number of bytes to read from
009557 940e 8a31 	call	MCOPY_RAM_AVR_Y
                 
009559 d53c      	rcall	_LAN_SET_USER
                 _LAN_BUILD_USER_ETH_FRAME_act:
00955a 9250 3658 	sts	LAN_OP_ETHTYPE, zero
                 _LAN_BUILD_USER_ETH_FRAME_act2:
00955c d274      	rcall	LAN_BUILD_ETH_FRAME
00955d 9150 365a
00955f 9350 0950
009561 9150 365b
009563 9350 0951 	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
009565 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 ; make ip frame from buf data and lan_block
                 _LAN_BUILD_USER_IP_FRAME:
009566 e2a2
009567 e3b2      	ldiw	X, LAN_IP_DATA		; address to store to (IP DATA)
009568 91e0 094e
00956a 91f0 094f 	ldw	Z, LAN_MBUF_OUT		; address to read from
00956c 91c0 0950
00956e 91d0 0951 	ldw	Y, LAN_MBUF_OUT_L	; number of bytes to read from
009570 940e 8a31 	call	MCOPY_RAM_AVR_Y
                 
009572 d523      	rcall	_LAN_SET_USER
                 _LAN_BUILD_USER_IP_FRAME_act:
009573 d277      	rcall	LAN_BUILD_IP_FRAME
009574 cfe5      	rjmp	_LAN_BUILD_USER_ETH_FRAME_act	; build eth frame
                 ;	rcall	LAN_BUILD_ETH_FRAME
                 ;	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
                 ;	ret	; rjmp	_LAN_CMD_end
                 
                 
                 ; make udp frame from buf data and lan_block
                 _LAN_BUILD_USER_UDP_FRAME:
009575 e2aa
009576 e3b2      	ldiw	X, LAN_UDP_DATA		; address to store to (IP DATA)
009577 91e0 094e
009579 91f0 094f 	ldw	Z, LAN_MBUF_OUT		; address to read from
00957b 91c0 0950
00957d 91d0 0951 	ldw	Y, LAN_MBUF_OUT_L	; number of bytes to read from
00957f 940e 8a31 	call	MCOPY_RAM_AVR_Y
                 
009581 d514      	rcall	_LAN_SET_USER
                 _LAN_BUILD_USER_UDP_FRAME_act:
009582 e151      	ldi	temp, LAN_PROTOCOL_UDP
009583 9350 0971 	sts	LAN_PROTOCOL, temp
009585 9350 365e 	sts	LAN_OP_PROTOCOL, temp		; set UDP
009587 d2a1      	rcall	LAN_BUILD_UDP_FRAME
009588 cfea      	rjmp	_LAN_BUILD_USER_IP_FRAME_act	; Proceed with IP, ETH
                 ;	rcall	LAN_BUILD_IP_FRAME
                 ;	rcall	LAN_BUILD_ETH_FRAME
                 ;	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
                 ;	ret	; rjmp	_LAN_CMD_end
                 
                 
                 
                 ; make tcp frame from buf data and lan_block
                 _LAN_BUILD_USER_TCP_FRAME:
009589 e3a6
00958a e3b2      	ldiw	X, LAN_TCP_DATA		; address to store to (IP DATA)
00958b 91e0 094e
00958d 91f0 094f 	ldw	Z, LAN_MBUF_OUT		; address to read from
00958f 91c0 0950
009591 91d0 0951 	ldw	Y, LAN_MBUF_OUT_L	; number of bytes to read from
009593 940e 8a31 	call	MCOPY_RAM_AVR_Y
                 
009595 d500      	rcall	_LAN_SET_USER
                 _LAN_BUILD_USER_TCP_FRAME_act:
009596 e056      	ldi	temp, LAN_PROTOCOL_TCP
009597 9350 0971 	sts	LAN_PROTOCOL, temp
009599 9350 365e 	sts	LAN_OP_PROTOCOL, temp		; set UDP
00959b d2c9      	rcall	LAN_BUILD_TCP_FRAME
00959c cfd6      	rjmp	_LAN_BUILD_USER_IP_FRAME_act	; Proceed with IP, ETH
                 ;	rcall	LAN_BUILD_IP_FRAME
                 ;	rcall	LAN_BUILD_ETH_FRAME
                 ;	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
                 ;	ret	; rjmp	_LAN_CMD_end
                 
                 
                 
                 ; build and send ARP request to user server
                 _LAN_BUILD_ARP_REQUEST:
00959d d4f8      	rcall	_LAN_SET_USER
00959e d381              rcall	LAN_BUILD_ARP_REQUEST
00959f 9150 0006         lds	temp, 6				; ARP
0095a1 9350 3658 	sts	LAN_OP_ETHTYPE, temp
0095a3 9150 365a
0095a5 9350 0950
0095a7 9150 365b
0095a9 9350 0951 	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
0095ab 9508      	ret	; rjmp	_LAN_CMD_end
                 ;
                 ;	rjmp	_LAN_BUILD_USER_ETH_FRAME_act2	; build ETH
                 ;	rcall	LAN_BUILD_ETH_FRAME
                 ;	ret	; rjmp	_LAN_CMD_end
                 
                 
                 
                 _LAN_BUILD_PING_REQUEST:
0095ac e2aa
0095ad e3b2      	ldiw	X, LAN_ICMP_DATA	; address to store to (ETH DATA)
0095ae 91e0 094e
0095b0 91f0 094f 	ldw	Z, LAN_MBUF_OUT		; address to read from
0095b2 91c0 0950
0095b4 91d0 0951 	ldw	Y, LAN_MBUF_OUT_L	; number of bytes to read from
0095b6 940e 8a31 	call	MCOPY_RAM_AVR_Y
                 
0095b8 e051      	ldi	temp, LAN_PROTOCOL_ICMP
0095b9 9350 0971 	sts	LAN_PROTOCOL, temp
0095bb d4da      	rcall	_LAN_SET_USER
                 
0095bc e058      	ldi	temp, LAN_PROT_ICMP_PING
0095bd 9350 3657 	sts	LAN_OP_TYPE, temp	; ping request
                 
0095bf d2ee      	rcall	LAN_BUILD_ICMP_FRAME
0095c0 cfb2      	rjmp	_LAN_BUILD_USER_IP_FRAME_act
                 
                 ;	rcall	LAN_BUILD_IP_FRAME
                 ;	rcall	LAN_BUILD_ETH_FRAME
                 ;	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
                 ;	ret	; rjmp	_LAN_CMD_end
                 
                 
                 _LAN_BUILD_PING_RESPONSE:
0095c1 9150 094c
0095c3 9350 0950
0095c5 9150 094d
0095c7 9350 0951 	ldstt2	LAN_MBUF_OUT_L, LAN_MBUF_IN_L	; set output buffer length
0095c9 d4cc      	rcall	_LAN_SET_USER
0095ca d3e7      	rcall	LAN_BUILD_PING_RESPONSE
0095cb 9150 365a
0095cd 9350 0950
0095cf 9150 365b
0095d1 9350 0951 	ldstt2	LAN_MBUF_OUT_L, LAN_OP_BUF_LEN
0095d3 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 
                 ; make arp response from buf data and lan_block
                 _LAN_BUILD_ARP_RESP:
0095d4 d4c1      	rcall	_LAN_SET_USER
0095d5 d302      	rcall	LAN_BUILD_ARP_RESPONSE
0095d6 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 
                 ; prepare and send user UDP message
                 _LAN_SEND_UDP:
0095d7 df9d      	rcall	_LAN_BUILD_USER_UDP_FRAME
0095d8 d78e      	rcall	__LAN_SEND		; safe send
                 ;	CMD_LAN	LAN_FUNC_SEND		; safe send
0095d9 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 ; prepare and send user UDP message
                 _LAN_SEND_TCP:
0095da dfae      	rcall	_LAN_BUILD_USER_TCP_FRAME
0095db d78b      	rcall	__LAN_SEND		; safe send
                 ;	CMD_LAN	LAN_FUNC_SEND		; safe send
0095dc 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 
                 ; returns UDP_DATA to zzRAM IN_BUF
                 _LAN_GET_UDP_DATA:
0095dd 91d0 3226 	lds	YH, LAN_UDP_LEN
0095df 91c0 3227 	lds	YL, LAN_UDP_LEN+1
0095e1 9728      	sbiw	Y, LAN_UDP_DATA-LAN_UDP_FRAME	; =8 - UDP header size
0095e2 93c0 094c
0095e4 93d0 094d 	stw	LAN_MBUF_IN_L, Y	; set actual length
0095e6 e2aa
0095e7 e3b2      	ldiw	X, LAN_UDP_DATA		; address to read from
0095e8 91e0 094a
0095ea 91f0 094b 	ldw	Z, LAN_MBUF_IN		; address to store to
                 ;	ldw	Y, LAN_MBUF_IN_L	; number of bytes to read from
0095ec 940e 89f1 	call	MCOPY_AVR_RAM_Y
0095ee 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 	
                 ; check that arp is for us
                 _LAN_CHECK_ARP_REQ:
0095ef d368      	rcall	LAN_CHECK_ARP_REQUEST
0095f0 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 _LAN_CHECK_FRAME_TYPE:
0095f1 d40c      	rcall	LAN_CHECK_FRAME_TYPE
0095f2 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 _LAN_PROCESS_MESSAGES:
0095f3 d59f      	rcall	LAN_PROCESS_MESSAGES
0095f4 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 _LAN_SEND_CON:
0095f5 d5f7      	rcall	LAN_SEND_CON			; send byte in zzC to server
0095f6 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 _LAN_SEND_PR:
0095f7 d5f9      	rcall	LAN_SEND_PR			; send byte in zzC to pr-server
0095f8 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 _LAN_SEND_PRN:
0095f9 d5fb      	rcall	LAN_SEND_PRN			; send byte in zzC to prn-server
0095fa 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 _LAN_SEND_RSD:
0095fb d5fd      	rcall	LAN_SEND_RSD			; send data to rsd -server
0095fc 9508      	ret	; rjmp	_LAN_CMD_end
                 
                 /*
                 ; removes UDP headers
                 _LAN_REMOVE_UDP_HEADER:
                 	lds	YH, LAN_UDP_LEN
                 	lds	YL, LAN_UDP_LEN+1
                 	sbiw	Y, LAN_UDP_DATA-LAN_UDP_FRAME	; =8 - UDP header size
                 	stw	LAN_MBUF_IN_L, Y	; set actual length
                 	ldiw	X, LAN_BUF
                 	ldiw	Z, LAN_UDP_DATA		; offset for data in ip frame (20) including offset in eth frame (14)
                 	call	LAN_ZXYb		; move Y btes from Z to X backward
                 	ret	; rjmp	_LAN_CMD_end
                 		
                 
                 ; set LAN_MBUF_IN_L for UDP DATA length only
                 _LAN_REMOVE_UDP_HEADER_L:
                 	lds	YH, LAN_UDP_LEN
                 	lds	YL, LAN_UDP_LEN+1
                 	sbiw	Y, LAN_UDP_DATA-LAN_UDP_FRAME	; =8 - UDP header size
                 	stw	LAN_MBUF_IN_L, Y	; set actual length
                 	ret	; rjmp	_LAN_CMD_end
                 */
                 
                 
                 
                 ; -------------------------------------------------------------------------------------------------------------
                 ; SUBROUTINES
                 
                 ; startup LAN Init
                 _LAN_INIT_DO: 
                         ; system reset
0095fd 982c              SPI_SELECT
0095fe ef5f              ldi	temp, 0xff
0095ff 940e 005f 	call	DOSPI
009601 9a2c              SPI_DESELECT
                 
009602 de90              DELAY_10us
009603 de8f              DELAY_10us
009604 de8e              DELAY_10us
009605 de8d              DELAY_10us
009606 de8c              DELAY_10us				; 50 us startup delay
                 
009607 d14e              rcall	LAN_SELECT_BANK_0			; select bank 0
009608 982c
009609 e458
00960a 940e 005f
00960c e050
00960d 940e 005f
00960f 9a2c
009610 982c
009611 e459
009612 940e 005f
009614 e050
009615 940e 005f
009617 9a2c              LAN_CREG_WRITE_LH LAN_ERXST, LAN_M_RXSTART	; rx buf start
009618 982c
009619 e45a
00961a 940e 005f
00961c ef5f
00961d 940e 005f
00961f 9a2c
009620 982c
009621 e45b
009622 940e 005f
009624 e159
009625 940e 005f
009627 9a2c              LAN_CREG_WRITE_LH LAN_ERXND, LAN_M_RXEND	; rx buf end
009628 982c
009629 e45c
00962a 940e 005f
00962c e050
00962d 940e 005f
00962f 9a2c
009630 982c
009631 e45d
009632 940e 005f
009634 e050
009635 940e 005f
009637 9a2c              LAN_CREG_WRITE_LH LAN_ERXRDPT, LAN_M_RXSTART	; read ptr
                 
009638 935f
009639 e050
00963a 9350 0967
00963c e050
00963d 9350 0968
00963f 915f              stiw	LAN_RXDPT, LAN_M_RXSTART		; store active pointer
                 
                 ;	LAN_CREG_WRITE_LH LAN_ETXST, LAN_M_TXSTART	; tx buf start
                 ;	LAN_CREG_WRITE_LH LAN_ETXND, LAN_M_TXEND	; tx buf end
                 ;	LAN_CREG_WRITE_LH LAN_ETXRDPT, LAN_M_TXSTART	; read ptr
                 
009640 d12f              rcall	LAN_SELECT_BANK_2			; select bank 2
                 ;	LAN_CREG_WRITE LAN_MACON2, 0			; clear
009641 982c
009642 e450
009643 940e 005f
009645 e05d
009646 940e 005f
009648 9a2c      	LAN_CREG_WRITE LAN_MACON1, 0b00001101		; TXPAUS RXPAUS MARXEN
009649 982c
00964a e452
00964b 940e 005f
00964d e353
00964e 940e 005f
009650 9a2c      	LAN_CREG_WRITE LAN_MACON3, 0b00110011		; PADCFG0 TXCRCEN FRMLNEN FULDPX
009651 982c
009652 e453
009653 940e 005f
009655 e450
009656 940e 005f
009658 9a2c      	LAN_CREG_WRITE LAN_MACON4, 0b01000000		; DEFER
009659 982c
00965a e45a
00965b 940e 005f
00965d ed5c
00965e 940e 005f
009660 9a2c
009661 982c
009662 e45b
009663 940e 005f
009665 e055
009666 940e 005f
009668 9a2c              LAN_CREG_WRITE_LH LAN_MAMXFL, LAN_M_MAXFRAME	; max frame size
009669 982c
00966a e454
00966b 940e 005f
00966d e155
00966e 940e 005f
009670 9a2c      	LAN_CREG_WRITE LAN_MABBIPG, 0x15		; Datasheet
009671 982c
009672 e456
009673 940e 005f
009675 e152
009676 940e 005f
009678 9a2c      	LAN_CREG_WRITE LAN_MAIPGL, 0x12			; Datasheet
                 ;	LAN_CREG_WRITE LAN_MAIPGH, 0x0c			; Datasheet ?????
                 
009679 d107              rcall	LAN_SELECT_BANK_3			; select bank 3
                 	; default MAC address for all devices 43-e8-9f-b3-5f-bc
00967a 982c
00967b e454
00967c 940e 005f
00967e e453
00967f 940e 005f
009681 9a2c      	LAN_CREG_WRITE LAN_MAADR1, 0x43
009682 982c
009683 e455
009684 940e 005f
009686 ee58
009687 940e 005f
009689 9a2c      	LAN_CREG_WRITE LAN_MAADR2, 0xe8
00968a 982c
00968b e452
00968c 940e 005f
00968e e95f
00968f 940e 005f
009691 9a2c      	LAN_CREG_WRITE LAN_MAADR3, 0x9f
009692 982c
009693 e453
009694 940e 005f
009696 eb53
009697 940e 005f
009699 9a2c      	LAN_CREG_WRITE LAN_MAADR4, 0xb3
00969a 982c
00969b e450
00969c 940e 005f
00969e e55f
00969f 940e 005f
0096a1 9a2c      	LAN_CREG_WRITE LAN_MAADR5, 0x5f
0096a2 982c
0096a3 e451
0096a4 940e 005f
0096a6 eb5c
0096a7 940e 005f
0096a9 9a2c      	LAN_CREG_WRITE LAN_MAADR6, 0xbc
                 
0096aa d0c5      	rcall	LAN_SELECT_BANK_2			; select bank 2
0096ab 982c
0096ac e554
0096ad 940e 005f
0096af e150
0096b0 940e 005f
0096b2 9a2c
0096b3 982c
0096b4 e556
0096b5 940e 005f
0096b7 e050
0096b8 940e 005f
0096ba 9a2c
0096bb 982c
0096bc e557
0096bd 940e 005f
0096bf e051
0096c0 940e 005f
0096c2 9a2c
0096c3 940e 9493 	LAN_WRITE_PHY LAN_PHCON2, 0b0000000100000000	; HDLDIS
0096c5 982c
0096c6 e554
0096c7 940e 005f
0096c9 e050
0096ca 940e 005f
0096cc 9a2c
0096cd 982c
0096ce e556
0096cf 940e 005f
0096d1 e050
0096d2 940e 005f
0096d4 9a2c
0096d5 982c
0096d6 e557
0096d7 940e 005f
0096d9 e051
0096da 940e 005f
0096dc 9a2c
0096dd 940e 9493 	LAN_WRITE_PHY LAN_PHCON1, 0b0000000100000000	; PDPXMD === FULDPX
0096df 982c
0096e0 e554
0096e1 940e 005f
0096e3 e154
0096e4 940e 005f
0096e6 9a2c
0096e7 982c
0096e8 e556
0096e9 940e 005f
0096eb e752
0096ec 940e 005f
0096ee 9a2c
0096ef 982c
0096f0 e557
0096f1 940e 005f
0096f3 e354
0096f4 940e 005f
0096f6 9a2c
0096f7 940e 9493 	LAN_WRITE_PHY LAN_PHLCON, 0b0011010001110010	; Activity
                 
                 ;	LAN_CREG_WRITE_C LAN_ECON2, 0b10000000, LAN_REG_BFS	; AUTOINC
0096f9 982c
0096fa e95f
0096fb 940e 005f
0096fd e054
0096fe 940e 005f
009700 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0b00000100, LAN_REG_BFS	; RXEN
009701 9508      	ret
                 
                 
                 ; SET MAC address
                 _LAN_SET_MY_MAC:
009702 9150 095a         lds	temp, 	LAN_MAC_MY+0			; set MAC from BUF data
009704 935f              push	temp
009705 9150 095b         lds	temp, 	LAN_MAC_MY+1
009707 935f              push	temp
009708 9150 095c         lds	temp, 	LAN_MAC_MY+2
00970a 935f              push	temp
00970b 9150 095d         lds	temp, 	LAN_MAC_MY+3
00970d 935f              push	temp
00970e 9150 095e         lds	temp, 	LAN_MAC_MY+4
009710 935f              push	temp
009711 9150 095f         lds	temp, 	LAN_MAC_MY+5
009713 935f              push	temp
                 
                         ; datasheed advises to disable TX during MAC address updating
009714 982c
009715 eb5f
009716 940e 005f
009718 e054
009719 940e 005f
00971b 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0b00000100, LAN_REG_BFC	; RXEN
                 
00971c d064              rcall	LAN_SELECT_BANK_3			; select bank 2
00971d 982c
00971e e451
00971f 940e 005f
009721 915f
009722 940e 005f
009724 9a2c      	LAN_CREG_WRITE_S LAN_MAADR6
009725 982c
009726 e450
009727 940e 005f
009729 915f
00972a 940e 005f
00972c 9a2c      	LAN_CREG_WRITE_S LAN_MAADR5
00972d 982c
00972e e453
00972f 940e 005f
009731 915f
009732 940e 005f
009734 9a2c      	LAN_CREG_WRITE_S LAN_MAADR4
009735 982c
009736 e452
009737 940e 005f
009739 915f
00973a 940e 005f
00973c 9a2c      	LAN_CREG_WRITE_S LAN_MAADR3
00973d 982c
00973e e455
00973f 940e 005f
009741 915f
009742 940e 005f
009744 9a2c      	LAN_CREG_WRITE_S LAN_MAADR2
009745 982c
009746 e454
009747 940e 005f
009749 915f
00974a 940e 005f
00974c 9a2c      	LAN_CREG_WRITE_S LAN_MAADR1
                 
00974d 982c
00974e e95f
00974f 940e 005f
009751 e054
009752 940e 005f
009754 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0b00000100, LAN_REG_BFS	; RXEN
009755 9508      	ret
                 
                 
                 
                 LAN_SELECT_BANK_0:
009756 982c
009757 eb5f
009758 940e 005f
00975a e053
00975b 940e 005f
00975d 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0x03, LAN_REG_BFC
                 ;	LAN_CREG_WRITE_C LAN_ECON1, LAN_BANK0, LAN_REG_BFS
00975e 9508      	ret	
                 
                 LAN_SELECT_BANK_1:
00975f 982c
009760 eb5f
009761 940e 005f
009763 e053
009764 940e 005f
009766 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0x03, LAN_REG_BFC
009767 982c
009768 e95f
009769 940e 005f
00976b e051
00976c 940e 005f
00976e 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, LAN_BANK1, LAN_REG_BFS
00976f 9508      	ret
                 
                 LAN_SELECT_BANK_2:
009770 982c
009771 eb5f
009772 940e 005f
009774 e053
009775 940e 005f
009777 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0x03, LAN_REG_BFC
009778 982c
009779 e95f
00977a 940e 005f
00977c e052
00977d 940e 005f
00977f 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, LAN_BANK2, LAN_REG_BFS
009780 9508      	ret
                 
                 LAN_SELECT_BANK_3:
                 ;	LAN_CREG_WRITE_C LAN_ECON1, 0x03, LAN_REG_BFC
009781 982c
009782 e95f
009783 940e 005f
009785 e053
009786 940e 005f
009788 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, LAN_BANK3, LAN_REG_BFS
009789 9508      	ret
                 
                 
                 ; select bank and returns reg num in temp
                 _LAN_CMD_PAR_PREPARE:
00978a 9150 0948 	lds	temp, LAN_PAR
00978c 7053      	andi	temp, 0x03		; mask unused bits
00978d 935f      	push	temp
00978e 982c
00978f eb5f
009790 940e 005f
009792 e053
009793 940e 005f
009795 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0x03, LAN_REG_BFC
009796 982c
009797 e95f
009798 940e 005f
00979a 915f
00979b 940e 005f
00979d 9a2c      	LAN_CREG_WRITE_C_S LAN_ECON1, LAN_REG_BFS
00979e 9150 0949 	lds	temp, LAN_PAR+1
0097a0 715f      	andi	temp, 0x1f		; mask unused bits
0097a1 9508      	ret
                 
                 
                 ; compute CRC from Z for Y bytes, return CRC in Z big endian 
                 _LAN_IPCRC:
0097a2 931f      	push	r17
0097a3 932f      	push	r18
0097a4 933f      	push	r19
0097a5 934f      	push	r20
                 
0097a6 2711      	clr	r17
0097a7 2722      	clr	r18
0097a8 2733      	clr	r19
0097a9 2744      	clr	r20			; sum will be here
                 
                 _lan_ipcrc_l2:
0097aa 30d0      	cpi	YH, 0
0097ab f411      	brne	_lan_ipcrc_l0
0097ac 30c2      	cpi	YL, 2
0097ad f058      	brlo	_lan_ipcrc_l1		; Y>=2 ?
                 _lan_ipcrc_l0:
0097ae 9151              ld	temp, Z+
0097af 0f35      	add	r19, temp
0097b0 1d25      	adc	r18, zero
0097b1 1d15      	adc	r17, zero		; sum + b<<8 - big endian
0097b2 9151              ld	temp, Z+
0097b3 0f45      	add	r20, temp
0097b4 1d35      	adc	r19, zero
0097b5 1d25      	adc	r18, zero
0097b6 1d15      	adc	r17, zero		; sum + b
0097b7 9722      	sbiw	Y, 2
0097b8 cff1      	rjmp	_lan_ipcrc_l2
                 _lan_ipcrc_l1:
0097b9 30c1      	cpi	YL, 1
0097ba f421      	brne	_lan_ipcrc_l3
0097bb 9151              ld	temp, Z+
0097bc 0f35      	add	r19, temp
0097bd 1d25      	adc	r18, zero
0097be 1d15      	adc	r17, zero		; sum + b<<8
                 
                 _lan_ipcrc_l3:
0097bf 2ff1      	mov	ZH, r17
0097c0 2fe2      	mov	ZL, r18
0097c1 2711      	clr	r17
0097c2 2722      	clr	r18			; sum &= 0x0ffff
0097c3 0f4e      	add	r20, ZL
0097c4 1f3f      	adc	r19, ZH			; sum += hiword(sum)
0097c5 1d25      	adc	r18, zero
                 ;	adc	r17, zero
                 ;	cpi	r17, 0
                 ;	brne	_lan_ipcrc_l3
0097c6 3020      	cpi	r18, 0
0097c7 f7b9      	brne	_lan_ipcrc_l3
                 
0097c8 2ff3      	mov	ZH, r19
0097c9 2fe4      	mov	ZL, r20
0097ca 95f0      	com	ZH
0097cb 95e0      	com	ZL			; complement
                 
0097cc 914f      	pop	r20
0097cd 913f      	pop	r19
0097ce 912f      	pop	r18
0097cf 911f      	pop	r17
0097d0 9508      	ret
                 
                 
                 
                 ; ADD address fields, data is preloaded
                 LAN_BUILD_ETH_FRAME:
0097d1 91a0 3658
0097d3 91b0 3659
0097d5 9610      	setlop	X, LAN_ETH_FRAME
0097d6 e4ec
0097d7 e3f6      	ldiw	Z, LAN_OP_DST_MAC
0097d8 d581      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
                 ;	setlop	X, LAN_ETH_SRCMAC
0097d9 e5ea
0097da e0f9      	ldiw	Z, LAN_MAC_MY
0097db d57e      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
                 ;	setlop	X, LAN_ETH_SRCMAC
                 ;	ldiw	Z, LAN_MAC_MY
                 ;	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
                 ;	setlop	X, LAN_ETH_TYPE
0097dc e058      	ldi	temp, 0x08		; 
0097dd 935d      	st	X+, temp
0097de 9150 3658 	lds	temp, LAN_OP_ETHTYPE
0097e0 935d      	st	X+, temp
                 ;	sts	LAN_ETH_TYPE+1, zero
                 ;	stst	LAN_ETH_TYPE, 0x08
                 
0097e1 91c0 365a
0097e3 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
0097e5 962e      	adiw	Y, (LAN_ETH_DATA-LAN_ETH_FRAME)
0097e6 93c0 365a
0097e8 93d0 365b 	stw	LAN_OP_BUF_LEN, Y	; for send command
0097ea 9508      	ret
                 
                 
                 
                 LAN_BUILD_IP_FRAME:
0097eb 91a0 3658
0097ed 91b0 3659
0097ef 961e      	setlop	X, LAN_IP_VERS
0097f0 e455      	ldi	temp, 0x45		; 
0097f1 935d      	st	X+, temp
                 ;	stst	LAN_IP_VERS, 0x45	;(4<<4) | 5	; IPv4, standard header
                 
                 ;	setlop	X, LAN_IP_TOS
0097f2 925d      	st	X+, zero
                 ;	stsz	LAN_IP_TOS
                 
0097f3 91c0 365a
0097f5 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN	; adjust length
0097f7 9664      	adiw	Y, LAN_IP_DATA-LAN_IP_FRAME
0097f8 93c0 365a
0097fa 93d0 365b 	stw	LAN_OP_BUF_LEN, Y	; for ethernet frame
                 
0097fc 93dd      	st	X+, YH
0097fd 93cd      	st	X+, YL
                 ;	stswbe	LAN_IP_LEN, Y
0097fe 91e0 0973
009800 91f0 0974 	ldw	Z, LAN_IP_ID
009802 0de9      	add	ZL, one
009803 1df5      	adc	ZH, zero		; increment ID
009804 93e0 0973
009806 93f0 0974 	stw	LAN_IP_ID, Z		
009808 93fd      	st	X+, ZH
009809 93ed      	st	X+, ZL			; Frame ID
                 ;	st	X+, zero
                 ;	stsz	LAN_IP_FRAG
                 ;	st	X+, zero
                 ;	stsz	LAN_IP_FRAG+1
00980a 925d      	st	X+, zero
                 ;	stsz	LAN_IP_FLAGS
00980b 925d      	st	X+, zero
                 ;	stsz	LAN_IP_FLAGS+1
00980c e850      	ldi	temp, 0x80		; 
00980d 935d      	st	X+, temp
                 ;	stst	LAN_IP_LIFE, 64
00980e 9150 365e 	lds	temp, LAN_OP_PROTOCOL
009810 935d      	st	X+, temp
                 ;	ldstt	LAN_IP_PROTOCOL, LAN_OP_PROTOCOL
009811 925d      	st	X+, zero
                 ;	stsz	LAN_IP_CS
009812 925d      	st	X+, zero
                 ;	stsz	LAN_IP_CS+1
                 
009813 e5e2
009814 e0f9      	ldiw	Z, LAN_IP_MY
009815 d53b      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 ;	COPY_IP LAN_IP_SRCIP, LAN_IP_MY
009816 e5e2
009817 e3f6      	ldiw	Z, LAN_OP_DST_IP
009818 d538      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 ;	COPY_IP LAN_IP_REMOTE, LAN_OP_DST_IP
                 
009819 91e0 3658
00981b 91f0 3659
00981d 963e      	setlop	Z, LAN_IP_FRAME
                 ;	ldiw	Z, LAN_IP_FRAME
00981e e1c4
00981f e0d0      	ldiw	Y, LAN_IP_DATA-LAN_IP_FRAME	; length
009820 df81      	rcall	_LAN_IPCRC
009821 91a0 3658
009823 91b0 3659
009825 9658      	setlop	X, LAN_IP_CS
009826 93fd      	st	X+, ZH
009827 93ed      	st	X+, ZL
                 ;	stswbe	LAN_IP_CS, Z
009828 9508      	ret
                 
                 
                 
                 LAN_BUILD_UDP_FRAME:		; for the case when data is loaded to LAN_UDP_DATA
009829 91a0 3658
00982b 91b0 3659
00982d 9692              setlop	X, LAN_UDP_SRCPORT
00982e e4ea
00982f e3f6              ldiw	Z, LAN_OP_SRC_PORT
009830 d51b              rcall	_LAN_COPY_PORT			; copy 2 bytes (X)<-(Z)
                 ;	COPY_PORT LAN_UDP_SRCPORT, LAN_OP_SRC_PORT
                 ;        setlop	X, LAN_UDP_DSTPORT
009831 e5e6
009832 e3f6              ldiw	Z, LAN_OP_DST_PORT
009833 d518              rcall	_LAN_COPY_PORT			; copy 2 bytes (X)<-(Z)
                 ;	COPY_PORT LAN_UDP_DSTPORT, LAN_OP_DST_PORT
                 
009834 91c0 365a
009836 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
009838 9628      	adiw	Y, LAN_UDP_DATA-LAN_UDP_FRAME
009839 93c0 365a
00983b 93d0 365b 	stw	LAN_OP_BUF_LEN, Y	; new length with header
                 
00983d 93dd      	st	X+, YH
00983e 93cd      	st	X+, YL
                 ;	stswbe	LAN_UDP_LEN, Y
00983f 925d      	st	X+, zero
                 ;	stsz	LAN_UDP_CS
009840 925d      	st	X+, zero
                 ;	stsz	LAN_UDP_CS+1
                 
009841 9508      	ret ;!!!!!!!! DEBUG!!!!! check CRC calculation!!!!!
                         
                 					; fill pseudo-header for crc
009842 91a0 3658
009844 91b0 3659
009846 9656              setlop	X, LAN_UDP_PH_START
009847 e4e6
009848 e3f6              ldiw	Z, LAN_OP_SRC_IP
009849 d507      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
00984a e5e2
00984b e3f6              ldiw	Z, LAN_OP_DST_IP
00984c d504      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
00984d 925d      	st	X+, zero
                 ;	stsz	LAN_UDP_PH_Z
                 ;	lds	temp, LAN_OP_PROTOCOL	;???? preset to UDP?????
00984e e151      	ldi	temp, LAN_PROTOCOL_UDP	; preset to UDP
00984f 935d      	st	X+, temp
009850 93dd      	st	X+, YH
009851 93cd      	st	X+, YL
                 
                 ;					; fill pseudo-header for crc
                 ;	stswbe	LAN_UDP_PH_LEN, Y
                 ;	ldi	temp, LAN_PROTOCOL_UDP	; 17 = UDP protocol ID for IP build
                 ;	sts	LAN_OP_PROTOCOL, temp	; store
                 ;	sts	LAN_UDP_PH_PROTOCOL, temp
                 ;	stsz	LAN_UDP_PH_Z
                 ;	COPY_IP LAN_UDP_PH_DSTIP, LAN_OP_DST_IP
                 ;	COPY_IP LAN_UDP_PH_SRCIP, LAN_IP_MY
                 
009852 91e0 3658
009854 91f0 3659
009856 9676              setlop	Z, LAN_UDP_PH_START
                 ;	ldiw	Z, LAN_UDP_PH_START
009857 91c0 365a
009859 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
00985b 962c      	adiw	Y, LAN_UDP_FRAME-LAN_UDP_PH_START	; add pseudo header
00985c df45      	rcall	_LAN_IPCRC
00985d 91a0 3658
00985f 91b0 3659
009861 9698      	setlop	X, LAN_UDP_CS
009862 93fd      	st	X+, ZH
009863 93ed      	st	X+, ZL
                 ;	stswbe	LAN_UDP_CS, Z		; set checksum
009864 9508      	ret
                 
                 
                 
                 ; Build TCP Frame
                 LAN_BUILD_TCP_FRAME:		; for the case when data is loaded to LAN_UDP_DATA
009865 91a0 3658
009867 91b0 3659
009869 9692              setlop	X, LAN_TCP_SRCPORT
00986a e4ea
00986b e3f6              ldiw	Z, LAN_OP_SRC_PORT
00986c d4df              rcall	_LAN_COPY_PORT		; copy 2 bytes (X)<-(Z)
                 ;	COPY_PORT LAN_UDP_SRCPORT, LAN_OP_SRC_PORT
                 ;        setlop	X, LAN_UDP_DSTPORT
00986d e5e6
00986e e3f6              ldiw	Z, LAN_OP_DST_PORT
00986f d4dc              rcall	_LAN_COPY_PORT		; copy 2 bytes (X)<-(Z)
                 ;	COPY_PORT LAN_UDP_DSTPORT, LAN_OP_DST_PORT
009870 e7e8
009871 e0f9              ldiw	Z, LAN_USR_TCP_SN	;!!!!! May be from OP_????
009872 d4de              rcall	_LAN_COPY_DWORD		; copy 4 bytes (X)<-(Z)
009873 e7ec
009874 e0f9              ldiw	Z, LAN_USR_TCP_ACK	;!!!!! May be from OP_????
009875 d4db              rcall	_LAN_COPY_DWORD		; copy 4 bytes (X)<-(Z)
                 
009876 e055      	ldi	temp, 5			; Header Length
009877 935d      	st	X+, temp
009878 9150 0948 	lds	temp, LAN_USR_TCP_FLAGS	;!!!!! May be from OP_????
00987a 935d      	st	X+, temp
00987b e7e6
00987c e0f9              ldiw	Z, LAN_USR_TCP_WINDOW	;!!!!! May be from OP_????
00987d d4c9              rcall	_LAN_COPY_WORD			; copy 2 bytes (X)<-(Z)
                 
00987e 91c0 365a
009880 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
009882 9664      	adiw	Y, LAN_TCP_DATA-LAN_TCP_FRAME
009883 93c0 365a
009885 93d0 365b 	stw	LAN_OP_BUF_LEN, Y	; new length with header
                 
009887 93dd      	st	X+, YH
009888 93cd      	st	X+, YL			; LAN_UDP_LEN, Y
009889 925d      	st	X+, zero		; LAN_UDP_CS
00988a 925d      	st	X+, zero		; LAN_UDP_CS+1
                 
                 					; fill pseudo-header for crc
00988b 91a0 3658
00988d 91b0 3659
00988f 9656              setlop	X, LAN_TCP_PH_START
009890 e4e6
009891 e3f6              ldiw	Z, LAN_OP_SRC_IP
009892 d4be      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
009893 e5e2
009894 e3f6              ldiw	Z, LAN_OP_DST_IP
009895 d4bb      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
009896 925d      	st	X+, zero
009897 e056      	ldi	temp, LAN_PROTOCOL_TCP	; preset to UDP
009898 935d      	st	X+, temp
009899 93dd      	st	X+, YH
00989a 93cd      	st	X+, YL
                 
00989b 91e0 3658
00989d 91f0 3659
00989f 9676              setlop	Z, LAN_TCP_PH_START
0098a0 91c0 365a
0098a2 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
0098a4 962c      	adiw	Y, LAN_TCP_FRAME-LAN_TCP_PH_START	; add pseudo header length
0098a5 defc      	rcall	_LAN_IPCRC
0098a6 91a0 3658
0098a8 91b0 3659
0098aa 96d2      	setlop	X, LAN_TCP_CS
0098ab 93fd      	st	X+, ZH
0098ac 93ed      	st	X+, ZL
0098ad 9508      	ret
                 
                 
                 
                 LAN_BUILD_ICMP_FRAME:		; 
0098ae 91a0 3658
0098b0 91b0 3659
0098b2 9692              setlop	X, LAN_ICMP_FRAME
0098b3 9150 3657         lds	temp, LAN_OP_TYPE
0098b5 935d              st	X+, temp
0098b6 925d              st	X+, zero		; CODE
0098b7 925d              st	X+, zero		; CS
0098b8 925d              st	X+, zero		; CS
0098b9 925d              st	X+, zero		; ROH
0098ba 925d              st	X+, zero		; ROH
0098bb 925d              st	X+, zero		; ROH
0098bc 925d              st	X+, zero		; ROH
                 
0098bd 91c0 365a
0098bf 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
0098c1 9628      	adiw	Y, LAN_ICMP_DATA-LAN_ICMP_FRAME	; Payload is not accepted!
0098c2 93c0 365a
0098c4 93d0 365b 	stw	LAN_OP_BUF_LEN, Y	; new length with header
                 
0098c6 91e0 3658
0098c8 91f0 3659
0098ca 96b2              setlop	Z, LAN_ICMP_FRAME
0098cb 91c0 365a
0098cd 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
0098cf ded2      	rcall	_LAN_IPCRC
0098d0 91a0 3658
0098d2 91b0 3659
0098d4 9694      	setlop	X, LAN_ICMP_CS
0098d5 93fd      	st	X+, ZH
0098d6 93ed      	st	X+, ZL
0098d7 9508      	ret
                 
                 
                 ; build ack response for arp-request
                 LAN_BUILD_ARP_RESPONSE:
0098d8 91a0 3658
0098da 91b0 3659
0098dc 9690      	setlop	X, LAN_ARP_DSTMAC
0098dd 91e0 3658
0098df 91f0 3659
0098e1 9676      	setlop	Z, LAN_ARP_SRCMAC
0098e2 d477      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
0098e3 91a0 3658
0098e5 91b0 3659
0098e7 9656      	setlop	X, LAN_ARP_SRCMAC
0098e8 e5ea
0098e9 e0f9      	ldiw	Z, LAN_MAC_MY
0098ea d46f      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
0098eb 91a0 3658
0098ed 91b0 3659
0098ef 9696      	setlop	X, LAN_ARP_DSTIP
0098f0 91e0 3658
0098f2 91f0 3659
0098f4 967c      	setlop	Z, LAN_ARP_SRCIP
0098f5 d45b      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 
0098f6 91a0 3658
0098f8 91b0 3659
0098fa 965c      	setlop	X, LAN_ARP_SRCIP
0098fb e5e2
0098fc e0f9      	ldiw	Z, LAN_IP_MY
0098fd d453      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 
0098fe 91a0 3658
009900 91b0 3659
009902 9654      	setlop	X, LAN_ARP_MSGTYPE
009903 925d      	st	X+, zero
009904 e052      	ldi	temp, 2			; ARP_TYPE_RESPONSE
009905 935c      	st	X, temp
                 ;	stsz	LAN_ARP_MSGTYPE 
                 ;	stst	LAN_ARP_MSGTYPE+1, 2	; ARP_TYPE_RESPONSE 
                 
009906 91a0 3658
009908 91b0 3659
00990a 9610      	setlop	X, LAN_ETH_DSTMAC
00990b 91e0 3658
00990d 91f0 3659
00990f 9636      	setlop	Z, LAN_ETH_SRCMAC
009910 d449      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
009911 91a0 3658
009913 91b0 3659
009915 9616      	setlop	X, LAN_ETH_SRCMAC
009916 e5ea
009917 e0f9      	ldiw	Z, LAN_MAC_MY
009918 d441      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
009919 e2ca
00991a e0d0      	ldiw	Y, 28+14		; ARP+ETH blocks, ready to send
00991b 93c0 365a 	sts	LAN_OP_BUF_LEN, YL	; set buffer length
00991d 93d0 365b 	sts	LAN_OP_BUF_LEN+1, YH	; set buffer length
00991f 9508      	ret
                 
                 
                 
                 ; build USER !!!! ARP request 
                 LAN_BUILD_ARP_REQUEST:
009920 91a0 3658
009922 91b0 3659
009924 9610      	setlop	X, LAN_ETH_DSTMAC
                 ;	ldiw	X, LAN_OP_DST_MAC
009925 922d      	st	X+, FF
009926 922d      	st	X+, FF
009927 922d      	st	X+, FF
009928 922d      	st	X+, FF
009929 922d      	st	X+, FF
00992a 922d      	st	X+, FF			; brodcast
                 	
00992b e5ea
00992c e0f9      	ldiw	Z, LAN_MAC_MY
00992d d42c      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
00992e e058      	ldi	temp, 0x08		; 
00992f 935d      	st	X+, temp
009930 e056      	ldi	temp, 0x06		; ARP
009931 935d      	st	X+, temp
                 
009932 91a0 3658
009934 91b0 3659
009936 961e      	setlop	X, LAN_ARP_HWTYPE
009937 925d      	st	X+, zero
009938 929d      	st	X+, one			; HWTYPE
009939 e058      	ldi	temp, LAN_PROTOCOL_IPH	; 8
00993a 935d      	st	X+, temp
00993b 925d      	st	X+, zero 		; 0
00993c e056      	ldi	temp, 6			; 6 MAC_LEN
00993d 935d      	st	X+, temp
00993e e054      	ldi	temp, 4			; 4 IP_LEN
00993f 935d      	st	X+, temp
                 
009940 925d      	st	X+, zero
009941 929d      	st	X+, one			; REEQUEST
                 
009942 e5ea
009943 e0f9      	ldiw	Z, LAN_MAC_MY
009944 d415      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
009945 e5e2
009946 e0f9      	ldiw	Z, LAN_IP_MY
009947 d409      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 
009948 925d      	st	X+, zero
009949 925d      	st	X+, zero
00994a 925d      	st	X+, zero
00994b 925d      	st	X+, zero
00994c 925d      	st	X+, zero
00994d 925d      	st	X+, zero		; DST_MAC
                 
00994e e5e2
00994f e3f6      	ldiw	Z, LAN_OP_DST_IP
009950 d400      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 
009951 e2ca
009952 e0d0      	ldiw	Y, 28+14 ;+14		; ARP+ETH block
009953 93c0 365a 	sts	LAN_OP_BUF_LEN, YL	; set buffer length
009955 93d0 365b 	sts	LAN_OP_BUF_LEN+1, YH	; set buffer length
009957 9508      	ret
                 
                 
                 
                 ;check arp request is ok
                 LAN_CHECK_ARP_REQUEST:
009958 e034      	ldi	r19, 4
009959 91a0 3658
00995b 91b0 3659
00995d 9696      	setlop	X, LAN_ARP_DSTIP
00995e e5e2
00995f e0f9      	ldiw	Z, LAN_IP_MY
009960 d3d5      	rcall	LAN_MEM_COMPARE
009961 f489      	brne	_lan_ch_arp_no
                 
009962 e03a      	ldi	r19, 10
009963 91a0 3658
009965 91b0 3659
009967 9654      	setlop	X, LAN_ARP_MSGTYPE
009968 915d      	ld	temp, X+
009969 3050      	cpi	temp, 0x00
00996a f441      	brne	_lan_ch_arp_no
                 
00996b 915c      	ld	temp, X
00996c 3051      	cpi	temp, 0x01			; request?
00996d f019      	breq	_lan_ch_arp_request
00996e 3052      	cpi	temp, 0x02			; response?
00996f f029      	breq	_lan_ch_arp_response
009970 c002      	rjmp	_lan_ch_arp_no			; not response - unknown - decline
                 _lan_ch_arp_request:
009971 e851      	ldi	temp, 0x81			; request matched!
009972 c001      	rjmp	_lan_ch_arp_ret
                 _lan_ch_arp_no:
009973 2f53      	mov	temp, r19			; error point
                 _lan_ch_arp_ret:
009974 9508      	ret
                 
                 _lan_ch_arp_response:
009975 e034      	ldi	r19, 4
009976 91a0 3658
009978 91b0 3659
00997a 965c      	setlop	X, LAN_ARP_SRCIP		; compare dest IP with lan_block
00997b e5e6
00997c e0f9      	ldiw	Z, LAN_IP_REMOTE
00997d d3b8      	rcall	LAN_MEM_COMPARE
00997e f7a1      	brne	_lan_ch_arp_no 			; not from user server
                 	
00997f e6a0
009980 e0b9      	ldiw	X, LAN_MAC_REMOTE
009981 91e0 3658
009983 91f0 3659
009985 9676      	setlop	Z, LAN_ARP_SRCMAC
009986 d3d3      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 ;	ZXYb	LAN_ARP_SRCMAC, LAN_MAC_REMOTE, 6	; store MAC 
                 
009987 e852      	ldi	temp, 0x82			; response received, REMOTE MAC set
009988 cfeb      	rjmp	_lan_ch_arp_ret
                 		
                 
                 
                 LAN_CHECK_ICMP_REQUEST:
009989 e034      	ldi	r19, 4
00998a 91a0 3658
00998c 91b0 3659
00998e 965e      	setlop	X, LAN_IP_DSTIP			; compare dest IP with lan_block
00998f e5e2
009990 e0f9      	ldiw	Z, LAN_IP_MY
009991 d3a4      	rcall	LAN_MEM_COMPARE
009992 f4d9      	brne	_ch_icmp_no			; not for USER settings
                 
009993 91a0 3658
009995 91b0 3659
009997 9692      	setlop	X, LAN_ICMP_TYPE		; compare dest IP with lan_block
009998 915d      	ld	temp, X+
                 
009999 3058      	cpi	temp, LAN_PROT_ICMP_PING
00999a f0a9      	breq	_ch_icmp_resp			; send reply
                 	
00999b 3050      	cpi	temp, LAN_PROT_ICMP_ECHO
00999c f491      	brne	_ch_icmp_ret			; unsupported command
                 
00999d e034      	ldi	r19, 4
00999e 91a0 3658
0099a0 91b0 3659
0099a2 965a      	setlop	X, LAN_IP_SRCIP			; compare dest IP with lan_block
0099a3 e5e6
0099a4 e0f9      	ldiw	Z, LAN_IP_REMOTE
0099a5 d390      	rcall	LAN_MEM_COMPARE
0099a6 f439      	brne	_ch_icmp_no			; not from user server
                 
0099a7 9150 0975 	lds	temp, LAN_ECHO_CNTR
0099a9 9553      	inc	temp
0099aa 9350 0975 	sts	LAN_ECHO_CNTR, temp		; increment counter indicating echo response
                 
0099ac e85b      	ldi	temp, 0x8b			; Ping echo received
0099ad c001      	rjmp	_ch_icmp_ret
                 
                 _ch_icmp_no:
0099ae e050      	ldi	temp, 0				; no match
                 _ch_icmp_ret:
0099af 9508      	ret
                 _ch_icmp_resp:
0099b0 e85a      	ldi	temp, 0x8a			; Ping request received
0099b1 cffd      	rjmp	_ch_icmp_ret
                 	
                 
                 
                 
                 LAN_BUILD_PING_RESPONSE:   				; build ICMP response from request
0099b2 91a0 3658
0099b4 91b0 3659
0099b6 9610      	setlop	X, LAN_ETH_DSTMAC
0099b7 91e0 3658
0099b9 91f0 3659
0099bb 9636      	setlop	Z, LAN_ETH_SRCMAC
0099bc d39d      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
0099bd 91a0 3658
0099bf 91b0 3659
0099c1 9616      	setlop	X, LAN_ETH_SRCMAC
0099c2 e5ea
0099c3 e0f9      	ldiw	Z, LAN_MAC_MY
0099c4 d395      	rcall	_LAN_COPY_MAC		; 6 bytes (x)<-(Z)
                 
0099c5 91a0 3658
0099c7 91b0 3659
0099c9 965e      	setlop	X, LAN_IP_DSTIP
0099ca 91e0 3658
0099cc 91f0 3659
0099ce 967a      	setlop	Z, LAN_IP_SRCIP
0099cf d381      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 
0099d0 91a0 3658
0099d2 91b0 3659
0099d4 965a      	setlop	X, LAN_IP_SRCIP
0099d5 e5e2
0099d6 e0f9      	ldiw	Z, LAN_IP_MY
0099d7 d379      	rcall	_LAN_COPY_IP		; 4 bytes (x)<-(Z)
                 
0099d8 91a0 3658
0099da 91b0 3659
0099dc 9692      	setlop	X, LAN_ICMP_TYPE
0099dd 925d      	st	X+, zero			; LAN_PROT_ICMP_ECHO
0099de 925d      	st	X+, zero			; type + code
                 
0099df 91a0 3658
0099e1 91b0 3659
0099e3 9694              setlop	X, LAN_ICMP_CS
0099e4 925d      	st	X+, zero			; Clear CS for computattion
0099e5 925d      	st	X+, zero			; 
                 
0099e6 91e0 3658
0099e8 91f0 3659
0099ea 96b2              setlop	Z, LAN_ICMP_FRAME
0099eb 91c0 365a
0099ed 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN
0099ef 97a2      	sbiw	Y, (LAN_IP_DATA-LAN_ETH_FRAME)	; correcting length
0099f0 ddb1      	rcall	_LAN_IPCRC
0099f1 91a0 3658
0099f3 91b0 3659
0099f5 9694      	setlop	X, LAN_ICMP_CS
0099f6 93fd      	st	X+, ZH
0099f7 93ed      	st	X+, ZL
                 
                 ;	rcall	LAN_SEND_PACKET			; send response
                 
0099f8 e85a      	ldi	temp, 0x8a			; Ping request - echoed
0099f9 cfb5      	rjmp	_ch_icmp_ret			; return
                 
                 
                 
                 
                 
                 LAN_ARP_MSK: 
0099fa 0608
0099fb 0100
0099fc 0008
0099fd 0406      	.DB	0x08, 0x06, 0x00, 0x01, 0x08, 0x00, 0x06, 0x04
                 LAN_CHECK_FRAME_TYPE:
0099fe 91a0 3658
009a00 91b0 3659
009a02 961c      	setlop	X, LAN_ETH_TYPE			; set offset to LAN*_ETH_TYPE data
009a03 efe4
009a04 e3f3      	ldiw	Z, LAN_ARP_MSK*2		; mask
009a05 e038      	ldi	r19, 8
                 _lan_ch_fr_l5:               			; check ARP mask
009a06 915d      	ld	temp, X+
009a07 9177      	celpm	FROMRAM0, Z+
009a08 1757      	cp	temp, FROMRAM0
009a09 f421      	brne	_lan_ch_fr_l1
009a0a 953a      	dec	r19
009a0b f7d1      	brne	_lan_ch_fr_l5
                 
                 ;	ldi	r19, 0x80+1;			; ARP index
009a0c df4b      	rcall	LAN_CHECK_ARP_REQUEST
009a0d 9508      	ret
                 ;	rjmp	_lan_ch_fr_ret			; return response
                 
                 _lan_ch_fr_l1:
009a0e 91a0 3658
009a10 91b0 3659
009a12 961c      	setlop	X, LAN_ETH_TYPE
                 ;	ldiw	X, LAN_ETH_TYPE
009a13 915d      	ld	temp, X+
009a14 3058      	cpi	temp, 0x08			; is IP protocol?
009a15 f5a9      	brne	_lan_ch_fr_ret_0
009a16 915d      	ld	temp, X+
009a17 3050      	cpi	temp, 0x00			; IP frame
009a18 f591      	brne	_lan_ch_fr_ret_0
                 
009a19 91a0 3658
009a1b 91b0 3659
009a1d 9657      	setlop	X, LAN_IP_PROTOCOL
009a1e 915d      	ld	temp, X+
                 _lan_ch_fr_udp:					; UDP packet received
009a1f 3151      	cpi	temp, LAN_PROTOCOL_UDP		; 17 = udp?	
009a20 f499      	brne	_lan_ch_fr_icmp			; goto next check
                 
009a21 e020      	ldi	FROMRAM2, 0x00                  ; Erroro point
                 
009a22 e034      	ldi	r19, 4
009a23 91a0 3658
009a25 91b0 3659
009a27 965e      	setlop	X, LAN_IP_DSTIP			; compare dest IP with lan_block
009a28 e5e2
009a29 e0f9      	ldiw	Z, LAN_IP_MY
009a2a d30b      	rcall	LAN_MEM_COMPARE
009a2b f431      	brne	_lan_ch_fr_udp_ret		; not for us, ignore broadcasts
009a2c 6021      	sbr	FROMRAM2, 1<<0
                 	; checking packet, on success procedure performs double ret
009a2d d036      	rcall	_lan_ch_fr_udp_pr		; check PR
009a2e d04c      	rcall	_lan_ch_fr_udp_srv		; check SRV
009a2f e853      	ldi	temp, 0x83			; UDP return code
009a30 2e15      	mov	FROMRAM1, temp			; return code
009a31 d01b      	rcall	_lan_ch_user_srv		; check USER server
                 _lan_ch_fr_udp_ret:
009a32 2f52      	mov	temp, FROMRAM2			; set error point to return
009a33 9508              ret
                 
                 _lan_ch_fr_icmp:
009a34 3051      	cpi	temp, LAN_PROTOCOL_ICMP		; 1 = icmp?
009a35 f411      	brne	_lan_ch_fr_tcp			; check TCP
                 
009a36 df52      	rcall	LAN_CHECK_ICMP_REQUEST		; process ICMP
009a37 9508      	ret
                 
                 _lan_ch_fr_tcp:					; UDP packet received
009a38 3056      	cpi	temp, LAN_PROTOCOL_TCP		; 6 = tcp?
009a39 f489      	brne	_lan_ch_fr_ret_0		; not supported
                 
009a3a e020      	ldi	FROMRAM2, 0x00                  ; Erroro point
                 
009a3b e034      	ldi	r19, 4
009a3c 91a0 3658
009a3e 91b0 3659
009a40 965e      	setlop	X, LAN_IP_DSTIP			; compare dest IP with lan_block
009a41 e5e2
009a42 e0f9      	ldiw	Z, LAN_IP_MY
009a43 d2f2      	rcall	LAN_MEM_COMPARE
009a44 f421      	brne	_lan_ch_fr_tcp_ret		; not for us, ignore broadcasts
009a45 6021      	sbr	FROMRAM2, 1<<0
                 	; checking packet, on success procedure performs double ret
009a46 e856      	ldi	temp, 0x86
009a47 2e15      	mov	FROMRAM1, temp			; return code
009a48 d004      	rcall	_lan_ch_user_srv		; check USER server
                 _lan_ch_fr_tcp_ret:
009a49 2f52      	mov	temp, FROMRAM2			; set error point to return
009a4a 9508              ret
                 
                 	; placed here to allow relative jump!
                 _lan_ch_fr_ret_0:				; returns with 0 - not for us or not supported
009a4b e050      	ldi	temp, 0
009a4c 9508      	ret
                 
                 _lan_ch_user_srv:
009a4d e034      	ldi	r19, 4
009a4e 91a0 3658
009a50 91b0 3659
009a52 965a      	setlop	X, LAN_IP_SRCIP			; compare dest IP with lan_block
009a53 e5e6
009a54 e0f9      	ldiw	Z, LAN_IP_REMOTE
009a55 d2e0      	rcall	LAN_MEM_COMPARE
009a56 f7a1      	brne	_lan_ch_fr_ret_0		; not for me
009a57 6022      	sbr	FROMRAM2, 1<<1
                 
009a58 91a0 3658
009a5a 91b0 3659
009a5c 9694      	setlop	X, LAN_UDP_DSTPORT		; compare dest Iport with lan_block
009a5d e6ed
009a5e e0f9      	ldiw	Z, LAN_PORT_MY
009a5f d2df      	rcall	LAN_MEM_COMPARE_BEW
009a60 f751      	brne	_lan_ch_fr_ret_0
009a61 6024      	sbr	FROMRAM2, 1<<2
                 
                 ;	ldi	temp, 0x83			; 
009a62 2d51      	mov	temp, FROMRAM1			; set return code
009a63 c02f      	rjmp	_lan_ch_fr_ret_to_main		; return to main
                 
                 _lan_ch_fr_udp_pr:	
009a64 e034      	ldi	r19, 4
009a65 91a0 3658
009a67 91b0 3659
009a69 965a      	setlop	X, LAN_IP_SRCIP
009a6a e5e0
009a6b e3ff      	ldiw	Z, PR_SRV_IP
009a6c d2c9      	rcall	LAN_MEM_COMPARE
009a6d f6e9      	brne	_lan_ch_fr_ret_0
009a6e 6028      	sbr	FROMRAM2, 1<<3
                 
009a6f 91a0 3658
009a71 91b0 3659
009a73 9694      	setlop	X, LAN_UDP_DSTPORT
009a74 e5e4
009a75 e3ff      	ldiw	Z, PR_SRV_PORT
009a76 d2c8      	rcall	LAN_MEM_COMPARE_BEW
009a77 f699      	brne	_lan_ch_fr_ret_0
009a78 6120      	sbr	FROMRAM2, 1<<4
                 
009a79 e854      	ldi	temp, 0x84			; UDP message from PR-SRV
009a7a c018      	rjmp	_lan_ch_fr_ret_to_main		; return to main
                 		
                 _lan_ch_fr_udp_srv:
009a7b e034      	ldi	r19, 4
009a7c 91a0 3658
009a7e 91b0 3659
009a80 965a      	setlop	X, LAN_IP_SRCIP
009a81 eaec
009a82 e3f6      	ldiw	Z, RTC_SRV_IP
009a83 d2b2      	rcall	LAN_MEM_COMPARE
009a84 f469      	brne	_lan_ch_fr_ret_0_l
009a85 6220      	sbr	FROMRAM2, 1<<5
                 
009a86 91a0 3658
009a88 91b0 3659
009a8a 9694      	setlop	X, LAN_UDP_DSTPORT
009a8b ebe0
009a8c e3f6      	ldiw	Z, RTC_SRV_PORT
009a8d d2b1      	rcall	LAN_MEM_COMPARE_BEW
009a8e f419      	brne	_lan_ch_fr_ret_0_l
009a8f 6420      	sbr	FROMRAM2, 1<<6
                 
009a90 e855      	ldi	temp, 0x85			; UDP message from SERVER 
009a91 c001      	rjmp	_lan_ch_fr_ret_to_main		; return to main
                 
                 ; Placed here to allow local jump!
                 _lan_ch_fr_ret_0_l:
009a92 cfb8      	rjmp	_lan_ch_fr_ret_0		; returns with 0 - not for us or not supported
                 
                 _lan_ch_fr_ret_to_main:				; return to main procedure
009a93 912f      	pop	FROMRAM2
009a94 912f      	pop	FROMRAM2			; clear first level call return
009a95 9508      	ret
                 	
                 
                 
                 
                 	; set buffer to USER 
                 _LAN_SET_USER:
009a96 9150 0950
009a98 9350 365a
009a9a 9150 0951
009a9c 9350 365b 	ldstt2	LAN_OP_BUF_LEN, LAN_MBUF_OUT_L
009a9e 935f
009a9f e050
009aa0 9350 3658
009aa2 e352
009aa3 9350 3659
009aa5 915f      	stiw	LAN_OP_BUF, LAN_BUF
009aa6 935f
009aa7 e050
009aa8 9350 365c
009aaa e053
009aab 9350 365d
009aad 915f      	stiw	LAN_OP_BUF_SIZE, LAN_BUF_SIZE
009aae e6e0
009aaf e0f9
009ab0 e4ac
009ab1 e3b6
009ab2 d2a7      	COPY_MAC LAN_OP_DST_MAC, LAN_MAC_REMOTE
009ab3 e5e6
009ab4 e0f9
009ab5 e5a2
009ab6 e3b6
009ab7 d299      	COPY_IP  LAN_OP_DST_IP, LAN_IP_REMOTE
009ab8 9150 096f
009aba 9350 3656
009abc 9150 0970
009abe 9350 3657 	COPY_PORT LAN_OP_DST_PORT, LAN_PORT_REMOTE
009ac0 9150 096d
009ac2 9350 364a
009ac4 9150 096e
009ac6 9350 364b 	COPY_PORT LAN_OP_SRC_PORT, LAN_PORT_MY
009ac8 9150 0971
009aca 9350 365e 	ldstt	LAN_OP_PROTOCOL, LAN_PROTOCOL
009acc 9508      	ret
                 
                 
                 	; set buffer to HEADER 
                 _LAN_SET_HDR:
009acd 935f
009ace e050
009acf 9350 3658
009ad1 e356
009ad2 9350 3659
009ad4 915f      	stiw	LAN_OP_BUF, LAN3_BUF
009ad5 935f
009ad6 e450
009ad7 9350 365c
009ad9 e050
009ada 9350 365d
009adc 915f      	stiw	LAN_OP_BUF_SIZE, LAN3_BUF_SIZE
009add 9508      	ret
                 
                 
                 _LAN_SET_BUF2:
009ade 935f
009adf e050
009ae0 9350 3658
009ae2 e355
009ae3 9350 3659
009ae5 915f      	stiw	LAN_OP_BUF, LAN2_BUF
009ae6 935f
009ae7 e050
009ae8 9350 365c
009aea e051
009aeb 9350 365d
009aed 915f      	stiw	LAN_OP_BUF_SIZE, LAN2_BUF_SIZE
009aee 9508      	ret
                 
                 	; system server
                 _LAN_SET_SRV:
                 ;	stiw	LAN_OP_BUF_LEN, 1
009aef 935f
009af0 e050
009af1 9350 3658
009af3 e355
009af4 9350 3659
009af6 915f      	stiw	LAN_OP_BUF, LAN2_BUF
009af7 935f
009af8 e050
009af9 9350 365c
009afb e051
009afc 9350 365d
009afe 915f      	stiw	LAN_OP_BUF_SIZE, LAN2_BUF_SIZE
009aff eae6
009b00 e3f6
009b01 e4ac
009b02 e3b6
009b03 d256      	COPY_MAC LAN_OP_DST_MAC, RTC_SRV_MAC
009b04 eaec
009b05 e3f6
009b06 e5a2
009b07 e3b6
009b08 d248      	COPY_IP  LAN_OP_DST_IP, RTC_SRV_IP
009b09 9150 36b0
009b0b 9350 3656
009b0d 9150 36b1
009b0f 9350 3657 	COPY_PORT LAN_OP_DST_PORT, RTC_SRV_PORT
009b11 9150 36b0
009b13 9350 364a
009b15 9150 36b1
009b17 9350 364b 	COPY_PORT LAN_OP_SRC_PORT, RTC_SRV_PORT
009b19 935f
009b1a e151
009b1b 9350 365e
009b1d e050
009b1e 9350 365f
009b20 915f      	stiw	LAN_OP_PROTOCOL, LAN_PROTOCOL_UDP		; UDP
009b21 9508      	ret
                 	
                 
                 	; Punch/Reader server
                 _LAN_SET_PR:
009b22 935f
009b23 e051
009b24 9350 365a
009b26 e050
009b27 9350 365b
009b29 915f      	stiw	LAN_OP_BUF_LEN, 1
009b2a 935f
009b2b e050
009b2c 9350 3658
009b2e e355
009b2f 9350 3659
009b31 915f      	stiw	LAN_OP_BUF, LAN2_BUF
009b32 935f
009b33 e050
009b34 9350 365c
009b36 e051
009b37 9350 365d
009b39 915f      	stiw	LAN_OP_BUF_SIZE, LAN2_BUF_SIZE
009b3a e4ea
009b3b e3ff
009b3c e4ac
009b3d e3b6
009b3e d21b      	COPY_MAC LAN_OP_DST_MAC, PR_SRV_MAC
009b3f e5e0
009b40 e3ff
009b41 e5a2
009b42 e3b6
009b43 d20d      	COPY_IP  LAN_OP_DST_IP, PR_SRV_IP
009b44 9150 3f54
009b46 9350 3656
009b48 9150 3f55
009b4a 9350 3657 	COPY_PORT LAN_OP_DST_PORT, PR_SRV_PORT
009b4c 9150 3f54
009b4e 9350 364a
009b50 9150 3f55
009b52 9350 364b 	COPY_PORT LAN_OP_SRC_PORT, PR_SRV_PORT
009b54 935f
009b55 e151
009b56 9350 365e
009b58 e050
009b59 9350 365f
009b5b 915f      	stiw	LAN_OP_PROTOCOL, LAN_PROTOCOL_UDP		; UDP
009b5c 9508      	ret
                 
                 	; System SRV CON port
                 _LAN_SET_CON:
009b5d df91      	rcall	_LAN_SET_SRV
009b5e 935f
009b5f e051
009b60 9350 365a
009b62 e050
009b63 9350 365b
009b65 915f      	stiw	LAN_OP_BUF_LEN, 1
009b66 9508      	ret
                 
                 	; System Printer port
                 _LAN_SET_PRN:
009b67 df87      	rcall	_LAN_SET_SRV
009b68 9150 36e5
009b6a 9350 3656
009b6c 9150 36e6
009b6e 9350 3657 	COPY_PORT LAN_OP_DST_PORT, RTC_PRN_PORT
009b70 9150 36e5
009b72 9350 364a
009b74 9150 36e6
009b76 9350 364b 	COPY_PORT LAN_OP_SRC_PORT, RTC_PRN_PORT
009b78 935f
009b79 e051
009b7a 9350 365a
009b7c e050
009b7d 9350 365b
009b7f 915f      	stiw	LAN_OP_BUF_LEN, 1
009b80 9508      	ret
                 
                 	; Remote SD port
                 	;?????? how to process responce ????
                 _LAN_SET_RSD:
009b81 df6d      	rcall	_LAN_SET_SRV
009b82 9150 36e7
009b84 9350 3656
009b86 9150 36e8
009b88 9350 3657 	COPY_PORT LAN_OP_DST_PORT, RTC_SDC_PORT
009b8a 9150 36e7
009b8c 9350 364a
009b8e 9150 36e8
009b90 9350 364b 	COPY_PORT LAN_OP_SRC_PORT, RTC_SDC_PORT
009b92 9508      	ret
                 
                 
                 
                 ; process messages
                 LAN_PROCESS_MESSAGES:
009b93 ef5e      	ldi	temp, 254
009b94 9130 0972 	lds	r19, LAN_MAIN_RQST		; check that request is processed
009b96 1135      	cpse	r19, zero
009b97 9508      	ret
                 
                 ;	rcall	_LAN_SET_HDR			; working with header only
                 _LAN_PROCESS_start:
009b98 d954      	rcall	_LAN_GET_EPKTCNT		; check is there messages waiting
009b99 3050      	cpi	temp, 0				; is there packets waiting?
009b9a f0a1      	breq	_LAN_PROCESS_ret
                 
009b9b df31      	rcall	_LAN_SET_HDR			; working with header only
009b9c d0fd      	rcall	LAN_RECEIVE_PACKET		; get packet header
009b9d de60      	rcall	LAN_CHECK_FRAME_TYPE		; understand what is it
                 
009b9e 3851
009b9f f409
009ba0 c00f      	tcbe	0x81, _LAN_PROCESS_ARP          ; ARP
009ba1 3853
009ba2 f409
009ba3 c038      	tcbe	0x83, _LAN_PROCESS_MAIN		; UDP to main
009ba4 3854
009ba5 f409
009ba6 c011      	tcbe	0x84, _LAN_PROCESS_PRSRV	; UDP to PRSRV
009ba7 3855
009ba8 f409
009ba9 c014      	tcbe	0x85, _LAN_PROCESS_SRV		; UDP to SRV
009baa 385a
009bab f409
009bac c006      	tcbe	0x8a, _LAN_PROCESS_PING		; build PING response
                 _LAN_PROCESS_NEXT:
009bad d164      	rcall	LAN_RECEIVE_PACKET_NEXT		; uncknown packet, ignore it
009bae cfe9      	rjmp	_LAN_PROCESS_start		; checking next frame
                 _LAN_PROCESS_RET:
009baf 9508      	ret
                 
                 _LAN_PROCESS_ARP:
009bb0 dd27      	rcall	LAN_BUILD_ARP_RESPONSE		; staying in HDR
009bb1 d049      	rcall	LAN_SEND_PACKET
009bb2 cffa      	rjmp	_LAN_PROCESS_NEXT		; checking next frame
                 
                 _LAN_PROCESS_PING:
                 	;!!! add flag is ping responsed
009bb3 df2a      	rcall	_LAN_SET_BUF2			; ICMP is bigger than 64 byte - using BUF2
009bb4 d0e5      	rcall	LAN_RECEIVE_PACKET		; get packet
009bb5 ddfc      	rcall	LAN_BUILD_PING_RESPONSE
009bb6 d044      	rcall	LAN_SEND_PACKET
009bb7 cff5      	rjmp	_LAN_PROCESS_NEXT		; checking next frame
                 
                 _LAN_PROCESS_PRSRV:
009bb8 9150 3f48 	lds	temp, PR_IOBYTE			; checking do we need it processing
009bba ff56      	sbrs	temp, PRIO_IN_LAN
009bbb cff1      	rjmp	_LAN_PROCESS_NEXT
                 ;	rcall	_LAN_SET_BUF2			; May be bigger than 64 byte - using BUF2 ????
                 ;	rcall	LAN_RECEIVE_PACKET		; get packet
009bbc ef51      	ldi	temp, BIOS_FUNC_PRBUF_APPEND	; 0xf1
009bbd c006      	rjmp	_LAN_PROCESS_BUF
                 
                 _LAN_PROCESS_SRV:
009bbe 9150 3f01 	lds	temp, CON_IOBYTE		; checking do we need it processing
009bc0 ff56      	sbrs	temp, CON_IN_LAN
009bc1 cfeb      	rjmp	_LAN_PROCESS_NEXT
                 ;	rcall	_LAN_SET_BUF2			; May be bigger than 64 byte - using BUF2
                 ;	rcall	LAN_RECEIVE_PACKET		; get packet
009bc2 ef50      	ldi	temp, BIOS_FUNC_CONBUF_APPEND	; 0xf0
009bc3 c000      	rjmp	_LAN_PROCESS_BUF
                 
                 _LAN_PROCESS_BUF:
009bc4 936f              push	zzC
009bc5 9130 365a         lds	r19, LAN_OP_BUF_LEN
                 
                 .EQU		LAN3_UDP_DATA = LAN3_BUF + (LAN_UDP_DATA-LAN_BUF)
                         
009bc7 523a              subi	r19, (LAN3_UDP_DATA-LAN3_BUF)	; length of DATA block
009bc8 e2ea
009bc9 e3f6              ldiw	Z, LAN3_UDP_DATA		; address of data to get
                 _LAN_PROCESS_BUF_LOOP:
009bca 3030              cpi	r19, 0
009bcb f061              breq	_LAN_PROCESS_BUF_END
009bcc 9161      	ld	zzC, Z+				; get data
009bcd 93ff
009bce 93ef      	pushw	Z
009bcf 935f              push	temp
009bd0 940e 7200 	call	BIOS				; store to buffer
009bd2 915f      	pop	temp
009bd3 91ef
009bd4 91ff      	popw	Z
009bd5 f020      	brcs	_LAN_PROCESS_BUF_CANCEL		;!! if C=1 === buffer is overloaded, stop processing until main stream will clear it
009bd6 953a      	dec	r19
009bd7 f791      	brne	_LAN_PROCESS_BUF_LOOP	
                 _LAN_PROCESS_BUF_END:
009bd8 916f      	pop	zzC
009bd9 cfd3      	rjmp	_LAN_PROCESS_NEXT		; set processed and check next frame
                 _LAN_PROCESS_BUF_CANCEL:
009bda 916f      	pop	zzC
009bdb cfd3      	rjmp	_LAN_PROCESS_RET		; buffer is overflowed
                 
                 _LAN_PROCESS_MAIN:
                 	;!!! still thinking - load packet or no?? ?????
                 	; stop processing for now
009bdc 9350 0972 	sts	LAN_MAIN_RQST, temp		; processing required
009bde d962      	rcall	_LAN_RECEIVE_USER_PACKET	; receive packet to USER buffer
                 ;	rcall	_LAN_SET_USER
                 ;	rcall	LAN_RECEIVE_PACKET		; get packet to user buffer
                 ;	rcall	LAN_RECEIVE_PACKET_NEXT		; set processed
009bdf cfcf      	rjmp	_LAN_PROCESS_RET		; just return, store data
                 
                 _LAN_PROCESS_RET2:
009be0 9508      	ret
                 
                 
                 
                 	; send system UDP packet
                 LAN_SEND_SAFE:
009be1 9150 3652 	lds	temp, LAN_OP_DST_IP		; check IP address is set
009be3 3050      	cpi	temp, 0				; IP starts with 0 == not set = nothing to do
009be4 f409      	brne	LAN_SEND_SAFE_do
009be5 c006      	rjmp	LAN_SEND_SAFE_ret
                 LAN_SEND_SAFE_do:
009be6 dc42      	rcall	LAN_BUILD_UDP_FRAME
009be7 dc03      	rcall	LAN_BUILD_IP_FRAME
009be8 9250 3658 	sts	LAN_OP_ETHTYPE, zero		; IP
009bea dbe6      	rcall	LAN_BUILD_ETH_FRAME
009beb d00f      	rcall	LAN_SEND_PACKET
                 LAN_SEND_SAFE_ret:
009bec 9508      	ret
                 
                 
                 .EQU		LAN2_UDP_DATA = LAN2_BUF + (LAN_UDP_DATA-LAN_BUF)
                 
                 	; sending data to system targets
                 LAN_SEND_CON:
009bed df6f      	rcall	_LAN_SET_CON
009bee 9360 352a 	sts	LAN2_UDP_DATA, zzC		; store symbol to transmit
009bf0 cff0      	rjmp	LAN_SEND_SAFE
                 
                 LAN_SEND_PR:
009bf1 df30      	rcall	_LAN_SET_PR
009bf2 9360 352a 	sts	LAN2_UDP_DATA, zzC		; store symbol to transmit
009bf4 cfec      	rjmp	LAN_SEND_SAFE
                 
                 LAN_SEND_PRN:
009bf5 df71      	rcall	_LAN_SET_PRN
009bf6 9360 352a 	sts	LAN2_UDP_DATA, zzC		; store symbol to transmit
009bf8 cfe8      	rjmp	LAN_SEND_SAFE
                 
                 	;?????? how to process responce ????
                 LAN_SEND_RSD:
009bf9 df87      	rcall	_LAN_SET_RSD
009bfa cfe6      	rjmp	LAN_SEND_SAFE
                 
                 
                 
                 ; send stored packet
                 LAN_SEND_PACKET:
009bfb d07f      	rcall	_LAN_SEND_WAIT_TXRTS
                 _LAN_SEND_PACKET_RESET:
                 	; reset TX
                 ;	rcall	LAN_SELECT_BANK_2			; select bank 2
                 ;	LAN_WRITE_PHY LAN_PHCON1, 0b0000000100000000	; PDPXMD === FULDPX Reset just for the case
                 
009bfc 982c
009bfd e95f
009bfe 940e 005f
009c00 e850
009c01 940e 005f
009c03 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0b10000000, LAN_REG_BFS	; TXRST - start
009c04 982c
009c05 eb5f
009c06 940e 005f
009c08 e850
009c09 940e 005f
009c0b 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0b10000000, LAN_REG_BFC	; TXRST - stop
009c0c 982c
009c0d eb5c
009c0e 940e 005f
009c10 e05a
009c11 940e 005f
009c13 9a2c      	LAN_CREG_WRITE_C LAN_EIR, 0b00001010, LAN_REG_BFC	; clear int flags - ERRATA advise
                 _LAN_SEND_PACKET_L0:
009c14 db41      	rcall	LAN_SELECT_BANK_0
009c15 982c
009c16 e452
009c17 940e 005f
009c19 e050
009c1a 940e 005f
009c1c 9a2c
009c1d 982c
009c1e e453
009c1f 940e 005f
009c21 e15a
009c22 940e 005f
009c24 9a2c      	LAN_CREG_WRITE_LH LAN_EWRPT, LAN_M_TXSTART	; tx buf start
                 
                 ;	pushw	Y					; counter
009c25 91c0 365a
009c27 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN	; buffer length
009c29 91e0 3658
009c2b 91f0 3659 	ldw	Z, LAN_OP_BUF		; address of lan_buffer
                 
                 	;boundary check	
009c2d 9150 365c 	lds	temp, LAN_OP_BUF_SIZE
009c2f 17c5      	cp	YL, temp
009c30 9150 365d 	lds	temp, LAN_OP_BUF_SIZE+1
009c32 07d5      	cpc	YH, temp
009c33 f010      	brlo	_lan_send_l4
009c34 f009      	breq	_lan_send_l4
009c35 c043      	rjmp	_LAN_SEND_PACKET_ERR	; error - length exceeds buffer size
                 
                 _lan_send_l4:
009c36 982c
009c37 e75a
009c38 940e 005f
009c3a e050
009c3b 940e 005f
009c3d 30d0
009c3e f411
009c3f 30c0
009c40 f029
009c41 9151
009c42 940e 005f
009c44 9721
009c45 cff7
009c46 9a2c      	LAN_TBUF_WRITE Z, Y				; upload buffer to chip
                 
009c47 982c
009c48 e454
009c49 940e 005f
009c4b e050
009c4c 940e 005f
009c4e 9a2c
009c4f 982c
009c50 e455
009c51 940e 005f
009c53 e15a
009c54 940e 005f
009c56 9a2c      	LAN_CREG_WRITE_LH LAN_ETXST, LAN_M_TXSTART	; tx buf start
                 
009c57 e0e0
009c58 e1fa      	ldiw	Z, LAN_M_TXSTART
009c59 91c0 365a
009c5b 91d0 365b 	ldw	Y, LAN_OP_BUF_LEN	; buffer length
009c5d 0fec      	add	ZL, YL
009c5e 1ffd      	adc	ZH, YH
009c5f 982c
009c60 e456
009c61 940e 005f
009c63 2f5e
009c64 940e 005f
009c66 9a2c
009c67 982c
009c68 e457
009c69 940e 005f
009c6b 2f5f
009c6c 940e 005f
009c6e 9a2c      	LAN_CREG_WRITE_LH_R LAN_ETXND, Z		; tx buf end
                 ;	popw	Y
                 
009c6f 982c
009c70 e95f
009c71 940e 005f
009c73 e058
009c74 940e 005f
009c76 9a2c      	LAN_CREG_WRITE_C LAN_ECON1, 0b00001000, LAN_REG_BFS	; TXRTS
                 
                 ;	rcall	_LAN_SEND_WAIT_TXRTS			; wait completion
                 ;	brne	_LAN_SEND_PACKET_OK			; ok, no error
                 ;	rjmp	_LAN_SEND_PACKET_RESET			; clear error and repeat the attempt otherwise
                 
                 _LAN_SEND_PACKET_OK:
009c77 e055      	ldi	temp, 5
009c78 9508      	ret
                 _LAN_SEND_PACKET_ERR:
009c79 ef5f      	ldi	temp, 255		; error with initialization	
009c7a 9508      	ret
                 
                 
                 
                 
                 ; wait TXRTS clearance
                 _LAN_SEND_WAIT_TXRTS:
009c7b 2777              clr	FROMRAM0
                 _lan_txrts_l0:
009c7c 982c
009c7d e15f
009c7e 940e 005f
009c80 ef5f
009c81 940e 005f
009c83 9a2c      	LAN_ETH_REG_READ LAN_ECON1
009c84 ff53      	sbrs	temp, 3			; TXRTS
009c85 c005      	rjmp	_lan_txrts_l1		; ok - start
009c86 d80c      	DELAY_10us
009c87 9573      	inc	FROMRAM0
009c88 3c78      	cpi	FROMRAM0, 200		; timeout 2 ms
009c89 f390      	brlo	_lan_txrts_l0		; waiting if lower than
009c8a c00d      	rjmp	_lan_txrts_fault	; error state detected
                 _lan_txrts_l1:
009c8b 982c
009c8c e15c
009c8d 940e 005f
009c8f ef5f
009c90 940e 005f
009c92 9a2c      	LAN_ETH_REG_READ LAN_EIR
009c93 ff51      	sbrs	temp, 1			; TXERIF
009c94 c001      	rjmp	_lan_txrts_ok		; ok - start
009c95 c002      	rjmp	_lan_txrts_fault	; error state detected
                 _lan_txrts_ok:
009c96 9498      	clz
009c97 9508      	ret
                 _lan_txrts_fault:
009c98 9418      	sez
009c99 9508      	ret
                 
                 
                 
                 
                 ; CMDLAN_GET_FRAME receive packet to ram
                 LAN_RECEIVE_PACKET:
009c9a dac4      	rcall	LAN_SELECT_BANK_1
009c9b 982c
009c9c e159
009c9d 940e 005f
009c9f ef5f
009ca0 940e 005f
009ca2 9a2c      	LAN_ETH_REG_READ LAN_EPKTCNT			; check that there is unread packet
009ca3 3050      	cpi	temp, 0
009ca4 f439      	brne	_LAN_RECEIVE_PACKET_L0
                 
009ca5 9250 365a 	sts	LAN_OP_BUF_LEN, zero
009ca7 9250 365b 	sts	LAN_OP_BUF_LEN+1, zero			; set length=0
009ca9 9250 0969 	sts	LAN_RXSTATUS, zero
009cab c063      	rjmp	_LAN_RECEIVE_PACKET_ret
                 
                 _LAN_RECEIVE_PACKET_L0:
009cac daa9      	rcall	LAN_SELECT_BANK_0
                 
009cad 91e0 0967
009caf 91f0 0968 	ldw	Z, LAN_RXDPT				; current pointer
009cb1 982c
009cb2 e450
009cb3 940e 005f
009cb5 2f5e
009cb6 940e 005f
009cb8 9a2c
009cb9 982c
009cba e451
009cbb 940e 005f
009cbd 2f5f
009cbe 940e 005f
009cc0 9a2c      	LAN_CREG_WRITE_LH_R LAN_ERDPT, Z		; rx buf start
                 	
009cc1 93df
009cc2 93cf      	pushw	Y					; counter
009cc3 91e0 3658
009cc5 91f0 3659 	ldw	Z, LAN_OP_BUF				; buffer address
009cc7 982c
009cc8 e35a
009cc9 940e 005f
009ccb 940e 005f
009ccd 9350 3655
009ccf 940e 005f
009cd1 9350 3656
009cd3 940e 005f
009cd5 2fc5
009cd6 940e 005f
009cd8 2fd5
009cd9 935f
009cda 30c4
009cdb e050
009cdc 07d5
009cdd 915f
009cde f418
009cdf 925f
009ce0 925f
009ce1 c024
009ce2 9724
009ce3 9150 365c
009ce5 17c5
009ce6 9150 365d
009ce8 07d5
009ce9 f020
009cea 91c0 365c
009cec 91d0 365d
009cee 93df
009cef 93cf
009cf0 940e 005f
009cf2 9350 0969
009cf4 935f
009cf5 940e 005f
009cf7 9350 096a
009cf9 915f
009cfa ff57
009cfb c00a
009cfc 30d0
009cfd f411
009cfe 30c0
009cff f031
009d00 ef5f
009d01 940e 005f
009d03 9351
009d04 9721
009d05 cff6
009d06 91cf
009d07 91df
009d08 9a2c      	LAN_TBUF_READ Z, Y				; upload buffer - check for BUF_SIZE is here!
009d09 93c0 365a
009d0b 93d0 365b 	stw	LAN_OP_BUF_LEN, Y			; store buffer length
009d0d 91cf
009d0e 91df      	popw	Y
                 
                 ;	ldw	Z, LAN_RXDPT				; current pointer
                 ;	sbiw	Z, 1
                 ;	andi	ZH, high(LAN_M_BUFEND)
                 ;	andi	ZL, low(LAN_M_BUFEND)     		; y = (rxdpt-1) & (buf_len-1)
                 
                 ;	LAN_CREG_WRITE_LH_R LAN_ERXRDPT, Z		; rx buf start - freeing buffer
                 ;	LAN_CREG_WRITE_C LAN_ECON2, 0b01000000, LAN_REG_BFS	; PKTDEC - packet is read
                 
                 _LAN_RECEIVE_PACKET_ret:
009d0f 9150 0969 	lds	temp, LAN_RXSTATUS 			; status for return
009d11 9508      	ret
                 
                 
                 ; Set packed processed and move to next one
                 LAN_RECEIVE_PACKET_NEXT:
009d12 91e0 3655
009d14 91f0 3656 	ldw	Z, LAN_OP_RXDPT				; current pointer
009d16 93e0 0967
009d18 93f0 0968 	stw	LAN_RXDPT, Z				; store permanently
009d1a 9731      	sbiw	Z, 1
009d1b 71ff      	andi	ZH, high(LAN_M_BUFEND)
009d1c 7fef      	andi	ZL, low(LAN_M_BUFEND)     		; y = (rxdpt-1) & (buf_len-1)
                 
009d1d 982c
009d1e e45c
009d1f 940e 005f
009d21 2f5e
009d22 940e 005f
009d24 9a2c
009d25 982c
009d26 e45d
009d27 940e 005f
009d29 2f5f
009d2a 940e 005f
009d2c 9a2c      	LAN_CREG_WRITE_LH_R LAN_ERXRDPT, Z		; rx buf start - freeing buffer
009d2d 982c
009d2e e95e
009d2f 940e 005f
009d31 e450
009d32 940e 005f
009d34 9a2c      	LAN_CREG_WRITE_C LAN_ECON2, 0b01000000, LAN_REG_BFS	; PKTDEC - packet is read
009d35 9508      	ret
                 
                 
                 
                 ; compare r19 bytes from (X) and (Z)
                 LAN_MEM_COMPARE:
009d36 915d      	ld	temp, X+
009d37 9171      	ld	FROMRAM0, Z+
009d38 1572      	cp	FROMRAM0, FF			; FF allows any value
009d39 f011      	breq	_lan_mc_l2
009d3a 1757      	cp	temp, FROMRAM0
009d3b f411      	brne	_lan_mc_l1
                 _lan_mc_l2:
009d3c 953a      	dec	r19
009d3d f7c1      	brne	LAN_MEM_COMPARE
                 _lan_mc_l1:
                 ;	cpi	r19, 0
009d3e 9508      	ret
                 
                 
                 
                 
                 ; compare BEV from (X) and (Z)
                 LAN_MEM_COMPARE_BEW:
009d3f 915d      	ld	temp, X+
009d40 913d      	ld	r19, X+     			; big endian value
009d41 9171      	ld	FROMRAM0, Z+
009d42 1737      	cp	r19, FROMRAM0
009d43 f411      	brne	_lan_mc_bew_l1
009d44 9171      	ld	FROMRAM0, Z+
009d45 1757      	cp	temp, FROMRAM0
                 _lan_mc_bew_l1:
009d46 9508      	ret
                 
                 
                 
                 ;COPY 2 Byte (Z)->(X)
                 _LAN_COPY_2B:
                 _LAN_COPY_WORD:
009d47 9151      	ld	temp, Z+
009d48 935d      	st	X+, temp
009d49 9151      	ld	temp, Z+
009d4a 935d      	st	X+, temp
009d4b 9508      	ret
                 
                 ;COPY 2 Byte (Z)->(X)
                 _LAN_COPY_PORT:
                 _LAN_COPY_RWORD:
009d4c 8151      	ldd	temp, Z+1
009d4d 935d      	st	X+, temp
009d4e 8150      	ldd	temp, Z+0
009d4f 935d      	st	X+, temp
009d50 9508      	ret
                 
                 ;COPY 4 Byte (Z)->(X)
                 _LAN_COPY_IP:
                 _LAN_COPY_DWORD:
009d51 9151      	ld	temp, Z+
009d52 935d      	st	X+, temp
009d53 9151      	ld	temp, Z+
009d54 935d      	st	X+, temp
009d55 9151      	ld	temp, Z+
009d56 935d      	st	X+, temp
009d57 9151      	ld	temp, Z+
009d58 935d      	st	X+, temp
009d59 9508      	ret
                 
                 ;COPY 6 Byte (Z)->(X)
                 _LAN_COPY_MAC:
009d5a 9151      	ld	temp, Z+
009d5b 935d      	st	X+, temp
009d5c 9151      	ld	temp, Z+
009d5d 935d      	st	X+, temp
009d5e 9151      	ld	temp, Z+
009d5f 935d      	st	X+, temp
009d60 9151      	ld	temp, Z+
009d61 935d      	st	X+, temp
009d62 9151      	ld	temp, Z+
009d63 935d      	st	X+, temp
009d64 9151      	ld	temp, Z+
009d65 935d      	st	X+, temp
009d66 9508      	ret
                 
                 __LAN_SEND:
009d67 e056
009d68 940e 9400 	EXEC_LAN_CMD LAN_FUNC_SEND	; safe send
009d6a 9508      	ret
                 
                 __LAN_RECEIVE:
009d6b e057
009d6c 940e 9400 	EXEC_LAN_CMD LAN_FUNC_RECEIVE	; safe reveive
009d6e 9508      	ret
                 LAN_END:
                 ;	nop
                 
                 .ORG 0x0a400		; 1 48
                 CAN_START:
                 #include "can.inc"			; can access routines
                 
00a400 940c a404 	jmp	__CAN_INIT
                 CAN_CMD:
00a402 940c a511 	jmp	_CAN_CMD
                 
                 
                 ; standard reset procedure
                 __CAN_INIT:
00a404 935f      	push	temp
00a405 e050      	ldi	temp, 0
00a406 dffb      	rcall	CAN_CMD
00a407 915f      	pop	temp
00a408 9508      	ret
                 
                 
                 
                 ; init CAN interface from default settings for mask as well
                 _CAN_INIT:
                 _CAN_INIT_BUF:
00a409 936f      	push	zzC
                 
00a40a 982c
00a40b ec50
00a40c 940e 005f
00a40e 9a2c      	CAN_RESET		; reset, enter configuration mode
                 
00a40f e860      	ldi	zzC, 0b10000000
00a410 e05f
00a411 d141      	CAN_CALL_WRITE CAN_REG_CANCTRL	; Normal operation mode, SOF signalling enabled
                 
00a412 982c
00a413 e053
00a414 940e 005f
00a416 e05e
00a417 940e 005f
00a419 ef5f
00a41a 940e 005f
00a41c 9a2c      	CAN_READ_REG CAN_REG_CANSTAT
00a41d 7e50      	andi	temp, 0b11100000
00a41e 3850      	cpi	temp, 0x80
00a41f f009      	breq	_CAN_INIT_do
00a420 c042      	rjmp	_CAN_INIT_ret	; reset didn't pass
                 
                 _CAN_INIT_do:
                 				; start setting bit timing from parameters
00a421 9160 0995 	lds	zzC, CAN_BT_SJW
00a423 0f66      	lsl	zzC
00a424 0f66      	lsl	zzC
00a425 0f66      	lsl	zzC
00a426 0f66      	lsl	zzC
00a427 0f66      	lsl	zzC
00a428 0f66      	lsl	zzC
00a429 9150 0996 	lds	temp, CAN_BT_BRP
00a42b 2b65      	or	zzC, temp
00a42c e25a
00a42d d125      	CAN_CALL_WRITE CAN_REG_CNF1
                 
00a42e e860      	ldi	zzC, 0x80		; BTLMODE = 1
00a42f 9150 0993 	lds	temp, CAN_BT_PS1
00a431 0f55      	lsl	temp
00a432 0f55      	lsl	temp
00a433 0f55      	lsl	temp
00a434 2b65      	or	zzC, temp
00a435 9150 0992 	lds	temp, CAN_BT_PSEG
00a437 2b65      	or	zzC, temp
00a438 e259
00a439 d119      	CAN_CALL_WRITE CAN_REG_CNF2
                 
00a43a e860      	ldi	zzC, 0x80		; SOF signalling = 1
00a43b 9150 0994 	lds	temp, CAN_BT_PS2
00a43d 2b65      	or	zzC, temp
00a43e e258
00a43f d113      	CAN_CALL_WRITE CAN_REG_CNF3
                 
00a440 9160 0988 	lds	zzC, CAN_ID_MY		; setting filter 0 with my ID
00a442 e050
00a443 d10f      	CAN_CALL_WRITE CAN_REG_RXF0SIDH
00a444 9160 0989 	lds	zzC, CAN_ID_MY+1
00a446 e051
00a447 d10b      	CAN_CALL_WRITE CAN_REG_RXF0SIDL
00a448 9160 098a 	lds	zzC, CAN_ID_MY+2
00a44a e052
00a44b d107      	CAN_CALL_WRITE CAN_REG_RXF0EID8
00a44c 9160 098b 	lds	zzC, CAN_ID_MY+3
00a44e e053
00a44f d103      	CAN_CALL_WRITE CAN_REG_RXF0EID0
                 
00a450 ef6f      	ldi	zzC, 0b11111111		; setting mask for standard messages
00a451 e250
00a452 d100      	CAN_CALL_WRITE CAN_REG_RXM0SIDH
00a453 ee60      	ldi	zzC, 0b11100000
00a454 e251
00a455 d0fd      	CAN_CALL_WRITE CAN_REG_RXM0SIDL
00a456 e060      	ldi	zzC, 0
00a457 e252
00a458 d0fa      	CAN_CALL_WRITE CAN_REG_RXM0EID8
00a459 e060      	ldi	zzC, 0
00a45a e253
00a45b d0f7      	CAN_CALL_WRITE CAN_REG_RXM0EID0
                 
00a45c e260      	ldi	zzC, 0b00100000		; Receive only valid messages with standard identifiers that meet filter criteria
                 					; No pending to BUF1
00a45d e650
00a45e d0f4      	CAN_CALL_WRITE CAN_REG_RXB0CTRL
                 
00a45f e064      	ldi	zzC, 0b00000100
00a460 e05f
00a461 d0f1      	CAN_CALL_WRITE CAN_REG_CANCTRL	; Normal operation mode, SOF signalling enabled
                 
00a462 e850              ldi	temp, 0x80	; report success
                 
                 _CAN_INIT_ret:
00a463 916f      	pop	zzC
00a464 c0e1      	rjmp	_CAN_CMD_ret
                 
                 
                 
                 ; returns RX status in temp: bit 6 = message in rxb0
                 _CAN_GET_RX_STATUS:
00a465 982c              SPI_SELECT
00a466 eb50
00a467 940e 005f 	iSPI	CAN_CMD_RXSTAT
00a469 ef5f
00a46a 940e 005f 	iSPI	0xff			; read response
00a46c 9a2c              SPI_DESELECT
00a46d c0d8      	rjmp	_CAN_CMD_ret
                 
                 
                 ; returns status in temp
                 _CAN_GET_STATUS:
00a46e 982c              SPI_SELECT
00a46f ea50
00a470 940e 005f 	iSPI	CAN_CMD_STATUS
00a472 ef5f
00a473 940e 005f 	iSPI	0xff			; read response
00a475 9a2c              SPI_DESELECT
00a476 c0cf      	rjmp	_CAN_CMD_ret
                 
                 
                 _CAN_SET_TX_LEN:
00a477 936f      	push	zzC
00a478 9160 0987 	lds	zzC, CAN_MBUF_OUT_L
00a47a 3069      	cpi	zzC, 9 
00a47b f410      	brsh	_CAN_SET_TX_LEN_ret	; bad length
00a47c e355
00a47d d0d5      	CAN_CALL_WRITE CAN_REG_TXB0DLC	; set outgoing messages length
                 _CAN_SET_TX_LEN_ret:
00a47e 2f56      	mov	temp,zzC
00a47f 916f      	pop	zzC
00a480 c0c5      	rjmp	_CAN_CMD_ret
                 
                 
                 _CAN_SEND_PACKET:
00a481 9150 0981 	lds	temp, CAN_MBUF_PAR+1	; TX buf no
00a483 3050      	cpi	temp, 0
00a484 f411      	brne	_CAN_SEND_PACKET_RX12
                 
00a485 e450      	ldi	temp, CAN_CMD_LOADTX0
00a486 c005      	rjmp	_CAN_SEND_PACKET_DO
                 
                 _CAN_SEND_PACKET_RX12:
00a487 3051      	cpi	temp, 1
00a488 f7f1      	brne	_CAN_SEND_PACKET_RX12
00a489 e452      	ldi	temp, CAN_CMD_LOADTX1
00a48a c001      	rjmp	_CAN_SEND_PACKET_DO
                 
                 _CAN_SEND_PACKET_RX2:
00a48b e454      	ldi	temp, CAN_CMD_LOADTX2
                 
                 _CAN_SEND_PACKET_DO:
00a48c 93df
00a48d 93cf      	pushw	Y
00a48e 936f      	push	zzC
                 
00a48f 982c              SPI_SELECT
00a490 940e 005f         call	DOSPI
                 ;	iSPI	CAN_CMD_LOADTX0
00a492 e064      	ldi	zzC, 4
00a493 e8cc
00a494 e0d9      	ldiw	Y, CAN_ID_REMOTE	; address
                 _CAN_SEND_PACKET_L4:
00a495 9159      	ld	temp, Y+
00a496 940e 005f         call	DOSPI
00a498 956a              dec	zzC
00a499 f7d9              brne	_CAN_SEND_PACKET_L4
                 
00a49a 9150 0987 	lds	temp, CAN_MBUF_OUT_L
00a49c 3059      	cpi	temp, 9 
00a49d f008      	brlo	_CAN_SEND_PACKET_L2	; length ok
00a49e e058      	ldi	temp, 8			; fix it otherwise
                 _CAN_SEND_PACKET_L2:
00a49f 2f65      	mov	zzC, temp		; bytes to send
00a4a0 940e 005f         call	DOSPI			; send DLC
                 
00a4a2 e9c7
00a4a3 e0d9      	ldiw	Y, CAN_DATA_BUF
                 _CAN_SEND_PACKET_L1:
00a4a4 3060      	cpi	zzC, 0
00a4a5 f029      	breq	_CAN_SEND_PACKET_L3
00a4a6 9159      	ld	temp, Y+
00a4a7 940e 005f 	call	DOSPI
00a4a9 956a      	dec	zzC
00a4aa f7c9      	brne	_CAN_SEND_PACKET_L1
                 
                 _CAN_SEND_PACKET_L3:
00a4ab 9a2c              SPI_DESELECT
                 
00a4ac 9160 0981 	lds	zzC, CAN_MBUF_PAR+1	; TX buf no
00a4ae 7063      	andi	zzC, 0x03
00a4af e051      	ldi	temp, 1
00a4b0 3060      	cpi	zzC, 0
00a4b1 f019      	breq 	_CAN_SEND_PACKET_L5
                 _CAN_SEND_PACKET_L6:
00a4b2 0f55      	lsl	temp
00a4b3 956a      	dec	zzC
00a4b4 f7e9      	brne	_CAN_SEND_PACKET_L6
                 
                 _CAN_SEND_PACKET_L5:
00a4b5 7057      	andi	temp, 0x07
00a4b6 6850      	ori	temp, CAN_CMD_RTS
00a4b7 935f      	push	temp
00a4b8 982c              SPI_SELECT
00a4b9 915f              pop	temp
00a4ba 940e 005f         call	DOSPI
                 ;        iSPI	CAN_CMD_RTS0	; send buf0
00a4bc 9a2c              SPI_DESELECT
                 
00a4bd 9150 0981 	lds	temp, CAN_MBUF_PAR+1	; TX buf no - success code
                 
                 _CAN_SEND_PACKET_ret:
00a4bf 916f      	pop	zzC
00a4c0 91cf
00a4c1 91df              popw	Y
00a4c2 c083      	rjmp	_CAN_CMD_ret
                 
                 
                 _CAN_ABORT_TX:
00a4c3 982c
00a4c4 e052
00a4c5 940e 005f
00a4c7 e350
00a4c8 940e 005f
00a4ca e050
00a4cb 940e 005f
00a4cd 9a2c      	CAN_WRITE_REG CAN_REG_TXB0CTRL, 0
00a4ce c077      	rjmp	_CAN_CMD_ret
                 
                 	
                 _CAN_GET_TX_STATUS:
00a4cf 982c
00a4d0 e053
00a4d1 940e 005f
00a4d3 e350
00a4d4 940e 005f
00a4d6 ef5f
00a4d7 940e 005f
00a4d9 9a2c      	CAN_READ_REG CAN_REG_TXB0CTRL
00a4da c06b      	rjmp	_CAN_CMD_ret
                 
                 
                 
                 ;_CAN_RECEIVE_PACKET_RX1:
                 ;	ldi	temp, CAN_CMD_READRX1
                 ;	rjmp	_CAN_RECEIVE_PACKET_DO
                 
                 ; read received packet, no control
                 _CAN_RECEIVE_PACKET:
00a4db 9150 0980 	lds	temp, CAN_MBUF_PAR	; RX buf no
00a4dd 3050      	cpi	temp, 0
00a4de f411      	brne	_CAN_RECEIVE_PACKET_RX1
                 
00a4df e950      	ldi	temp, CAN_CMD_READRX0
00a4e0 c001      	rjmp	_CAN_RECEIVE_PACKET_DO
                 
                 _CAN_RECEIVE_PACKET_RX1:
00a4e1 e954      	ldi	temp, CAN_CMD_READRX1	; 0 or 1
                 _CAN_RECEIVE_PACKET_DO:
00a4e2 936f      	push	zzC
00a4e3 93ff
00a4e4 93ef      	pushw	Z
00a4e5 e9ef
00a4e6 e0f9      	ldiw	Z, CAN_MSG_HDR		; place to store
00a4e7 935f      	push	temp
00a4e8 982c              SPI_SELECT
00a4e9 915f              pop	temp
00a4ea 940e 005f         call	DOSPI			; send command
                 ;
                 ;	iSPI	CAN_CMD_READRX0		; read RXB0
00a4ec e064      	ldi	zzC, 4
                 _CAN_RECEIVE_PACKET_L3:
00a4ed 940e 005f 	call	DOSPI			; read header
00a4ef 9351      	st	Z+, temp
00a4f0 956a      	dec	zzC
00a4f1 f7d9      	brne	_CAN_RECEIVE_PACKET_L3	
                 
00a4f2 e9e7
00a4f3 e0f9      	ldiw	Z, CAN_DATA_BUF		; place to store
00a4f4 940e 005f 	call	DOSPI			; Read DLC
00a4f6 2f65      	mov	zzC, temp
00a4f7 706f      	andi	zzC, 0x0f
00a4f8 3069      	cpi	zzC, 9			; check correct length
00a4f9 f008      	brlo	_CAN_RECEIVE_PACKET_L4
00a4fa e068      	ldi	zzC, 8			; repair for errors
                 _CAN_RECEIVE_PACKET_L4:
00a4fb 9360 0984 	sts	CAN_MBUF_IN_L, zzC	; save length
                 _CAN_RECEIVE_PACKET_L1:
00a4fd 3060      	cpi	zzC, 0
00a4fe f029      	breq	_CAN_RECEIVE_PACKET_L2
00a4ff 940e 005f 	call	DOSPI			; read reg
00a501 9351      	st	Z+, temp
00a502 956a      	dec	zzC
00a503 f7c9      	brne	_CAN_RECEIVE_PACKET_L1	
                 _CAN_RECEIVE_PACKET_L2:
00a504 9a2c              SPI_DESELECT
                 _CAN_RECEIVE_PACKET_ret:
00a505 91ef
00a506 91ff      	popw	Z
00a507 916f      	pop	zzC
00a508 9150 0984 	lds	temp, CAN_MBUF_IN_L
00a50a c03b      	rjmp	_CAN_CMD_ret
                 
                 
                 
                 
                 _CAN_RESET_CMD:
00a50b 982c
00a50c ec50
00a50d 940e 005f
00a50f 9a2c      	CAN_RESET		; reset, enter configuration mode
00a510 c035      	rjmp	_CAN_CMD_ret
                 	
                 
                 
                 
                 ; execute CAN interface command
                 _CAN_CMD:	
00a511 9170 3f02 	lds	FROMRAM0, HW_FOUND
00a513 ff76      	sbrs	FROMRAM0, HW_FOUND_CAN
00a514 940c 8101 	jmp	SPCMD_notfound
                 
00a516 93bf
00a517 93af      	pushw	X
00a518 93df
00a519 93cf      	pushw	Y
00a51a 93ff
00a51b 93ef      	pushw	Z
00a51c 933f      	push	r19
                 
                 	; commands that doesn't access chip
                 ;	tcbe	2,  _CAN_COPY_RAM_BUF
                 ;	tcbe	3,  _CAN_COPY_BUF_RAM
                 ;	tcbe	11, _CAN_CRC
                 
                 	; commands that work with chip
00a51d 935f
00a51e e15f
00a51f b955
00a520 eb5f
00a521 b954
00a522 e050
00a523 bd5d
00a524 e550
00a525 bd5c
00a526 9859
00a527 915f              SPI_INIT SPI_SLAVE_CAN, SPI_FCK_DIV_4
00a528 3050
00a529 f409
00a52a cede      	tcbe	0,  _CAN_INIT
00a52b 3051
00a52c f409
00a52d cedb      	tcbe	1,  _CAN_INIT_BUF
00a52e 3056
00a52f f409
00a530 cf50      	tcbe	6,  _CAN_SEND_PACKET
00a531 3057
00a532 f409
00a533 cfa7      	tcbe	7,  _CAN_RECEIVE_PACKET
00a534 3058
00a535 f409
00a536 cf2e      	tcbe	8,  _CAN_GET_RX_STATUS
00a537 3151
00a538 f409
00a539 cf34      	tcbe	17, _CAN_GET_STATUS
00a53a 3155
00a53b f409
00a53c cf3a      	tcbe	21, _CAN_SET_TX_LEN
00a53d 3156
00a53e f409
00a53f cf83      	tcbe	22, _CAN_ABORT_TX
00a540 3157
00a541 f409
00a542 cf8c      	tcbe	23, _CAN_GET_TX_STATUS
00a543 3158
00a544 f409
00a545 cfc5      	tcbe	24, _CAN_RESET_CMD
                 _CAN_CMD_ret:
00a546 bc5c
00a547 9a59
00a548 b854              SPI_STOP
                 _CAN_CMD_end:
00a549 9350 08fe 	sts	PCMD_FE, temp			; store response
00a54b 913f              pop	r19
00a54c 91ef
00a54d 91ff      	popw	Z
00a54e 91cf
00a54f 91df      	popw	Y
00a550 91af
00a551 91bf      	popw	X
00a552 9508      	ret
                 
                 
                 ; write zzC to register temp
                 CAN_EXEC_WRITE:
00a553 936f      	push	zzC
00a554 935f      	push	temp
00a555 982c      	SPI_SELECT
00a556 e052
00a557 940e 005f 	iSPI	CAN_CMD_WRITE
00a559 915f      	pop	temp
00a55a 940e 005f 	call	DOSPI		; send address
00a55c 915f      	pop	temp
00a55d 940e 005f 	call	DOSPI		; send data
00a55f 9a2c              SPI_DESELECT
00a560 9508      	ret
                 CAN_END:
                 
                 .ORG 0x0b000            ; 1 60
                 DEBUG_START:
                 #include "debug.inc"			; 
                 
00b000 c045      DBG_RES: 	rjmp	_DBG_RES
00b001 c154      DBG_PORT_IN:	rjmp	_DBG_PORT_IN
00b002 c178      DBG_PORT_OUT:	rjmp	_DBG_PORT_OUT
00b003 c10f      DBG_BDOS:	rjmp	_DBG_BDOS
00b004 c042      DBG_BIOS:	rjmp	_DBG_BIOS
00b005 c07d      DBG_SD: 	rjmp	_DBG_SD
00b006 c099      DBG_SDERR: 	rjmp	_DBG_SDERR
00b007 c0c6      DBG_CONOUT:	rjmp	_DBG_CONOUT
00b008 c1d0      DBG_IRQ:	rjmp	_DBG_IRQ
                 DEBUG_Z80:
00b009 c1fe      DBG_z80:	rjmp	_DBG_z80
00b00a c0bf      DBG_CR: 	rjmp	_DBG_CR		; uDBGcr
00b00b c0b2      DBG_TEMP: 	rjmp	_DBG_TEMP
                 
                 ;_DBG_z80:
                 ;	ret
                 
                 DBG_ZRAM:
00b00c b9f8
00b00d b9e2
00b00e b854
00b00f b83b
00b010 0000
00b011 0000
00b012 b153
00b013 b82b      	LDRAM   ZH, ZL, temp
00b014 2f55
00b015 940e 8945 	uDBGh	temp
00b017 9508      	ret
                 
                 ; ---------------- send current command and registers to UART
                 DBG_UART_CMD:
00b018 935f              push	temp
00b019 2f59      	mov	temp, zzPCh
00b01a 940e 893c 	call	UART1_SEND
00b01c 2f58      	mov	temp, zzPCl
00b01d 940e 893c 	call	UART1_SEND
00b01f 2f54      	mov	temp, zzF
00b020 940e 893c 	call	UART1_SEND
00b022 2f51      	mov	temp, zzA
00b023 940e 893c 	call	UART1_SEND
00b025 2d5a      	mov	temp, zzB
00b026 940e 893c 	call	UART1_SEND
00b028 2f56      	mov	temp, zzC
00b029 940e 893c 	call	UART1_SEND
00b02b 2d5c      	mov	temp, zzD
00b02c 940e 893c 	call	UART1_SEND
00b02e 2d5d      	mov	temp, zzE
00b02f 940e 893c 	call	UART1_SEND
00b031 2d5e      	mov	temp, zzH
00b032 940e 893c 	call	UART1_SEND
00b034 2d5f      	mov	temp, zzL
00b035 940e 893c 	call	UART1_SEND
                 ;	pushw	Z
                 ;	push	zzA
                 ;	ldi	Zh, 0x6e
                 ;	ldi	Zl, 0x9c
                 ;	LDRAM 	Zh, Zl, zzA
                 ;	mov	temp, zzA
                 ;	call	UART1_SEND
                 ;	pop	zzA
                 ;	popw	Z
00b037 b998
00b038 b982
00b039 b854
00b03a b83b
00b03b 0000
00b03c 0000
00b03d b153
00b03e b82b      	LDRAM 	zzPCh, zzPCl, temp
00b03f 940e 893c 	call	UART1_SEND
00b041 e05d      	ldi	temp, 13
00b042 940e 893c 	call	UART1_SEND
00b044 915f      	pop	temp
00b045 9508      	ret
                 
                 _DBG_RES:
00b046 9508      	ret
                 
                 ; output BIOS calls
                 _DBG_BIOS:
00b047 935f      	push	temp
00b048 e05d
00b049 940e 893c 	uDBGcr
00b04b 2f59
00b04c 940e 8945
00b04e 2f58
00b04f 940e 8945
00b051 e35a
00b052 940e 893c 	uDBGa	zzPCh, zzPCl
00b054 e452
00b055 940e 893c 	uDBGc	'B'
00b057 e459
00b058 940e 893c 	uDBGc	'I'
00b05a e45f
00b05b 940e 893c 	uDBGc	'O'
00b05d e553
00b05e 940e 893c 	uDBGc	'S'
00b060 e35a
00b061 940e 893c 	uDBGc	':'
00b063 e250
00b064 940e 893c 	uDBGc	' '
00b066 9150 3f2e 	lds	temp, BIOS_LAST_CALL
00b068 2f55
00b069 940e 8945 	uDBGh	temp
00b06b e250
00b06c 940e 893c 	uDBGc	' '
00b06e 2d5a
00b06f 940e 8945 	uDBGh	zzB
00b071 2f56
00b072 940e 8945 	uDBGh	zzC
00b074 e250
00b075 940e 893c 	uDBGc	' '
00b077 2f51
00b078 940e 8945 	uDBGh	zzA
00b07a e250
00b07b 940e 893c 	uDBGc	' '
                 
00b07d d129      	rcall	_DBG_CALL_FROM
                 
00b07e e05d
00b07f 940e 893c 	uDBGcr
00b081 915f      	pop	temp
00b082 9508      	ret
                 
                 ; -------------------- debug SD read operations to CON
                 _DBG_SD:
                 ;	push	temp
00b083 93ff
00b084 93ef      	pushw	Z
00b085 e05d
00b086 940e 893c 	uDBGcr
00b088 e553
00b089 940e 893c 	uDBGc	'S'
00b08b e454
00b08c 940e 893c 	uDBGc	'D'
00b08e e35a
00b08f 940e 893c 	uDBGc	':'
00b091 e250
00b092 940e 893c 	uDBGc	' '
00b094 2f51
00b095 940e 8945 	uDBGh	zzA
00b097 2f5b
00b098 940e 8945 	uDBGh	XH
00b09a 2f5a
00b09b 940e 8945 	uDBGh	XL
                 ;	uDBGc	' '
                 ;	uDBGz	zzCURR_DISK_NO
                 ;	uDBGc	' '
                 ;	uDBGz	zzCURR_TRACK_NUM
                 ;	uDBGc	' '
                 ;	uDBGz	zzCURR_SECTOR_NUM
                 ;	uDBGc	' '
                 ;	uDBGcr
00b09d 91ef
00b09e 91ff      	popw	Z
                 ;	pop	temp
00b09f 9508      	ret
                 
                 _DBG_SDERR:
00b0a0 9150 092d
00b0a2 940e 8945 	uDBGm	SD_ADDRESS+3
00b0a4 9150 092c
00b0a6 940e 8945 	uDBGm	SD_ADDRESS+2
00b0a8 9150 092b
00b0aa 940e 8945 	uDBGm	SD_ADDRESS+1
00b0ac 9150 092a
00b0ae 940e 8945 	uDBGm	SD_ADDRESS+0
00b0b0 e250
00b0b1 940e 893c 	uDBGc	' '
00b0b3 e455
00b0b4 940e 893c 	uDBGc	'E'
00b0b6 9150 3f30
00b0b8 940e 8945 	uDBGm	SD_ERROR
00b0ba e05d
00b0bb 940e 893c 	uDBGcr
                 ;	uDBGc	' '
00b0bd 9508      	ret
                 
                 _DBG_TEMP:
00b0be 9150 3f31         lds	temp, DBG_CODE
00b0c0 940e 893c         uDBGu
00b0c2 9150 3f32
00b0c4 940e 8945 	uDBGm	DBG_DATA
00b0c6 e250
00b0c7 940e 893c 	uDBGc	' '
00b0c9 9508      	ret
                 	
                 _DBG_CR:
00b0ca e05d
00b0cb 940e 893c 	uDBGcr
00b0cd 9508      	ret
                 
                 ; process debug CON request
                 _DBG_CONOUT:
00b0ce 935f      	push	temp
00b0cf e05d
00b0d0 940e 893c 	uDBGcr
00b0d2 e453
00b0d3 940e 893c 	uDBGc	'C'
00b0d5 e45f
00b0d6 940e 893c 	uDBGc	'O'
00b0d8 e45e
00b0d9 940e 893c 	uDBGc	'N'
00b0db e35a
00b0dc 940e 893c 	uDBGc	':'
00b0de e250
00b0df 940e 893c 	uDBGc	' '
00b0e1 2f56
00b0e2 940e 8945 	uDBGh	zzC
00b0e4 316b      	cpi	zzC, 27
00b0e5 f101      	breq	_DBG_CONOUT_L2
00b0e6 3260      	cpi	zzC, ' '
00b0e7 f030      	brlo	_DBG_CONOUT_L1
00b0e8 e250
00b0e9 940e 893c 	uDBGc	' '
00b0eb 2f56
00b0ec 940e 893c 	uDBGr	zzC
                 _DBG_CONOUT_L1:
00b0ee e25f
00b0ef 940e 893c 	uDBGc	'/'
00b0f1 9150 091c
00b0f3 940e 8945 	uDBGm	CON_ESC
00b0f5 9150 091d
00b0f7 940e 8945 	uDBGm	CON_ESC_C1
00b0f9 9150 091e
00b0fb 940e 8945 	uDBGm	CON_ESC_C2
00b0fd 9150 091f
00b0ff 940e 8945 	uDBGm	CON_ESC_C3
00b101 e05d
00b102 940e 893c 	uDBGcr
00b104 915f      	pop	temp
00b105 9508      	ret
                 _DBG_CONOUT_L2:
                 	;!!!! for 1B add RAM addr where is executed !!!!!
00b106 e250
00b107 940e 893c 	uDBGc	' '
00b109 e455
00b10a 940e 893c 	uDBGc	'E'
00b10c e553
00b10d 940e 893c 	uDBGc	'S'
00b10f e453
00b110 940e 893c 	uDBGc	'C'
00b112 cfdb      	rjmp	_DBG_CONOUT_L1
                 
                 
                 ; output BDOS calls
                 _DBG_BDOS:
00b113 935f      	push	temp
00b114 e05d
00b115 940e 893c 	uDBGcr
00b117 2f59
00b118 940e 8945
00b11a 2f58
00b11b 940e 8945
00b11d e35a
00b11e 940e 893c 	uDBGa	zzPCh, zzPCl
00b120 e452
00b121 940e 893c 	uDBGc	'B'
00b123 e454
00b124 940e 893c 	uDBGc	'D'
00b126 e45f
00b127 940e 893c 	uDBGc	'O'
00b129 e553
00b12a 940e 893c 	uDBGc	'S'
00b12c e35a
00b12d 940e 893c 	uDBGc	':'
00b12f e250
00b130 940e 893c 	uDBGc	' '
                 ;	lds	temp, BDOS_LAST_CALL
                 ;	uDBGh	temp
                 ;	uDBGc	' '
00b132 2f56
00b133 940e 8945 	uDBGh	zzC
00b135 e250
00b136 940e 893c 	uDBGc	' '
00b138 2f51
00b139 940e 8945 	uDBGh	zzA
00b13b e250
00b13c 940e 893c 	uDBGc	' '
00b13e 2d5c
00b13f 940e 8945
00b141 2d5d
00b142 940e 8945 	uDBGw	zzD, zzE
00b144 e250
00b145 940e 893c 	uDBGc	' '
00b147 2d5e
00b148 940e 8945
00b14a 2d5f
00b14b 940e 8945 	uDBGw	zzH, zzL
00b14d e250
00b14e 940e 893c 	uDBGc	' '
                 
00b150 d056      	rcall	_DBG_CALL_FROM
                 
00b151 e05d
00b152 940e 893c 	uDBGcr
00b154 915f      	pop	temp
00b155 9508      	ret
                 
                 ; z80 port access
                 _DBG_PORT_IN:
00b156 935f      	push	temp
00b157 e05d
00b158 940e 893c 	uDBGcr
00b15a 2f59
00b15b 940e 8945
00b15d 2f58
00b15e 940e 8945
00b160 e35a
00b161 940e 893c 	uDBGa	zzPCh, zzPCl
00b163 e459
00b164 940e 893c 	uDBGc	'I'
00b166 e45e
00b167 940e 893c 	uDBGc	'N'
00b169 e550
00b16a 940e 893c 	uDBGc	'P'
00b16c e35a
00b16d 940e 893c 	uDBGc	':'
00b16f e250
00b170 940e 893c 	uDBGc	' '
00b172 9150 0910
00b174 940e 8945 	uDBGm	CDATA+2
00b176 e05d
00b177 940e 893c 	uDBGcr
00b179 915f      	pop	temp
00b17a 9508      	ret
                 
                 ; z80 port access
                 _DBG_PORT_OUT:
00b17b 935f      	push	temp
00b17c e05d
00b17d 940e 893c 	uDBGcr
00b17f 2f59
00b180 940e 8945
00b182 2f58
00b183 940e 8945
00b185 e35a
00b186 940e 893c 	uDBGa	zzPCh, zzPCl
00b188 e45f
00b189 940e 893c 	uDBGc	'O'
00b18b e555
00b18c 940e 893c 	uDBGc	'U'
00b18e e554
00b18f 940e 893c 	uDBGc	'T'
00b191 e35a
00b192 940e 893c 	uDBGc	':'
00b194 e250
00b195 940e 893c 	uDBGc	' '
00b197 9150 0910
00b199 940e 8945 	uDBGm	CDATA+2
00b19b e250
00b19c 940e 893c 	uDBGc	' '
00b19e 9150 090e
00b1a0 940e 8945 	uDBGm	CDATA	
00b1a2 e05d
00b1a3 940e 893c 	uDBGcr
00b1a5 915f      	pop	temp
00b1a6 9508      	ret
                 
                 _DBG_CALL_FROM:
00b1a7 e35c
00b1a8 940e 893c 	uDBGc	'<'
00b1aa 93ff
00b1ab 93ef      	pushw	Z
00b1ac 2ffd      	mov	ZH, zzSPh
00b1ad 2fec      	mov	ZL, zzSPl
00b1ae b9f8
00b1af b9e2
00b1b0 b854
00b1b1 b83b
00b1b2 0000
00b1b3 0000
00b1b4 b153
00b1b5 b82b      	LDRAM 	ZH, ZL, temp
00b1b6 935f      	push	temp
00b1b7 9631      	adiw	Z, 1
00b1b8 b9f8
00b1b9 b9e2
00b1ba b854
00b1bb b83b
00b1bc 0000
00b1bd 0000
00b1be b153
00b1bf b82b      	LDRAM 	ZH, ZL, temp
00b1c0 2ff5      	mov	ZH, temp
00b1c1 91ef      	pop	ZL
00b1c2 9733      	sbiw	Z, 3		; looking for call start "CALL 5"
00b1c3 2f5f
00b1c4 940e 8945
00b1c6 2f5e
00b1c7 940e 8945 	uDBGw	Zh, ZL
00b1c9 e258
00b1ca 940e 893c 	uDBGc	'('
00b1cc 95fa      	dec	ZH
00b1cd 2f5f
00b1ce 940e 8945
00b1d0 2f5e
00b1d1 940e 8945 	uDBGw	Zh, ZL		; addres in COM file
00b1d3 e259
00b1d4 940e 893c 	uDBGc	')'
00b1d6 91ef
00b1d7 91ff      	popw	Z
00b1d8 9508      	ret
                 
                 _DBG_IRQ:
00b1d9 935f      	push	temp
00b1da e05d
00b1db 940e 893c 	uDBGcr
00b1dd e459
00b1de 940e 893c 	uDBGc	'I'
00b1e0 e552
00b1e1 940e 893c 	uDBGc	'R'
00b1e3 e551
00b1e4 940e 893c 	uDBGc	'Q'
00b1e6 e35a
00b1e7 940e 893c 	uDBGc	':'
00b1e9 e250
00b1ea 940e 893c 	uDBGc	' '
00b1ec b55a      	in	temp, GPIOR1
00b1ed 940e 8945 	call	UART1_HEXOUT
                 ;	uDBGm	IRQ_CPD_FLAG
00b1ef e250
00b1f0 940e 893c 	uDBGc	' '
00b1f2 b35e      	in	temp, GPIOR0
00b1f3 940e 8945 	call	UART1_HEXOUT
00b1f5 e250
00b1f6 940e 893c 	uDBGc	' '
00b1f8 9150 3f03
00b1fa 940e 8945 	uDBGm	INT_MASK
00b1fc e250
00b1fd 940e 893c 	uDBGc	' '
00b1ff 9150 3f04
00b201 940e 8945 	uDBGm	INT_MASK+1
00b203 e05d
00b204 940e 893c 	uDBGcr
00b206 915f      	pop	temp
00b207 9508      	ret
                 #include "debug_z80.inc"			; 
                 
00b208 9508              ret
                 	;!!! Use DBG_OPTIONS
                 
                 ;	push	zzC
                 ;	push	zzA
                 ;;	ldi	zzC, '.'
                   ;      ldi	temp, BIOS_FUNC_CONOUT
                    ;     call	BIOS			; set display mode
                 ;	pop	zzA
                 ;	pop	zzC
                 	
                 ;	ret
                 DEBUG__END:
                 
                 .ORG 0x0b300            ; 1 66
                 EEPROM_START:
                 #include "eeprom.inc"			; eeprom access routines
                 
00b300 940c b304 	jmp	_EEPROM_INIT
                 EEPROM_CMD:
00b302 940c b305 	jmp	_EEPROM_CMD	
                 	; exec port cmd command
                 
                 
                 
                 
                 
                 
                 
                 ; startup LAN Init
                 _EEPROM_INIT: 
                 ;        iSPI	0xff		; soft reset
00b304 9508      	ret
                 
                 
                 _EEPROM_CMD:
00b305 9170 3f02 	lds	FROMRAM0, HW_FOUND
00b307 ff74      	sbrs	FROMRAM0, HW_FOUND_ROM
00b308 940c 8101 	jmp	SPCMD_notfound
                 
00b30a 3050
00b30b f409
00b30c cff7              tcbe	0, _EEPROM_INIT
00b30d 9508      	ret
                 #include "rtc.inc"			; rtc access routines
                 
00b30e c008      	rjmp	_RTC_START
                 RTC_CMD:
00b30f c08e      	rjmp	_RTC_CMD
                 
                 
                 _RTC_SELECT:
00b310 935f      	push	temp
00b311 982c      	SPI_SELECT
00b312 e05a
00b313 955a
00b314 f7f1      	delay3	30
00b315 915f      	pop	temp
00b316 9508      	ret
                 
                 _RTC_START:
                 	; start clock
00b317 935f
00b318 e15a
00b319 b955
00b31a eb5f
00b31b b954
00b31c e050
00b31d bd5d
00b31e e556
00b31f bd5c
00b320 9859
00b321 915f      	SPI_INIT SPI_SLAVE_RTC, SPI_FCK_DIV_16_CPHA	; /16, RTC supports fck till 2 MHz
00b322 dfed      	rcall	_RTC_SELECT
00b323 e85f
00b324 940e 005f 	iSPI	0x8F			; write control register
00b326 e053
00b327 940e 005f 	iSPI	0x03			; activate ints for alarms and start RTC
00b329 bc5c
00b32a 9a59
00b32b b854      	SPI_STOP
00b32c 9508      	ret
                 
                 
                 
                 _RTC_READ_DO:
                     	; access RTC chip
                 ;	SPI_INIT SPI_SLAVE_RTC, SPI_FCK_DIV_16		; /16, RTC supports fck till 2 MHz
00b32d 93bf
00b32e 93af      	pushw	X
                 
00b32f dfe0      	rcall	_RTC_SELECT
                 ;	SPI_SELECT
                 
00b330 e4a1
00b331 e3bf      	ldiw	X, RTC_SBUF
00b332 2f52      	mov	temp, r18
00b333 940e 005f 	call	DOSPI			; base address
                 _rtc_init_l8:
00b335 ef5f
00b336 940e 005f 	iSPI	0xff
00b338 935d      	st	X+, temp
00b339 953a      	dec	r19
00b33a f7d1      	brne  	_rtc_init_l8
                 
00b33b 9a2c      	SPI_DESELECT
                 ;    	SPI_STOP		    	; stop RTC access
00b33c 91af
00b33d 91bf      	popw	X
00b33e 9508      	ret
                 
                 
                 _RTC_READ:
00b33f e020      	ldi	r18, 0x00		; read control registers
00b340 e037      	ldi	r19, 0x07		; read control registers
                 _RTC_READ_L0:
00b341 dfeb      	rcall	_RTC_READ_DO
                 ;	pushw	X
                 ;	pushw	Y
                 ;	pushw	Z
                 ;	ZXYb	RTC_BUF, RTC_SECS, 7	; copy actual time to time buffer
                 ;	popw	Z
                 ;	popw	Y
                 ;	popw	X
                 
00b342 c085      	rjmp	_RTC_CMD_ret
                 
                 
                 _RTC_ALARM0_READ:
00b343 e027      	ldi	r18, 0x07		; read control registers
00b344 e034      	ldi	r19, 0x04		; read control registers
00b345 cffb      	rjmp	_RTC_READ_L0
                 
                 
                 _RTC_ALARM1_READ:
00b346 e02b      	ldi	r18, 0x0b		; read control registers
00b347 e034      	ldi	r19, 0x04		; read control registers
00b348 cff8      	rjmp	_RTC_READ_L0
                 
                 
                 _RTC_SET_TIME:
00b349 dfc6      	rcall	_RTC_SELECT
                 ;	SPI_SELECT
00b34a e850
00b34b 940e 005f 	iSPI	0x80
00b34d 9150 3f41 	lds	temp, RTC_SECS
00b34f 940e 005f 	call	DOSPI
00b351 9150 3f42 	lds	temp, RTC_MINS
00b353 940e 005f 	call	DOSPI
00b355 9150 3f43 	lds	temp, RTC_HOURS
00b357 940e 005f 	call	DOSPI
00b359 c06e      	rjmp	_RTC_CMD_ret
                 
                 
                 _RTC_SET_DATE:
00b35a dfb5      	rcall	_RTC_SELECT
                 ;	SPI_SELECT
00b35b e853
00b35c 940e 005f 	iSPI	0x83
00b35e 9150 3f44 	lds	temp, RTC_DAY
00b360 940e 005f 	call	DOSPI
00b362 9150 3f45 	lds	temp, RTC_DATE
00b364 940e 005f 	call	DOSPI
00b366 9150 3f46 	lds	temp, RTC_MONTH
00b368 940e 005f 	call	DOSPI
00b36a 9150 3f47 	lds	temp, RTC_YEAR
00b36c 940e 005f 	call	DOSPI
00b36e c059      	rjmp	_RTC_CMD_ret
                 
                 
                 _RTC_SET_ROM:
00b36f 93ff
00b370 93ef      	pushw	Z
00b371 933f      	push	r19
00b372 e9e0
00b373 e3f6      	ldiw	Z, RTC_RAM
00b374 e630      	ldi	r19, 96
00b375 df9a      	rcall	_RTC_SELECT
                 ;	SPI_SELECT
00b376 ea50
00b377 940e 005f 	iSPI	0xa0
                 _ret_set_rom_l0:
00b379 9151      	ld	temp, Z+
00b37a 940e 005f 	call	DOSPI
00b37c 953a      	dec	r19
00b37d f7d9      	brne	_ret_set_rom_l0
00b37e 913f      	pop	r19
00b37f 91ef
00b380 91ff      	popw	Z
00b381 c046      	rjmp	_RTC_CMD_ret
                 
                 
                 _RTC_READ_STATUS:
00b382 df8d      	rcall	_RTC_SELECT
                 ;	SPI_SELECT
00b383 e150
00b384 940e 005f 	iSPI	0x10
00b386 ef5f
00b387 940e 005f 	iSPI	0xff
00b389 c03e      	rjmp	_RTC_CMD_ret
                 	
                 
                 _RTC_LOAD_ROM:
00b38a 93ff
00b38b 93ef      	pushw	Z
00b38c 933f      	push	r19
00b38d e9e0
00b38e e3f6      	ldiw	Z, RTC_RAM
00b38f e630      	ldi	r19, 96
00b390 df7f      	rcall	_RTC_SELECT
                 ;	SPI_SELECT
00b391 e250
00b392 940e 005f 	iSPI	0x20			; base address
                 _rtc_load_rom_l0:
00b394 ef5f
00b395 940e 005f 	iSPI	0xff
00b397 9351      	st	Z+, temp
00b398 953a      	dec	r19
00b399 f7d1      	brne  	_rtc_load_rom_l0
00b39a 913f      	pop	r19
00b39b 91ef
00b39c 91ff      	popw	Z
00b39d c02a      	rjmp	_RTC_CMD_ret
                 
                 
                 
                 _RTC_CMD:
00b39e 9170 3f02 	lds	FROMRAM0, HW_FOUND
00b3a0 ff73      	sbrs	FROMRAM0, HW_FOUND_RTC
00b3a1 940c 8101 	jmp	SPCMD_notfound
                 
00b3a3 932f      	push	r18
00b3a4 933f      	push	r19
00b3a5 935f
00b3a6 e15a
00b3a7 b955
00b3a8 eb5f
00b3a9 b954
00b3aa e050
00b3ab bd5d
00b3ac e556
00b3ad bd5c
00b3ae 9859
00b3af 915f      	SPI_INIT SPI_SLAVE_RTC, SPI_FCK_DIV_16_CPHA		; /16, RTC supports fck till 2 MHz
00b3b0 3050
00b3b1 f409
00b3b2 cf8c              tcbe	0, _RTC_READ
00b3b3 3051
00b3b4 f409
00b3b5 cf93              tcbe	1, _RTC_SET_TIME
00b3b6 3052
00b3b7 f409
00b3b8 cfa1              tcbe	2, _RTC_SET_DATE
00b3b9 3053
00b3ba f409
00b3bb cfb3              tcbe	3, _RTC_SET_ROM
00b3bc 3054
00b3bd f409
00b3be cf84              tcbe	4, _RTC_ALARM0_READ
00b3bf 3055
00b3c0 f409
00b3c1 cf84              tcbe	5, _RTC_ALARM1_READ
00b3c2 3056
00b3c3 f409
00b3c4 cfbd              tcbe	6, _RTC_READ_STATUS
00b3c5 3057
00b3c6 f409
00b3c7 cfc2              tcbe	7, _RTC_LOAD_ROM
                 _RTC_CMD_ret:
00b3c8 9350 08fe 	sts	PCMD_FE, temp			; store response
00b3ca bc5c
00b3cb 9a59
00b3cc b854              SPI_STOP
00b3cd 913f      	pop	r19
00b3ce 912f      	pop	r18
00b3cf 9508      	ret
                 
                 EEPROM__END:
                 
                 .ORG 0x0b400            ; 1 68
                 CLR_START:
                 #include "clr.inc"			; CLR control access routines
                 
                 ; 0 - set default mode/color
                 ; 1 - set user static color
                 ; 2 - set pattern mode
                 ; 3 - set X
                 ; 4 - set Y
                 ; 5 - clear line
                 ; 6 - cler screen
                 ; 7 - scroll
                 ; 8 - goto pattern mode
                 ; 0xff - raw command
                 
                 CLR_CMD:
00b400 9170 3f02 	lds	FROMRAM0, HW_FOUND
00b402 ff71      	sbrs	FROMRAM0, HW_FOUND_EXT
00b403 940c 8101 	jmp	SPCMD_notfound
                 
00b405 3f5f
00b406 f409
00b407 c08e      	tcbe	CLR_CMD_RAW,	  _CLR_RAW	; 0xff
00b408 3050
00b409 f409
00b40a c065      	tcbe	CLR_CMD_DEFAULT,  _CLR_DEFAULT	; 0
00b40b 3051
00b40c f409
00b40d c06b      	tcbe	1,  	_CLR_SET_COLOR
00b40e 3058
00b40f f409
00b410 c07e      	tcbe	8,  	_CLR_PATTERN_MODE
                 
00b411 932f
00b412 9120 3f05
00b414 7120
00b415 912f      	cfmem	CRT_SETTINGS, CRT_USE_CLR	; is pattern mode active?
00b416 f091      	breq	_clr_cmd_notfound		; no, skip other commands
                 
00b417 3053
00b418 f409
00b419 c065      	tcbe	CLR_CMD_SET_X,	  _CLR_SET_X	; 3
00b41a 3054
00b41b f409
00b41c c067      	tcbe	CLR_CMD_SET_Y,    _CLR_SET_Y	; 4
00b41d 3052
00b41e f409
00b41f c05c      	tcbe	CLR_CMD_PATTERN,  _CLR_PATTERN	; 2
00b420 3055
00b421 f409
00b422 c066      	tcbe	5,  _CLR_CLR_LINE
00b423 3056
00b424 f409
00b425 c065      	tcbe	6,  _CLR_CLR_SCR
00b426 3057
00b427 f409
00b428 c064      	tcbe	7,  _CLR_SCROLL
                 
                 _clr_cmd_notfound:
00b429 940c 8101 	jmp	SPCMD_notfound		; bad command
                 ;	rjmp	_CLR_CMD_ret
                 
                 _CLR_CMD_EXEC:
00b42b 936f      	push	zzC
00b42c 2f65      	mov	zzC, temp
                 
                 _CLR_CMD_EXEC_DO:
                 ;        push   	temp
00b42d e550              ldi	temp, 80		; timeout timer 1s approx
00b42e 9350 0089         sts	OCR1AH, temp
00b430 9250 0088         sts	OCR1AL, zero
00b432 9250 0085         sts	TCNT1H, zero
00b434 9250 0084         sts	TCNT1L, zero
00b436 9ab1              sbi	TIFR1, OCF1A  		; clear oc1a flag
00b437 e055              ldi     temp, (1<<CS12)|(1<<CS10)  	; fclk/1024 
00b438 9350 0081         sts     TCCR1B, temp 		; start timer
                 ;        pop	temp
                 
                 	; commands that work with chip
00b43a 935f
00b43b e157
00b43c b955
00b43d eb5f
00b43e b954
00b43f e050
00b440 bd5d
00b441 e550
00b442 bd5c
00b443 9859
00b444 915f              SPI_INIT SPI_SLAVE_CLR, SPI_FCK_DIV_4
00b445 982c      	SPI_SELECT
                 
                 _clr_wait_rtr_0:
00b446 9b1e      	sbis	PINB, PB6
00b447 c004      	rjmp	_clr_rtr_0	; MISO is low
00b448 99b1      	sbic    TIFR1, OCF1A      	
00b449 940c b46a 	jmp	_CLR_CMD_EXEC_err	; check timeout, return if no response
00b44b cffa      	rjmp	_clr_wait_rtr_0
                 _clr_rtr_0:
                 
00b44c 2f56              mov	temp, zzC	; byte to send
                 ;        FAST_SPI		; embedded SPI
                 ;        nop
                 ;	nop
                 ;	nop
                 ;	nop        
                 ;	nop
                 ;	nop        
                 ;	nop
                 ;	nop        
00b44d 940e 005f         call	DOSPI		; temp contains data to send
                 
00b44f 935f      	push	temp
00b450 e154
00b451 955a
00b452 f7f1      	delay3	60
00b453 915f      	pop	temp		; delay for the CLR to stop SPI
                 
                 _CLR_CMD_ret:
00b454 bc5c
00b455 9a59
00b456 b854              SPI_STOP
                 
                 _clr_wait_rtr_1:		; wait MISO line release
00b457 991e      	sbic	PINB, PB6
00b458 c004      	rjmp	_clr_rtr_1	; MISO is low
00b459 99b1      	sbic    TIFR1, OCF1A      	
00b45a 940c b46a 	jmp	_CLR_CMD_EXEC_err	; check timeout, return if no response
00b45c cffa      	rjmp	_clr_wait_rtr_1
                 _clr_rtr_1:
                 
00b45d 3050              cpi	temp, 0		; Busy?
00b45e f429              brne	_CLR_CMD_end	
                 
00b45f ef5a
00b460 955a
00b461 f7f1      	delay3	750             ; delay for the CLR to complete request
00b462 2f56      	mov	temp, zzC	; restore byte to send
00b463 cfc9      	rjmp	_CLR_CMD_EXEC_DO	; repeat request
                 
                 _CLR_CMD_end:
00b464 9250 0081         sts     TCCR1B, zero 	; stop timer
00b466 9350 08fe 	sts	PCMD_FE, temp	; store response
00b468 916f      	pop	zzC
00b469 9508      	ret
                 
                 _CLR_CMD_EXEC_err:
00b46a 916f      	pop	zzC
                 
                 _CLR_CMD_err:	
00b46b bc5c
00b46c 9a59
00b46d b854              SPI_STOP
00b46e 940c 8101 	jmp	SPCMD_notfound
                 
                 
                 _CLR_DEFAULT:
00b470 e050              ldi	temp, 0
                 _CLR_PASSIVE:
00b471 935f      	push	temp
00b472 9150 3f05 	lds	temp, CRT_SETTINGS
00b474 7e5f      	cbr	temp, (1<<CRT_USE_CLR)	; clear active clr flag
00b475 9350 3f05 	sts	CRT_SETTINGS, temp
00b477 915f      	pop	temp
00b478 cfb2              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_SET_COLOR:
00b479 e051              ldi	temp, 1
00b47a 0f56              add	temp, zzC
00b47b cff5              rjmp	_CLR_PASSIVE
                 ;        rjmp	_CLR_CMD_EXEC
                 
                 _CLR_PATTERN:
00b47c e850      	ldi	temp, 0x80
00b47d 2b56      	or	temp, zzC
                 ;        ori	zzC, 0x80		; set bit 7
00b47e cfac              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_SET_X:
00b47f 3560      	cpi	zzC, 80
00b480 f750      	brsh	_CLR_CMD_err
00b481 e151              ldi	temp, 17
00b482 0f56              add	temp, zzC
00b483 cfa7              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_SET_Y:
00b484 3168      	cpi	zzC, 24
00b485 f728      	brsh	_CLR_CMD_err
00b486 e651              ldi	temp, 97
00b487 0f56              add	temp, zzC
00b488 cfa2              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_CLR_LINE:
00b489 e759              ldi	temp, 121
00b48a cfa0              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_CLR_SCR:
00b48b e75a              ldi	temp, 122
00b48c cf9e              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_SCROLL:
00b48d e75b              ldi	temp, 123
00b48e cf9c              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_PATTERN_MODE:
00b48f 9150 3f05 	lds	temp, CRT_SETTINGS
00b491 6150      	sbr	temp, (1<<CRT_USE_CLR)	; set active clr flag
00b492 9350 3f05 	sts	CRT_SETTINGS, temp
00b494 e75f              ldi	temp, 127
00b495 cf95              rjmp	_CLR_CMD_EXEC
                 
                 _CLR_RAW:
00b496 2f56              mov	temp, zzC
00b497 cf93              rjmp	_CLR_CMD_EXEC
                 CLR__END:
                 
                 ;HALT:	rjmp	HALT			; dummy STOP
                 
                 
                 ; --------------------- HW compatibility layer -------------------------------
                 
                 .ORG 0x0b500            ; 1 6a-..
                 HWC_START:
                 #include "hw_layer.inc"			; hw compatibility routines
                 
00b500 c05c      	rjmp	_HW_CONIN
                 HW_CONOUT_CHAR:
00b501 c064      	rjmp	_HW_CONOUT_CHAR
                 HW_CONOUT_SC:
00b502 c075      	rjmp	_HW_CONOUT_SC
                 HW_CONOUT_ESC:
00b503 c080      	rjmp	_HW_CONOUT_ESC
                 HW_PORTIN:
00b504 c091      	rjmp	_HW_PORTIN
                 HW_PORTOUT:
00b505 c099      	rjmp	_HW_PORTOUT
                 HW_LST:
00b506 c0a1      	rjmp	_HW_LST
                 HW_INIT:
00b507 c0a6      	rjmp	_HW_INIT
                 
                 .EQU	HW_DESCRIPTOR_SIZE = 24
                 HW_OPTIONS:
00b508 5243
00b509 5349
00b50a 2053
00b50b 5043
00b50c 4d2f
00b50d 5620
00b50e 2e33
00b50f 2078      	.DB	"CRISS CP/M V3.x "
00b510 5018
00b511 0000
00b512 0000
00b513 0000      	.DB	24, 80, 0, 0, 0, 0, 0, 0		; parameters: lines, chars, codepage, crt
00b514 4f52
00b515 4f42
00b516 5254
00b517 4e4f
00b518 3120
00b519 3137
00b51a 2035
00b51b 5552      	.DB	"ROBOTRON 1715 RU"
00b51c 5018
00b51d 0042
00b51e 0000
00b51f 0000      	.DB	24, 80, (1<<CRT_USE_ATTR)|2, 0, 0, 0, 0, 0		; parameters
00b520 4f52
00b521 4f42
00b522 5254
00b523 4e4f
00b524 3120
00b525 3137
00b526 2035
00b527 4e45      	.DB	"ROBOTRON 1715 EN"
00b528 5018
00b529 0043
00b52a 0000
00b52b 0000      	.DB	24, 80, (1<<CRT_USE_ATTR)|3, 0, 0, 0, 0, 0		; parameters
00b52c 414b
00b52d 5059
00b52e 4f52
00b52f 4320
00b530 2f50
00b531 204d
00b532 2020
00b533 2020      	.DB	"KAYPRO CP/M     "
00b534 5018
00b535 0003
00b536 0000
00b537 0000      	.DB	24, 80, 3, 0, 0, 0, 0, 0		; parameters
00b538 5254
00b539 2d53
00b53a 3038
00b53b 4320
00b53c 2f50
00b53d 204d
00b53e 2020
00b53f 2020      	.DB	"TRS-80 CP/M     "
00b540 5018
00b541 0003
00b542 0000
00b543 0000      	.DB	24, 80, 3, 0, 0, 0, 0, 0		; parameters
00b544 414b
00b545 5059
00b546 4f52
00b547 4320
00b548 2f50
00b549 204d
00b54a 6238
00b54b 7469      	.DB	"KAYPRO CP/M 8bit"
00b54c 5018
00b54d 0000
00b54e 0000
00b54f 0000      	.DB	24, 80, 0, 0, 0, 0, 0, 0		; parameters
00b550 5456
00b551 3031
00b552 2f30
00b553 4e41
00b554 4953
00b555 562f
00b556 3554
00b557 2032      	.DB	"VT100/ANSI/VT52 "
00b558 5018
00b559 0043
00b55a 0000
00b55b 0000      	.DB	24, 80, (1<<CRT_USE_ATTR)|3, 0, 0, 0, 0, 0		; parameters
00b55c 0000      	.DB	0,0
                 
                 
                 _HW_CONIN:
00b55d 9150 3f00 	lds	temp, HW_FLAG
                 ;	tcbe	0, HW0_CONIN
00b55f 3051
00b560 f409
00b561 c155      	tcbe	1, HW1_CONIN
00b562 3052
00b563 f409
00b564 c342      	tcbe	2, HW2_CONIN
                 ;	tcbe	3, HW0_CONIN
00b565 c050      	rjmp	HW0_CONIN
                 ;	ret
                 
                 _HW_CONOUT_CHAR:
00b566 9150 3f00 	lds	temp, HW_FLAG
                 ;	tcbe	0, HW0_CONOUT_CHAR
00b568 3051
00b569 f409
00b56a c22d      	tcbe	1, HW1_CONOUT_CHAR
00b56b 3052
00b56c f409
00b56d c22a      	tcbe	2, HW1_CONOUT_CHAR
00b56e 3053
00b56f f409
00b570 c353      	tcbe	3, HW3_CONOUT_CHAR
00b571 3054
00b572 f409
00b573 c398      	tcbe	4, HW4_CONOUT_CHAR
00b574 3056
00b575 f409
00b576 c397      	tcbe	6, HW6_CONOUT_CHAR	; ascii + lines + inv
                 ;HW_CONOUT_DEFAULT:
00b577 c041      	rjmp	HW0_CONOUT_CHAR
                 ;	ret
                 
                 _HW_CONOUT_SC:
00b578 9150 3f00 	lds	temp, HW_FLAG
                 ;	tcbe	0, HW0_CONOUT_SC
                 ;	tcbe	1, HW1_CONOUT_SC
                 ;	tcbe	2, HW1_CONOUT_SC
00b57a 3053
00b57b f409
00b57c c34e      	tcbe	3, HW3_CONOUT_SC
                 ;	tcbe	4, HW3_CONOUT_SC
00b57d 3055
00b57e f409
00b57f c34b      	tcbe	5, HW3_CONOUT_SC
00b580 3056
00b581 f409
00b582 c3c1      	tcbe	6, HW6_CONOUT_SC
                 ;_HW_CONOUT_SC_DEFAULT:
00b583 c039      	rjmp	HW0_CONOUT_SC
                 ;	ret
                 
                 _HW_CONOUT_ESC:
00b584 9150 3f00 	lds	temp, HW_FLAG
                 ;	tcbe	0, HW0_CONOUT_ESC
00b586 3051
00b587 f409
00b588 c260      	tcbe	1, HW1_CONOUT_ESC
00b589 3052
00b58a f409
00b58b c320      	tcbe	2, HW2_CONOUT_ESC
00b58c 3053
00b58d f409
00b58e c357      	tcbe	3, HW3_CONOUT_ESC
00b58f 3055
00b590 f409
00b591 c354      	tcbe	5, HW3_CONOUT_ESC
00b592 3056
00b593 f409
00b594 c3e1      	tcbe	6, HW6_CONOUT_ESC
00b595 c069      	rjmp	HW0_CONOUT_ESC
                 ;	ret
                 
                 _HW_PORTIN:
00b596 9150 3f00 	lds	temp, HW_FLAG
                 ;	tcbe	0, HW0_PORTIN
00b598 3051
00b599 f409
00b59a c26d      	tcbe	1, HW1_PORTIN
00b59b 3052
00b59c f409
00b59d c26a      	tcbe	2, HW1_PORTIN
00b59e c111      	rjmp	HW0_PORTIN
                 ;	ret
                 
                 _HW_PORTOUT:
00b59f 9150 3f00 	lds	temp, HW_FLAG
                 ;	tcbe	0, HW1_PORTOUT
00b5a1 3051
00b5a2 f409
00b5a3 c29e      	tcbe	1, HW1_PORTOUT
00b5a4 3052
00b5a5 f409
00b5a6 c29b      	tcbe	2, HW1_PORTOUT
00b5a7 c10b      	rjmp	HW0_PORTOUT
                 ;	ret
                 
                 _HW_LST:
00b5a8 9150 3f00 	lds	temp, HW_FLAG
00b5aa 3051
00b5ab f409
00b5ac c2f9      	tcbe	1, HW1_LST
                 ;	tcbe	2, HW1_LST
00b5ad c108      	rjmp	HW0_LST
                 ;	ret
                 
                 _HW_INIT:
00b5ae 9250 3776 	sts	HW_DATA, zero
00b5b0 9250 3777 	sts	HW_DATA+1, zero
00b5b2 9250 3778 	sts	HW_DATA+2, zero
00b5b4 9250 3779 	sts	HW_DATA+3, zero
                 ;	ret
                 
                 
                 .MACRO  HWREPLACE
                 	pushw	Z
                 	push	zzA
                 	ldi	ZH, high((@0)*2)
                 	ldi	ZL, low((@0)*2)
                 HWREPLACE_l0:
                 	elpm	zzA, Z+
                 	cpi	zzA, 0
                 	breq	HWREPLACE_notfound	
                 	cp	zzA, temp
                 	breq	HWREPLACE_found
                 	adiw 	Z, 1
                 	rjmp	HWREPLACE_l0
                 HWREPLACE_found:
                 	elpm	temp, Z
                 	rjmp	HWREPLACE_end
                 HWREPLACE_notfound:
                 	pop	zzA
                 	push	zzA
                 	mov	temp, @1
                 HWREPLACE_end:
                 	pop	zzA
                 	popw	Z
                 .ENDM
                 
                 #include "hw_0_criss.inc"		; CRISS
                 
00b5b6 940e b6d3         call	HW1_CONIN_DO			; same as for Robotron 1715, but no decode
00b5b8 9508      	ret
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW0_CONOUT_CHAR:
                 ;	mov	temp, zzC
00b5b9 3f6f      	cpi	zzC, 0xff
00b5ba f409      	brne	HW0_CONOUT_CHAR_ret
00b5bb e76f      	ldi	zzC, 0x7f
                 HW0_CONOUT_CHAR_ret:
00b5bc 9508      	ret
                 
                 
                 
                 
                 
                 HW0_CONOUT_SC:
00b5bd 2f56      	mov	temp, zzC
                 
00b5be 305d
00b5bf f411
00b5c0 940c 76fa 	tcbel	0x0d, BIOS_L04_ENTER		; Enter
00b5c2 305a
00b5c3 f411
00b5c4 940c 76fd 	tcbel	0x0a, BIOS_L04_CR		; CR
00b5c6 3058
00b5c7 f411
00b5c8 940c 771a 	tcbel	0x08, BIOS_L04_BSP		; LEFT
00b5ca 305c
00b5cb f411
00b5cc 940c 7723 	tcbel	0x0c, BIOS_L04_CLRSCR		; CLRSCR
00b5ce 3059
00b5cf f411
00b5d0 940c 7898 	tcbel	0x09, BIOS_L04_TAB		; TAB
00b5d2 3051
00b5d3 f411
00b5d4 940c 772d 	tcbel	0x01, BIOS_L04_HOME		; HOME
00b5d6 3057
00b5d7 f411
00b5d8 940c 7733 	tcbel	0x07, BIOS_L04_BEEP		; BEEP
00b5da 3155
00b5db f411
00b5dc 940c 7736 	tcbel	0x15, BIOS_L04_RIGHT		; RIGHT
00b5de 315a
00b5df f411
00b5e0 940c 7743 	tcbel	0x1a, BIOS_L04_UP		; UP
00b5e2 3158
00b5e3 f411
00b5e4 940c 774c 	tcbel	0x18, BIOS_L04_CLRLN		; CLRLN
00b5e6 3154
00b5e7 f411
00b5e8 940c 7750 	tcbel	0x14, BIOS_L04_CLRCUR		; CLRCUR
00b5ea 3156
00b5eb f411
00b5ec 940c 77a1 	tcbel	0x16, BIOS_L04_CLREOL		; CLREOL
                 
00b5ee 305e
00b5ef f411
00b5f0 940c 7c48 	tcbel	0x0e, BIOS_L04_SCRLOFF		; SCROLL OFF
00b5f2 305f
00b5f3 f411
00b5f4 940c 7c4e 	tcbel	0x0f, BIOS_L04_SCRLON		; SCROLL ON
                 
00b5f6 315e
00b5f7 f411
00b5f8 940c 78a1 	tcbel	0x1e, BIOS_L04_CUROFF		; CURSOR OFF
00b5fa 315f
00b5fb f411
00b5fc 940c 78a7 	tcbel	0x1f, BIOS_L04_CURON		; CURSOR ON
                 
                 HW0_CONOUT_SC_RET:
00b5fe 9508      	ret
                 
                 
                 
                 
                 
                 HW0_CONOUT_ESC:
00b5ff 9170 091d 	lds	FROMRAM0, CON_ESC_C1		; getting main command
00b601 2755      	clr	temp				; return 0 if processed
                 
00b602 3022      	cpi	FROMRAM2, 2			; FROMRAM2 = number of 
00b603 f511      	brne	HW0_CONOUT_ESC_3
                 
00b604 2722      	clr	FROMRAM2
00b605 3370
00b606 f411
00b607 940c 78a1 	tcbel0	'0', BIOS_L04_CUROFF
00b609 3371
00b60a f411
00b60b 940c 78a7 	tcbel0	'1', BIOS_L04_CURON
00b60d 367a
00b60e f411
00b60f 940c 7723 	tcbel0	'j', BIOS_L04_CLRSCR
00b611 3478
00b612 f411
00b613 940c 772d 	tcbel0	'H', BIOS_L04_HOME
00b615 347a
00b616 f411
00b617 940c 7750 	tcbel0	'J', BIOS_L04_CLRCUR
00b619 347b
00b61a f411
00b61b 940c 77a1 	tcbel0	'K', BIOS_L04_CLREOL
00b61d 3572
00b61e f411
00b61f 940c 7a1d 	tcbel0	'R', BIOS_ESC_KAYPRO_R		; delete line - error in manual
00b621 3475
00b622 f411
00b623 940c 79b1 	tcbel0	'E', BIOS_ESC_KAYPRO_E		; insert line - error in manual
00b625 c088      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW0_CONOUT_ESC_3:	
00b626 3023      	cpi	FROMRAM2, 3
00b627 f5f9      	brne	HW0_CONOUT_ESC_4
                 
00b628 2722      	clr	FROMRAM2
00b629 3472
00b62a f411
00b62b 940c 795a 	tcbel0	'B', BIOS04_ESC_KAYPRO_B	; 4/6/S
                 ;	tcbel0	'B', BIOS04_ESC_KAYPRO_B
00b62d 3473
00b62e f411
00b62f 940c 796e 	tcbel0	'C', BIOS04_ESC_KAYPRO_C	; 4/6/S
00b631 3079
00b632 f411
00b633 940c 7982 	tcbel0	 9 , BIOS04_ESC_CRISS_09	; set x position
00b635 357e
00b636 f411
00b637 940c b6af 	tcbel0	'^', HW0_CONOUT_ESC_exit	; ignore
00b639 357f
00b63a f411
00b63b 940c b6af 	tcbel0	'_', HW0_CONOUT_ESC_exit	; ignore
00b63d 357a
00b63e f411
00b63f 940c 7a8b 	tcbel0	'Z', BIOS04_ESC_CRISS_ZG	; select lines and char set
00b641 3477
00b642 f411
00b643 940c 7aa1 	tcbel0	'G', BIOS04_ESC_TRS_GRMODE	; set screen mode
00b645 357c
00b646 f411
00b647 940c 798d 	tcbel0	92,  BIOS04_ESC_CRISS_OUT	; '\' - output char as is for #1..#30
00b649 377c
00b64a f411
00b64b 940c 7ecc 	tcbel0	'|', BIOS04_ESC_CRISS_VGA_OUT	; '|' - direct output char to screen not to VRAM
00b64d 367b
00b64e f411
00b64f 940c 7c5c 	tcbel0	'k', BIOS04_ESC_CRISS_SET_CON	; 'k' # - send char to CON input
00b651 3777
00b652 f411
00b653 940c 7cff 	tcbel0	'w', BIOS04_ESC_CRISS_WIN_CTRLS	; clear/fill/scroll window
00b655 367d
00b656 f411
00b657 940c 7e1f 	tcbel0	'm', BIOS04_ESC_CRISS_MELODY	; plays music #1 #2 .. #n 0x04 CMD
00b659 3771
00b65a f411
00b65b 940c 7e44 	tcbel0	'q', BIOS04_ESC_CRISS_CLR_RAW	; CLR raw command
00b65d 3772
00b65e f411
00b65f 940c 7e57 	tcbel0	'r', BIOS04_ESC_CRISS_CLR_CMD	; CLR Clrscr, clrLn, Scroll
                 HW0_CONOUT_ESC_3_RB_XY:
00b661 3870      	cpi	FROMRAM0, 0x80
00b662 f408      	brsh	HW0_CONOUT_ESC_3_l0
00b663 c04a      	rjmp	HW0_CONOUT_ESC_ret		; HW0_CONOUT_ESC_3_ret
                 HW0_CONOUT_ESC_3_l0:
00b664 940e 798f 	call	BIOS04_ESC_ROB_CUR
00b666 c045      	rjmp	HW0_CONOUT_ESC_stop
                 
                 HW0_CONOUT_ESC_4:	
00b667 3024      	cpi	FROMRAM2, 4
00b668 f531      	brne	HW0_CONOUT_ESC_5
                 
00b669 2722      	clr	FROMRAM2
00b66a 337d
00b66b f411
00b66c 940c 79a7 	tcbel0	'=', BIOS04_ESC_KAYPRO_CUR
00b66e 3579
00b66f f411
00b670 940c 79ac 	tcbel0	'Y', BIOS04_ESC_TRS_CUR
00b672 3779
00b673 f411
00b674 940c 7df9 	tcbel0	'y', BIOS04_ESC_CRISS_CUR_WIN	; cursor relative to output window
00b676 327a
00b677 f411
00b678 940c 7b69 	tcbel0	'*', BIOS04_ESC_KAYPRO_PUTPIX
00b67a 3270
00b67b f411
00b67c 940c 7b73 	tcbel0	' ', BIOS04_ESC_KAYPRO_CLRPIX
00b67e 3273
00b67f f411
00b680 940c 7b7e 	tcbel0	'#', BIOS04_ESC_CRISS_TGLPIX
00b682 3573
00b683 f411
00b684 940c 7b88 	tcbel0	'S', BIOS04_ESC_CRISS_SWP	; ??? no code
00b686 3677
00b687 f411
00b688 940c 7c58 	tcbel0	'g', BIOS04_ESC_CRISS_GPIO	; output char to GPIO
00b68a 3773
00b68b f411
00b68c 940c 7e8e 	tcbel0	's', BIOS04_ESC_CRISS_CLR_OUT	; CLR output colored
00b68e c01f      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW0_CONOUT_ESC_5:	
00b68f 3025      	cpi	FROMRAM2, 5
00b690 f411      	brne	HW0_CONOUT_ESC_6
                 
00b691 2722      	clr	FROMRAM2
                 ;	tcbel0	'f', BIOS04_ESC_CRISS_F
                 ;	tcbel0	'F', BIOS04_ESC_CRISS_DF
                 ;	tcbel0	'V', BIOS04_ESC_CRISS_VP
                 ;	tcbel0	'e', BIOS04_ESC_CRISS_CLR
00b692 c01b      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW0_CONOUT_ESC_6:
00b693 3026      	cpi	FROMRAM2, 6
00b694 f4b1      	brne	HW0_CONOUT_ESC_7
                 
00b695 2722      	clr	FROMRAM2
00b696 3673
00b697 f411
00b698 940c 7c13 	tcbel0	'c', BIOS04_ESC_CRISS_CIRCLE
00b69a 347c
00b69b f411
00b69c 940c 7b8a 	tcbel0	'L', BIOS04_ESC_KAYPRO_PUTLN
00b69e 3474
00b69f f411
00b6a0 940c 7b8a 	tcbel0	'D', BIOS04_ESC_KAYPRO_CLRLN
00b6a2 3778
00b6a3 f411
00b6a4 940c 7b8a 	tcbel0	'x', BIOS04_ESC_CRISS_INVLN
00b6a6 3577
00b6a7 f411
00b6a8 940c 7cb5 	tcbel0	'W', BIOS04_ESC_CRISS_WIN	; set output limits
00b6aa c003      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW0_CONOUT_ESC_7:
00b6ab c000      	rjmp	HW0_CONOUT_ESC_stop		; too long seq, no match = consider as error, stop processing
                 
                 HW0_CONOUT_ESC_stop:
00b6ac 2722      	clr	FROMRAM2
00b6ad 9508      	ret
                 ;	rjmp	HW0_CONOUT_ESC_exit
                 HW0_CONOUT_ESC_ret:
00b6ae 2d21      	mov	FROMRAM2, FROMRAM1		; restore - proceed with input
                 HW0_CONOUT_ESC_exit:
00b6af 9508      	ret
                 
                 
                 
                 HW0_PORTIN:
00b6b0 940e b808 	call	HW1_PORTIN	; Ports from Robotron 1715
00b6b2 9508      	ret
                 
                 
                 HW0_PORTOUT:
00b6b3 940e b842 	call	HW1_PORTOUT	; Ports from Robotron 1715
00b6b5 9508      	ret
                 
                 
                 HW0_LST:
00b6b6 9508      	ret
                 #include "hw_1_r1715.inc"		; Robotron 1715
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW1_CONIN:
                 
00b6b7 311e      	cpi	zzA, 0x1E	; NUMLOCK
00b6b8 f461      	brne	hw1_conin_process
00b6b9 940e 8960 	call	SYSTEM_BEEP
00b6bb 937f      	push	FROMRAM0
00b6bc 9150 0927 	lds	temp, CON_ATTR_XOR
00b6be e074      	ldi	FROMRAM0, (1<<CRT_ATTR_S0)
00b6bf 2757      	eor	temp, FROMRAM0
00b6c0 9350 0927 	sts	CON_ATTR_XOR, temp
00b6c2 917f      	pop	FROMRAM0	
                 ;	ldi	temp, BIOS_FUNC_REFRESH_HW
                 ;	call	BIOS		; refresh screen
00b6c3 2711      	clr	zzA		; disabled key, no response
00b6c4 9508      	ret
                 
                 hw1_conin_process:
                 ;	cpi	zzA, 0x60	; decode Russian symbols
                 ;	lds	temp, CON_ATTR_XOR
                 ;	sbrc	temp, CRT_ATTR_S0
                 ;	rjmp	HW1_CONIN_S1
                 	
                 ;HW1_CONIN_S0:
00b6c5 371f      	cpi	zzA, 0x7F	; BackSpace
00b6c6 f061      	breq	HW1_CONIN_DO
                 
00b6c7 3610      	cpi	zzA, 0x60	; decode Russian symbols
00b6c8 f050      	brlo	HW1_CONIN_DO
00b6c9 3810      	cpi	zzA, 0x80
00b6ca f038      	brlo	HW1_CONIN_l1
                 
00b6cb eee8
00b6cc e6fd      	ldiw2	Z, HW1_CONIN_DECODER
00b6cd 5810      	subi	zzA, 0x80
                 ;	ldiw2	Z, HW1_CONIN_DECODER
                 ;	subi	zzA, 0x80
                 ;	add	ZL, zzA
                 ;	adc	ZH, zero
                 ;	elpm	zzA, Z		; decoded symbol
                 ;	call	HW1_CONIN_DECODE
                 ;	rjmp	HW1_CONIN_DO
00b6ce c000      	rjmp	HW1_DECODE_AND_DO
                 
                 ;HW1_CONIN_S1:
                 ;	cpi	zzA, 0x41
                 ;	brlo	HW1_CONIN_DO
                 ;	cpi	zzA, 0x80
                 ;	brsh	HW1_CONIN_S1_L2
                 
                 ;	ldiw2	Z, HW1_CONIN_S1_DECODER_L
                 ;	subi	zzA, 0x40
                 ;	rjmp	HW1_DECODE_AND_DO
                 
                 ;HW1_CONIN_S1_L2:
                 ;	ldiw2	Z, HW1_CONIN_S1_DECODER_R
                 ;	subi	zzA, 0x80
                 
                 HW1_DECODE_AND_DO:
00b6cf 940e b6f0 	call	HW1_CONIN_DECODE
00b6d1 c001      	rjmp	HW1_CONIN_DO
                 			
                 
                 HW1_CONIN_l1:
00b6d2 5210      	subi	zzA, 0x20	; lowcase to uppercase
                 
                 HW1_CONIN_DO:
00b6d3 e054
00b6d4 940e 720c 	nportin cpd_kactk	; key scancode
00b6d6 93ff
00b6d7 93ef
00b6d8 931f
00b6d9 e6ff
00b6da e2e8
00b6db 9117
00b6dc 3010
00b6dd f031
00b6de 1715
00b6df f011
00b6e0 9631
00b6e1 cff9
00b6e2 9156
00b6e3 c003
00b6e4 911f
00b6e5 931f
00b6e6 2f51
00b6e7 911f
00b6e8 91ef
00b6e9 91ff      	HWREPLACE R1715scancodes2, zzA
                 
00b6ea 2ec5      	mov	zzD, temp       ; scancode
                 
00b6eb ee50      	ldi	temp, 0xe0	; 1 1 1 ? CAPS/LOCK S0/S1 SHIFT CTRL
00b6ec 2ed5      	mov	zzE, temp	; status code
                 
00b6ed 2ca5      	mov	zzB, zero
00b6ee 2d6c      	mov	zzC, zzD
00b6ef 9508      	ret
                 
                 HW1_CONIN_DECODE:
00b6f0 0fe1      	add	ZL, zzA
00b6f1 1df5      	adc	ZH, zero
00b6f2 9116      	elpm	zzA, Z		; decoded symbol
00b6f3 9508      	ret
                 
                 HW1_CONIN_DECODER:
00b6f4 6261
00b6f5 6777
00b6f6 6564
00b6f7 7a76
00b6f8 6a69
00b6f9 6c6b
00b6fa 6e6d
00b6fb 706f      	.DB	'a', 'b', 'w', 'g', 'd', 'e', 'v', 'z', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p'
00b6fc 7372
00b6fd 7574
00b6fe 6866
00b6ff 7e63
00b700 7d7b
00b701 7978
00b702 7c78
00b703 7160      	.DB	'r', 's', 't', 'u', 'f', 'h', 'c', '~', '{', '}', 'x', 'y', 'x', '|', '`', 'q'
00b704 6261
00b705 6777
00b706 6564
00b707 7a76
00b708 6a69
00b709 6c6b
00b70a 6e6d
00b70b 706f      	.DB	'a', 'b', 'w', 'g', 'd', 'e', 'v', 'z', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p'
00b70c 2020
00b70d 2020
00b70e 2020
00b70f 2020
00b710 2020
00b711 2020
00b712 2020
00b713 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b714 2020
00b715 2020
00b716 2020
00b717 2020
00b718 2020
00b719 2020
00b71a 2020
00b71b 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b71c 2020
00b71d 2020
00b71e 2020
00b71f 2020
00b720 2020
00b721 2020
00b722 2020
00b723 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b724 7372
00b725 7574
00b726 6866
00b727 7e63
00b728 7d7b
00b729 7978
00b72a 7c78
00b72b 7160      	.DB	'r', 's', 't', 'u', 'f', 'h', 'c', '~', '{', '}', 'x', 'y', 'x', '|', '`', 'q'
00b72c 2020
00b72d 2020
00b72e 2020
00b72f 2020
00b730 2020
00b731 2020
00b732 2020
00b733 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
                 
                 HW1_CONIN_S1_DECODER_R:
00b734 6261
00b735 6777
00b736 6564
00b737 7a76
00b738 6a69
00b739 6c6b
00b73a 6e6d
00b73b 706f      	.DB	'a', 'b', 'w', 'g', 'd', 'e', 'v', 'z', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p'
00b73c 7372
00b73d 7574
00b73e 6866
00b73f 7e63
00b740 5d5b
00b741 7978
00b742 7c78
00b743 7160      	.DB	'r', 's', 't', 'u', 'f', 'h', 'c', '~', '[', ']', 'x', 'y', 'x', '|', '`', 'q'
00b744 4241
00b745 4757
00b746 4544
00b747 5a56
00b748 4a49
00b749 4c4b
00b74a 4e4d
00b74b 504f      	.DB	'A', 'B', 'W', 'G', 'D', 'E', 'V', 'Z', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'
00b74c 2020
00b74d 2020
00b74e 2020
00b74f 2020
00b750 2020
00b751 2020
00b752 2020
00b753 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b754 2020
00b755 2020
00b756 2020
00b757 2020
00b758 2020
00b759 2020
00b75a 2020
00b75b 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b75c 2020
00b75d 2020
00b75e 2020
00b75f 2020
00b760 2020
00b761 2020
00b762 2020
00b763 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b764 5352
00b765 5554
00b766 4846
00b767 5e43
00b768 7d7b
00b769 5958
00b76a 5c58
00b76b 5140      	.DB	'R', 'S', 'T', 'U', 'F', 'H', 'C', '^', '{', '}', 'X', 'Y', 'X',  92, '@', 'Q'
00b76c 2020
00b76d 2020
00b76e 2020
00b76f 2020
00b770 2020
00b771 2020
00b772 2020
00b773 2020      	.DB	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
                 
                 HW1_CONIN_S1_DECODER_L:
00b774 6640
00b775 7369
00b776 7977
00b777 7061
00b778 5b72
00b779 6c6f
00b77a 7864
00b77b 5d74      	.DB	'@', 'f', 'i', 's', 'w', 'y', 'a', 'p', 'r', '[', 'o', 'l', 'd', 'x', 't', ']'
00b77c 6a7a
00b77d 796b
00b77e 6765
00b77f 636d
00b780 6e7e
00b781 6871
00b782 7c7c
00b783 5f78      	.DB	'z', 'j', 'k', 'y', 'e', 'g', 'm', 'c', '~', 'n', 'q', 'h', '|', '|', 'x', '_'
00b784 4660
00b785 5349
00b786 5957
00b787 5041
00b788 7b52
00b789 4c4f
00b78a 5844
00b78b 7d54      	.DB	'`', 'F', 'I', 'S', 'W', 'Y', 'A', 'P', 'R', '{', 'O', 'L', 'D', 'X', 'T', '}'
00b78c 4a5a
00b78d 594b
00b78e 4745
00b78f 434d
00b790 4e5e
00b791 4851
00b792 7c7c
00b793 5f58      	.DB	'Z', 'J', 'K', 'Y', 'E', 'G', 'M', 'C', '^', 'N', 'Q', 'H', '|', '|', 'X', '_'
                 
                 R1715scancodes2:
00b794 800d      	.DB	0x0d, 0x80	;TAB
00b795 7f66      	.DB	0x66, 0x7f	;DEL
00b796 9e5a      	.DB	0x5a, 0x9e	;Enter
00b797 0000      	.DB	0, 0
                 
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW1_CONOUT_CHAR:
00b798 3860      	cpi	zzC, 0x80			; Robotron works with chars 32-127 only
00b799 f470      	brsh	HW1_CONOUT_CHAR_80
                 
                 HW1_CONOUT_CHAR_DO:
00b79a 937f      	push	FROMRAM0
                 ;	clr	temp
00b79b ef5b      	ldi	temp, BIOS_FUNC_ECON_ATTR_GET
00b79c 940e 7200 	call	BIOS				; ECON_GET_ATTR			; read attr value (temp)
00b79e 9170 0927 	lds	FROMRAM0, CON_ATTR_XOR		; default charset s0/s1
                 ;	lds	temp, CON_ESC_C5		; attribute
00b7a0 2757      	eor	temp, FROMRAM0
00b7a1 fd52      	sbrc	temp, CRT_ATTR_S0		; alternative znakogen table?
00b7a2 940e b7df 	call	HW1_TRANSLATE_S1		; s1 russian charset
00b7a4 fd54      	sbrc	temp, CRT_ATTR_REV		; inverse?
00b7a5 6860      	ori	zzC, 0x80			; select inverse chars
00b7a6 917f      	pop	FROMRAM0
00b7a7 c021      	rjmp	HW1_CONOUT_CHAR_exit
                 	
                 HW1_CONOUT_CHAR_80:
00b7a8 2f56      	mov	temp, zzC
00b7a9 e060      	ldi	zzC, 0	 			; ret from tcbe will return temp=0
00b7aa 3853
00b7ab f411
00b7ac 940c 78a1 	tcbel	0x83, BIOS_L04_CUROFF		; CURSOR OFF
00b7ae 3852
00b7af f411
00b7b0 940c 78a7 	tcbel	0x82, BIOS_L04_CURON		; CURSOR ON
00b7b2 3854
00b7b3 f409
00b7b4 c016      	tcbe	0x84, HW1_CHAR_84		; attr
00b7b5 3855
00b7b6 f409
00b7b7 c015      	tcbe	0x85, HW1_CHAR_85		; 
00b7b8 3856
00b7b9 f409
00b7ba c014      	tcbe	0x86, HW1_CHAR_86		; 
00b7bb 3857
00b7bc f409
00b7bd c013      	tcbe	0x87, HW1_CHAR_87		; 
00b7be 3950
00b7bf f409
00b7c0 c017      	tcbe	0x90, HW1_CHAR_90		; s0
00b7c1 3951
00b7c2 f409
00b7c3 c017      	tcbe	0x91, HW1_CHAR_91		; s1
00b7c4 3f5f      	cpi	temp, 0xff
00b7c5 f411      	brne	HW1_CONOUT_CHAR_empty
00b7c6 e76f      	ldi	zzC, 0x7f
00b7c7 c001      	rjmp	HW1_CONOUT_CHAR_exit
                 HW1_CONOUT_CHAR_empty:
00b7c8 e260      	ldi	zzC, ' '			; ignore all char > 0x80 and replace with 0
                 ;	ldi	zzC, ':'			;!!!! debug!!!!!!
                 HW1_CONOUT_CHAR_exit:
00b7c9 2f56      	mov	temp, zzC
                 HW1_CONOUT_CHAR_ret:
00b7ca 9508       	ret
                 
                 
                 HW1_CHAR_84:
00b7cb e460      	ldi	zzC, 0x40
00b7cc c006      	rjmp	HW1_ATTRIBUTE2
                 HW1_CHAR_85:
00b7cd e560      	ldi	zzC, 0x50
00b7ce c004      	rjmp	HW1_ATTRIBUTE2
                 HW1_CHAR_86:
00b7cf e461      	ldi	zzC, 0x41
00b7d0 c002      	rjmp	HW1_ATTRIBUTE2
                 HW1_CHAR_87:
00b7d1 e561      	ldi	zzC, 0x51
00b7d2 c000      	rjmp	HW1_ATTRIBUTE2
                 
                 HW1_ATTRIBUTE2:
00b7d3 ef5a      	ldi	temp, BIOS_FUNC_CRT_ATTR	; put screen attribute
00b7d4 940e 7200 	call	BIOS
00b7d6 2766      	clr	zzC
00b7d7 9508      	ret
                 
                 
                 ; set default 	;s0
                 HW1_CHAR_90:
00b7d8 9250 0927 	sts	CON_ATTR_XOR, zero
00b7da cfee      	rjmp	HW1_CONOUT_CHAR_exit
                 HW1_CHAR_91:	; s1
00b7db e054      	ldi	temp, (1<<CRT_ATTR_S0)
00b7dc 9350 0927 	sts	CON_ATTR_XOR, temp
00b7de cfea      	rjmp	HW1_CONOUT_CHAR_exit
                 
                 
                 HW1_TRANSLATE_S1:
00b7df 3460      	cpi	zzC, 0x40
00b7e0 f031      	breq	_hw1_s1_40
00b7e1 3461      	cpi	zzC, 0x41
00b7e2 f018      	brlo	_hw1_s1_ret
00b7e3 3660      	cpi	zzC, 0x5F+1
00b7e4 f408      	brsh	_hw1_s1_ret
00b7e5 5460      	subi	zzC, 0x40			; lowrcase russian characters
                 _hw1_s1_ret:
00b7e6 9508      	ret
                 _hw1_s1_40: 
00b7e7 e16f      	ldi	zzC, 0x1f
00b7e8 9508      	ret
                 
                 ; --------------------------------------------------------------------------------------------------
                 ;HW1_CONOUT_SC:
                 ;	mov	temp, zzC
                  ;
                 ;	tcbel	0x0d, BIOS_L04_ENTER		; Enter
                 ;	tcbel	0x0a, HW1_BIOS_L04_CR		; CR
                 ;	tcbel	0x08, BIOS_L04_BSP		; BSP
                 ;	tcbel	0x0c, HW1_BIOS_L04_CLRSCR	; CLRSCR
                 ;	tcbel	0x09, BIOS_L04_TAB		; TAB
                 ;	tcbel	0x01, BIOS_L04_HOME		; HOME
                 ;	tcbel	0x07, BIOS_L04_BEEP		; BEEP
                 ;	tcbel	0x15, BIOS_L04_RIGHT		; RIGHT
                 ;	tcbel	0x1a, BIOS_L04_UP		; UP
                 ;	tcbel	0x18, BIOS_L04_CLRLN		; CLRLN
                 ;	tcbel	0x14, BIOS_L04_CLRCUR		; CLRCUR
                 ;	tcbel	0x16, BIOS_L04_CLREOL		; CLREOL
                  ;
                 ;HW1_CONOUT_SC_RET:
                 ;        jmp	HW0_CONOUT_SC
                 ;	ret
                 
                 ;HW1_BIOS_L04_CLRSCR:
                 ;	call	BIOS_RESET_2			; clear attr screen
                 ;	rjmp	HW1_CONOUT_SC_RET
                 
                 ;HW1_BIOS_L04_CR:
                 ;	cpmemmem CURSOR_Y, CRT_LINES
                 ;	brlo	HW1_CONOUT_SC_RET
                 ;	call	ECON_ATTR_SCROLL
                 ;	rjmp	HW1_CONOUT_SC_RET
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW1_CONOUT_ESC:
00b7e9 3023      	cpi	FROMRAM2, 3
00b7ea f009      	breq	HW1_CONOUT_ESC_3		; just for the case
00b7eb 9508      	ret					; proceed otherwise
                 ;	rjmp	HW0_CONOUT_ESC
                 
                 HW1_CONOUT_ESC_3:
00b7ec 9170 091d 	lds	FROMRAM0, CON_ESC_C1		; get main command
                 
00b7ee 357e      	cpi	FROMRAM0, 0x5E
00b7ef f081      	breq	HW1_ATTRIBUTE			; set attribute
00b7f0 357f      	cpi	FROMRAM0, 0x5F
00b7f1 f049      	breq	HW1_FRAMES			; empty char
                 
00b7f2 367e      	cpi	FROMRAM0, 0x6E
00b7f3 f081      	breq	HW1_ATTRIBUTE_HIDDEN		; set attribute, no echo
                 
00b7f4 940e 798f 	call	BIOS04_ESC_ROB_CUR		; otherwise
                 
                 HW1_CONOUT_ESC_ret:
00b7f6 9250 091c 	sts	CON_ESC, zero
00b7f8 2722      	clr	FROMRAM2
00b7f9 9508      	ret
                 
00b7fa ce04      	rjmp	HW0_CONOUT_ESC
                 
                 ;	cpi	FROMRAM0, 0x80
                 ;	brlo	HW1_CONOUT_ESC_clr		; ignore attribute set commands
                 
                 ;	call	BIOS04_ESC_ROB_CUR		; cursor pos command
                 
                 ;HW1_CONOUT_ESC_clr:
                 ;	clr	FROMRAM1			; stop processing
                 ;HW1_CONOUT_ESC_ret:
                 ;	mov	FROMRAM2, FROMRAM1		; restore - proceed with input
                 ;HW1_CONOUT_ESC_exit:
                 ;	ret
                 
                 
                 HW1_FRAMES:
00b7fb e26b      	ldi	zzC, '+'
00b7fc e054      	ldi	temp, BIOS_FUNC_CONOUT
00b7fd 940e 7200 	call	BIOS
00b7ff cff6      	rjmp	HW1_CONOUT_ESC_ret 
                 
                 HW1_ATTRIBUTE:
00b800 ef5a      	ldi	temp, BIOS_FUNC_CRT_ATTR	; put screen attribute
00b801 940e 7200 	call	BIOS
00b803 cff2      	rjmp	HW1_CONOUT_ESC_ret 
                 
                 ;	ldi	temp, BIOS_FUNC_ECON_ATTR_SET
                 ;	call	BIOS				;ECON_SET_ATTR			; store attribute
                 ;	ldi	zzC, ':'			;!!!! debug!!!!!!
                 ;	ldi	temp, 0xfd
                 ;	call	BIOS				; echo space 
                 ;	sts	CON_ESC_C5, zzC			; store attribute
                 ;	ldi	zzC, ' '			;!!!! debug - decode in future
                 ;HW1_ATTRIBUTE_FILL:
                 ;	ldi	zzC, '+'			;!!!! debug!!!!!!
                 ;	ldi	temp, BIOS_FUNC_CRT_CHAR
                 ;	call	BIOS				; echo space 
                 ;	call	BIOS_L04_CHAR_L1		; echo space
                 ;HW1_ATTRIBUTE_EXIT:
                 ;	sts	CON_ESC, zero
                 ;	clr	FROMRAM2
                 ;	ret
                 
                 HW1_ATTRIBUTE_HIDDEN:
00b804 ef5c      	ldi	temp, BIOS_FUNC_ECON_ATTR_SET
00b805 940e 7200 	call	BIOS				;ECON_SET_ATTR			; store attribute
00b807 cfee      	rjmp	HW1_CONOUT_ESC_ret
                 ;	sts	CON_ESC_C5, zzC			; store attribute
                 ;	sts	CON_ESC, zero
                 ;	clr	FROMRAM2
                 ;	ret
                 
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW1_PORTIN:
00b808 9150 0910         lds	temp, CDATA+2		; port requested
00b80a 305c
00b80b f411
00b80c 940c b80f 	tcbel	0x0c, HW1_PORTIN_0C	; port 12 - keyboard controller
00b80e 9508      	ret
                 
                 HW1_PORTIN_0C:
00b80f e054
00b810 940e 720c 	nportin cpd_kactk	; key scancode
                 ;	HWREPLACE R1715scancodes, zero
00b812 93ff
00b813 93ef
00b814 931f
00b815 e7f0
00b816 e4ee
00b817 9117
00b818 3010
00b819 f031
00b81a 1715
00b81b f011
00b81c 9631
00b81d cff9
00b81e 9156
00b81f c003
00b820 911f
00b821 931f
00b822 2f51
00b823 911f
00b824 91ef
00b825 91ff      	HWREPLACE R1715scancodes, zzA
                 ;	cpse	temp, zero
00b826 9508      	ret
                 ;	mov	temp, zzA		; return key code otherwise
                 ;	lds	temp, CON_LAST_CHAR	; return key code otherwise
                 ;	ret
                 ; robotron 1715 replacements ; scan-codes:
                 R1715scancodes:
00b827 d105      	.DB	0x05, 0xd1	;f1
00b828 d206      	.DB	0x06, 0xd2	;f2
00b829 d304      	.DB	0x04, 0xd3	;f3
00b82a d40c      	.DB	0x0c, 0xd4	;f4
00b82b f503      	.DB	0x03, 0xf5	;f5
00b82c a00b      	.DB	0x0b, 0xa0	;f6
00b82d a102      	.DB	0x02, 0xa1	;f7
00b82e a20a      	.DB	0x0a, 0xa2	;f8
00b82f a301      	.DB	0x01, 0xa3	;f9
00b830 8309      	.DB	0x09, 0x83	;f10
00b831 c178      	.DB	0x78, 0xc1	;f11
00b832 c007      	.DB	0x07, 0xc0	;f12
00b833 800d      	.DB	0x0d, 0x80	;TAB
00b834 1b76      	.DB	0x76, 0x1b	;ESC
00b835 8260      	.DB	0x60, 0x82	;INS
00b836 7f66      	.DB	0x66, 0x7f	;BackSpace
00b837 875f      	.DB	0x5f, 0x87	;home
00b838 8b64      	.DB	0x64, 139; 0x86	;up 134
00b839 8967      	.DB	0x67, 0x89	;pgup
00b83a 885e      	.DB	0x5e, 136; 0x8a	;left  corrected from old program sources
00b83b 8c73      	.DB	0x73, 0x8c	;??? 5
00b83c 8663      	.DB	0x63, 134; 0x8b	;right
00b83d 8e5c      	.DB	0x5c, 0x8e	;end
00b83e 8a62      	.DB	0x62, 138; 0x88	;down
00b83f 9d65      	.DB	0x65, 0x9d	;pgdn
00b840 9e5a      	.DB	0x5a, 0x9e	;Enter
00b841 0000      	.DB	0, 0
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW1_PORTOUT:
                         ; ROBOTRON compatibility
00b842 9150 0910         lds	temp, CDATA+2		; port requested
00b844 305e
00b845 f411
00b846 940c b851 	tcbel	0x0e, HW1_PORTOUT_0E
00b848 3158
00b849 f411
00b84a 940c b852 	tcbel	0x18, HW1_PORTOUT_18             ; crt settings
00b84c 3159
00b84d f411
00b84e 940c b88a 	tcbel	0x19, HW1_PORTOUT_19		; crt settings
                 HW1_PORTOUT_RET:
00b850 9508      	ret;
                 
                 HW1_PORTOUT_0E:
                 	;!!! keyboard for port 12 read -- code here
00b851 9508      	ret
                 
                 HW1_PORTOUT_18:
00b852 9150 3776 	lds	temp, HW_DATA
00b854 3051
00b855 f411
00b856 940c b873 	tcbel	0x01, HW1_PORTOUT_18_L1		; port[19]=80 X
00b858 3052
00b859 f411
00b85a 940c b87b 	tcbel	0x02, HW1_PORTOUT_18_L2		; port[19]=80 Y
00b85c 3055
00b85d f411
00b85e 940c b865 	tcbel	0x05, HW1_PORTOUT_18_L3		; port[19]=0  1st
00b860 3056
00b861 f411
00b862 940c b869 	tcbel	0x06, HW1_PORTOUT_18_L4		; port[19]=0  2nd - process it!
00b864 9508      	ret
                 
                 HW1_PORTOUT_18_L3:   				; ignore 1st parameter
00b865 9553      	inc	temp
00b866 9350 3776 	sts	HW_DATA, temp			; inc (HW_DATA)
00b868 9508      	ret
                 
                 	; set line numbers
                 HW1_PORTOUT_18_L4:
00b869 9250 3776 	sts	HW_DATA, zero
                 ;	nportin cpd_vstat			; read crt settings
                 ;	andi	temp, 0b10000111		; clear lines number
                 ;	push	zzA
                 ;	lds	zzA, CDATA
                 ;	subi	zzA, 63				; PORT[$18]:=64+R-1; R = 1..25
00b86b 9150 090e 	lds	temp, CDATA
00b86d 535f      	subi	temp, 63			; PORT[$18]:=64+R-1; R = 1..25
00b86e 9350 3f09 	sts	CRT_LINES, temp			; store lines
                 ;	call	BIOS_SET_VIDEO_MODE		; set display mode
00b870 940c 7611 	jmp	BIOS_SET_VIDEO_MODE		; set display mode and return
                 ;	lsl	zzA
                 ;	lsl	zzA
                 ;	lsl	zzA
                 ;	or	temp, zzA			; set new line number
                 ;	pop	zzA
                 ;	nportout cpd_vstat, temp		; store new settings
00b872 9508      	ret
                 
                 HW1_PORTOUT_18_L1:
00b873 9150 090e 	lds	temp, CDATA			; pos
00b875 9350 3777 	sts	HW_DATA+1, temp
00b877 e052
00b878 9350 3776 	stst	HW_DATA, 2
00b87a 9508      	ret
                 
                 HW1_PORTOUT_18_L2:
00b87b 9150 090e 	lds	temp, CDATA			; line
00b87d 9553      	inc	temp
00b87e 9350 3f07 	sts	CURSOR_Y, temp
00b880 9150 3777 	lds	temp, HW_DATA+1			; pos
00b882 9553      	inc	temp
00b883 9350 3f06 	sts	CURSOR_X, temp
00b885 940e 7518 	call	CURSOR_APPLY_XY
00b887 9250 3776 	sts	HW_DATA, zero			; clear port[$19] request
00b889 9508      	ret
                 
                 HW1_PORTOUT_19:
00b88a 9150 090e 	lds	temp, CDATA			; port value
00b88c 3850
00b88d f411
00b88e 940c b8a2 	tcbel	0x80, HW1_PORTOUT_19_80		; cursor positioning
00b890 3050
00b891 f411
00b892 940c b89e 	tcbel	0x00, HW1_PORTOUT_19_00		; start crt setup
00b894 3250
00b895 f411
00b896 940c b89b 	tcbel	0x20, HW1_PORTOUT_19_20		; end of crt setup - nothing to do
00b898 9250 3776 	sts	HW_DATA, zero
00b89a 9508      	ret
                 
                 HW1_PORTOUT_19_20:
00b89b 9250 3776 	sts	HW_DATA, zero
00b89d 9508      	ret
                 
                 HW1_PORTOUT_19_00:
00b89e e055
00b89f 9350 3776 	stst	HW_DATA, 5
00b8a1 9508      	ret
                 
                 HW1_PORTOUT_19_80:
00b8a2 e051
00b8a3 9350 3776 	stst	HW_DATA, 1
00b8a5 9508      	ret
                 
                 
                 HW1_LST:
00b8a6 9508      	ret
                 #include "hw_2_r1715en.inc"		; Robotron 1715en
                 
                 HW2_CONIN:
00b8a7 3810      	cpi	zzA, 0x80	; 
00b8a8 f408      	brsh	hw2_conin_stop
00b8a9 ce29      	rjmp	HW1_CONIN_DO
                 	
                 hw2_conin_stop:	
00b8aa 2711      	clr	zzA		; disabled key, no response
00b8ab 9508      	ret
                 	
                 
                 
                 HW2_CONOUT_ESC:
00b8ac 3023      	cpi	FROMRAM2, 3
00b8ad f009      	breq	HW2_CONOUT_ESC_3		; just for the case
00b8ae 9508      	ret					; proceed otherwise
                 ;	rjmp	HW0_CONOUT_ESC
                 
                 HW2_CONOUT_ESC_3:
00b8af 9170 091d 	lds	FROMRAM0, CON_ESC_C1		; get main command
                 
00b8b1 357f      	cpi	FROMRAM0, 0x5F
00b8b2 f009      	breq	HW2_FRAMES			; empty char
                 
                 HW2_CONOUT_ESC_CONT:
00b8b3 cf35      	rjmp	HW1_CONOUT_ESC
                 
                 
                 HW2_FRAMES:
00b8b4 3460      	cpi	zzC, 0x40
00b8b5 f3e8      	brlo	HW2_CONOUT_ESC_CONT
00b8b6 366c      	cpi	zzC, 0x6C
00b8b7 f7d8      	brsh	HW2_CONOUT_ESC_CONT
00b8b8 5460      	subi	zzC, 0x40
00b8b9 9566      	lsr	zzC
00b8ba 9566      	lsr	zzC
00b8bb 5f60      	subi	zzC, -0x10			; start position of frame chars
00b8bc 940e b79a 	call	HW1_CONOUT_CHAR_DO		; apply attributes
00b8be 940e 7300 	call	BIOS_L04_CHAR_L1		; echo char
00b8c0 9250 091c 	sts	CON_ESC, zero
00b8c2 2722      	clr	FROMRAM2
00b8c3 9508      	ret
                 #include "hw_3_kaypro.inc"		; Kaypro
                 
                 
                 HW3_CONOUT_CHAR:
00b8c4 776f      	andi	zzC, 0x7f
00b8c5 ef5b      	ldi	temp, BIOS_FUNC_ECON_ATTR_GET
00b8c6 940e 7200 	call	BIOS				; ECON_GET_ATTR			; read attr value (temp)
                 ;	lds	temp, CON_ESC_C5		; attributes
00b8c8 fd54      	sbrc	temp, 4				; inverse
00b8c9 6860      	ori	zzC, 0x80			; select inverted chars
00b8ca 9508      	ret
                 
                 
                 
                 HW3_CONOUT_SC:
00b8cb 2f56      	mov	temp, zzC
                 
00b8cc 305c
00b8cd f411
00b8ce 940c 7736 	tcbel	0x0c, BIOS_L04_RIGHT		; RIGHT
00b8d0 305b
00b8d1 f411
00b8d2 940c 7743 	tcbel	0x0b, BIOS_L04_UP		; UP
00b8d4 3157
00b8d5 f411
00b8d6 940c 7750 	tcbel	0x17, BIOS_L04_CLRCUR		; CLRCUR
00b8d8 3158
00b8d9 f411
00b8da 940c 77a1 	tcbel	0x18, BIOS_L04_CLREOL		; CLREOL
00b8dc 315a
00b8dd f411
00b8de 940c 7723 	tcbel	0x1a, BIOS_L04_CLRSCR		; CLRSCR
00b8e0 315e
00b8e1 f411
00b8e2 940c 772d 	tcbel	0x1e, BIOS_L04_HOME		; HOME
                 
00b8e4 940c b5bd 	jmp	HW0_CONOUT_SC
                 
                 
                 
                 
                 HW3_CONOUT_ESC:
00b8e6 3023      	cpi	FROMRAM2, 3
00b8e7 f009      	breq	HW3_CONOUT_ESC_3		; just for the case
00b8e8 cd16      	rjmp	HW0_CONOUT_ESC
                 
                 HW3_CONOUT_ESC_3:
00b8e9 9170 091d 	lds	FROMRAM0, CON_ESC_C1		; get main command
                 
00b8eb 3472      	cpi	FROMRAM0, 'B'
00b8ec f039      	breq	HW3_ATTRIBUTE_B			; set attribute
00b8ed 3473      	cpi	FROMRAM0, 'C'
00b8ee f089      	breq	HW3_ATTRIBUTE_C			; empty char
                 
                 HW3_CONOUT_ESC_exit:
00b8ef cd0f      	rjmp	HW0_CONOUT_ESC
                 
                 HW3_CONOUT_ESC_stop:
00b8f0 9250 091c 	sts	CON_ESC, zero
00b8f2 2722      	clr	FROMRAM2
00b8f3 9508      	ret
                 
                 HW3_ATTRIBUTE_B:
00b8f4 3360              cpi	zzC, '0'
00b8f5 f3c8      	brlo	HW3_CONOUT_ESC_exit
00b8f6 3364              cpi	zzC, '4'
00b8f7 f7b8      	brsh	HW3_CONOUT_ESC_exit
                 
00b8f8 3360              cpi	zzC, '0'
00b8f9 f7b1      	brne	HW3_CONOUT_ESC_stop
                 
00b8fa e160      	ldi	zzC, (1<<CRT_ATTR_REV)
00b8fb ef5a      	ldi	temp, BIOS_FUNC_CRT_ATTR	; put screen attribute
00b8fc 940e 7200 	call	BIOS
00b8fe 2766      	clr	zzC
                 ;	ret
                 ;	ldi	temp, 1<<4
                 ;	sts	CON_ESC_C5, temp		; store attribute
00b8ff cff0      	rjmp	HW3_CONOUT_ESC_stop
                 
                 
                 HW3_ATTRIBUTE_C:
00b900 3360              cpi	zzC, '0'
00b901 f368      	brlo	HW3_CONOUT_ESC_exit
00b902 3364              cpi	zzC, '4'
00b903 f758      	brsh	HW3_CONOUT_ESC_exit
                 
00b904 3360              cpi	zzC, '0'
00b905 f751      	brne	HW3_CONOUT_ESC_stop
                 
00b906 e060      	ldi	zzC, 0
00b907 ef5a      	ldi	temp, BIOS_FUNC_CRT_ATTR	; put screen attribute
00b908 940e 7200 	call	BIOS
00b90a 2766      	clr	zzC
                 ;	sts	CON_ESC_C5, zero		; store attribute
00b90b cfe4      	rjmp	HW3_CONOUT_ESC_stop
                 
                 
                 
                 #include "hw_4_trs80.inc"		; microbee
                 
                 
                 HW4_CONOUT_CHAR:
00b90c 776f      	andi	zzC, 0x7f
00b90d 9508      	ret
                 #include "hw_6_vt100.inc"		; vt100
                 
                 
                 
                 ; --------------------------------------------------------------------------------------------------
                 HW6_CONOUT_CHAR:
                 ;	ret
                 ;	mov	temp, zzC
00b90e 3f6f      	cpi	zzC, 0xff
00b90f f411      	brne	HW6_CONOUT_CHAR_L2
00b910 e76f      	ldi	zzC, 0x7f
00b911 9508      	ret
                 HW6_CONOUT_CHAR_L2:
00b912 3860      	cpi	zzC, 0x80
00b913 f058      	brlo	HW6_CONOUT_CHAR_ret		; no translation required
                 
00b914 776f      	andi	zzC, 0x7f
00b915 3660      	cpi	zzC, 0x60
00b916 f040      	brlo	HW6_CONOUT_CHAR_ret		; no decoding required
                 
00b917 5660      	subi	zzC, 0x60
00b918 93ff
00b919 93ef      	pushw	Z
00b91a e4e8
00b91b e7f2      	ldiw2	Z, HW6_CONOUT_DECODER
00b91c d003      	rcall	HW6_C_DECODE			; decode symbol
00b91d 91ef
00b91e 91ff      	popw	Z
                 
                 HW6_CONOUT_CHAR_ret:
00b91f 9508      	ret
                 
                 
                 HW6_C_DECODE:
00b920 0fe6      	add	ZL, zzC
00b921 1df5      	adc	ZH, zero
00b922 9166      	elpm	zzC, Z		; decoded symbol
00b923 9508      	ret
                 
                 HW6_CONOUT_DECODER:
00b924 2020
00b925 2020
00b926 2020
00b927 2020
00b928 2020
00b929 1113
00b92a 1210
00b92b 080a      	.DB	 ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',0x13,0x11,0x10,0x12,0x0a,0x08
00b92c 0808
00b92d 0808
00b92e 0506
00b92f 0407
00b930 2009
00b931 2020
00b932 2020
00b933 2020      	.DB	0x08,0x08,0x08,0x08,0x06,0x05,0x07,0x04,0x09, ' ', ' ', ' ', ' ', ' ', ' ', ' '
                 
                 
                 HW6_CONOUT_DECODER_SC:
00b934 2020
00b935 2020
00b936 2020
00b937 2020
00b938 2020
00b939 2020
00b93a 2020
00b93b 2020      	.DB	 ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '
00b93c 1c1b
00b93d 2020
00b93e 2020
00b93f 2020
00b940 2020
00b941 2020
00b942 2020
00b943 1e1d      	.DB	0x1b,0x1c, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',0x1d,0x1e
                 
                 HW6_CONOUT_SC:
00b944 2f56      	mov	temp, zzC
                 
00b945 305a
00b946 f411
00b947 940c baca 	tcbel	0x0a, VT100_LF			; VT100 LF
00b949 305b
00b94a f411
00b94b 940c baca 	tcbel	0x0b, VT100_LF			; VT100 LF
00b94d 305c
00b94e f411
00b94f 940c baca 	tcbel	0x0c, VT100_LF			; VT100 LF
00b951 305d
00b952 f411
00b953 940c 76fa 	tcbel	0x0d, BIOS_L04_ENTER		; CR
00b955 3057
00b956 f411
00b957 940c 7733 	tcbel	0x07, BIOS_L04_BEEP		; VT100 custom tab
00b959 3059
00b95a f411
00b95b 940c bac9 	tcbel	0x09, VT100_TAB			; VT100 custom tab
00b95d 305e
00b95e f411
00b95f 940c bac9 	tcbel	0x0e, VT100_G1			; VT100 G1
00b961 305f
00b962 f411
00b963 940c bac9 	tcbel	0x0f, VT100_G2			; VT100 G2
                 ;	tcbel	0x17, BIOS_L04_CLRCUR		; CLRCUR
00b965 3158
00b966 f411
00b967 940c 7c54 	tcbel	0x18, BIOS_ESC_CANCEL		; VT100 cancel ESC sequence
00b969 315b
00b96a f411
00b96b 940c 7c54 	tcbel	0x1b, BIOS_ESC_CANCEL		; VT100 cancel ESC sequence
                 
00b96d 93ff
00b96e 93ef      	pushw	Z
00b96f e6e8
00b970 e7f2      	ldiw2	Z, HW6_CONOUT_DECODER_SC
00b971 dfae      	rcall	HW6_C_DECODE			; decode symbol
00b972 91ef
00b973 91ff      	popw	Z
00b974 940c 798d 	jmp	BIOS04_ESC_CRISS_OUT		; just output char
                 ;	rjmp	BIOS_L04_CHAR_L1		; just output char
                 ;	BIOS_L04_CHAR_L1
                 ;	BIOS_CALL BIOS_FUNC_CONOUT		; output ^C symbol
                 ;	
                 ;	clr	temp				; no other codes available
                 ;	ret
                 
                 
                 
                 
                 HW6_CONOUT_ESC:
00b976 9170 091d 	lds	FROMRAM0, CON_ESC_C1		; getting main command
00b978 2755      	clr	temp				; return 0 if processed
                 
00b979 3022      	cpi	FROMRAM2, 2			; FROMRAM2 = number of 
00b97a f009      	breq	HW6_CONOUT_ESC_2
00b97b c052      	rjmp	HW6_CONOUT_ESC_3
                 
                 HW6_CONOUT_ESC_2:
00b97c 2722      	clr	FROMRAM2
                 	;!!!!add optional table depending on HW_DATA[0] byte - current mode!!!!!
00b97d 3178
00b97e f411
00b97f 940c 7c54 	tcbel0	 24, BIOS_ESC_CANCEL
00b981 3179
00b982 f411
00b983 940c 7c54 	tcbel0	 25, BIOS_ESC_CANCEL
00b985 3471
00b986 f411
00b987 940c 7743 	tcbel0	'A', BIOS_L04_UP
00b989 3472
00b98a f411
00b98b 940c 76fa 	tcbel0	'B', BIOS_L04_ENTER
00b98d 3473
00b98e f411
00b98f 940c 7736 	tcbel0	'C', BIOS_L04_RIGHT
00b991 3474
00b992 f411
00b993 940c 771a 	tcbel0	'D', BIOS_L04_BSP		;!!! scroll in ANSI !!!!
00b995 3476
00b996 f411
00b997 940c 7c54 	tcbel0	'F', BIOS_ESC_CANCEL		;!!! graph char set
00b999 3477
00b99a f411
00b99b 940c 7c54 	tcbel0	'G', BIOS_ESC_CANCEL		;!!! ASCII char set
00b99d 3478
00b99e f411
00b99f 940c 772d 	tcbel0	'H', BIOS_L04_HOME		;!!! TAB set in ANSI
00b9a1 3479
00b9a2 f411
00b9a3 940c 7c54 	tcbel0	'I', BIOS_ESC_CANCEL		;!!! Reverse line feed ????
00b9a5 347a
00b9a6 f411
00b9a7 940c 7750 	tcbel0	'J', BIOS_L04_CLRCUR
00b9a9 347b
00b9aa f411
00b9ab 940c 77a1 	tcbel0	'K', BIOS_L04_CLREOL
00b9ad 337d
00b9ae f411
00b9af 940c 7c54 	tcbel0	'=', BIOS_ESC_CANCEL		;!!! Enter alternate keypad mode
00b9b1 337e
00b9b2 f411
00b9b3 940c 7c54 	tcbel0	'>', BIOS_ESC_CANCEL		;!!! Exit alternate keypad mode
00b9b5 337c
00b9b6 f411
00b9b7 940c bacc 	tcbel0	'<', VT100_ANSI			;!!! Enter ANSI mode
00b9b9 3377
00b9ba f411
00b9bb 940c 7965 	tcbel0	'7', BIOS04_ESC_CUR_STORE
00b9bd 3378
00b9be f411
00b9bf 940c 7979 	tcbel0	'8', BIOS04_ESC_CUR_RESTORE
00b9c1 3773
00b9c2 f411
00b9c3 940c 7965 	tcbel0	's', BIOS04_ESC_CUR_STORE
00b9c5 3775
00b9c6 f411
00b9c7 940c 7979 	tcbel0	'u', BIOS04_ESC_CUR_RESTORE
00b9c9 3673
00b9ca f411
00b9cb 940c bac9 	tcbel0	'c', VT100_RESET
                 
00b9cd cce0      	rjmp	HW0_CONOUT_ESC_ret
                 
                 
                 HW6_CONOUT_ESC_3:
00b9ce 3023      	cpi	FROMRAM2, 3			; FROMRAM2 = number of 
00b9cf f431      	brne	HW6_CONOUT_ESC_4
                 
00b9d0 2722      	clr	FROMRAM2
00b9d1 357b
00b9d2 f411
00b9d3 940c ba0c 	tcbel0	'[', VT100_ANSI_BR
00b9d5 ccd8      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW6_CONOUT_ESC_4:
00b9d6 3024      	cpi	FROMRAM2, 4			; FROMRAM2 = number of 
00b9d7 f491      	brne	HW6_CONOUT_ESC_5
                 
00b9d8 2722      	clr	FROMRAM2
00b9d9 3579
00b9da f411
00b9db 940c 79a7 	tcbel0	'Y', BIOS04_ESC_KAYPRO_CUR
00b9dd 357b
00b9de f411
00b9df 940c ba0c 	tcbel0	'[', VT100_ANSI_BR
00b9e1 3278
00b9e2 f411
00b9e3 940c bac9 	tcbel0	'(', VT100_CHARSET		;!!! char set
00b9e5 3279
00b9e6 f411
00b9e7 940c bac9 	tcbel0	')', VT100_CHARSET		;!!! char set
                 
00b9e9 ccc4      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW6_CONOUT_ESC_5:	
00b9ea 3025      	cpi	FROMRAM2, 5			; FROMRAM2 = number of 
00b9eb f431      	brne	HW6_CONOUT_ESC_6
                 
00b9ec 2722      	clr	FROMRAM2
00b9ed 357b
00b9ee f411
00b9ef 940c ba0c 	tcbel0	'[', VT100_ANSI_BR
00b9f1 ccbc      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW6_CONOUT_ESC_6:	
00b9f2 3026      	cpi	FROMRAM2, 6			; FROMRAM2 = number of 
00b9f3 f431      	brne	HW6_CONOUT_ESC_7
                 
00b9f4 2722      	clr	FROMRAM2
00b9f5 357b
00b9f6 f411
00b9f7 940c ba0c 	tcbel0	'[', VT100_ANSI_BR
00b9f9 ccb4      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW6_CONOUT_ESC_7:	
00b9fa 3027      	cpi	FROMRAM2, 7			; FROMRAM2 = number of 
00b9fb f431      	brne	HW6_CONOUT_ESC_8
                 
00b9fc 2722      	clr	FROMRAM2
00b9fd 357b
00b9fe f411
00b9ff 940c ba0c 	tcbel0	'[', VT100_ANSI_BR
00ba01 ccac      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW6_CONOUT_ESC_8:	
00ba02 3028      	cpi	FROMRAM2, 8			; FROMRAM2 = number of 
00ba03 f431      	brne	HW6_CONOUT_ESC_9
                 
00ba04 2722      	clr	FROMRAM2
00ba05 357b
00ba06 f411
00ba07 940c ba0c 	tcbel0	'[', VT100_ANSI_BR
00ba09 cca4      	rjmp	HW0_CONOUT_ESC_ret
                 
                 HW6_CONOUT_ESC_9:	
                 VT100_IGNORE:
00ba0a 940c 7c54 	jmp	BIOS_ESC_CANCEL			; stop processing
                 
                 
                 ; process complex parameters
                 VT100_ANSI_BR:
                         ;!!! check letter and process parameters here!
00ba0c 3461              cpi	zzC, 'A'
00ba0d f408              brsh	VT100_ANSI_BR_PARS		; command received - process it!
00ba0e cc9f              rjmp	HW0_CONOUT_ESC_ret		; not command yet, still parameter
                 
                 VT100_ANSI_BR_PARS:				; decoding parameters
00ba0f 93ff
00ba10 93ef              pushw	Z
00ba11 93df
00ba12 93cf              pushw	Y
00ba13 931f              push	zzA
00ba14 921f              push	FROMRAM1
00ba15 e070              ldi	FROMRAM0, 0			; parameters count
00ba16 e1ee
00ba17 e0f9              ldiw	Z, CON_ESC_C2			; parameters area starts here
00ba18 e1cd
00ba19 e0d9              ldiw	Y, CON_ESC_C1			; where results will be stored
                 ;        st	Y, one				; just for the case: if no parameter than set=1 for A..C commands
                 VT100_ANSI_BR_L3:
00ba1a 2711              clr	zzA				; current parameter value
                 VT100_ANSI_BR_L2:
00ba1b 9151              ld	temp, Z+			; get next char
00ba1c 335b              cpi	temp, ';'			; check delimeter?
00ba1d f419              brne	VT100_ANSI_BR_L4
00ba1e 9319              st	Y+, zzA				; store parameter
00ba1f 9573              inc	FROMRAM0			; inc praameter counter
00ba20 cff9              rjmp	VT100_ANSI_BR_L3		; start with next one
                 
                 VT100_ANSI_BR_L4:
00ba21 3451              cpi	temp, 'A'			; end of parameters list, command reached
00ba22 f460              brsh	VT100_ANSI_BR_L1
00ba23 3350              cpi	temp, '0'			; check for '0'..'9' range
00ba24 f3b0              brlo	VT100_ANSI_BR_L2		; error - ignore and go to next char
00ba25 335a              cpi	temp, '9'+1			; 
00ba26 f7a0              brsh	VT100_ANSI_BR_L2		; error - ignore and go to next char
00ba27 5350              subi	temp, '0'			; covert single char to number
00ba28 0f11              add	zzA, zzA			; need to mul zzA*10 and add new value, a=a*2 for the beginning
00ba29 2e11              mov	FROMRAM1, zzA
00ba2a 0f11              add	zzA, zzA			; A=A*4
00ba2b 0f11              add	zzA, zzA			; A=A*8
00ba2c 0d11              add	zzA, FROMRAM1			; A=8*A+2*A = 10*A
00ba2d 0f15              add	zzA, temp			; add decoded decimal value, zzA=actual value
00ba2e cfec              rjmp	VT100_ANSI_BR_L2		; goto next char
                 
                 VT100_ANSI_BR_L1:
00ba2f 9319              st	Y+, zzA				; store last parameter
00ba30 9573              inc	FROMRAM0			; inc praameter counter
                 
00ba31 901f      	pop	FROMRAM1
00ba32 911f              pop	zzA
00ba33 91cf
00ba34 91df              popw	Y
00ba35 91ef
00ba36 91ff              popw	Z
                 VT100_ANSI_BR_CMD:				; FROMRAM0 = number of parameters, CON_ESC_C1..CON_ESC_C4 - decoded values
00ba37 2722      	clr	FROMRAM2			; indicates that command is processed
00ba38 3461
00ba39 f411
00ba3a 940c ba83 	ccbel0	'A', VT100_BR_A
00ba3c 3462
00ba3d f411
00ba3e 940c ba8d 	ccbel0	'B', VT100_BR_B
00ba40 3463
00ba41 f411
00ba42 940c ba97 	ccbel0	'C', VT100_BR_C
00ba44 3464
00ba45 f411
00ba46 940c baa1 	ccbel0	'D', VT100_BR_D
00ba48 346b
00ba49 f411
00ba4a 940c baab 	ccbel0	'K', VT100_CLR_K
00ba4c 346a
00ba4d f411
00ba4e 940c baba 	ccbel0	'J', VT100_CLR_J
00ba50 3468
00ba51 f411
00ba52 940c ba69 	ccbel0	'H', VT100_CUR
00ba54 3666
00ba55 f411
00ba56 940c ba69 	ccbel0	'f', VT100_CUR
00ba58 366d
00ba59 f411
00ba5a 940c bac9 	ccbel0	'm', VT100_ATTR
00ba5c 3761
00ba5d f411
00ba5e 940c bac9 	ccbel0	'q', VT100_LEDS
00ba60 3668
00ba61 f411
00ba62 940c bac9 	ccbel0	'h', VT100_CMD_h
00ba64 366c
00ba65 f411
00ba66 940c bac9 	ccbel0	'l', VT100_CMD_l
                 VT100_ANSI_BR_RET:
00ba68 9508      	ret					; unknown command
                 
                 		
                 VT100_CUR:
00ba69 3072      	cpi	FROMRAM0, 2
00ba6a f3e8      	brlo	VT100_ANSI_BR_RET		; not enough parameters - ignore
00ba6b 9150 091d 	lds	temp, CON_ESC_C1
00ba6d 3158      	cpi	temp, 24			;????? check is Y from 0 or from 1?
00ba6e f7c8      	brsh	VT100_ANSI_BR_RET		; bad parameters - ignore
00ba6f 9150 091e 	lds	temp, CON_ESC_C2
00ba71 3550      	cpi	temp, 80
00ba72 f7a8      	brsh	VT100_ANSI_BR_RET		; bad parameters - ignore
00ba73 9150 091d 	lds	temp, CON_ESC_C1
00ba75 9350 3f07 	sts	CURSOR_Y, temp
00ba77 9150 091e 	lds	temp, CON_ESC_C2
00ba79 9350 3f06 	sts	CURSOR_X, temp
00ba7b 940c 7518 	jmp	CURSOR_APPLY_XY			; set cursor and return
                 
                 VT100_BR_DEF1:					; set default parameter=1 if not specified
00ba7d 9170 091d 	lds	FROMRAM0, CON_ESC_C1
00ba7f 1175      	cpse	FROMRAM0, zero
00ba80 9508      	ret
00ba81 9573      	inc	FROMRAM0
00ba82 9508      	ret
                 
                 VT100_BR_A:					; cursor up for Pn lines
00ba83 9150 3f07 	lds	temp, CURSOR_Y
00ba85 dff7      	rcall	VT100_BR_DEF1
                 ;	lds	FROMRAM0, CON_ESC_C1
00ba86 1b57      	sub	temp, FROMRAM0
00ba87 3158      	cpi	temp, 24
00ba88 f6f8      	brsh	VT100_ANSI_BR_RET		; bad parameters - ignore
00ba89 9350 3f07 	sts	CURSOR_Y, temp
00ba8b 940c 7518 	jmp	CURSOR_APPLY_XY			; set cursor and return
                 
                 VT100_BR_B:
00ba8d 9150 3f07 	lds	temp, CURSOR_Y
00ba8f dfed      	rcall	VT100_BR_DEF1
                 ;	lds	FROMRAM0, CON_ESC_C1
00ba90 0f57      	add	temp, FROMRAM0
00ba91 3158      	cpi	temp, 24
00ba92 f6a8      	brsh	VT100_ANSI_BR_RET		; bad parameters - ignore
00ba93 9350 3f07 	sts	CURSOR_Y, temp
00ba95 940c 7518 	jmp	CURSOR_APPLY_XY			; set cursor and return
                 
                 VT100_BR_C:
00ba97 9150 3f06 	lds	temp, CURSOR_X
00ba99 dfe3      	rcall	VT100_BR_DEF1
                 ;	lds	FROMRAM0, CON_ESC_C1
00ba9a 0f57      	add	temp, FROMRAM0
00ba9b 3550      	cpi	temp, 80
00ba9c f658      	brsh	VT100_ANSI_BR_RET		; bad parameters - ignore
00ba9d 9350 3f06 	sts	CURSOR_X, temp
00ba9f 940c 7518 	jmp	CURSOR_APPLY_XY			; set cursor and return
                 
                 VT100_BR_D:
00baa1 9150 3f06 	lds	temp, CURSOR_X
00baa3 dfd9      	rcall	VT100_BR_DEF1
                 ;	lds	FROMRAM0, CON_ESC_C1
00baa4 1b57      	sub	temp, FROMRAM0
00baa5 3550      	cpi	temp, 80
00baa6 f608      	brsh	VT100_ANSI_BR_RET		; bad parameters - ignore
00baa7 9350 3f06 	sts	CURSOR_X, temp
00baa9 940c 7518 	jmp	CURSOR_APPLY_XY			; set cursor and return
                 
                 VT100_CLR_K:
00baab 9150 091d 	lds	temp, CON_ESC_C1		; subcommand
00baad 3050
00baae f411
00baaf 940c 77a1 	tcbel	0, BIOS_L04_CLREOL
00bab1 3051
00bab2 f411
00bab3 940c 77f8 	tcbel	1, BIOS_L04_CLRBOL
00bab5 3052
00bab6 f411
00bab7 940c 774c 	tcbel	2, BIOS_L04_CLRLN
00bab9 9508      	ret
                 
                 VT100_CLR_J:
00baba 9150 091d 	lds	temp, CON_ESC_C1		; subcommand
00babc 3050
00babd f411
00babe 940c 7750 	tcbel	0, BIOS_L04_CLRCUR
00bac0 3051
00bac1 f411
00bac2 940c 784a 	tcbel	1, BIOS_L04_CLR_BOS		; clear from the beginning of the screen to cursor
00bac4 3052
00bac5 f411
00bac6 940c 7723 	tcbel	2, BIOS_L04_CLRSCR
00bac8 9508      	ret
                 
                 VT100_TAB:
                 VT100_G1:
                 VT100_G2:
                 VT100_ATTR:
                 VT100_LEDS:
                 VT100_RESET:
                 VT100_CMD_h:
                 VT100_CMD_l:
                 VT100_CHARSET:
00bac9 9508      	ret
                 
                 VT100_LF: 
                 	;!!!!!write code here!!!! depends on settings!!!!
00baca 940c 76fd 	jmp	BIOS_L04_CR
                 
                 VT100_ANSI:
00bacc 9290 3776 	sts	HW_DATA, one			; indicates ANSI mode!
00bace 9508      	ret
                 HWC_END:
                 
                 FE_USER_START:
                 #include "user_port_fe.inc"		; fe cmd port user routines
                 
                 USER_PORT_FE:
00bacf 9508      FE_USER_END:
                 
                 FLOAT_START:
                 #include "float.asm"			; float point co-processor library
                 
                 
                 ;	ret
                 
00bad0 920f      	push	r0
00bad1 921f      	push	r1
00bad2 922f      	push	r2
00bad3 923f      	push	r3
00bad4 924f      	push	r4
00bad5 925f      	push	r5
00bad6 926f      	push	r6
00bad7 927f      	push	r7
00bad8 928f      	push	r8
00bad9 929f      	push	r9
00bada 92af      	push	r10
00badb 92bf      	push	r11
00badc 92cf      	push	r12
00badd 92df      	push	r13
00bade 92ef      	push	r14
00badf 92ff      	push	r15
00bae0 930f      	push	r16
00bae1 931f      	push	r17
00bae2 932f      	push	r18
00bae3 933f      	push	r19
00bae4 934f      	push	r20
00bae5 935f      	push	r21
00bae6 936f      	push	r22
00bae7 937f      	push	r23
00bae8 938f      	push	r24
00bae9 939f      	push	r25
00baea 93af      	push	r26
00baeb 93bf      	push	r27
00baec 93cf      	push	r28
00baed 93df      	push	r29
                 ;	push	r30
                 ;	push	r31
                 
00baee b7cd      	in	r28, SPL
00baef b7de      	in	r29, SPH
00baf0 b60f      	in	r0, SREG
00baf1 93c0 4001 	sts	FLOATSPL, r28	; store SPL
00baf3 93d0 4000 	sts	FLOATSPH, r29	; store SPH
00baf5 9200 4002 	sts	FLOATSREG, r0	; store SREG
                 
                 	; set new stack for float routines
00baf7 b60f      	in	r0, SREG
00baf8 e4d0      	ldi	r29, high(FLOATSTACK)
00baf9 e8c0      	ldi	r28, low(FLOATSTACK)
00bafa 94f8      	cli
00bafb bfde       	out	SPH, r29	
00bafc be0f       	out	SREG, r0	
00bafd bfcd      	out	SPL, r28	; new stack for float operations
                 
00bafe 9110 3f33 	lds	r17, FLIB_CMD
                 
00bb00 3110      	cpi	r17, 16
00bb01 f488      	brsh	_fl_pr48
                 
00bb02 9160 3f34 	lds	r22, FLOATDATA1+0	
00bb04 9170 3f35 	lds	r23, FLOATDATA1+1
00bb06 9180 3f36 	lds	r24, FLOATDATA1+2
00bb08 9190 3f37 	lds	r25, FLOATDATA1+3
                 
00bb0a 9120 3f38 	lds	r18, FLOATDATA2+0
00bb0c 9130 3f39 	lds	r19, FLOATDATA2+1
00bb0e 9140 3f3a 	lds	r20, FLOATDATA2+2
00bb10 9150 3f3b 	lds	r21, FLOATDATA2+3
00bb12 c000      	rjmp	_fl_pr_end
                 _fl_pr48:
                 	;!!! code here!!!
                 _fl_pr_end:
                 
                 ;	sts	FLIB_CMD, one
00bb13 2411      	clr	r1
00bb14 2400      	clr	r0
00bb15 6810      	ori	r17, 0x80		; mark that processed
                 
00bb16 3810      	cpi	r17, 0x80+0
00bb17 f421      	brne	_fl_c1
00bb18 9310 3f33 	sts	FLIB_CMD, r17
00bb1a d2e7      	rcall	FLOAT_SUM
00bb1b c016      	rjmp	_fl_done
                 _fl_c1:
00bb1c 3811      	cpi	r17, 0x80+1
00bb1d f421      	brne	_fl_c2
00bb1e 9310 3f33 	sts	FLIB_CMD, r17
00bb20 d2b0      	rcall	FLOAT_SUB
00bb21 c010      	rjmp	_fl_done
                 _fl_c2:
00bb22 3812      	cpi	r17, 0x80+2
00bb23 f421      	brne	_fl_c3
00bb24 9310 3f33 	sts	FLIB_CMD, r17
00bb26 d308      	rcall	FLOAT_MUL
00bb27 c00a      	rjmp	_fl_done
                 _fl_c3:
00bb28 3813      	cpi	r17, 0x80+3
00bb29 f421      	brne	_fl_c4
00bb2a 9310 3f33 	sts	FLIB_CMD, r17
00bb2c d3fc      	rcall	FLOAT_DIV
00bb2d c004      	rjmp	_fl_done
                 _fl_c4:
00bb2e e410      	ldi	r17, 64
00bb2f 9310 3f33 	sts	FLIB_CMD, r17		; error
00bb31 c00e      	rjmp	_fl_st_end
                 	
                 _fl_done:
                 
00bb32 9110 3f33 	lds	r17, FLIB_CMD
00bb34 771f              cbr	r17, 0x80
                 
00bb35 3110      	cpi	r17, 16
00bb36 f448      	brsh	_fl_st48
00bb37 9360 3f3c 	sts	FLOATDATA3+0, r22
00bb39 9370 3f3d 	sts	FLOATDATA3+1, r23
00bb3b 9380 3f3e 	sts	FLOATDATA3+2, r24
00bb3d 9390 3f3f 	sts	FLOATDATA3+3, r25
00bb3f c000      	rjmp	_fl_st_end
                 _fl_st48:
                 	;!!! code here
                 _fl_st_end:
                 		
00bb40 9000 4002 	lds	r0, FLOATSREG
00bb42 91d0 4000 	lds	r29, FLOATSPH
00bb44 91c0 4001 	lds	r28, FLOATSPL
00bb46 94f8      	cli
00bb47 bfde       	out	SPH, r29	
00bb48 be0f       	out	SREG, r0	
00bb49 bfcd      	out	SPL, r28	
                 	
00bb4a 91df      	pop	r29
00bb4b 91cf      	pop	r28
00bb4c 91bf      	pop	r27
00bb4d 91af      	pop	r26
00bb4e 919f      	pop	r25
00bb4f 918f      	pop	r24
00bb50 917f      	pop	r23
00bb51 916f      	pop	r22
00bb52 915f      	pop	r21
00bb53 914f      	pop	r20
00bb54 913f      	pop	r19
00bb55 912f      	pop	r18
00bb56 911f      	pop	r17
00bb57 910f      	pop	r16
00bb58 90ff      	pop	r15
00bb59 90ef      	pop	r14
00bb5a 90df      	pop	r13
00bb5b 90cf      	pop	r12
00bb5c 90bf      	pop	r11
00bb5d 90af      	pop	r10
00bb5e 909f      	pop	r9
00bb5f 908f      	pop	r8
00bb60 907f      	pop	r7
00bb61 906f      	pop	r6
00bb62 905f      	pop	r5
00bb63 904f      	pop	r4
00bb64 903f      	pop	r3
00bb65 902f      	pop	r2
00bb66 901f      	pop	r1
00bb67 900f      	pop	r0
                 
00bb68 9508      	ret
                 
                 
                 FLOAT_zCMD:
00bb69 92ef      	push	zzH
00bb6a 92ff      	push	zzL
00bb6b 935f      	push	temp
                 
00bb6c b8e8
00bb6d b8f2
00bb6e b854
00bb6f b83b
00bb70 0000
00bb71 0000
00bb72 b153
00bb73 b82b      	LDRAM	zzH, zzL, temp		; load (HL) -> FLOATDATA1
00bb74 9350 3f34 	sts	FLOATDATA1+0, temp
00bb76 0cf9      	add	zzL, one
00bb77 1ce5      	adc	zzH, zero
00bb78 b8e8
00bb79 b8f2
00bb7a b854
00bb7b b83b
00bb7c 0000
00bb7d 0000
00bb7e b153
00bb7f b82b      	LDRAM	zzH, zzL, temp
00bb80 9350 3f35 	sts	FLOATDATA1+1, temp
00bb82 0cf9      	add	zzL, one
00bb83 1ce5      	adc	zzH, zero
00bb84 b8e8
00bb85 b8f2
00bb86 b854
00bb87 b83b
00bb88 0000
00bb89 0000
00bb8a b153
00bb8b b82b      	LDRAM	zzH, zzL, temp
00bb8c 9350 3f36 	sts	FLOATDATA1+2, temp
00bb8e 0cf9      	add	zzL, one
00bb8f 1ce5      	adc	zzH, zero
00bb90 b8e8
00bb91 b8f2
00bb92 b854
00bb93 b83b
00bb94 0000
00bb95 0000
00bb96 b153
00bb97 b82b      	LDRAM	zzH, zzL, temp
00bb98 9350 3f37 	sts	FLOATDATA1+3, temp
                 
00bb9a 2cea      	mov	zzH, zzB
00bb9b 2ef6      	mov	zzL, zzC
                 
00bb9c b8e8
00bb9d b8f2
00bb9e b854
00bb9f b83b
00bba0 0000
00bba1 0000
00bba2 b153
00bba3 b82b      	LDRAM	zzH, zzL, temp		; load (BC) -> FLOATDATA2
00bba4 9350 3f38 	sts	FLOATDATA2+0, temp
00bba6 0cf9      	add	zzL, one
00bba7 1ce5      	adc	zzH, zero
00bba8 b8e8
00bba9 b8f2
00bbaa b854
00bbab b83b
00bbac 0000
00bbad 0000
00bbae b153
00bbaf b82b      	LDRAM	zzH, zzL, temp
00bbb0 9350 3f39 	sts	FLOATDATA2+1, temp
00bbb2 0cf9      	add	zzL, one
00bbb3 1ce5      	adc	zzH, zero
00bbb4 b8e8
00bbb5 b8f2
00bbb6 b854
00bbb7 b83b
00bbb8 0000
00bbb9 0000
00bbba b153
00bbbb b82b      	LDRAM	zzH, zzL, temp
00bbbc 9350 3f3a 	sts	FLOATDATA2+2, temp
00bbbe 0cf9      	add	zzL, one
00bbbf 1ce5      	adc	zzH, zero
00bbc0 b8e8
00bbc1 b8f2
00bbc2 b854
00bbc3 b83b
00bbc4 0000
00bbc5 0000
00bbc6 b153
00bbc7 b82b      	LDRAM	zzH, zzL, temp
00bbc8 9350 3f3b 	sts	FLOATDATA2+3, temp
                 
00bbca 915f      	pop	temp
00bbcb 90ff      	pop	zzL
00bbcc 90ef      	pop	zzH
                 
00bbcd 9350 3f33 	sts	FLIB_CMD, temp		; commant to execute
00bbcf df00      	rcall	FLOAT
                 
00bbd0 92ef      	push	zzH
00bbd1 92ff      	push	zzL
00bbd2 935f      	push	temp
                 
00bbd3 9150 3f3c 	lds	temp, FLOATDATA3+0
00bbd5 b8e8
00bbd6 b8f2
00bbd7 b955
00bbd8 b824
00bbd9 14e6
00bbda 985d
00bbdb f100
00bbdc b82b
00bbdd 935f
00bbde e158
00bbdf b955
00bbe0 eb5f
00bbe1 b954
00bbe2 e050
00bbe3 bd5d
00bbe4 e550
00bbe5 bd5c
00bbe6 9859
00bbe7 915f
00bbe8 982c
00bbe9 935f
00bbea 2d5e
00bbeb 940e 005f
00bbed e054
00bbee 955a
00bbef f7f1
00bbf0 2d5f
00bbf1 940e 005f
00bbf3 e054
00bbf4 955a
00bbf5 f7f1
00bbf6 915f
00bbf7 940e 005f
00bbf9 bc5c
00bbfa 9a59
00bbfb b854
00bbfc b82b      	STRAM	zzH, zzL, temp
00bbfd 0cf9      	add	zzL, one
00bbfe 1ce5      	adc	zzH, zero
00bbff 9150 3f3d 	lds	temp, FLOATDATA3+1
00bc01 b8e8
00bc02 b8f2
00bc03 b955
00bc04 b824
00bc05 14e6
00bc06 985d
00bc07 f100
00bc08 b82b
00bc09 935f
00bc0a e158
00bc0b b955
00bc0c eb5f
00bc0d b954
00bc0e e050
00bc0f bd5d
00bc10 e550
00bc11 bd5c
00bc12 9859
00bc13 915f
00bc14 982c
00bc15 935f
00bc16 2d5e
00bc17 940e 005f
00bc19 e054
00bc1a 955a
00bc1b f7f1
00bc1c 2d5f
00bc1d 940e 005f
00bc1f e054
00bc20 955a
00bc21 f7f1
00bc22 915f
00bc23 940e 005f
00bc25 bc5c
00bc26 9a59
00bc27 b854
00bc28 b82b      	STRAM	zzH, zzL, temp
00bc29 0cf9      	add	zzL, one
00bc2a 1ce5      	adc	zzH, zero
00bc2b 9150 3f3e 	lds	temp, FLOATDATA3+2
00bc2d b8e8
00bc2e b8f2
00bc2f b955
00bc30 b824
00bc31 14e6
00bc32 985d
00bc33 f100
00bc34 b82b
00bc35 935f
00bc36 e158
00bc37 b955
00bc38 eb5f
00bc39 b954
00bc3a e050
00bc3b bd5d
00bc3c e550
00bc3d bd5c
00bc3e 9859
00bc3f 915f
00bc40 982c
00bc41 935f
00bc42 2d5e
00bc43 940e 005f
00bc45 e054
00bc46 955a
00bc47 f7f1
00bc48 2d5f
00bc49 940e 005f
00bc4b e054
00bc4c 955a
00bc4d f7f1
00bc4e 915f
00bc4f 940e 005f
00bc51 bc5c
00bc52 9a59
00bc53 b854
00bc54 b82b      	STRAM	zzH, zzL, temp
00bc55 0cf9      	add	zzL, one
00bc56 1ce5      	adc	zzH, zero
00bc57 9150 3f3f 	lds	temp, FLOATDATA3+3
00bc59 b8e8
00bc5a b8f2
00bc5b b955
00bc5c b824
00bc5d 14e6
00bc5e 985d
00bc5f f100
00bc60 b82b
00bc61 935f
00bc62 e158
00bc63 b955
00bc64 eb5f
00bc65 b954
00bc66 e050
00bc67 bd5d
00bc68 e550
00bc69 bd5c
00bc6a 9859
00bc6b 915f
00bc6c 982c
00bc6d 935f
00bc6e 2d5e
00bc6f 940e 005f
00bc71 e054
00bc72 955a
00bc73 f7f1
00bc74 2d5f
00bc75 940e 005f
00bc77 e054
00bc78 955a
00bc79 f7f1
00bc7a 915f
00bc7b 940e 005f
00bc7d bc5c
00bc7e 9a59
00bc7f b854
00bc80 b82b      	STRAM	zzH, zzL, temp
                 
00bc81 915f      	pop	temp
00bc82 90ff      	pop	zzL
00bc83 90ef      	pop	zzH
                 	
00bc84 9508      	ret
                 
                 
                 #include "flb2.asm"	; float library
                 
00bc85 e0a0      fl_184:	ldi	r26, 0x00	; 0
00bc86 e0b0      fl_186:	ldi	r27, 0x00	; 0
00bc87 e8eb      fl_188:	ldi	r30, low(fl_190) ;0xC8	; 200
00bc88 ebfc      fl_18a:	ldi	r31, high(fl_190) 	; 0
00bc89 940c c122 fl_18c:	jmp	fl_abe	;  0xabe
00bc8b 01dc      fl_190:	movw	r26, r24
00bc8c 012b      fl_192:	movw	r4, r22
00bc8d 01fa      fl_194:	movw	r30, r20
00bc8e 919c      fl_196:	ld	r25, X
00bc8f 3092      fl_198:	cpi	r25, 0x02	; 2
00bc90 f408      fl_19a:	brcc	fl_19e
00bc91 c139      fl_19c:	rjmp	fl_410
00bc92 01eb      fl_19e:	movw	r28, r22
00bc93 8188      fl_1a0:	ld	r24, Y
00bc94 3082      fl_1a2:	cpi	r24, 0x02	; 2
00bc95 f408      fl_1a4:	brcc	fl_1a8
00bc96 c133      fl_1a6:	rjmp	fl_40e
00bc97 3094      fl_1a8:	cpi	r25, 0x04	; 4
00bc98 f469      fl_1aa:	brne	fl_1c6
00bc99 3084      fl_1ac:	cpi	r24, 0x04	; 4
00bc9a f009      fl_1ae:	breq	fl_1b2
00bc9b c12f      fl_1b0:	rjmp	fl_410
00bc9c 9611      fl_1b2:	adiw	r26, 0x01	; 1
00bc9d 919c      fl_1b4:	ld	r25, X
00bc9e 9711      fl_1b6:	sbiw	r26, 0x01	; 1
00bc9f 8189      fl_1b8:	ldd	r24, Y+1	; 0x01
00bca0 1798      fl_1ba:	cp	r25, r24
00bca1 f409      fl_1bc:	brne	fl_1c0
00bca2 c128      fl_1be:	rjmp	fl_410
00bca3 e0a0      fl_1c0:	ldi	r26, 0x00	; 0
00bca4 e0b1      fl_1c2:	ldi	r27, 0x01	; 1
00bca5 c125      fl_1c4:	rjmp	fl_410
00bca6 3084      fl_1c6:	cpi	r24, 0x04	; 4
00bca7 f409      fl_1c8:	brne	fl_1cc
00bca8 c121      fl_1ca:	rjmp	fl_40e
00bca9 3082      fl_1cc:	cpi	r24, 0x02	; 2
00bcaa f4a9      fl_1ce:	brne	fl_1fa
00bcab 3092      fl_1d0:	cpi	r25, 0x02	; 2
00bcac f009      fl_1d2:	breq	fl_1d6
00bcad c11d      fl_1d4:	rjmp	fl_410
00bcae 019a      fl_1d6:	movw	r18, r20
00bcaf 01ad      fl_1d8:	movw	r20, r26
00bcb0 e088      fl_1da:	ldi	r24, 0x08	; 8
00bcb1 01ea      fl_1dc:	movw	r28, r20
00bcb2 9009      fl_1de:	ld	r0, Y+
00bcb3 01ae      fl_1e0:	movw	r20, r28
00bcb4 01e9      fl_1e2:	movw	r28, r18
00bcb5 9209      fl_1e4:	st	Y+, r0
00bcb6 019e      fl_1e6:	movw	r18, r28
00bcb7 5081      fl_1e8:	subi	r24, 0x01	; 1
00bcb8 f7c1      fl_1ea:	brne	fl_1dc
00bcb9 01e2      fl_1ec:	movw	r28, r4
00bcba 8189      fl_1ee:	ldd	r24, Y+1	; 0x01
00bcbb 9611      fl_1f0:	adiw	r26, 0x01	; 1
00bcbc 919c      fl_1f2:	ld	r25, X
00bcbd 2389      fl_1f4:	and	r24, r25
00bcbe 8381      fl_1f6:	std	Z+1, r24	; 0x01
00bcbf c108      fl_1f8:	rjmp	fl_40a
00bcc0 3092      fl_1fa:	cpi	r25, 0x02	; 2
00bcc1 f409      fl_1fc:	brne	fl_200
00bcc2 c107      fl_1fe:	rjmp	fl_40e
00bcc3 9612      fl_200:	adiw	r26, 0x02	; 2
00bcc4 902d      fl_202:	ld	r2, X+
00bcc5 903c      fl_204:	ld	r3, X
00bcc6 9713      fl_206:	sbiw	r26, 0x03	; 3
00bcc7 01eb      fl_208:	movw	r28, r22
00bcc8 818a      fl_20a:	ldd	r24, Y+2	; 0x02
00bcc9 819b      fl_20c:	ldd	r25, Y+3	; 0x03
00bcca 9614      fl_20e:	adiw	r26, 0x04	; 4
00bccb 90ad      fl_210:	ld	r10, X+
00bccc 90bd      fl_212:	ld	r11, X+
00bccd 90cd      fl_214:	ld	r12, X+
00bcce 90dc      fl_216:	ld	r13, X
00bccf 9717      fl_218:	sbiw	r26, 0x07	; 7
00bcd0 80ec      fl_21a:	ldd	r14, Y+4	; 0x04
00bcd1 80fd      fl_21c:	ldd	r15, Y+5	; 0x05
00bcd2 810e      fl_21e:	ldd	r16, Y+6	; 0x06
00bcd3 811f      fl_220:	ldd	r17, Y+7	; 0x07
00bcd4 0191      fl_222:	movw	r18, r2
00bcd5 1b28      fl_224:	sub	r18, r24
00bcd6 0b39      fl_226:	sbc	r19, r25
00bcd7 01b9      fl_228:	movw	r22, r18
00bcd8 ff37      fl_22a:	sbrs	r19, 7
00bcd9 c004      fl_22c:	rjmp	fl_236
00bcda 2766      fl_22e:	eor	r22, r22
00bcdb 2777      fl_230:	eor	r23, r23
00bcdc 1b62      fl_232:	sub	r22, r18
00bcdd 0b73      fl_234:	sbc	r23, r19
00bcde 3260      fl_236:	cpi	r22, 0x20	; 32
00bcdf 0571      fl_238:	cpc	r23, r1
00bce0 f00c      fl_23a:	brlt	fl_23e
00bce1 c061      fl_23c:	rjmp	fl_300
00bce2 1612      fl_23e:	cp	r1, r18
00bce3 0613      fl_240:	cpc	r1, r19
00bce4 f56c      fl_242:	brge	fl_29e
00bce5 0137      fl_244:	movw	r6, r14
00bce6 0148      fl_246:	movw	r8, r16
00bce7 2e06      fl_248:	mov	r0, r22
00bce8 c004      fl_24a:	rjmp	fl_254
00bce9 9496      fl_24c:	lsr	r9
00bcea 9487      fl_24e:	ror	r8
00bceb 9477      fl_250:	ror	r7
00bcec 9467      fl_252:	ror	r6
00bced 940a      fl_254:	dec	r0
00bcee f7d2      fl_256:	brpl	fl_24c
00bcef e021      fl_258:	ldi	r18, 0x01	; 1
00bcf0 e030      fl_25a:	ldi	r19, 0x00	; 0
00bcf1 e040      fl_25c:	ldi	r20, 0x00	; 0
00bcf2 e050      fl_25e:	ldi	r21, 0x00	; 0
00bcf3 c004      fl_260:	rjmp	fl_26a
00bcf4 0f22      fl_262:	add	r18, r18
00bcf5 1f33      fl_264:	adc	r19, r19
00bcf6 1f44      fl_266:	adc	r20, r20
00bcf7 1f55      fl_268:	adc	r21, r21
00bcf8 956a      fl_26a:	dec	r22
00bcf9 f7d2      fl_26c:	brpl	fl_262
00bcfa 5021      fl_26e:	subi	r18, 0x01	; 1
00bcfb 4030      fl_270:	sbci	r19, 0x00	; 0
00bcfc 4040      fl_272:	sbci	r20, 0x00	; 0
00bcfd 4050      fl_274:	sbci	r21, 0x00	; 0
00bcfe 212e      fl_276:	and	r18, r14
00bcff 213f      fl_278:	and	r19, r15
00bd00 2340      fl_27a:	and	r20, r16
00bd01 2351      fl_27c:	and	r21, r17
00bd02 1521      fl_27e:	cp	r18, r1
00bd03 0531      fl_280:	cpc	r19, r1
00bd04 0541      fl_282:	cpc	r20, r1
00bd05 0551      fl_284:	cpc	r21, r1
00bd06 f021      fl_286:	breq	fl_290
00bd07 e021      fl_288:	ldi	r18, 0x01	; 1
00bd08 e030      fl_28a:	ldi	r19, 0x00	; 0
00bd09 e040      fl_28c:	ldi	r20, 0x00	; 0
00bd0a e050      fl_28e:	ldi	r21, 0x00	; 0
00bd0b 0179      fl_290:	movw	r14, r18
00bd0c 018a      fl_292:	movw	r16, r20
00bd0d 28e6      fl_294:	or	r14, r6
00bd0e 28f7      fl_296:	or	r15, r7
00bd0f 2908      fl_298:	or	r16, r8
00bd10 2919      fl_29a:	or	r17, r9
00bd11 c03c      fl_29c:	rjmp	fl_316
00bd12 2b23      fl_29e:	or	r18, r19
00bd13 f1d1      fl_2a0:	breq	fl_316
00bd14 0e26      fl_2a2:	add	r2, r22
00bd15 1e37      fl_2a4:	adc	r3, r23
00bd16 0135      fl_2a6:	movw	r6, r10
00bd17 0146      fl_2a8:	movw	r8, r12
00bd18 2e06      fl_2aa:	mov	r0, r22
00bd19 c004      fl_2ac:	rjmp	fl_2b6
00bd1a 9496      fl_2ae:	lsr	r9
00bd1b 9487      fl_2b0:	ror	r8
00bd1c 9477      fl_2b2:	ror	r7
00bd1d 9467      fl_2b4:	ror	r6
00bd1e 940a      fl_2b6:	dec	r0
00bd1f f7d2      fl_2b8:	brpl	fl_2ae
00bd20 e021      fl_2ba:	ldi	r18, 0x01	; 1
00bd21 e030      fl_2bc:	ldi	r19, 0x00	; 0
00bd22 e040      fl_2be:	ldi	r20, 0x00	; 0
00bd23 e050      fl_2c0:	ldi	r21, 0x00	; 0
00bd24 c004      fl_2c2:	rjmp	fl_2cc
00bd25 0f22      fl_2c4:	add	r18, r18
00bd26 1f33      fl_2c6:	adc	r19, r19
00bd27 1f44      fl_2c8:	adc	r20, r20
00bd28 1f55      fl_2ca:	adc	r21, r21
00bd29 956a      fl_2cc:	dec	r22
00bd2a f7d2      fl_2ce:	brpl	fl_2c4
00bd2b 5021      fl_2d0:	subi	r18, 0x01	; 1
00bd2c 4030      fl_2d2:	sbci	r19, 0x00	; 0
00bd2d 4040      fl_2d4:	sbci	r20, 0x00	; 0
00bd2e 4050      fl_2d6:	sbci	r21, 0x00	; 0
00bd2f 212a      fl_2d8:	and	r18, r10
00bd30 213b      fl_2da:	and	r19, r11
00bd31 214c      fl_2dc:	and	r20, r12
00bd32 215d      fl_2de:	and	r21, r13
00bd33 1521      fl_2e0:	cp	r18, r1
00bd34 0531      fl_2e2:	cpc	r19, r1
00bd35 0541      fl_2e4:	cpc	r20, r1
00bd36 0551      fl_2e6:	cpc	r21, r1
00bd37 f021      fl_2e8:	breq	fl_2f2
00bd38 e021      fl_2ea:	ldi	r18, 0x01	; 1
00bd39 e030      fl_2ec:	ldi	r19, 0x00	; 0
00bd3a e040      fl_2ee:	ldi	r20, 0x00	; 0
00bd3b e050      fl_2f0:	ldi	r21, 0x00	; 0
00bd3c 0159      fl_2f2:	movw	r10, r18
00bd3d 016a      fl_2f4:	movw	r12, r20
00bd3e 28a6      fl_2f6:	or	r10, r6
00bd3f 28b7      fl_2f8:	or	r11, r7
00bd40 28c8      fl_2fa:	or	r12, r8
00bd41 28d9      fl_2fc:	or	r13, r9
00bd42 c00b      fl_2fe:	rjmp	fl_316
00bd43 1582      fl_300:	cp	r24, r2
00bd44 0593      fl_302:	cpc	r25, r3
00bd45 f02c      fl_304:	brlt	fl_310
00bd46 011c      fl_306:	movw	r2, r24
00bd47 24aa      fl_308:	eor	r10, r10
00bd48 24bb      fl_30a:	eor	r11, r11
00bd49 0165      fl_30c:	movw	r12, r10
00bd4a c003      fl_30e:	rjmp	fl_316
00bd4b 24ee      fl_310:	eor	r14, r14
00bd4c 24ff      fl_312:	eor	r15, r15
00bd4d 0187      fl_314:	movw	r16, r14
00bd4e 9611      fl_316:	adiw	r26, 0x01	; 1
00bd4f 919c      fl_318:	ld	r25, X
00bd50 01d2      fl_31a:	movw	r26, r4
00bd51 9611      fl_31c:	adiw	r26, 0x01	; 1
00bd52 918c      fl_31e:	ld	r24, X
00bd53 1798      fl_320:	cp	r25, r24
00bd54 f409      fl_322:	brne	fl_326
00bd55 c045      fl_324:	rjmp	fl_3b0
00bd56 2399      fl_326:	and	r25, r25
00bd57 f039      fl_328:	breq	fl_338
00bd58 01a8      fl_32a:	movw	r20, r16
00bd59 0197      fl_32c:	movw	r18, r14
00bd5a 192a      fl_32e:	sub	r18, r10
00bd5b 093b      fl_330:	sbc	r19, r11
00bd5c 094c      fl_332:	sbc	r20, r12
00bd5d 095d      fl_334:	sbc	r21, r13
00bd5e c006      fl_336:	rjmp	fl_344
00bd5f 01a6      fl_338:	movw	r20, r12
00bd60 0195      fl_33a:	movw	r18, r10
00bd61 192e      fl_33c:	sub	r18, r14
00bd62 093f      fl_33e:	sbc	r19, r15
00bd63 0b40      fl_340:	sbc	r20, r16
00bd64 0b51      fl_342:	sbc	r21, r17
00bd65 fd57      fl_344:	sbrc	r21, 7
00bd66 c008      fl_346:	rjmp	fl_358
00bd67 8211      fl_348:	std	Z+1, r1	; 0x01
00bd68 8233      fl_34a:	std	Z+3, r3	; 0x03
00bd69 8222      fl_34c:	std	Z+2, r2	; 0x02
00bd6a 8324      fl_34e:	std	Z+4, r18	; 0x04
00bd6b 8335      fl_350:	std	Z+5, r19	; 0x05
00bd6c 8346      fl_352:	std	Z+6, r20	; 0x06
00bd6d 8357      fl_354:	std	Z+7, r21	; 0x07
00bd6e c01d      fl_356:	rjmp	fl_392
00bd6f e081      fl_358:	ldi	r24, 0x01	; 1
00bd70 8381      fl_35a:	std	Z+1, r24	; 0x01
00bd71 8233      fl_35c:	std	Z+3, r3	; 0x03
00bd72 8222      fl_35e:	std	Z+2, r2	; 0x02
00bd73 2788      fl_360:	eor	r24, r24
00bd74 2799      fl_362:	eor	r25, r25
00bd75 01dc      fl_364:	movw	r26, r24
00bd76 1b82      fl_366:	sub	r24, r18
00bd77 0b93      fl_368:	sbc	r25, r19
00bd78 0ba4      fl_36a:	sbc	r26, r20
00bd79 0bb5      fl_36c:	sbc	r27, r21
00bd7a 8384      fl_36e:	std	Z+4, r24	; 0x04
00bd7b 8395      fl_370:	std	Z+5, r25	; 0x05
00bd7c 83a6      fl_372:	std	Z+6, r26	; 0x06
00bd7d 83b7      fl_374:	std	Z+7, r27	; 0x07
00bd7e c00d      fl_376:	rjmp	fl_392
00bd7f 0f22      fl_378:	add	r18, r18
00bd80 1f33      fl_37a:	adc	r19, r19
00bd81 1f44      fl_37c:	adc	r20, r20
00bd82 1f55      fl_37e:	adc	r21, r21
00bd83 8324      fl_380:	std	Z+4, r18	; 0x04
00bd84 8335      fl_382:	std	Z+5, r19	; 0x05
00bd85 8346      fl_384:	std	Z+6, r20	; 0x06
00bd86 8357      fl_386:	std	Z+7, r21	; 0x07
00bd87 8182      fl_388:	ldd	r24, Z+2	; 0x02
00bd88 8193      fl_38a:	ldd	r25, Z+3	; 0x03
00bd89 9701      fl_38c:	sbiw	r24, 0x01	; 1
00bd8a 8393      fl_38e:	std	Z+3, r25	; 0x03
00bd8b 8382      fl_390:	std	Z+2, r24	; 0x02
00bd8c 8124      fl_392:	ldd	r18, Z+4	; 0x04
00bd8d 8135      fl_394:	ldd	r19, Z+5	; 0x05
00bd8e 8146      fl_396:	ldd	r20, Z+6	; 0x06
00bd8f 8157      fl_398:	ldd	r21, Z+7	; 0x07
00bd90 01da      fl_39a:	movw	r26, r20
00bd91 01c9      fl_39c:	movw	r24, r18
00bd92 9701      fl_39e:	sbiw	r24, 0x01	; 1
00bd93 09a1      fl_3a0:	sbc	r26, r1
00bd94 09b1      fl_3a2:	sbc	r27, r1
00bd95 5f8f      fl_3a4:	subi	r24, 0xFF	; 255
00bd96 4f9f      fl_3a6:	sbci	r25, 0xFF	; 255
00bd97 4faf      fl_3a8:	sbci	r26, 0xFF	; 255
00bd98 43bf      fl_3aa:	sbci	r27, 0x3F	; 63
00bd99 f328      fl_3ac:	brcs	fl_378
00bd9a c00b      fl_3ae:	rjmp	fl_3c6
00bd9b 8391      fl_3b0:	std	Z+1, r25	; 0x01
00bd9c 8233      fl_3b2:	std	Z+3, r3	; 0x03
00bd9d 8222      fl_3b4:	std	Z+2, r2	; 0x02
00bd9e 0cea      fl_3b6:	add	r14, r10
00bd9f 1cfb      fl_3b8:	adc	r15, r11
00bda0 1d0c      fl_3ba:	adc	r16, r12
00bda1 1d1d      fl_3bc:	adc	r17, r13
00bda2 82e4      fl_3be:	std	Z+4, r14	; 0x04
00bda3 82f5      fl_3c0:	std	Z+5, r15	; 0x05
00bda4 8306      fl_3c2:	std	Z+6, r16	; 0x06
00bda5 8317      fl_3c4:	std	Z+7, r17	; 0x07
00bda6 e083      fl_3c6:	ldi	r24, 0x03	; 3
00bda7 8380      fl_3c8:	st	Z, r24
00bda8 8124      fl_3ca:	ldd	r18, Z+4	; 0x04
00bda9 8135      fl_3cc:	ldd	r19, Z+5	; 0x05
00bdaa 8146      fl_3ce:	ldd	r20, Z+6	; 0x06
00bdab 8157      fl_3d0:	ldd	r21, Z+7	; 0x07
00bdac ff57      fl_3d2:	sbrs	r21, 7
00bdad c01a      fl_3d4:	rjmp	fl_40a
00bdae 01c9      fl_3d6:	movw	r24, r18
00bdaf 27aa      fl_3d8:	eor	r26, r26
00bdb0 fd97      fl_3da:	sbrc	r25, 7
00bdb1 95a0      fl_3dc:	com	r26
00bdb2 2fba      fl_3de:	mov	r27, r26
00bdb3 7081      fl_3e0:	andi	r24, 0x01	; 1
00bdb4 7090      fl_3e2:	andi	r25, 0x00	; 0
00bdb5 70a0      fl_3e4:	andi	r26, 0x00	; 0
00bdb6 70b0      fl_3e6:	andi	r27, 0x00	; 0
00bdb7 9556      fl_3e8:	lsr	r21
00bdb8 9547      fl_3ea:	ror	r20
00bdb9 9537      fl_3ec:	ror	r19
00bdba 9527      fl_3ee:	ror	r18
00bdbb 2b82      fl_3f0:	or	r24, r18
00bdbc 2b93      fl_3f2:	or	r25, r19
00bdbd 2ba4      fl_3f4:	or	r26, r20
00bdbe 2bb5      fl_3f6:	or	r27, r21
00bdbf 8384      fl_3f8:	std	Z+4, r24	; 0x04
00bdc0 8395      fl_3fa:	std	Z+5, r25	; 0x05
00bdc1 83a6      fl_3fc:	std	Z+6, r26	; 0x06
00bdc2 83b7      fl_3fe:	std	Z+7, r27	; 0x07
00bdc3 8182      fl_400:	ldd	r24, Z+2	; 0x02
00bdc4 8193      fl_402:	ldd	r25, Z+3	; 0x03
00bdc5 9601      fl_404:	adiw	r24, 0x01	; 1
00bdc6 8393      fl_406:	std	Z+3, r25	; 0x03
00bdc7 8382      fl_408:	std	Z+2, r24	; 0x02
00bdc8 01df      fl_40a:	movw	r26, r30
00bdc9 c001      fl_40c:	rjmp	fl_410
00bdca 01d2      fl_40e:	movw	r26, r4
00bdcb 01cd      fl_410:	movw	r24, r26
00bdcc b7cd      fl_412:	in	r28, 0x3d	; 61
00bdcd b7de      fl_414:	in	r29, 0x3e	; 62
00bdce e1e2      fl_416:	ldi	r30, 0x12	; 18
00bdcf 940c c13e fl_418:	jmp	fl_af6	;  0xaf6
                 
                 FLOAT_SUB:
00bdd1 e2a0      fl_41c:	ldi	r26, 0x20	; 32
00bdd2 e0b0      fl_41e:	ldi	r27, 0x00	; 0
00bdd3 ede7      fl_420:	ldi	r30, low(fl_428) ;0x14	; 20
00bdd4 ebfd      fl_422:	ldi	r31, high(fl_428); 0x02	; 2
00bdd5 940c c12e fl_424:	jmp	fl_ad6	;  0xad6
00bdd7 8369      fl_428:	std	Y+1, r22	; 0x01
00bdd8 837a      fl_42a:	std	Y+2, r23	; 0x02
00bdd9 838b      fl_42c:	std	Y+3, r24	; 0x03
00bdda 839c      fl_42e:	std	Y+4, r25	; 0x04
00bddb 832d      fl_430:	std	Y+5, r18	; 0x05
00bddc 833e      fl_432:	std	Y+6, r19	; 0x06
00bddd 834f      fl_434:	std	Y+7, r20	; 0x07
00bdde 8758      fl_436:	std	Y+8, r21	; 0x08
00bddf e0e9      fl_438:	ldi	r30, 0x09	; 9
00bde0 2eee      fl_43a:	mov	r14, r30
00bde1 2cf1      fl_43c:	mov	r15, r1
00bde2 0eec      fl_43e:	add	r14, r28
00bde3 1efd      fl_440:	adc	r15, r29
00bde4 01ce      fl_442:	movw	r24, r28
00bde5 9601      fl_444:	adiw	r24, 0x01	; 1
00bde6 01b7      fl_446:	movw	r22, r14
00bde7 940e c0aa fl_448:	call	fl_9ce	;  0x9ce
00bde9 018e      fl_44c:	movw	r16, r28
00bdea 5e0f      fl_44e:	subi	r16, 0xEF	; 239
00bdeb 4f1f      fl_450:	sbci	r17, 0xFF	; 255
00bdec 01ce      fl_452:	movw	r24, r28
00bded 9605      fl_454:	adiw	r24, 0x05	; 5
00bdee 01b8      fl_456:	movw	r22, r16
00bdef 940e c0aa fl_458:	call	fl_9ce	;  0x9ce
00bdf1 898a      fl_45c:	ldd	r24, Y+18	; 0x12
00bdf2 e091      fl_45e:	ldi	r25, 0x01	; 1
00bdf3 2789      fl_460:	eor	r24, r25
00bdf4 8b8a      fl_462:	std	Y+18, r24	; 0x12
00bdf5 01c7      fl_464:	movw	r24, r14
00bdf6 01b8      fl_466:	movw	r22, r16
00bdf7 01ae      fl_468:	movw	r20, r28
00bdf8 5e47      fl_46a:	subi	r20, 0xE7	; 231
00bdf9 4f5f      fl_46c:	sbci	r21, 0xFF	; 255
00bdfa 940e bc85 fl_46e:	call	fl_184	;  0x184
00bdfc 940e bfd5 fl_472:	call	fl_824	;  0x824
00bdfe 96a0      fl_476:	adiw	r28, 0x20	; 32
00bdff e0e6      fl_478:	ldi	r30, 0x06	; 6
00be00 940c c14a fl_47a:	jmp	fl_b0e	;  0xb0e
                 
                 FLOAT_SUM:
00be02 e2a0      fl_47e:	ldi	r26, 0x20	; 32
00be03 e0b0      fl_480:	ldi	r27, 0x00	; 0
00be04 e0e8      fl_482:	ldi	r30, low(fl_48a) ;0x45	; 69
00be05 ebfe      fl_484:	ldi	r31, high(fl_48a); 0x02	; 2
00be06 940c c12e fl_486:	jmp	fl_ad6	;  0xad6
00be08 8369      fl_48a:	std	Y+1, r22	; 0x01
00be09 837a      fl_48c:	std	Y+2, r23	; 0x02
00be0a 838b      fl_48e:	std	Y+3, r24	; 0x03
00be0b 839c      fl_490:	std	Y+4, r25	; 0x04
00be0c 832d      fl_492:	std	Y+5, r18	; 0x05
00be0d 833e      fl_494:	std	Y+6, r19	; 0x06
00be0e 834f      fl_496:	std	Y+7, r20	; 0x07
00be0f 8758      fl_498:	std	Y+8, r21	; 0x08
00be10 e0f9      fl_49a:	ldi	r31, 0x09	; 9
00be11 2eef      fl_49c:	mov	r14, r31
00be12 2cf1      fl_49e:	mov	r15, r1
00be13 0eec      fl_4a0:	add	r14, r28
00be14 1efd      fl_4a2:	adc	r15, r29
00be15 01ce      fl_4a4:	movw	r24, r28
00be16 9601      fl_4a6:	adiw	r24, 0x01	; 1
00be17 01b7      fl_4a8:	movw	r22, r14
00be18 940e c0aa fl_4aa:	call	fl_9ce	;  0x9ce
00be1a 018e      fl_4ae:	movw	r16, r28
00be1b 5e0f      fl_4b0:	subi	r16, 0xEF	; 239
00be1c 4f1f      fl_4b2:	sbci	r17, 0xFF	; 255
00be1d 01ce      fl_4b4:	movw	r24, r28
00be1e 9605      fl_4b6:	adiw	r24, 0x05	; 5
00be1f 01b8      fl_4b8:	movw	r22, r16
00be20 940e c0aa fl_4ba:	call	fl_9ce	;  0x9ce
00be22 01c7      fl_4be:	movw	r24, r14
00be23 01b8      fl_4c0:	movw	r22, r16
00be24 01ae      fl_4c2:	movw	r20, r28
00be25 5e47      fl_4c4:	subi	r20, 0xE7	; 231
00be26 4f5f      fl_4c6:	sbci	r21, 0xFF	; 255
00be27 940e bc85 fl_4c8:	call	fl_184	;  0x184
00be29 940e bfd5 fl_4cc:	call	fl_824	;  0x824
00be2b 96a0      fl_4d0:	adiw	r28, 0x20	; 32
00be2c e0e6      fl_4d2:	ldi	r30, 0x06	; 6
00be2d 940c c14a fl_4d4:	jmp	fl_b0e	;  0xb0e
                 
                 FLOAT_MUL:
00be2f e2a0      fl_4d8:	ldi	r26, 0x20	; 32
00be30 e0b0      fl_4da:	ldi	r27, 0x00	; 0
00be31 e3e5      fl_4dc:	ldi	r30, low(fl_4e4);0x72	; 114
00be32 ebfe      fl_4de:	ldi	r31, high(fl_4e4);0x02	; 2
00be33 940c c122 fl_4e0:	jmp	fl_abe	;  0xabe
00be35 8369      fl_4e4:	std	Y+1, r22	; 0x01
00be36 837a      fl_4e6:	std	Y+2, r23	; 0x02
00be37 838b      fl_4e8:	std	Y+3, r24	; 0x03
00be38 839c      fl_4ea:	std	Y+4, r25	; 0x04
00be39 832d      fl_4ec:	std	Y+5, r18	; 0x05
00be3a 833e      fl_4ee:	std	Y+6, r19	; 0x06
00be3b 834f      fl_4f0:	std	Y+7, r20	; 0x07
00be3c 8758      fl_4f2:	std	Y+8, r21	; 0x08
00be3d 01ce      fl_4f4:	movw	r24, r28
00be3e 9601      fl_4f6:	adiw	r24, 0x01	; 1
00be3f 01be      fl_4f8:	movw	r22, r28
00be40 5f67      fl_4fa:	subi	r22, 0xF7	; 247
00be41 4f7f      fl_4fc:	sbci	r23, 0xFF	; 255
00be42 940e c0aa fl_4fe:	call	fl_9ce	;  0x9ce
00be44 01ce      fl_502:	movw	r24, r28
00be45 9605      fl_504:	adiw	r24, 0x05	; 5
00be46 01be      fl_506:	movw	r22, r28
00be47 5e6f      fl_508:	subi	r22, 0xEF	; 239
00be48 4f7f      fl_50a:	sbci	r23, 0xFF	; 255
00be49 940e c0aa fl_50c:	call	fl_9ce	;  0x9ce
00be4b 8599      fl_510:	ldd	r25, Y+9	; 0x09
00be4c 3092      fl_512:	cpi	r25, 0x02	; 2
00be4d f088      fl_514:	brcs	fl_538
00be4e 8989      fl_516:	ldd	r24, Y+17	; 0x11
00be4f 3082      fl_518:	cpi	r24, 0x02	; 2
00be50 f0c8      fl_51a:	brcs	fl_54e
00be51 3094      fl_51c:	cpi	r25, 0x04	; 4
00be52 f419      fl_51e:	brne	fl_526
00be53 3082      fl_520:	cpi	r24, 0x02	; 2
00be54 f451      fl_522:	brne	fl_538
00be55 c004      fl_524:	rjmp	fl_52e
00be56 3084      fl_526:	cpi	r24, 0x04	; 4
00be57 f429      fl_528:	brne	fl_534
00be58 3092      fl_52a:	cpi	r25, 0x02	; 2
00be59 f481      fl_52c:	brne	fl_54e
00be5a e080      fl_52e:	ldi	r24, 0x00	; 0
00be5b e091      fl_530:	ldi	r25, 0x01	; 1
00be5c c0c6      fl_532:	rjmp	fl_6c0
00be5d 3092      fl_534:	cpi	r25, 0x02	; 2
00be5e f449      fl_536:	brne	fl_54a
00be5f e020      fl_538:	ldi	r18, 0x00	; 0
00be60 859a      fl_53a:	ldd	r25, Y+10	; 0x0a
00be61 898a      fl_53c:	ldd	r24, Y+18	; 0x12
00be62 1398      fl_53e:	cpse	r25, r24
00be63 e021      fl_540:	ldi	r18, 0x01	; 1
00be64 872a      fl_542:	std	Y+10, r18	; 0x0a
00be65 01ce      fl_544:	movw	r24, r28
00be66 9609      fl_546:	adiw	r24, 0x09	; 9
00be67 c0bb      fl_548:	rjmp	fl_6c0
00be68 3082      fl_54a:	cpi	r24, 0x02	; 2
00be69 f449      fl_54c:	brne	fl_560
00be6a e020      fl_54e:	ldi	r18, 0x00	; 0
00be6b 859a      fl_550:	ldd	r25, Y+10	; 0x0a
00be6c 898a      fl_552:	ldd	r24, Y+18	; 0x12
00be6d 1398      fl_554:	cpse	r25, r24
00be6e e021      fl_556:	ldi	r18, 0x01	; 1
00be6f 8b2a      fl_558:	std	Y+18, r18	; 0x12
00be70 01ce      fl_55a:	movw	r24, r28
00be71 9641      fl_55c:	adiw	r24, 0x11	; 17
00be72 c0b0      fl_55e:	rjmp	fl_6c0
00be73 842d      fl_560:	ldd	r2, Y+13	; 0x0d
00be74 843e      fl_562:	ldd	r3, Y+14	; 0x0e
00be75 844f      fl_564:	ldd	r4, Y+15	; 0x0f
00be76 8858      fl_566:	ldd	r5, Y+16	; 0x10
00be77 886d      fl_568:	ldd	r6, Y+21	; 0x15
00be78 887e      fl_56a:	ldd	r7, Y+22	; 0x16
00be79 888f      fl_56c:	ldd	r8, Y+23	; 0x17
00be7a 8c98      fl_56e:	ldd	r9, Y+24	; 0x18
00be7b 24ee      fl_570:	eor	r14, r14
00be7c 24ff      fl_572:	eor	r15, r15
00be7d 0187      fl_574:	movw	r16, r14
00be7e 24aa      fl_576:	eor	r10, r10
00be7f 24bb      fl_578:	eor	r11, r11
00be80 0165      fl_57a:	movw	r12, r10
00be81 e040      fl_57c:	ldi	r20, 0x00	; 0
00be82 e050      fl_57e:	ldi	r21, 0x00	; 0
00be83 e060      fl_580:	ldi	r22, 0x00	; 0
00be84 e070      fl_582:	ldi	r23, 0x00	; 0
00be85 e0e0      fl_584:	ldi	r30, 0x00	; 0
00be86 e0f0      fl_586:	ldi	r31, 0x00	; 0
00be87 01c1      fl_588:	movw	r24, r2
00be88 7081      fl_58a:	andi	r24, 0x01	; 1
00be89 7090      fl_58c:	andi	r25, 0x00	; 0
00be8a 2b89      fl_58e:	or	r24, r25
00be8b f0e9      fl_590:	breq	fl_5cc
00be8c 0ce6      fl_592:	add	r14, r6
00be8d 1cf7      fl_594:	adc	r15, r7
00be8e 1d08      fl_596:	adc	r16, r8
00be8f 1d19      fl_598:	adc	r17, r9
00be90 019a      fl_59a:	movw	r18, r20
00be91 01ab      fl_59c:	movw	r20, r22
00be92 0d2a      fl_59e:	add	r18, r10
00be93 1d3b      fl_5a0:	adc	r19, r11
00be94 1d4c      fl_5a2:	adc	r20, r12
00be95 1d5d      fl_5a4:	adc	r21, r13
00be96 e080      fl_5a6:	ldi	r24, 0x00	; 0
00be97 e090      fl_5a8:	ldi	r25, 0x00	; 0
00be98 e0a0      fl_5aa:	ldi	r26, 0x00	; 0
00be99 e0b0      fl_5ac:	ldi	r27, 0x00	; 0
00be9a 14e6      fl_5ae:	cp	r14, r6
00be9b 04f7      fl_5b0:	cpc	r15, r7
00be9c 0508      fl_5b2:	cpc	r16, r8
00be9d 0519      fl_5b4:	cpc	r17, r9
00be9e f420      fl_5b6:	brcc	fl_5c0
00be9f e081      fl_5b8:	ldi	r24, 0x01	; 1
00bea0 e090      fl_5ba:	ldi	r25, 0x00	; 0
00bea1 e0a0      fl_5bc:	ldi	r26, 0x00	; 0
00bea2 e0b0      fl_5be:	ldi	r27, 0x00	; 0
00bea3 01ba      fl_5c0:	movw	r22, r20
00bea4 01a9      fl_5c2:	movw	r20, r18
00bea5 0f48      fl_5c4:	add	r20, r24
00bea6 1f59      fl_5c6:	adc	r21, r25
00bea7 1f6a      fl_5c8:	adc	r22, r26
00bea8 1f7b      fl_5ca:	adc	r23, r27
00bea9 0caa      fl_5cc:	add	r10, r10
00beaa 1cbb      fl_5ce:	adc	r11, r11
00beab 1ccc      fl_5d0:	adc	r12, r12
00beac 1cdd      fl_5d2:	adc	r13, r13
00bead fe97      fl_5d4:	sbrs	r9, 7
00beae c008      fl_5d6:	rjmp	fl_5e8
00beaf e081      fl_5d8:	ldi	r24, 0x01	; 1
00beb0 e090      fl_5da:	ldi	r25, 0x00	; 0
00beb1 e0a0      fl_5dc:	ldi	r26, 0x00	; 0
00beb2 e0b0      fl_5de:	ldi	r27, 0x00	; 0
00beb3 2aa8      fl_5e0:	or	r10, r24
00beb4 2ab9      fl_5e2:	or	r11, r25
00beb5 2aca      fl_5e4:	or	r12, r26
00beb6 2adb      fl_5e6:	or	r13, r27
00beb7 9631      fl_5e8:	adiw	r30, 0x01	; 1
00beb8 32e0      fl_5ea:	cpi	r30, 0x20	; 32
00beb9 05f1      fl_5ec:	cpc	r31, r1
00beba f049      fl_5ee:	breq	fl_602
00bebb 0c66      fl_5f0:	add	r6, r6
00bebc 1c77      fl_5f2:	adc	r7, r7
00bebd 1c88      fl_5f4:	adc	r8, r8
00bebe 1c99      fl_5f6:	adc	r9, r9
00bebf 9456      fl_5f8:	lsr	r5
00bec0 9447      fl_5fa:	ror	r4
00bec1 9437      fl_5fc:	ror	r3
00bec2 9427      fl_5fe:	ror	r2
00bec3 cfc3      fl_600:	rjmp	fl_588
00bec4 85fa      fl_602:	ldd	r31, Y+10	; 0x0a
00bec5 89ea      fl_604:	ldd	r30, Y+18	; 0x12
00bec6 892b      fl_606:	ldd	r18, Y+19	; 0x13
00bec7 893c      fl_608:	ldd	r19, Y+20	; 0x14
00bec8 858b      fl_60a:	ldd	r24, Y+11	; 0x0b
00bec9 859c      fl_60c:	ldd	r25, Y+12	; 0x0c
00beca 0f28      fl_60e:	add	r18, r24
00becb 1f39      fl_610:	adc	r19, r25
00becc 5f2e      fl_612:	subi	r18, 0xFE	; 254
00becd 4f3f      fl_614:	sbci	r19, 0xFF	; 255
00bece c017      fl_616:	rjmp	fl_646
00becf 01ca      fl_618:	movw	r24, r20
00bed0 7081      fl_61a:	andi	r24, 0x01	; 1
00bed1 7090      fl_61c:	andi	r25, 0x00	; 0
00bed2 2b89      fl_61e:	or	r24, r25
00bed3 f061      fl_620:	breq	fl_63a
00bed4 9516      fl_622:	lsr	r17
00bed5 9507      fl_624:	ror	r16
00bed6 94f7      fl_626:	ror	r15
00bed7 94e7      fl_628:	ror	r14
00bed8 e080      fl_62a:	ldi	r24, 0x00	; 0
00bed9 e090      fl_62c:	ldi	r25, 0x00	; 0
00beda e0a0      fl_62e:	ldi	r26, 0x00	; 0
00bedb e8b0      fl_630:	ldi	r27, 0x80	; 128
00bedc 2ae8      fl_632:	or	r14, r24
00bedd 2af9      fl_634:	or	r15, r25
00bede 2b0a      fl_636:	or	r16, r26
00bedf 2b1b      fl_638:	or	r17, r27
00bee0 9576      fl_63a:	lsr	r23
00bee1 9567      fl_63c:	ror	r22
00bee2 9557      fl_63e:	ror	r21
00bee3 9547      fl_640:	ror	r20
00bee4 5f2f      fl_642:	subi	r18, 0xFF	; 255
00bee5 4f3f      fl_644:	sbci	r19, 0xFF	; 255
00bee6 fd77      fl_646:	sbrc	r23, 7
00bee7 cfe7      fl_648:	rjmp	fl_618
00bee8 c00c      fl_64a:	rjmp	fl_664
00bee9 0f44      fl_64c:	add	r20, r20
00beea 1f55      fl_64e:	adc	r21, r21
00beeb 1f66      fl_650:	adc	r22, r22
00beec 1f77      fl_652:	adc	r23, r23
00beed fd17      fl_654:	sbrc	r17, 7
00beee 6041      fl_656:	ori	r20, 0x01	; 1
00beef 0cee      fl_658:	add	r14, r14
00bef0 1cff      fl_65a:	adc	r15, r15
00bef1 1f00      fl_65c:	adc	r16, r16
00bef2 1f11      fl_65e:	adc	r17, r17
00bef3 5021      fl_660:	subi	r18, 0x01	; 1
00bef4 4030      fl_662:	sbci	r19, 0x00	; 0
00bef5 3040      fl_664:	cpi	r20, 0x00	; 0
00bef6 e090      fl_666:	ldi	r25, 0x00	; 0
00bef7 0759      fl_668:	cpc	r21, r25
00bef8 e090      fl_66a:	ldi	r25, 0x00	; 0
00bef9 0769      fl_66c:	cpc	r22, r25
00befa e490      fl_66e:	ldi	r25, 0x40	; 64
00befb 0779      fl_670:	cpc	r23, r25
00befc f360      fl_672:	brcs	fl_64c
00befd 8f2b      fl_674:	std	Y+27, r18	; 0x1b
00befe 8f3c      fl_676:	std	Y+28, r19	; 0x1c
00beff 01db      fl_678:	movw	r26, r22
00bf00 01ca      fl_67a:	movw	r24, r20
00bf01 778f      fl_67c:	andi	r24, 0x7F	; 127
00bf02 7090      fl_67e:	andi	r25, 0x00	; 0
00bf03 70a0      fl_680:	andi	r26, 0x00	; 0
00bf04 70b0      fl_682:	andi	r27, 0x00	; 0
00bf05 3480      fl_684:	cpi	r24, 0x40	; 64
00bf06 0591      fl_686:	cpc	r25, r1
00bf07 05a1      fl_688:	cpc	r26, r1
00bf08 05b1      fl_68a:	cpc	r27, r1
00bf09 f461      fl_68c:	brne	fl_6a6
00bf0a fd47      fl_68e:	sbrc	r20, 7
00bf0b c00a      fl_690:	rjmp	fl_6a6
00bf0c 14e1      fl_692:	cp	r14, r1
00bf0d 04f1      fl_694:	cpc	r15, r1
00bf0e 0501      fl_696:	cpc	r16, r1
00bf0f 0511      fl_698:	cpc	r17, r1
00bf10 f029      fl_69a:	breq	fl_6a6
00bf11 5c40      fl_69c:	subi	r20, 0xC0	; 192
00bf12 4f5f      fl_69e:	sbci	r21, 0xFF	; 255
00bf13 4f6f      fl_6a0:	sbci	r22, 0xFF	; 255
00bf14 4f7f      fl_6a2:	sbci	r23, 0xFF	; 255
00bf15 7840      fl_6a4:	andi	r20, 0x80	; 128
00bf16 8e1a      fl_6a6:	std	Y+26, r1	; 0x1a
00bf17 17fe      fl_6a8:	cp	r31, r30
00bf18 f011      fl_6aa:	breq	fl_6b0
00bf19 e081      fl_6ac:	ldi	r24, 0x01	; 1
00bf1a 8f8a      fl_6ae:	std	Y+26, r24	; 0x1a
00bf1b 8f4d      fl_6b0:	std	Y+29, r20	; 0x1d
00bf1c 8f5e      fl_6b2:	std	Y+30, r21	; 0x1e
00bf1d 8f6f      fl_6b4:	std	Y+31, r22	; 0x1f
00bf1e a378      fl_6b6:	std	Y+32, r23	; 0x20
00bf1f e083      fl_6b8:	ldi	r24, 0x03	; 3
00bf20 8f89      fl_6ba:	std	Y+25, r24	; 0x19
00bf21 01ce      fl_6bc:	movw	r24, r28
00bf22 9649      fl_6be:	adiw	r24, 0x19	; 25
00bf23 940e bfd5 fl_6c0:	call	fl_824	;  0x824
00bf25 96a0      fl_6c4:	adiw	r28, 0x20	; 32
00bf26 e1e2      fl_6c6:	ldi	r30, 0x12	; 18
00bf27 940c c13e fl_6c8:	jmp	fl_af6	;  0xaf6
                 
                 FLOAT_DIV:
00bf29 e1a8      fl_6cc:	ldi	r26, 0x18	; 24
00bf2a e0b0      fl_6ce:	ldi	r27, 0x00	; 0
00bf2b e2ef      fl_6d0:	ldi	r30, low(fl_6d8); 0x6C	; 108
00bf2c ebff      fl_6d2:	ldi	r31, high(fl_6d8); 0x03	; 3
00bf2d 940c c12a fl_6d4:	jmp	fl_ace	;  0xace
00bf2f 8369      fl_6d8:	std	Y+1, r22	; 0x01
00bf30 837a      fl_6da:	std	Y+2, r23	; 0x02
00bf31 838b      fl_6dc:	std	Y+3, r24	; 0x03
00bf32 839c      fl_6de:	std	Y+4, r25	; 0x04
00bf33 832d      fl_6e0:	std	Y+5, r18	; 0x05
00bf34 833e      fl_6e2:	std	Y+6, r19	; 0x06
00bf35 834f      fl_6e4:	std	Y+7, r20	; 0x07
00bf36 8758      fl_6e6:	std	Y+8, r21	; 0x08
00bf37 e0b9      fl_6e8:	ldi	r27, 0x09	; 9
00bf38 2eeb      fl_6ea:	mov	r14, r27
00bf39 2cf1      fl_6ec:	mov	r15, r1
00bf3a 0eec      fl_6ee:	add	r14, r28
00bf3b 1efd      fl_6f0:	adc	r15, r29
00bf3c 01ce      fl_6f2:	movw	r24, r28
00bf3d 9601      fl_6f4:	adiw	r24, 0x01	; 1
00bf3e 01b7      fl_6f6:	movw	r22, r14
00bf3f 940e c0aa fl_6f8:	call	fl_9ce	;  0x9ce
00bf41 018e      fl_6fc:	movw	r16, r28
00bf42 5e0f      fl_6fe:	subi	r16, 0xEF	; 239
00bf43 4f1f      fl_700:	sbci	r17, 0xFF	; 255
00bf44 01ce      fl_702:	movw	r24, r28
00bf45 9605      fl_704:	adiw	r24, 0x05	; 5
00bf46 01b8      fl_706:	movw	r22, r16
00bf47 940e c0aa fl_708:	call	fl_9ce	;  0x9ce
00bf49 8529      fl_70c:	ldd	r18, Y+9	; 0x09
00bf4a 3022      fl_70e:	cpi	r18, 0x02	; 2
00bf4b f408      fl_710:	brcc	fl_714
00bf4c c07e      fl_712:	rjmp	fl_810
00bf4d 8939      fl_714:	ldd	r19, Y+17	; 0x11
00bf4e 3032      fl_716:	cpi	r19, 0x02	; 2
00bf4f f410      fl_718:	brcc	fl_71e
00bf50 01b8      fl_71a:	movw	r22, r16
00bf51 c07c      fl_71c:	rjmp	fl_816
00bf52 858a      fl_71e:	ldd	r24, Y+10	; 0x0a
00bf53 899a      fl_720:	ldd	r25, Y+18	; 0x12
00bf54 2789      fl_722:	eor	r24, r25
00bf55 878a      fl_724:	std	Y+10, r24	; 0x0a
00bf56 3024      fl_726:	cpi	r18, 0x04	; 4
00bf57 f011      fl_728:	breq	fl_72e
00bf58 3022      fl_72a:	cpi	r18, 0x02	; 2
00bf59 f431      fl_72c:	brne	fl_73a
00bf5a 1723      fl_72e:	cp	r18, r19
00bf5b f009      fl_730:	breq	fl_734
00bf5c c06e      fl_732:	rjmp	fl_810
00bf5d e060      fl_734:	ldi	r22, 0x00	; 0
00bf5e e071      fl_736:	ldi	r23, 0x01	; 1
00bf5f c06e      fl_738:	rjmp	fl_816
00bf60 3034      fl_73a:	cpi	r19, 0x04	; 4
00bf61 f439      fl_73c:	brne	fl_74c
00bf62 861d      fl_73e:	std	Y+13, r1	; 0x0d
00bf63 861e      fl_740:	std	Y+14, r1	; 0x0e
00bf64 861f      fl_742:	std	Y+15, r1	; 0x0f
00bf65 8a18      fl_744:	std	Y+16, r1	; 0x10
00bf66 861c      fl_746:	std	Y+12, r1	; 0x0c
00bf67 861b      fl_748:	std	Y+11, r1	; 0x0b
00bf68 c004      fl_74a:	rjmp	fl_754
00bf69 3032      fl_74c:	cpi	r19, 0x02	; 2
00bf6a f421      fl_74e:	brne	fl_758
00bf6b e084      fl_750:	ldi	r24, 0x04	; 4
00bf6c 8789      fl_752:	std	Y+9, r24	; 0x09
00bf6d 01b7      fl_754:	movw	r22, r14
00bf6e c05f      fl_756:	rjmp	fl_816
00bf6f 852b      fl_758:	ldd	r18, Y+11	; 0x0b
00bf70 853c      fl_75a:	ldd	r19, Y+12	; 0x0c
00bf71 898b      fl_75c:	ldd	r24, Y+19	; 0x13
00bf72 899c      fl_75e:	ldd	r25, Y+20	; 0x14
00bf73 1b28      fl_760:	sub	r18, r24
00bf74 0b39      fl_762:	sbc	r19, r25
00bf75 873c      fl_764:	std	Y+12, r19	; 0x0c
00bf76 872b      fl_766:	std	Y+11, r18	; 0x0b
00bf77 84ed      fl_768:	ldd	r14, Y+13	; 0x0d
00bf78 84fe      fl_76a:	ldd	r15, Y+14	; 0x0e
00bf79 850f      fl_76c:	ldd	r16, Y+15	; 0x0f
00bf7a 8918      fl_76e:	ldd	r17, Y+16	; 0x10
00bf7b 88ad      fl_770:	ldd	r10, Y+21	; 0x15
00bf7c 88be      fl_772:	ldd	r11, Y+22	; 0x16
00bf7d 88cf      fl_774:	ldd	r12, Y+23	; 0x17
00bf7e 8cd8      fl_776:	ldd	r13, Y+24	; 0x18
00bf7f 14ea      fl_778:	cp	r14, r10
00bf80 04fb      fl_77a:	cpc	r15, r11
00bf81 050c      fl_77c:	cpc	r16, r12
00bf82 051d      fl_77e:	cpc	r17, r13
00bf83 f440      fl_780:	brcc	fl_792
00bf84 0cee      fl_782:	add	r14, r14
00bf85 1cff      fl_784:	adc	r15, r15
00bf86 1f00      fl_786:	adc	r16, r16
00bf87 1f11      fl_788:	adc	r17, r17
00bf88 5021      fl_78a:	subi	r18, 0x01	; 1
00bf89 4030      fl_78c:	sbci	r19, 0x00	; 0
00bf8a 873c      fl_78e:	std	Y+12, r19	; 0x0c
00bf8b 872b      fl_790:	std	Y+11, r18	; 0x0b
00bf8c e020      fl_792:	ldi	r18, 0x00	; 0
00bf8d e030      fl_794:	ldi	r19, 0x00	; 0
00bf8e e040      fl_796:	ldi	r20, 0x00	; 0
00bf8f e050      fl_798:	ldi	r21, 0x00	; 0
00bf90 e080      fl_79a:	ldi	r24, 0x00	; 0
00bf91 e090      fl_79c:	ldi	r25, 0x00	; 0
00bf92 e0a0      fl_79e:	ldi	r26, 0x00	; 0
00bf93 e4b0      fl_7a0:	ldi	r27, 0x40	; 64
00bf94 e060      fl_7a2:	ldi	r22, 0x00	; 0
00bf95 e070      fl_7a4:	ldi	r23, 0x00	; 0
00bf96 14ea      fl_7a6:	cp	r14, r10
00bf97 04fb      fl_7a8:	cpc	r15, r11
00bf98 050c      fl_7aa:	cpc	r16, r12
00bf99 051d      fl_7ac:	cpc	r17, r13
00bf9a f040      fl_7ae:	brcs	fl_7c0
00bf9b 2b28      fl_7b0:	or	r18, r24
00bf9c 2b39      fl_7b2:	or	r19, r25
00bf9d 2b4a      fl_7b4:	or	r20, r26
00bf9e 2b5b      fl_7b6:	or	r21, r27
00bf9f 18ea      fl_7b8:	sub	r14, r10
00bfa0 08fb      fl_7ba:	sbc	r15, r11
00bfa1 090c      fl_7bc:	sbc	r16, r12
00bfa2 091d      fl_7be:	sbc	r17, r13
00bfa3 95b6      fl_7c0:	lsr	r27
00bfa4 95a7      fl_7c2:	ror	r26
00bfa5 9597      fl_7c4:	ror	r25
00bfa6 9587      fl_7c6:	ror	r24
00bfa7 0cee      fl_7c8:	add	r14, r14
00bfa8 1cff      fl_7ca:	adc	r15, r15
00bfa9 1f00      fl_7cc:	adc	r16, r16
00bfaa 1f11      fl_7ce:	adc	r17, r17
00bfab 5f6f      fl_7d0:	subi	r22, 0xFF	; 255
00bfac 4f7f      fl_7d2:	sbci	r23, 0xFF	; 255
00bfad 316f      fl_7d4:	cpi	r22, 0x1F	; 31
00bfae 0571      fl_7d6:	cpc	r23, r1
00bfaf f731      fl_7d8:	brne	fl_7a6
00bfb0 01da      fl_7da:	movw	r26, r20
00bfb1 01c9      fl_7dc:	movw	r24, r18
00bfb2 778f      fl_7de:	andi	r24, 0x7F	; 127
00bfb3 7090      fl_7e0:	andi	r25, 0x00	; 0
00bfb4 70a0      fl_7e2:	andi	r26, 0x00	; 0
00bfb5 70b0      fl_7e4:	andi	r27, 0x00	; 0
00bfb6 3480      fl_7e6:	cpi	r24, 0x40	; 64
00bfb7 0591      fl_7e8:	cpc	r25, r1
00bfb8 05a1      fl_7ea:	cpc	r26, r1
00bfb9 05b1      fl_7ec:	cpc	r27, r1
00bfba f461      fl_7ee:	brne	fl_808
00bfbb fd27      fl_7f0:	sbrc	r18, 7
00bfbc c00a      fl_7f2:	rjmp	fl_808
00bfbd 14e1      fl_7f4:	cp	r14, r1
00bfbe 04f1      fl_7f6:	cpc	r15, r1
00bfbf 0501      fl_7f8:	cpc	r16, r1
00bfc0 0511      fl_7fa:	cpc	r17, r1
00bfc1 f029      fl_7fc:	breq	fl_808
00bfc2 5c20      fl_7fe:	subi	r18, 0xC0	; 192
00bfc3 4f3f      fl_800:	sbci	r19, 0xFF	; 255
00bfc4 4f4f      fl_802:	sbci	r20, 0xFF	; 255
00bfc5 4f5f      fl_804:	sbci	r21, 0xFF	; 255
00bfc6 7820      fl_806:	andi	r18, 0x80	; 128
00bfc7 872d      fl_808:	std	Y+13, r18	; 0x0d
00bfc8 873e      fl_80a:	std	Y+14, r19	; 0x0e
00bfc9 874f      fl_80c:	std	Y+15, r20	; 0x0f
00bfca 8b58      fl_80e:	std	Y+16, r21	; 0x10
00bfcb 01be      fl_810:	movw	r22, r28
00bfcc 5f67      fl_812:	subi	r22, 0xF7	; 247
00bfcd 4f7f      fl_814:	sbci	r23, 0xFF	; 255
00bfce 01cb      fl_816:	movw	r24, r22
00bfcf 940e bfd5 fl_818:	call	fl_824	;  0x824
00bfd1 9668      fl_81c:	adiw	r28, 0x18	; 24
00bfd2 e0ea      fl_81e:	ldi	r30, 0x0A	; 10
00bfd3 940c c146 fl_820:	jmp	fl_b06	;  0xb06
00bfd5 92df      fl_824:	push	r13
00bfd6 92ef      fl_826:	push	r14
00bfd7 92ff      fl_828:	push	r15
00bfd8 930f      fl_82a:	push	r16
00bfd9 931f      fl_82c:	push	r17
00bfda 01fc      fl_82e:	movw	r30, r24
00bfdb 80e4      fl_830:	ldd	r14, Z+4	; 0x04
00bfdc 80f5      fl_832:	ldd	r15, Z+5	; 0x05
00bfdd 8106      fl_834:	ldd	r16, Z+6	; 0x06
00bfde 8117      fl_836:	ldd	r17, Z+7	; 0x07
00bfdf 80d1      fl_838:	ldd	r13, Z+1	; 0x01
00bfe0 8180      fl_83a:	ld	r24, Z
00bfe1 3082      fl_83c:	cpi	r24, 0x02	; 2
00bfe2 f448      fl_83e:	brcc	fl_852
00bfe3 e080      fl_840:	ldi	r24, 0x00	; 0
00bfe4 e090      fl_842:	ldi	r25, 0x00	; 0
00bfe5 e1a0      fl_844:	ldi	r26, 0x10	; 16
00bfe6 e0b0      fl_846:	ldi	r27, 0x00	; 0
00bfe7 2ae8      fl_848:	or	r14, r24
00bfe8 2af9      fl_84a:	or	r15, r25
00bfe9 2b0a      fl_84c:	or	r16, r26
00bfea 2b1b      fl_84e:	or	r17, r27
00bfeb c0a5      fl_850:	rjmp	fl_99c
00bfec 3084      fl_852:	cpi	r24, 0x04	; 4
00bfed f409      fl_854:	brne	fl_858
00bfee c09f      fl_856:	rjmp	fl_996
00bfef 3082      fl_858:	cpi	r24, 0x02	; 2
00bff0 f421      fl_85a:	brne	fl_864
00bff1 24ee      fl_85c:	eor	r14, r14
00bff2 24ff      fl_85e:	eor	r15, r15
00bff3 0187      fl_860:	movw	r16, r14
00bff4 c005      fl_862:	rjmp	fl_86e
00bff5 14e1      fl_864:	cp	r14, r1
00bff6 04f1      fl_866:	cpc	r15, r1
00bff7 0501      fl_868:	cpc	r16, r1
00bff8 0511      fl_86a:	cpc	r17, r1
00bff9 f419      fl_86c:	brne	fl_874
00bffa e0e0      fl_86e:	ldi	r30, 0x00	; 0
00bffb e0f0      fl_870:	ldi	r31, 0x00	; 0
00bffc c096      fl_872:	rjmp	fl_9a0
00bffd 8162      fl_874:	ldd	r22, Z+2	; 0x02
00bffe 8173      fl_876:	ldd	r23, Z+3	; 0x03
00bfff ef9f      fl_878:	ldi	r25, 0xFF	; 255
00c000 3862      fl_87a:	cpi	r22, 0x82	; 130
00c001 0779      fl_87c:	cpc	r23, r25
00c002 f00c      fl_87e:	brlt	fl_882
00c003 c05b      fl_880:	rjmp	fl_938
00c004 e822      fl_882:	ldi	r18, 0x82	; 130
00c005 ef3f      fl_884:	ldi	r19, 0xFF	; 255
00c006 1b26      fl_886:	sub	r18, r22
00c007 0b37      fl_888:	sbc	r19, r23
00c008 312a      fl_88a:	cpi	r18, 0x1A	; 26
00c009 0531      fl_88c:	cpc	r19, r1
00c00a f02c      fl_88e:	brlt	fl_89a
00c00b e020      fl_890:	ldi	r18, 0x00	; 0
00c00c e030      fl_892:	ldi	r19, 0x00	; 0
00c00d e040      fl_894:	ldi	r20, 0x00	; 0
00c00e e050      fl_896:	ldi	r21, 0x00	; 0
00c00f c02a      fl_898:	rjmp	fl_8ee
00c010 01b8      fl_89a:	movw	r22, r16
00c011 01a7      fl_89c:	movw	r20, r14
00c012 2e02      fl_89e:	mov	r0, r18
00c013 c004      fl_8a0:	rjmp	fl_8aa
00c014 9576      fl_8a2:	lsr	r23
00c015 9567      fl_8a4:	ror	r22
00c016 9557      fl_8a6:	ror	r21
00c017 9547      fl_8a8:	ror	r20
00c018 940a      fl_8aa:	dec	r0
00c019 f7d2      fl_8ac:	brpl	fl_8a2
00c01a e081      fl_8ae:	ldi	r24, 0x01	; 1
00c01b e090      fl_8b0:	ldi	r25, 0x00	; 0
00c01c e0a0      fl_8b2:	ldi	r26, 0x00	; 0
00c01d e0b0      fl_8b4:	ldi	r27, 0x00	; 0
00c01e c004      fl_8b6:	rjmp	fl_8c0
00c01f 0f88      fl_8b8:	add	r24, r24
00c020 1f99      fl_8ba:	adc	r25, r25
00c021 1faa      fl_8bc:	adc	r26, r26
00c022 1fbb      fl_8be:	adc	r27, r27
00c023 952a      fl_8c0:	dec	r18
00c024 f7d2      fl_8c2:	brpl	fl_8b8
00c025 9701      fl_8c4:	sbiw	r24, 0x01	; 1
00c026 09a1      fl_8c6:	sbc	r26, r1
00c027 09b1      fl_8c8:	sbc	r27, r1
00c028 218e      fl_8ca:	and	r24, r14
00c029 219f      fl_8cc:	and	r25, r15
00c02a 23a0      fl_8ce:	and	r26, r16
00c02b 23b1      fl_8d0:	and	r27, r17
00c02c 9700      fl_8d2:	sbiw	r24, 0x00	; 0
00c02d 05a1      fl_8d4:	cpc	r26, r1
00c02e 05b1      fl_8d6:	cpc	r27, r1
00c02f f021      fl_8d8:	breq	fl_8e2
00c030 e081      fl_8da:	ldi	r24, 0x01	; 1
00c031 e090      fl_8dc:	ldi	r25, 0x00	; 0
00c032 e0a0      fl_8de:	ldi	r26, 0x00	; 0
00c033 e0b0      fl_8e0:	ldi	r27, 0x00	; 0
00c034 019a      fl_8e2:	movw	r18, r20
00c035 01ab      fl_8e4:	movw	r20, r22
00c036 2b28      fl_8e6:	or	r18, r24
00c037 2b39      fl_8e8:	or	r19, r25
00c038 2b4a      fl_8ea:	or	r20, r26
00c039 2b5b      fl_8ec:	or	r21, r27
00c03a 01da      fl_8ee:	movw	r26, r20
00c03b 01c9      fl_8f0:	movw	r24, r18
00c03c 778f      fl_8f2:	andi	r24, 0x7F	; 127
00c03d 7090      fl_8f4:	andi	r25, 0x00	; 0
00c03e 70a0      fl_8f6:	andi	r26, 0x00	; 0
00c03f 70b0      fl_8f8:	andi	r27, 0x00	; 0
00c040 3480      fl_8fa:	cpi	r24, 0x40	; 64
00c041 0591      fl_8fc:	cpc	r25, r1
00c042 05a1      fl_8fe:	cpc	r26, r1
00c043 05b1      fl_900:	cpc	r27, r1
00c044 f439      fl_902:	brne	fl_912
00c045 ff27      fl_904:	sbrs	r18, 7
00c046 c009      fl_906:	rjmp	fl_91a
00c047 5c20      fl_908:	subi	r18, 0xC0	; 192
00c048 4f3f      fl_90a:	sbci	r19, 0xFF	; 255
00c049 4f4f      fl_90c:	sbci	r20, 0xFF	; 255
00c04a 4f5f      fl_90e:	sbci	r21, 0xFF	; 255
00c04b c004      fl_910:	rjmp	fl_91a
00c04c 5c21      fl_912:	subi	r18, 0xC1	; 193
00c04d 4f3f      fl_914:	sbci	r19, 0xFF	; 255
00c04e 4f4f      fl_916:	sbci	r20, 0xFF	; 255
00c04f 4f5f      fl_918:	sbci	r21, 0xFF	; 255
00c050 e0e0      fl_91a:	ldi	r30, 0x00	; 0
00c051 e0f0      fl_91c:	ldi	r31, 0x00	; 0
00c052 3020      fl_91e:	cpi	r18, 0x00	; 0
00c053 e0a0      fl_920:	ldi	r26, 0x00	; 0
00c054 073a      fl_922:	cpc	r19, r26
00c055 e0a0      fl_924:	ldi	r26, 0x00	; 0
00c056 074a      fl_926:	cpc	r20, r26
00c057 e4a0      fl_928:	ldi	r26, 0x40	; 64
00c058 075a      fl_92a:	cpc	r21, r26
00c059 f010      fl_92c:	brcs	fl_932
00c05a e0e1      fl_92e:	ldi	r30, 0x01	; 1
00c05b e0f0      fl_930:	ldi	r31, 0x00	; 0
00c05c 0179      fl_932:	movw	r14, r18
00c05d 018a      fl_934:	movw	r16, r20
00c05e c027      fl_936:	rjmp	fl_986
00c05f 3860      fl_938:	cpi	r22, 0x80	; 128
00c060 0571      fl_93a:	cpc	r23, r1
00c061 f564      fl_93c:	brge	fl_996
00c062 01fb      fl_93e:	movw	r30, r22
00c063 58e1      fl_940:	subi	r30, 0x81	; 129
00c064 4fff      fl_942:	sbci	r31, 0xFF	; 255
00c065 01d8      fl_944:	movw	r26, r16
00c066 01c7      fl_946:	movw	r24, r14
00c067 778f      fl_948:	andi	r24, 0x7F	; 127
00c068 7090      fl_94a:	andi	r25, 0x00	; 0
00c069 70a0      fl_94c:	andi	r26, 0x00	; 0
00c06a 70b0      fl_94e:	andi	r27, 0x00	; 0
00c06b 3480      fl_950:	cpi	r24, 0x40	; 64
00c06c 0591      fl_952:	cpc	r25, r1
00c06d 05a1      fl_954:	cpc	r26, r1
00c06e 05b1      fl_956:	cpc	r27, r1
00c06f f439      fl_958:	brne	fl_968
00c070 fee7      fl_95a:	sbrs	r14, 7
00c071 c00d      fl_95c:	rjmp	fl_978
00c072 e480      fl_95e:	ldi	r24, 0x40	; 64
00c073 e090      fl_960:	ldi	r25, 0x00	; 0
00c074 e0a0      fl_962:	ldi	r26, 0x00	; 0
00c075 e0b0      fl_964:	ldi	r27, 0x00	; 0
00c076 c004      fl_966:	rjmp	fl_970
00c077 e38f      fl_968:	ldi	r24, 0x3F	; 63
00c078 e090      fl_96a:	ldi	r25, 0x00	; 0
00c079 e0a0      fl_96c:	ldi	r26, 0x00	; 0
00c07a e0b0      fl_96e:	ldi	r27, 0x00	; 0
00c07b 0ee8      fl_970:	add	r14, r24
00c07c 1ef9      fl_972:	adc	r15, r25
00c07d 1f0a      fl_974:	adc	r16, r26
00c07e 1f1b      fl_976:	adc	r17, r27
00c07f ff17      fl_978:	sbrs	r17, 7
00c080 c005      fl_97a:	rjmp	fl_986
00c081 9516      fl_97c:	lsr	r17
00c082 9507      fl_97e:	ror	r16
00c083 94f7      fl_980:	ror	r15
00c084 94e7      fl_982:	ror	r14
00c085 9631      fl_984:	adiw	r30, 0x01	; 1
00c086 e087      fl_986:	ldi	r24, 0x07	; 7
00c087 9516      fl_988:	lsr	r17
00c088 9507      fl_98a:	ror	r16
00c089 94f7      fl_98c:	ror	r15
00c08a 94e7      fl_98e:	ror	r14
00c08b 958a      fl_990:	dec	r24
00c08c f7d1      fl_992:	brne	fl_988
00c08d c005      fl_994:	rjmp	fl_9a0
00c08e 24ee      fl_996:	eor	r14, r14
00c08f 24ff      fl_998:	eor	r15, r15
00c090 0187      fl_99a:	movw	r16, r14
00c091 efef      fl_99c:	ldi	r30, 0xFF	; 255
00c092 e0f0      fl_99e:	ldi	r31, 0x00	; 0
00c093 2f6e      fl_9a0:	mov	r22, r30
00c094 9567      fl_9a2:	ror	r22
00c095 2766      fl_9a4:	eor	r22, r22
00c096 9567      fl_9a6:	ror	r22
00c097 2f90      fl_9a8:	mov	r25, r16
00c098 779f      fl_9aa:	andi	r25, 0x7F	; 127
00c099 94d7      fl_9ac:	ror	r13
00c09a 24dd      fl_9ae:	eor	r13, r13
00c09b 94d7      fl_9b0:	ror	r13
00c09c 2f8e      fl_9b2:	mov	r24, r30
00c09d 9586      fl_9b4:	lsr	r24
00c09e 2f49      fl_9b6:	mov	r20, r25
00c09f 2b46      fl_9b8:	or	r20, r22
00c0a0 2f58      fl_9ba:	mov	r21, r24
00c0a1 295d      fl_9bc:	or	r21, r13
00c0a2 01b7      fl_9be:	movw	r22, r14
00c0a3 01ca      fl_9c0:	movw	r24, r20
00c0a4 911f      fl_9c2:	pop	r17
00c0a5 910f      fl_9c4:	pop	r16
00c0a6 90ff      fl_9c6:	pop	r15
00c0a7 90ef      fl_9c8:	pop	r14
00c0a8 90df      fl_9ca:	pop	r13
00c0a9 9508      fl_9cc:	ret
00c0aa 01fc      fl_9ce:	movw	r30, r24
00c0ab 01db      fl_9d0:	movw	r26, r22
00c0ac 8140      fl_9d2:	ld	r20, Z
00c0ad 8151      fl_9d4:	ldd	r21, Z+1	; 0x01
00c0ae 8122      fl_9d6:	ldd	r18, Z+2	; 0x02
00c0af 2f62      fl_9d8:	mov	r22, r18
00c0b0 776f      fl_9da:	andi	r22, 0x7F	; 127
00c0b1 e070      fl_9dc:	ldi	r23, 0x00	; 0
00c0b2 1f22      fl_9de:	adc	r18, r18
00c0b3 2722      fl_9e0:	eor	r18, r18
00c0b4 1f22      fl_9e2:	adc	r18, r18
00c0b5 8193      fl_9e4:	ldd	r25, Z+3	; 0x03
00c0b6 2f89      fl_9e6:	mov	r24, r25
00c0b7 0f88      fl_9e8:	add	r24, r24
00c0b8 2b82      fl_9ea:	or	r24, r18
00c0b9 2f28      fl_9ec:	mov	r18, r24
00c0ba e030      fl_9ee:	ldi	r19, 0x00	; 0
00c0bb 1f99      fl_9f0:	adc	r25, r25
00c0bc 2799      fl_9f2:	eor	r25, r25
00c0bd 1f99      fl_9f4:	adc	r25, r25
00c0be 9611      fl_9f6:	adiw	r26, 0x01	; 1
00c0bf 939c      fl_9f8:	st	X, r25
00c0c0 9711      fl_9fa:	sbiw	r26, 0x01	; 1
00c0c1 1521      fl_9fc:	cp	r18, r1
00c0c2 0531      fl_9fe:	cpc	r19, r1
00c0c3 f5a9      fl_a00:	brne	fl_a6c
00c0c4 1541      fl_a02:	cp	r20, r1
00c0c5 0551      fl_a04:	cpc	r21, r1
00c0c6 0561      fl_a06:	cpc	r22, r1
00c0c7 0571      fl_a08:	cpc	r23, r1
00c0c8 f411      fl_a0a:	brne	fl_a10
00c0c9 e082      fl_a0c:	ldi	r24, 0x02	; 2
00c0ca c037      fl_a0e:	rjmp	fl_a7e
00c0cb e882      fl_a10:	ldi	r24, 0x82	; 130
00c0cc ef9f      fl_a12:	ldi	r25, 0xFF	; 255
00c0cd 9613      fl_a14:	adiw	r26, 0x03	; 3
00c0ce 939c      fl_a16:	st	X, r25
00c0cf 938e      fl_a18:	st	-X, r24
00c0d0 9712      fl_a1a:	sbiw	r26, 0x02	; 2
00c0d1 019a      fl_a1c:	movw	r18, r20
00c0d2 01ab      fl_a1e:	movw	r20, r22
00c0d3 e067      fl_a20:	ldi	r22, 0x07	; 7
00c0d4 0f22      fl_a22:	add	r18, r18
00c0d5 1f33      fl_a24:	adc	r19, r19
00c0d6 1f44      fl_a26:	adc	r20, r20
00c0d7 1f55      fl_a28:	adc	r21, r21
00c0d8 956a      fl_a2a:	dec	r22
00c0d9 f7d1      fl_a2c:	brne	fl_a22
00c0da e083      fl_a2e:	ldi	r24, 0x03	; 3
00c0db 938c      fl_a30:	st	X, r24
00c0dc c00d      fl_a32:	rjmp	fl_a4e
00c0dd 0f22      fl_a34:	add	r18, r18
00c0de 1f33      fl_a36:	adc	r19, r19
00c0df 1f44      fl_a38:	adc	r20, r20
00c0e0 1f55      fl_a3a:	adc	r21, r21
00c0e1 9612      fl_a3c:	adiw	r26, 0x02	; 2
00c0e2 918d      fl_a3e:	ld	r24, X+
00c0e3 919c      fl_a40:	ld	r25, X
00c0e4 9713      fl_a42:	sbiw	r26, 0x03	; 3
00c0e5 9701      fl_a44:	sbiw	r24, 0x01	; 1
00c0e6 9613      fl_a46:	adiw	r26, 0x03	; 3
00c0e7 939c      fl_a48:	st	X, r25
00c0e8 938e      fl_a4a:	st	-X, r24
00c0e9 9712      fl_a4c:	sbiw	r26, 0x02	; 2
00c0ea 3020      fl_a4e:	cpi	r18, 0x00	; 0
00c0eb e080      fl_a50:	ldi	r24, 0x00	; 0
00c0ec 0738      fl_a52:	cpc	r19, r24
00c0ed e080      fl_a54:	ldi	r24, 0x00	; 0
00c0ee 0748      fl_a56:	cpc	r20, r24
00c0ef e480      fl_a58:	ldi	r24, 0x40	; 64
00c0f0 0758      fl_a5a:	cpc	r21, r24
00c0f1 f358      fl_a5c:	brcs	fl_a34
00c0f2 9614      fl_a5e:	adiw	r26, 0x04	; 4
00c0f3 932d      fl_a60:	st	X+, r18
00c0f4 933d      fl_a62:	st	X+, r19
00c0f5 934d      fl_a64:	st	X+, r20
00c0f6 935c      fl_a66:	st	X, r21
00c0f7 9717      fl_a68:	sbiw	r26, 0x07	; 7
00c0f8 9508      fl_a6a:	ret
00c0f9 3f2f      fl_a6c:	cpi	r18, 0xFF	; 255
00c0fa 0531      fl_a6e:	cpc	r19, r1
00c0fb f479      fl_a70:	brne	fl_a90
00c0fc 1541      fl_a72:	cp	r20, r1
00c0fd 0551      fl_a74:	cpc	r21, r1
00c0fe 0561      fl_a76:	cpc	r22, r1
00c0ff 0571      fl_a78:	cpc	r23, r1
00c100 f419      fl_a7a:	brne	fl_a82
00c101 e084      fl_a7c:	ldi	r24, 0x04	; 4
00c102 938c      fl_a7e:	st	X, r24
00c103 9508      fl_a80:	ret
00c104 ff64      fl_a82:	sbrs	r22, 4
00c105 c003      fl_a84:	rjmp	fl_a8c
00c106 e081      fl_a86:	ldi	r24, 0x01	; 1
00c107 938c      fl_a88:	st	X, r24
00c108 c012      fl_a8a:	rjmp	fl_ab0
00c109 921c      fl_a8c:	st	X, r1
00c10a c010      fl_a8e:	rjmp	fl_ab0
00c10b 572f      fl_a90:	subi	r18, 0x7F	; 127
00c10c 4030      fl_a92:	sbci	r19, 0x00	; 0
00c10d 9613      fl_a94:	adiw	r26, 0x03	; 3
00c10e 933c      fl_a96:	st	X, r19
00c10f 932e      fl_a98:	st	-X, r18
00c110 9712      fl_a9a:	sbiw	r26, 0x02	; 2
00c111 e083      fl_a9c:	ldi	r24, 0x03	; 3
00c112 938c      fl_a9e:	st	X, r24
00c113 e087      fl_aa0:	ldi	r24, 0x07	; 7
00c114 0f44      fl_aa2:	add	r20, r20
00c115 1f55      fl_aa4:	adc	r21, r21
00c116 1f66      fl_aa6:	adc	r22, r22
00c117 1f77      fl_aa8:	adc	r23, r23
00c118 958a      fl_aaa:	dec	r24
00c119 f7d1      fl_aac:	brne	fl_aa2
00c11a 6470      fl_aae:	ori	r23, 0x40	; 64
00c11b 9614      fl_ab0:	adiw	r26, 0x04	; 4
00c11c 934d      fl_ab2:	st	X+, r20
00c11d 935d      fl_ab4:	st	X+, r21
00c11e 936d      fl_ab6:	st	X+, r22
00c11f 937c      fl_ab8:	st	X, r23
00c120 9717      fl_aba:	sbiw	r26, 0x07	; 7
00c121 9508      fl_abc:	ret
00c122 922f      fl_abe:	push	r2
00c123 923f      fl_ac0:	push	r3
00c124 924f      fl_ac2:	push	r4
00c125 925f      fl_ac4:	push	r5
00c126 926f      fl_ac6:	push	r6
00c127 927f      fl_ac8:	push	r7
00c128 928f      fl_aca:	push	r8
00c129 929f      fl_acc:	push	r9
00c12a 92af      fl_ace:	push	r10
00c12b 92bf      fl_ad0:	push	r11
00c12c 92cf      fl_ad2:	push	r12
00c12d 92df      fl_ad4:	push	r13
00c12e 92ef      fl_ad6:	push	r14
00c12f 92ff      fl_ad8:	push	r15
00c130 930f      fl_ada:	push	r16
00c131 931f      fl_adc:	push	r17
00c132 93cf      fl_ade:	push	r28
00c133 93df      fl_ae0:	push	r29
00c134 b7cd      fl_ae2:	in	r28, 0x3d	; 61
00c135 b7de      fl_ae4:	in	r29, 0x3e	; 62
00c136 1bca      fl_ae6:	sub	r28, r26
00c137 0bdb      fl_ae8:	sbc	r29, r27
00c138 b60f      fl_aea:	in	r0, 0x3f	; 63
00c139 94f8      fl_aec:	cli
00c13a bfde      fl_aee:	out	0x3e, r29	; 62
00c13b be0f      fl_af0:	out	0x3f, r0	; 63
00c13c bfcd      fl_af2:	out	0x3d, r28	; 61
00c13d 9409      fl_af4:	ijmp
00c13e 882a      fl_af6:	ldd	r2, Y+18	; 0x12
00c13f 8839      fl_af8:	ldd	r3, Y+17	; 0x11
00c140 8848      fl_afa:	ldd	r4, Y+16	; 0x10
00c141 845f      fl_afc:	ldd	r5, Y+15	; 0x0f
00c142 846e      fl_afe:	ldd	r6, Y+14	; 0x0e
00c143 847d      fl_b00:	ldd	r7, Y+13	; 0x0d
00c144 848c      fl_b02:	ldd	r8, Y+12	; 0x0c
00c145 849b      fl_b04:	ldd	r9, Y+11	; 0x0b
00c146 84aa      fl_b06:	ldd	r10, Y+10	; 0x0a
00c147 84b9      fl_b08:	ldd	r11, Y+9	; 0x09
00c148 84c8      fl_b0a:	ldd	r12, Y+8	; 0x08
00c149 80df      fl_b0c:	ldd	r13, Y+7	; 0x07
00c14a 80ee      fl_b0e:	ldd	r14, Y+6	; 0x06
00c14b 80fd      fl_b10:	ldd	r15, Y+5	; 0x05
00c14c 810c      fl_b12:	ldd	r16, Y+4	; 0x04
00c14d 811b      fl_b14:	ldd	r17, Y+3	; 0x03
00c14e 81aa      fl_b16:	ldd	r26, Y+2	; 0x02
00c14f 81b9      fl_b18:	ldd	r27, Y+1	; 0x01
00c150 0fce      fl_b1a:	add	r28, r30
00c151 1dd1      fl_b1c:	adc	r29, r1
00c152 b60f      fl_b1e:	in	r0, 0x3f	; 63
00c153 94f8      fl_b20:	cli
00c154 bfde      fl_b22:	out	0x3e, r29	; 62
00c155 be0f      fl_b24:	out	0x3f, r0	; 63
00c156 bfcd      fl_b26:	out	0x3d, r28	; 61
00c157 01ed      fl_b28:	movw	r28, r26
00c158 9508      fl_b2a:	ret
                 
                 FLOAT_END:
                 
                 
                 ; --------------------  system console ----------------------------------------
                 
                 .ORG 0x0c400            ; 1 8a-9f
                 CAD_START:
                 #include "CtrlAltDel.inc"		; Ctrl-Alt-Del NMI
                 
                 	.DB	high(0xf800+((@1)-1)*80+((@0)-1)), low(0xf800+((@1)-1)*80+((@0)-1)), @2, 0
                 .ENDM
                 
                 .MACRO 	m_puts
                 	ldi	zh, high((@0)*2)    
                 	ldi	zl, low((@0)*2)
                 	rcall	CAD_PUTS_XY
                 .ENDM
                 
                 .MACRO 	m_puts_block
                 	ldi	r19, @1
                 	ldi	zh, high((@0)*2)    
                 	ldi	zl, low((@0)*2)
                 	rcall	CAD_PUT_MSG_BLOCK
                 .ENDM
                 
                 .MACRO 	m_puts_c
                 	ldi	zh, high((@0)*2)    
                 	ldi	zl, low((@0)*2)
                 	rcall	CAD_PUTS
                 .ENDM
                 
                 ; copy (@0) -> @1, @2 bytes
                 .MACRO	ldir
                     	ldiw	Y, @0	
                 _l4:
                     	ld	temp, Y+
                     	st	@1, temp
                 	cpi	YL, low(@0+@2+1)	
                 	brne	_l4
                 .ENDM
                 
                 ; copy (@0) -> @1, @2 bytes
                 .MACRO	sdir
                     	ldiw	Y, @0	
                 _l4:
                     	ld	temp, @1
                     	st	Y+, temp
                 	cpi	YL, low(@0+@2+1)	
                 	brne	_l4
                 .ENDM
                 
                 
                 	; process NMI Ctrl-Alt-Del
                 	; ctr-alt-del pressed
                 CAD_CMD:
00c400 c6d7      	rjmp	_CAD_CMD
                 CTRLALTDEL:
00c401 c013      	rjmp	_CTRLALTDEL
                 
                 CAD_STORE_STATE:
                 ;	pushw	X
                 ;	pushw	Y
                 ;	pushw	Z
                 ;	push	r19
                 ;       push	zzA
                 ;	push	temp
                 
                 ;	nportin cpd_vstat		; read crt settings
                 ;	sts	DBG_DATA, temp		; store codepage
                 
                 ;	ldiw	X, 8			; pointer in RAM
00c402 e7e6
00c403 e3f7      	ldiw	Z, HW_DATA		; pointer in HWDATA
00c404 9311      	st	Z+, zzA
00c405 9341      	st	Z+, zzF
00c406 92a1      	st	Z+, zzB
00c407 9361      	st	Z+, zzC
00c408 92c1      	st	Z+, zzD
00c409 92d1      	st	Z+, zzE
00c40a 92e1      	st	Z+, zzH
00c40b 92f1      	st	Z+, zzL
00c40c 9301      	st	Z+, zzIXl
00c40d 9281      	st	Z+, zzIXh
00c40e 92b1      	st	Z+, zzIYl
00c40f 9331      	st	Z+, zzIYh
00c410 93c1      	st	Z+, zzSPl
00c411 93d1      	st	Z+, zzSPh
00c412 9381      	st	Z+, zzPCl
00c413 9391      	st	Z+, zzPCh
                 ;	ldi	temp, 26
                 ;_cad_store_loop:
                 ;	ld	temp, X+
                 ;	st	Z+, temp
                 ;	cpi	XL, 32-6		; till r25
                 ;	brlo	_cad_store_loop
                 ;	st	Z+, YH
                 ;	st	Z+, YL
00c414 9508      	ret
                 
                 
                 _CTRLALTDEL:
00c415 ec58      	ldi	temp, (25<<3)|0
00c416 9350 090f
00c418 e050
00c419 940e 720a 	nportout cpd_vstat, temp	; set standard video mode
                 
00c41b dfe6      	rcall	CAD_STORE_STATE
                 
00c41c 940e 8960 	call	SYSTEM_BEEP		; welcome beep
00c41e 9250 090f
00c420 e055
00c421 940e 720a 	nportout cpd_kchar, zero	; clear char just for the case
                 
                 CAD_MAIN:
00c423 d651      	rcall	CAD_CLRSCR
                 
00c424 e039
00c425 e9f6
00c426 e0e6
00c427 d694      	m_puts_block CAD_MSG_WC, 9
                 
                 ;	m_puts CAD_MSG_WC
                 ;	m_puts CAD_MSG_M1
                 ;	m_puts CAD_MSG_M2
                 ;	m_puts CAD_MSG_M3
                 ;	m_puts CAD_MSG_M4
                 ;	m_puts CAD_MSG_M5
                 ;	m_puts CAD_MSG_M6
                 ;	m_puts CAD_MSG_MA
                 ;	m_puts CAD_MSG_M7		; screen messages
                 
00c428 9150 3f02 	lds	temp, HW_FOUND
00c42a ff53      	sbrs	temp, HW_FOUND_RTC	; check that RTC found
00c42b c003      	rjmp	_cad_l1
                 
                 ;	m_puts_block CAD_MSG_M10, 2
00c42c e9f6
00c42d eaee
00c42e d5c0      	m_puts CAD_MSG_M10
                 ;	m_puts CAD_MSG_M11
                 _cad_l1:	
                 
00c42f 9150 3f02 	lds	temp, HW_FOUND
00c431 ff54      	sbrs	temp, HW_FOUND_ROM	; check that EEPROM found
00c432 c003      	rjmp	_cad_l0
00c433 e9f6
00c434 ece2
00c435 d5b9      	m_puts CAD_MSG_M9
                 _cad_l0:	
                 
                 ;	m_puts CAD_MSG_M8		; screen messages
00c436 e032
00c437 e9f6
00c438 ede0
00c439 d682      	m_puts_block CAD_MSG_M13, 2	; VRAM HALT
                 ;	m_puts CAD_MSG_M14		; HALT
                 
                 ;	m_puts CAD_MSG_MS
00c43a e9fb
00c43b e2e4
00c43c d5b2      	m_puts CAD_MSG_RM
                 ;	rcall	CAD_CURSOR
                 
                 CAD_COMMAND:
00c43d d61f      	rcall	CAD_CONIN
                 
00c43e 315b
00c43f f409
00c440 c027      	tcbe	27, CAD_EXIT
00c441 3451
00c442 f409
00c443 c062      	tcbe	'A', CAD_SET_IMAGE
00c444 3452
00c445 f409
00c446 c05f      	tcbe	'B', CAD_SET_IMAGE
00c447 3453
00c448 f409
00c449 c05c      	tcbe	'C', CAD_SET_IMAGE
00c44a 3454
00c44b f409
00c44c c059      	tcbe	'D', CAD_SET_IMAGE
00c44d 3553
00c44e f409
00c44f c051      	tcbe	'S', CAD_INIT_SD
00c450 3459
00c451 f409
00c452 c115      	tcbe	'I', CAD_SET_IOBYTE
00c453 3555
00c454 f409
00c455 c161      	tcbe	'U', CAD_SET_DEBUG
00c456 3455
00c457 f409
00c458 c1c6      	tcbe	'E', CAD_SET_EEPROM
00c459 3458
00c45a f409
00c45b c0b8      	tcbe	'H', CAD_SET_HW
00c45c 3552
00c45d f409
00c45e c313      	tcbe	'R', CAD_SET_RTC
00c45f 3556
00c460 f409
00c461 c032      	tcbe	'V', CAD_VRAM
00c462 355a
00c463 f409
00c464 c027      	tcbe	'Z', CAD_HALT
                 
00c465 940e 8960 	call	SYSTEM_BEEP
00c467 cfd5      	rjmp	CAD_COMMAND
                 
                 CAD_EXIT:
                 ;	lds	temp, DBG_DATA		; load codepage
                 ;	nportout cpd_vstat, temp	; restore video mode
                 	
00c468 d62b      	rcall	CAD_RSTSCR
                 
                 ;	pop	temp
                 CAD_EXIT_NO_CRT:
                 ;        push	temp			; START enters here with temp=0x61
                 
00c469 ef5f      	ldi	temp, BIOS_FUNC_CRT_RESET
00c46a 940e 7200 	call	BIOS			; restore video mode and reset BIOS
                 ;	call	BIOS_SETCPDCURSOR
                 
                 CAD_EXIT_NO_CRT_2:
                 
                         ; restoring registers
00c46c e7e6
00c46d e3f7      	ldiw	Z, HW_DATA		; pointer in HWDATA
00c46e 9111      	ld	zzA, Z+
00c46f 9141      	ld	zzF, Z+
00c470 90a1      	ld	zzB, Z+
00c471 9161      	ld	zzC, Z+
00c472 90c1      	ld	zzD, Z+
00c473 90d1      	ld	zzE, Z+
00c474 90e1      	ld	zzH, Z+
00c475 90f1      	ld	zzL, Z+
00c476 9101      	ld	zzIXl, Z+
00c477 9081      	ld	zzIXh, Z+
00c478 90b1      	ld	zzIYl, Z+
00c479 9131      	ld	zzIYh, Z+
00c47a 91c1      	ld	zzSPl, Z+
00c47b 91d1      	ld	zzSPh, Z+
00c47c 9181      	ld	zzPCl, Z+
00c47d 9191      	ld	zzPCh, Z+
                 	
                 ;	ldiw	X, 8			; pointer in RAM
                 ;	ldiw	Z, HW_DATA		; pointer in HWDATA
                 ;_cad_restore_loop:
                 ;	ld	temp, Z+
                 ;	st	X+, temp
                 ;	cpi	XL, 32-6		; till r25
                 ;	brlo	_cad_restore_loop
                 ;	ld	YH, Z+			; restore YH:YL
                 ;	ld	YL, Z+
                 
                 CAD_EXIT_NO_CRT_3:
                 	; refill hw_data with zeros!
00c47e e7e6
00c47f e3f7      	ldiw	Z, HW_DATA		; pointer in HW_DATA
00c480 e250      	ldi	temp, 32
                 _cad_restore_hw_loop:
00c481 9251      	st	Z+, zero
00c482 955a      	dec	temp
00c483 f7e9      	brne	_cad_restore_hw_loop
                 
                 ;	pop	temp
                 ;	pop	zzA
                 ;	pop	r19
                 ;	popw	Z
                 ;	popw	Y
                 ;	popw	X
                 
00c484 9250 090f
00c486 e055
00c487 940e 720a 	nportout cpd_kchar, zero	; clear keyboard buffer
00c489 9250 091c 	sts	CON_ESC, zero
                 
00c48b 9508      	ret
                 
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; HALT current program
                 CAD_HALT:
00c48c e052      	ldi	temp, 0x02		; after -2 it will jump to the 0000 address
00c48d 9350 3784 	sts	HW_DATA+14, temp
00c48f 9250 3785 	sts	HW_DATA+15, zero
                 ;	sts	CURSOR_STATUS, zero	; show cursor
00c491 940e 8960 	call	SYSTEM_BEEP
00c493 cf8f      	rjmp	CAD_MAIN
                 
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; Echo SVRAM to screen
                 CAD_VRAM:
00c494 d5e0      	rcall	CAD_CLRSCR
00c495 efd8
00c496 e0c0      	STR_GOTOXY 1,1
00c497 e0e0
00c498 e0f1      	ldiw	Z, VIDEOBUF
                 CAD_VRAM_L1:
00c499 9131      	ld	r19, Z+
00c49a d578      	rcall	CAD_PUTC
00c49b 38e0      	cpi	ZL, low(VIDEOBUF+24*80)
00c49c f7e1      	brne	CAD_VRAM_L1
00c49d 30f8      	cpi	ZH, high(VIDEOBUF+24*80)
00c49e f7d1      	brne	CAD_VRAM_L1
00c49f d5bd      	rcall	CAD_CONIN
00c4a0 cf82      	rjmp	CAD_MAIN
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; Init SD card - no responce
                 CAD_INIT_SD:
00c4a1 940e 9000 	call	SD_INIT
00c4a3 940e 8960 	call	SYSTEM_BEEP
00c4a5 cf7d      	rjmp	CAD_MAIN
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; select image for drive
                 CAD_SET_IMAGE:
                 ;	push	zzA
00c4a6 2f15      	mov	zzA, temp
00c4a7 5411      	subi	zzA, 'A'		; zzA = drive to change 0..
                 
00c4a8 d5cc      	rcall	CAD_CLRSCR
00c4a9 e9f6
00c4aa e0e6
00c4ab d543      	m_puts CAD_MSG_WC
                 
                 	; output disk content
00c4ac e9f6
00c4ad efe0
00c4ae d540      	m_puts CAD_MSG_SD
00c4af 9250 092a 	sts	SD_ADDRESS, zero
00c4b1 e058      	ldi	temp, 0x08
00c4b2 9350 092b 	sts	SD_ADDRESS+1, temp
00c4b4 9250 092c 	sts	SD_ADDRESS+2, zero
00c4b6 9250 092d 	sts	SD_ADDRESS+3, zero
00c4b8 940e 9004 	call	SD_READ_DO		; load SD card name
                 
00c4ba e0e0
00c4bb e3f0      	ldiw	Z, SD_BUF
00c4bc d585      	rcall	CAD_PUTS_RAM
                 
00c4bd efd9
00c4be e4c0      	STR_GOTOXY 1,5
                 
00c4bf e031      	ldi	r19, 0x01
                 CAD_SD_IMG_L1:
00c4c0 93df
00c4c1 93cf      	pushw	Y			; store cursor position
                 
00c4c2 933f      	push	r19
00c4c3 5c30      	subi	r19,-('A'-1)
00c4c4 d54e      	rcall	CAD_PUTC		; show index
00c4c5 9621      	adiw	Y, 1
00c4c6 e53b      	ldi	r19,'['
00c4c7 d54b      	rcall	CAD_PUTC		; show selected
00c4c8 9621      	adiw	Y, 1
00c4c9 e53d      	ldi	r19,']'
00c4ca d548      	rcall	CAD_PUTC		; show selected
00c4cb 9621      	adiw	Y, 1
00c4cc 913f      	pop	r19
                 
00c4cd 9330 092a 	sts	SD_ADDRESS, r19
00c4cf e058      	ldi	temp, 0x08
00c4d0 9350 092b 	sts	SD_ADDRESS+1, temp
00c4d2 9250 092c 	sts	SD_ADDRESS+2, zero
00c4d4 9250 092d 	sts	SD_ADDRESS+3, zero
00c4d6 940e 9004 	call	SD_READ_DO		; load SD card name
                 
00c4d8 e0e0
00c4d9 e3f0      	ldiw	Z, SD_BUF
00c4da d567      	rcall	CAD_PUTS_RAM
                 
00c4db 91cf
00c4dc 91df      	popw	Y
00c4dd 96a8      	adiw	Y, 40			; position for next name
                 
00c4de 9533      	inc	r19
00c4df 313f      	cpi	r19, 31
00c4e0 f2f8      	brlo	CAD_SD_IMG_L1		; loop
                 
                 CAD_SD_IMG_MARK_SELECTED:	
00c4e1 e1ea
00c4e2 e3ff      	ldiw	Z, SD_FDD_BASE
00c4e3 0fe1      	add	ZL, zzA
00c4e4 1df5      	adc	ZH, zero
00c4e5 8150      	ld	temp, Z			; current image index
00c4e6 932f      	push	r18
00c4e7 933f      	push	r19
00c4e8 efd9
00c4e9 e4c3      	STR_GOTOXY 4,5
00c4ea e021      	ldi	r18, 0x01		; index starts from 1
                 CAD_SD_IMG_L7:
00c4eb 1725      	cp	r18, temp
00c4ec e230      	ldi	r19, ' '
00c4ed f409      	brne	CAD_SD_IMG_L6
00c4ee e23a      	ldi	r19, '*'
                 CAD_SD_IMG_L6:
00c4ef d523      	rcall	CAD_PUTC		; show selected
00c4f0 96a7      	adiw	Y, 39
00c4f1 9523      	inc	r18
00c4f2 312f      	cpi	r18, 31
00c4f3 f3b8      	brlo	CAD_SD_IMG_L7		; loop
00c4f4 913f      	pop	r19
00c4f5 912f      	pop	r18
                 
00c4f6 e9f6
00c4f7 efec
00c4f8 d4f6      	m_puts CAD_MSG_SS		; echo select option
00c4f9 2f31              mov	r19, zzA
00c4fa 5b3f              subi	r19, -'A'
00c4fb d517      	rcall	CAD_PUTC		; show drive letter
00c4fc e9f7
00c4fd e1e6
00c4fe d502      	m_puts_c CAD_MSG_SE		; echo select option
                 
                 CAD_SD_IMG_L2:
00c4ff d55d      	rcall	CAD_CONIN
00c500 315b
00c501 f409
00c502 c00e      	tcbe	27, CAD_SD_IMG_END
00c503 3451      	cpi	temp, 'A'
00c504 f048      	brlo	CAD_SD_IMG_L3
00c505 3651      	cpi	temp, 'A'+32
00c506 f438      	brsh	CAD_SD_IMG_L3
                 
00c507 e1ea
00c508 e3ff      	ldiw	Z, SD_FDD_BASE
00c509 0fe1      	add	ZL, zzA
00c50a 1df5      	adc	ZH, zero		; this data block is alined just for the case
00c50b 5450      	subi	temp, 'A'-1		; index starts s 0x01
00c50c 8350      	st	Z, temp			; store image index
                 
00c50d cfd3      	rjmp	CAD_SD_IMG_MARK_SELECTED
                 
                 CAD_SD_IMG_L3:
00c50e 940e 8960 	call	SYSTEM_BEEP
00c510 cfee      	rjmp	CAD_SD_IMG_L2
                 
                 CAD_SD_IMG_END:
00c511 940e 900a 	call	SD_LAST_RESET
                 ;	sts	SD_LASTADDRESS+3, FF
                 ;	sts	SD_LASTADDRESS+2, FF
                 ;	sts	SD_LASTADDRESS+1, FF
                 ;	sts	SD_LASTADDRESS, FF
                 
                 ;	pop	zzA
00c513 cf0f      	rjmp	CAD_MAIN
                 
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; set HW platform compatability 
                 CAD_SET_HW:
00c514 d560      	rcall	CAD_CLRSCR
00c515 e9f6
00c516 e0e6
00c517 d4d7      	m_puts 	CAD_MSG_WC
00c518 e9fb
00c519 e4e4
00c51a d4d4      	m_puts 	CAD_MSG_H1
                 
                 CAD_SET_HW_LOOKUP_START:
00c51b e1e0
00c51c e6fa      	ldiw2	Z, HW_OPTIONS
00c51d e050      	ldi	temp, 0
00c51e efd9
00c51f e4c0      	STR_GOTOXY 1,5
                 
                 CAD_SET_HW_LOOKUP:			; out as 0 = [ ] Name
00c520 9136      	elpm	r19, Z
00c521 3030      	cpi	r19, 0
00c522 f121      	breq	CAD_SET_HW_CMD		; no more options
                 
00c523 93df
00c524 93cf      	pushw	Y
00c525 e330      	ldi	r19, '0'
00c526 0f35      	add	r19, temp
00c527 d4eb      	rcall	CAD_PUTC		; show hw index
                 ;	inc	YL			; space
                 ;	ldi	r19,'='
                 ;	rcall	CAD_PUTC		; =
00c528 95c3      	inc	YL			; space
00c529 e53b      	ldi	r19,'['
00c52a d4e8      	rcall	CAD_PUTC		; =
                 
00c52b 9130 3f00 	lds	r19, HW_FLAG
00c52d 1735      	cp	r19, temp
00c52e e23a      	ldi	r19, '*'
00c52f f009      	breq	_cad_hw_l0		; = active option??
00c530 e230      	ldi	r19, ' '		; no, no mark
                 
                 _cad_hw_l0:
00c531 d4e1      	rcall	CAD_PUTC		; mark
                 
00c532 e53d      	ldi	r19,']'
00c533 d4df      	rcall	CAD_PUTC		; =
00c534 9621      	adiw	Y, 1			; space
                 
00c535 e110      	ldi	zzA, 16
                 _cad_hw_putname:
00c536 9137      	elpm	r19, Z+
00c537 d4db      	rcall	CAD_PUTC		; =
00c538 951a      	dec	zzA
00c539 f7e1      	brne	_cad_hw_putname
                 
                 ;	ldi	r19,' '
                 ;	rcall	CAD_PUTC		; =
00c53a 9624      	adiw	Y, 4			; space
                 
00c53b e018      	ldi	zzA, 8
                 _cad_hw_putpar:
00c53c 9137      	elpm	r19, Z+
00c53d d4ed      	rcall	CAD_PUTHEX		; 
                 ;	ldi	r19,' '
                 ;	rcall	CAD_PUTC		; 
00c53e 9621      	adiw	Y, 1			; space
00c53f 951a      	dec	zzA
00c540 f7d9      	brne	_cad_hw_putpar
                 
00c541 91cf
00c542 91df      	popw	Y
00c543 96a8      	adiw	Y, 40
00c544 96a8      	adiw	Y, 40
                 ;	adiw	Y, 40 + (40-16-4-4-4-8*3)
                 ;	adiw	Y, 40-16-4-4-4-8*3	; position for next name
                 
                 ;	adiw	Z, 8			; skip parameters
                 ;					;!!!! add display of parameters !!!!
                 
00c545 9553      	inc	temp
00c546 cfd9      	rjmp	CAD_SET_HW_LOOKUP
                 
                 ;	mov	r19, zzA
                 ;	rcall	CAD_PUTHEX		; 
                 
                 CAD_SET_HW_CMD:
00c547 e310      	ldi	zzA, '0'
00c548 0f15      	add	zzA, temp		; last index available
                 
                 CAD_SET_HW_CMD_LOOP:
00c549 e9fa
00c54a e5e8
00c54b d4a3      	m_puts 	CAD_MSG_DM
                 	
00c54c d510      	rcall	CAD_CONIN
00c54d 315b      	cpi	temp, 27
00c54e f0c1      	breq	CAD_SET_HW_END
00c54f 3350      	cpi	temp, '0'
00c550 f3c0      	brlo	CAD_SET_HW_CMD_LOOP
00c551 1751      	cp	temp, zzA
00c552 f7b0      	brsh	CAD_SET_HW_CMD_LOOP
                 
00c553 5350      	subi	temp, '0'
00c554 9350 3f00 	sts	HW_FLAG, temp		; save hw_flag
00c556 e2e0
00c557 e6fa      	ldiw2	Z, HW_OPTIONS+8		; params for hw_index == 0
00c558 3050      	cpi	temp, 0
00c559 f019      	breq	CAD_SET_HW_SET_L0
                 CAD_SET_HW_SET_L1:
00c55a 9678      	adiw	Z, 16+8
00c55b 955a      	dec	temp
00c55c f7e9      	brne	CAD_SET_HW_SET_L1
                 CAD_SET_HW_SET_L0:	         	; Z->parameters
00c55d 9157      	elpm	temp, Z+
00c55e 9350 3f09 	sts	CRT_LINES, temp		; codepage after restore
00c560 9157      	elpm	temp, Z+
00c561 9350 3f0a 	sts	CRT_CHARS, temp		; codepage after restore
00c563 9157      	elpm	temp, Z+
00c564 9350 3f05 	sts	CRT_SETTINGS, temp	; codepage after restore
                 					;!!!! add other parameters!!!!
                 ;	sts	CON_ESC_C4, zero
                 ;	sts	CON_ESC_C5, zero
                 
                 ;	call	SYSTEM_BEEP
00c566 cfb4      	rjmp	CAD_SET_HW_LOOKUP_START
                 
                 CAD_SET_HW_END:
00c567 cebb      	rjmp	CAD_MAIN
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; set CRISS IOBYTE
                 CAD_SET_IOBYTE:
00c568 d50c      	rcall	CAD_CLRSCR
00c569 e9f6
00c56a e0e6
00c56b d483      	m_puts CAD_MSG_WC
                 
00c56c e039
00c56d e9f7
00c56e e2e6
00c56f d54c      	m_puts_block CAD_MSG_I0, 9
                 	
                 CAD_SET_IOBYTE_L2:
                 
00c570 efd8
00c571 efcd      	STR_GOTOXY 14,4			; out IOBYTE value
00c572 e0e1
00c573 e3ff      	ldiw	Z, CON_IOBYTE
00c574 d40b      	rcall	CAD_PUT_IOBYTE
                 
00c575 efda
00c576 e3cd      	STR_GOTOXY 14,8			; out IOBYTE value
00c577 e4e8
00c578 e3ff      	ldiw	Z, PR_IOBYTE
00c579 d406      	rcall	CAD_PUT_IOBYTE
                 
00c57a efdb
00c57b e7cd      	STR_GOTOXY 14,12		; out IOBYTE value
00c57c e5e8
00c57d e3ff      	ldiw	Z, DEV_IOBYTE
00c57e d401      	rcall	CAD_PUT_IOBYTE
                 
00c57f e9f8
00c580 edea
00c581 d46d      	m_puts CAD_MSG_IM
                 	
00c582 d4da      	rcall	CAD_CONIN
00c583 315b
00c584 f409
00c585 c021      	tcbe	27, CAD_SET_IOBYTE_END
00c586 3451      	cpi	temp, 'A'
00c587 f0e0      	brlo	CAD_SET_IOBYTE_L3
00c588 3459      	cpi	temp, 'H'+1
00c589 f068      	brlo	CAD_SET_IOBYTE_L6	; con_io
00c58a 3551      	cpi	temp, 'P'+1
00c58b f038      	brlo	CAD_SET_IOBYTE_L7	; pr_io
00c58c 3559      	cpi	temp, 'X'+1
00c58d f008      	brlo	CAD_SET_IOBYTE_L9	; LST_IO
                 ;	cpi	temp, 'X'+1
                 ;	brlo	CAD_SET_IOBYTE_LA	; SD_IO
00c58e c015      	rjmp	CAD_SET_IOBYTE_L3
                 
                 CAD_SET_IOBYTE_L9:
00c58f 5551      	subi	temp, 'Q'		; A = 0..7		
00c590 e5e8
00c591 e3ff      	ldiw	Z, DEV_IOBYTE
00c592 c007      	rjmp	CAD_SET_IOBYTE_L8
                 	
                 ;CAD_SET_IOBYTE_LA:
                 ;	subi	temp, 'U'		; A = 0..7		
                 ;	ldiw	Z, SD_IOBYTE
                 ;	rjmp	CAD_SET_IOBYTE_L8	
                 
                 CAD_SET_IOBYTE_L7:
00c593 5459      	subi	temp, 'I'		; A = 0..7		
00c594 e4e8
00c595 e3ff      	ldiw	Z, PR_IOBYTE
00c596 c003      	rjmp	CAD_SET_IOBYTE_L8
                 
                 CAD_SET_IOBYTE_L6:
00c597 5451      	subi	temp, 'A'		; A = 0..7		
00c598 e0e1
00c599 e3ff      	ldiw	Z, CON_IOBYTE
                 
                 CAD_SET_IOBYTE_L8:
00c59a e031      	ldi	r19,1			; bit to xor
00c59b 3050      	cpi	temp, 0
00c59c f019      	breq	CAD_SET_IOBYTE_L4
                 CAD_SET_IOBYTE_L5:
00c59d 0f33      	lsl	r19
00c59e 955a      	dec	temp
00c59f f7e9      	brne	CAD_SET_IOBYTE_L5
                 
                 CAD_SET_IOBYTE_L4:
00c5a0 8150      	ld	temp, Z
00c5a1 2753      	eor	temp, r19
00c5a2 8350      	st	Z, temp
00c5a3 cfcc      	rjmp	CAD_SET_IOBYTE_L2	; loop until ESC
                 
                 CAD_SET_IOBYTE_L3:			; input error
00c5a4 940e 8960 	call	SYSTEM_BEEP
00c5a6 cfc9      	rjmp	CAD_SET_IOBYTE_L2
                 CAD_SET_IOBYTE_END:
00c5a7 9150 3f01 	lds	temp, CON_IOBYTE
00c5a9 9350 3691 	sts	RTC_IOBYTE, temp
00c5ab 9150 3f48 	lds	temp, PR_IOBYTE
00c5ad 9350 36c2 	sts	RTC_PR_IOBYTE, temp
00c5af 9150 3f58 	lds	temp, DEV_IOBYTE
00c5b1 9350 36e4 	sts	RTC_DEV_IOBYTE, temp
                 ;	lds	temp, SD_IOBYTE
                 ;	sts	RTC_SD_IOBYTE, temp
                 
00c5b3 e053      	ldi	temp, 3			; write ROM command
00c5b4 940e b30f 	call	RTC_CMD			; store PR_IOBYTE
                 
                 CAD_SET_IOBYTE_END2:
00c5b6 ce6c      	rjmp	CAD_MAIN
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; set CRISS DEBUG 
                 ;	lds	temp, SYS_NOTIFY	
                 
                 CAD_SET_DEBUG:
00c5b7 d4bd      	rcall	CAD_CLRSCR
00c5b8 e9f6
00c5b9 e0e6
00c5ba d434      	m_puts CAD_MSG_WC
                 
00c5bb e132
00c5bc e9f9
00c5bd e0e2
00c5be d4fd      	m_puts_block CAD_MSG_D1, 18
                 		
                 CAD_SET_DBG_L2:
                 
00c5bf efd9
00c5c0 e4c3      	STR_GOTOXY 4,5			; out current value
00c5c1 9130 3f2a 	lds	r19, SYS_NOTIFY	
00c5c3 d041      	rcall	CAD_PUT_V_FLAGS
                 
00c5c4 efd9
00c5c5 e6c5      	STR_GOTOXY 38,5			; out current value
00c5c6 9130 3f2b 	lds	r19, DBG_OPTIONS	
00c5c8 d03c      	rcall	CAD_PUT_V_FLAGS
                 
00c5c9 efdb
00c5ca e5c8      	STR_GOTOXY 57, 11
00c5cb 9130 3f2d 	lds	r19, DBG_BREAK+1
00c5cd d45d      	rcall	CAD_PUTHEX
00c5ce 9130 3f2c 	lds	r19, DBG_BREAK
00c5d0 d45a      	rcall	CAD_PUTHEX
                 
                 ;	ldi	temp, 1<<0              ; bit to test
                 ;CAD_DBG_0:
                 ;	lds	r19, SYS_NOTIFY	
                 ;	and	r19, temp
                 ;	ldi	r19, ' '
                 ;	breq	CAD_DBG_1
                 ;	ldi	r19, '*'
                 ;CAD_DBG_1:
                 ;	push	temp
                 ;	rcall	CAD_PUTC		; set value mark
                 ;	pop	temp
                 ;	lsl	temp
                 ;	adiw	Y,40			
                 ;	adiw	Y,39			; go to next box
                 ;	cpi	temp, 0
                 ;	brne	CAD_DBG_0
                 
00c5d1 e9fa
00c5d2 e5e8
00c5d3 d41b      	m_puts CAD_MSG_DM
00c5d4 d488      	rcall	CAD_CONIN
                 
00c5d5 315b
00c5d6 f409
00c5d7 c01d      	tcbe	27, CAD_SET_DBG_END
00c5d8 3451      	cpi	temp, 'A'
00c5d9 f030      	brlo	CAD_SET_DBG_L3
00c5da 3459      	cpi	temp, 'A'+8
00c5db f038      	brlo	CAD_SET_DBG_B1
00c5dc 3559      	cpi	temp, 'I'+16
00c5dd f050      	brlo	CAD_SET_DBG_B2
00c5de 3551      	cpi	temp, 'Q'
00c5df f061      	breq	CAD_SET_DBG_B3
                 
                 ;	rjmp	CAD_SET_DBG_L3
                 CAD_SET_DBG_L3:				; input error
00c5e0 940e 8960 	call	SYSTEM_BEEP
00c5e2 cfdc      	rjmp	CAD_SET_DBG_L2
                 
                 CAD_SET_DBG_B1:
00c5e3 5451      	subi	temp, 'A'		; A = 0..7		
00c5e4 e2ea
00c5e5 e3ff      	ldiw	Z, SYS_NOTIFY
                 CAD_SET_DBG_B1_L1:
00c5e6 d02e      	rcall	CAD_SET_FLAG
00c5e7 cfd7      	rjmp	CAD_SET_DBG_L2		; loop until ESC
                 
                 CAD_SET_DBG_B2:
00c5e8 5459      	subi	temp, 'I'		; A = 0..7		
00c5e9 e2eb
00c5ea e3ff      	ldiw	Z, DBG_OPTIONS
00c5eb cffa      	rjmp	CAD_SET_DBG_B1_L1
                 
                 CAD_SET_DBG_B3:
00c5ec efdb
00c5ed e5c8      	STR_GOTOXY 57, 11
00c5ee d3c4      	rcall	CAD_READ_HEX2
00c5ef 9350 3f2d 	sts	DBG_BREAK+1, temp
00c5f1 d3c1      	rcall	CAD_READ_HEX2
00c5f2 9350 3f2c 	sts	DBG_BREAK, temp
00c5f4 cfca      	rjmp	CAD_SET_DBG_L2		; loop until ESC
                 
                 ;	ldi	r19,1			; bit to xor
                 ;	subi	temp, 'A'		; A = 0..7		
                 ;	breq	CAD_SET_DBG_L4
                 ;CAD_SET_DBG_L5:
                 ;	lsl	r19
                 ;	dec	temp
                 ;	brne	CAD_SET_DBG_L5
                 
                 ;CAD_SET_DBG_L4:
                 ;	lds	temp, SYS_NOTIFY	
                 ;	eor	temp, r19
                 ;	sts	SYS_NOTIFY, temp
                 ;	rjmp	CAD_SET_DBG_L2		; loop until ESC
                 
                 ;CAD_SET_DBG_L3:				; input error
                 ;	call	SYSTEM_BEEP
                 ;	rjmp	CAD_SET_DBG_L2
                 CAD_SET_DBG_END:
00c5f5 9150 3f2a 	lds	temp, SYS_NOTIFY
00c5f7 ff57      	sbrs	temp, NOTIFY_Z80
00c5f8 c006      	rjmp	CAD_SET_DBG_NO_Z80
                 
00c5f9 e25b      	ldi	temp, high(IRQOPCODES)	; next command will execute IRQ handler
00c5fa bd5b      	out	GPIOR2, temp		; GPIOR2 contains high pointer to decode table
00c5fb b35e      	in	temp, GPIOR0		; GPIOR0 = int requests for CPU
00c5fc 6250      	sbr	temp, (1<<IRQ_V_DEBUG)
00c5fd bb5e      	out	GPIOR0, temp		; SET irq flag
                 
00c5fe ce24      	rjmp	CAD_MAIN
                 
                 CAD_SET_DBG_NO_Z80:
00c5ff e05a      	ldi	temp, high(zOPCODE__LBLS_L)
00c600 bd5b      	out	GPIOR2, temp		; GPIOR2 contains high pointer to decode table
00c601 b35e      	in	temp, GPIOR0		; GPIOR0 = int requests for CPU
00c602 7d5f      	cbr	temp, (1<<IRQ_V_DEBUG)
00c603 bb5e      	out	GPIOR0, temp		; clear IRQ flag
00c604 ce1e      	rjmp	CAD_MAIN
                 		
                 
                 
                 CAD_PUT_V_FLAGS:
00c605 e051      	ldi	temp, 1<<0              ; bit to test
                 CAD_DBG_0:
                 ;	lds	r19, SYS_NOTIFY	
00c606 933f      	push	r19
00c607 2335      	and	r19, temp
00c608 e230      	ldi	r19, ' '
00c609 f009      	breq	CAD_DBG_1
00c60a e23a      	ldi	r19, '*'
                 CAD_DBG_1:
00c60b 935f      	push	temp
00c60c d406      	rcall	CAD_PUTC		; set value mark
00c60d 915f      	pop	temp
00c60e 913f      	pop	r19
00c60f 0f55      	lsl	temp
00c610 96a8      	adiw	Y,40			
00c611 96a7      	adiw	Y,39			; go to next box
00c612 3050      	cpi	temp, 0
00c613 f791      	brne	CAD_DBG_0
00c614 9508      	ret
                 
                 
                 ; set flags, Z->var, r19=flag
                 CAD_SET_FLAG:
00c615 e031      	ldi	r19,1			; bit to xor
00c616 3050      	cpi	temp, 0
                 ;	subi	temp, 'A'		; A = 0..7		
00c617 f019      	breq	CAD_SET_DBG_L4
                 CAD_SET_DBG_L5:
00c618 0f33      	lsl	r19
00c619 955a      	dec	temp
00c61a f7e9      	brne	CAD_SET_DBG_L5
                 
                 CAD_SET_DBG_L4:
00c61b 8150      	ld	temp, Z	
00c61c 2753      	eor	temp, r19
00c61d 8350      	st	Z, temp
00c61e 9508      	ret
                 ;	rjmp	CAD_SET_DBG_L2		; loop until ESC
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; set CRISS EEPROM 
                 ;	lds	temp, SYS_NOTIFY	
                 CAD_SET_EEPROM:
                 ;        pushw	Z
00c61f d455      	rcall	CAD_CLRSCR
00c620 e9f6
00c621 e0e6
00c622 d3cc      	m_puts CAD_MSG_WC
                 
00c623 e03a
00c624 e9fa
00c625 e7e6
00c626 d495      	m_puts_BLOCK CAD_MSG_R1, 10
                 
                 ;	m_puts CAD_MSG_R1		; screen messages
                 ;	m_puts CAD_MSG_R2
                 ;	m_puts CAD_MSG_R3
                 ;	m_puts CAD_MSG_R4
                 ;	m_puts CAD_MSG_R5
                 ;	m_puts CAD_MSG_R6
                 ;	m_puts CAD_MSG_R7
                 ;	m_puts CAD_MSG_R8
                 ;	m_puts CAD_MSG_R9
                 ;	m_puts CAD_MSG_RM
                 
                 CAD_SET_EEPROM_CMD:
00c627 d435      	rcall	CAD_CONIN
00c628 315b
00c629 f409
00c62a c01e      	tcbe	27, CAD_SET_EEPROM_END
00c62b 3451
00c62c f409
00c62d c01c      	tcbe	'A', CAD_SET_EEPROM_A
00c62e 3452
00c62f f409
00c630 c01d      	tcbe	'B', CAD_SET_EEPROM_B
00c631 3453
00c632 f409
00c633 c01e      	tcbe	'C', CAD_SET_EEPROM_C
00c634 3454
00c635 f409
00c636 c015      	tcbe	'D', CAD_SET_EEPROM_D
00c637 3455
00c638 f409
00c639 c016      	tcbe	'E', CAD_SET_EEPROM_E
00c63a 3456
00c63b f409
00c63c c017      	tcbe	'F', CAD_SET_EEPROM_F
00c63d 3457
00c63e f409
00c63f c103      	tcbe	'G', CAD_SET_EEPROM_G
00c640 3458
00c641 f409
00c642 c102      	tcbe	'H', CAD_SET_EEPROM_H
                 
00c643 cfe3      	rjmp	CAD_SET_EEPROM_CMD
                 
                 CAD_SET_EEPROM_DONE:
00c644 940e 8960 	call	SYSTEM_BEEP
00c646 940e 900a 	call	SD_LAST_RESET
                 ;	sts	SD_LASTADDRESS+3, FF
                 ;	sts	SD_LASTADDRESS+2, FF
                 ;	sts	SD_LASTADDRESS+1, FF
                 ;	sts	SD_LASTADDRESS+0, FF		; clear last_access - sdbuf was used
00c648 cfd6      	rjmp	CAD_SET_EEPROM;_CMD
                 
                 CAD_SET_EEPROM_END:
                 ;	popw	Z
00c649 cdd9      	rjmp	CAD_MAIN
                 
                 
                 
                 CAD_SET_EEPROM_A:
00c64a e010      	ldi	zzA, 0
00c64b c025      	rjmp	CAD_SET_EEPROM_RAM_ROM
                 CAD_SET_EEPROM_D:
00c64c e011      	ldi	zzA, 1
00c64d c023      	rjmp	CAD_SET_EEPROM_RAM_ROM
                 
                 CAD_SET_EEPROM_B:
00c64e e010      	ldi	zzA, 0
00c64f c017      	rjmp	CAD_SET_EEPROM_ROM_RAM
                 CAD_SET_EEPROM_E:
00c650 e011      	ldi	zzA, 1
00c651 c015      	rjmp	CAD_SET_EEPROM_ROM_RAM
                 
                 CAD_SET_EEPROM_C:
00c652 e010      	ldi	zzA, 0
00c653 c002      	rjmp	CAD_SET_EEPROM_SWAP
                 CAD_SET_EEPROM_F:
00c654 e011      	ldi	zzA, 1
00c655 c000      	rjmp	CAD_SET_EEPROM_SWAP
                 
                 
                 ; swap ROM and RAM
                 CAD_SET_EEPROM_SWAP:
00c656 d001      	rcall	CAD_SET_EEPROM_SWAP_PROC
00c657 cfec      	rjmp	CAD_SET_EEPROM_DONE
                 
                 CAD_SET_EEPROM_SWAP_PROC:
00c658 e0e0
00c659 e0f0      	ldiw	Z, 0
                 _cadr2e_l9:
00c65a d0ac      	rcall	CAD_SET_EEPROM_READ_RAM_BUF
00c65b d087      	rcall	CAD_SET_EEPROM_READ_BUF
00c65c d0b8      	rcall	CAD_SET_EEPROM_WRITE_RAM_BUF
00c65d d05c      	rcall	CAD_SET_EEPROM_WRITE_BUF
00c65e 95f3      	inc	ZH
00c65f f7d1      	brne	_cadr2e_l9
                 
00c660 d01c      	rcall	CAD_SET_EEPROM_STORE_REGS
00c661 efff      	ldi	ZH, 0xff
00c662 d057      	rcall	CAD_SET_EEPROM_WRITE_BUF; rewrite last block
                 
00c663 e0a0
00c664 e3b2      	ldiw	X, SD_BUF+512
00c665 d030      	rcall	CAD_SET_EEPROM_RESTORE_REGS
                 
                 ;	rjmp	CAD_SET_EEPROM_DONE
00c666 9508      	ret
                 
                 
                 ; read ROM to RAM
                 CAD_SET_EEPROM_ROM_RAM:
00c667 d001      	rcall	CAD_SET_EEPROM_ROM_RAM_PROC
00c668 cfdb      	rjmp	CAD_SET_EEPROM_DONE
                 
                 CAD_SET_EEPROM_ROM_RAM_PROC:		; to be able to use from START routine
00c669 e0e0
00c66a e0f0      	ldiw	Z, 0
                 _cadr2e_l7:
00c66b d077      	rcall	CAD_SET_EEPROM_READ_BUF
00c66c d0a8      	rcall	CAD_SET_EEPROM_WRITE_RAM_BUF
00c66d 95f3      	inc	ZH
00c66e f7e1      	brne	_cadr2e_l7
                 
00c66f d026      	rcall	CAD_SET_EEPROM_RESTORE_REGS
                 ;	ldi	ZH, 0xff
                 ;	rcall	CAD_SET_EEPROM_WRITE_BUF; rewrite last block
                 
                 ;        pop	zzA
                 ;	rjmp	CAD_SET_EEPROM_DONE
00c670 9508      	ret
                 
                 
                 CAD_SET_EEPROM_RAM_ROM:
00c671 d001      	rcall	CAD_SET_EEPROM_RAM_ROM_PROC
00c672 cfd1      	rjmp	CAD_SET_EEPROM_DONE
                 
                 CAD_SET_EEPROM_RAM_ROM_PROC:
                 ;        push	zzA
                 ;        mov	zzA, temp
00c673 e0e0
00c674 e0f0      	ldiw	Z, 0
                 _cadr2e_l2:
00c675 d091      	rcall	CAD_SET_EEPROM_READ_RAM_BUF
00c676 d043      	rcall	CAD_SET_EEPROM_WRITE_BUF
00c677 95f3      	inc	ZH
00c678 f7e1      	brne	_cadr2e_l2
                 
00c679 d003      	rcall	CAD_SET_EEPROM_STORE_REGS
00c67a efff      	ldi	ZH, 0xff
00c67b d03e      	rcall	CAD_SET_EEPROM_WRITE_BUF; rewrite last block
                 
                 ;        pop	zzA
                 ;	rjmp	CAD_SET_EEPROM_DONE
00c67c 9508      	ret
                 
                 CAD_SET_EEPROM_STORE_REGS:
00c67d e7c6
00c67e e3d7
00c67f 9159
00c680 935e
00c681 38c7
00c682 f7e1      	ldir	HW_DATA, -X, 16		; reg z-registers
00c683 e0c0
00c684 e0d9
00c685 9159
00c686 935e
00c687 30cf
00c688 f7e1      	ldir	0x0900, -X, 14		; ram z-registers
00c689 e0c5
00c68a e3df
00c68b 9159
00c68c 935e
00c68d 31c0
00c68e f7e1      	ldir	CRT_SETTINGS, -X, 10	; crt settings
00c68f e0c0
00c690 e3df
00c691 9159
00c692 935e
00c693 30c3
00c694 f7e1      	ldir	SHARABLE, -X, 2		; hw and iobyte
00c695 9508      	ret
                 
                 
                 CAD_SET_EEPROM_RESTORE_REGS:
00c696 e7c6
00c697 e3d7
00c698 915e
00c699 9359
00c69a 38c7
00c69b f7e1      	sdir	HW_DATA, -X, 16		; reg z-registers
00c69c e0c0
00c69d e0d9
00c69e 915e
00c69f 9359
00c6a0 30cf
00c6a1 f7e1      	sdir	0x0900, -X, 14		; ram z-registers
00c6a2 e0c5
00c6a3 e3df
00c6a4 915e
00c6a5 9359
00c6a6 31c0
00c6a7 f7e1      	sdir	CRT_SETTINGS, -X, 10	; crt settings
00c6a8 e0c0
00c6a9 e3df
00c6aa 915e
00c6ab 9359
00c6ac 30c3
00c6ad f7e1      	sdir	SHARABLE, -X, 2		; hw and iobyte
00c6ae 9508      	ret
                 
                 
                 CAD_SET_EEPROM_WAIT_WIP:
00c6af 982c      	SPI_SELECT
00c6b0 e055
00c6b1 940e 005f 	iSPI	0b00000101		; RDSR
00c6b3 ef5f
00c6b4 940e 005f 	iSPI	0xff
00c6b6 9a2c      	SPI_DESELECT
00c6b7 fd50      	sbrc	temp, 0			; check Write-In-Process (WIP)
00c6b8 cff6      	rjmp	CAD_SET_EEPROM_WAIT_WIP
00c6b9 9508      	ret
                 
                 ; write 256 bytes from SDBUF to zzA:ZH:00
                 CAD_SET_EEPROM_WRITE_BUF:
00c6ba 935f
00c6bb e15c
00c6bc b955
00c6bd eb5f
00c6be b954
00c6bf e050
00c6c0 bd5d
00c6c1 e550
00c6c2 bd5c
00c6c3 9859
00c6c4 915f      	SPI_INIT SPI_SLAVE_ROM, SPI_FCK_DIV_4
                 
00c6c5 dfe9      	rcall	CAD_SET_EEPROM_WAIT_WIP
                 ;CAD_SET_EEPROM_WRITE_BUF_L0:
                 ;	SPI_SELECT
                 ;	iSPI	0b00000101		; RDSR
                 ;	iSPI	0xff
                 ;	SPI_DESELECT
                 ;	sbrc	temp, 0			; check Write-In-Process (WIP)
                 ;	rjmp	CAD_SET_EEPROM_WRITE_BUF_L0
                 
00c6c6 982c      	SPI_SELECT
00c6c7 e056
00c6c8 940e 005f 	iSPI	0b00000110		; WREN
00c6ca 9a2c      	SPI_DESELECT
                 
00c6cb e0a0
00c6cc e3b0      	ldiw	X, SD_BUF		; buffer
00c6cd 982c      	SPI_SELECT
00c6ce e052
00c6cf 940e 005f 	iSPI	0b00000010		; WRITE
00c6d1 2f51
00c6d2 940e 005f 	rSPI	zzA
00c6d4 2f5f
00c6d5 940e 005f 	rSPI	ZH
00c6d7 2f5e
00c6d8 940e 005f 	rSPI	ZL
                 _cadr2e_l1:
00c6da 915d      	ld	temp, X+
00c6db 940e 005f 	call	DOSPI
00c6dd 95e3      	inc	ZL
00c6de f7d9      	brne	_cadr2e_l1
                 ;	SPI_DESELECT
00c6df bc5c
00c6e0 9a59
00c6e1 b854          	SPI_STOP		    	; stop access
00c6e2 9508      	ret
                 
                 
                 ; write 256 bytes from SDBUF to zzA:ZH:00
                 CAD_SET_EEPROM_READ_BUF:
00c6e3 935f
00c6e4 e15c
00c6e5 b955
00c6e6 eb5f
00c6e7 b954
00c6e8 e050
00c6e9 bd5d
00c6ea e550
00c6eb bd5c
00c6ec 9859
00c6ed 915f      	SPI_INIT SPI_SLAVE_ROM, SPI_FCK_DIV_4
                 
00c6ee dfc0      	rcall	CAD_SET_EEPROM_WAIT_WIP
                 	
00c6ef e0a0
00c6f0 e3b1      	ldiw	X, SD_BUF+256		; buffer 2nd half
00c6f1 982c      	SPI_SELECT
00c6f2 e053
00c6f3 940e 005f 	iSPI	0b00000011		; READ
00c6f5 2f51
00c6f6 940e 005f 	rSPI	zzA
00c6f8 2f5f
00c6f9 940e 005f 	rSPI	ZH
00c6fb 2f5e
00c6fc 940e 005f 	rSPI	ZL
                 _cadr2e_l4:
00c6fe 940e 005f 	call	DOSPI
00c700 935d      	st	X+, temp
00c701 95e3      	inc	ZL
00c702 f7d9      	brne	_cadr2e_l4
                 ;	SPI_DESELECT
00c703 bc5c
00c704 9a59
00c705 b854          	SPI_STOP		    	; stop access
00c706 9508      	ret
                 
                 
                 ; read 256 bytes from RAM ZH:00
                 CAD_SET_EEPROM_READ_RAM_BUF:
00c707 e0a0
00c708 e3b0      	ldiw	X, SD_BUF		; read RAM to buffer
                 _cadr2e_l0:
00c709 b9f8
00c70a b9e2
00c70b b854
00c70c b83b
00c70d 0000
00c70e 0000
00c70f b153
00c710 b82b      	LDRAM	ZH, ZL, temp
00c711 935d      	st	X+, temp
00c712 95e3      	inc	ZL
00c713 f7a9      	brne	_cadr2e_l0
00c714 9508      	ret
                 
                 
                 ; save 256 bytes from RAM ZH:00
                 CAD_SET_EEPROM_WRITE_RAM_BUF:
00c715 e0a0
00c716 e3b1      	ldiw	X, SD_BUF+256		; read RAM to buffer
                 _cadr2e_l6:
00c717 915d      	ld	temp, X+
00c718 b9f8
00c719 b9e2
00c71a b955
00c71b b824
00c71c 15f6
00c71d 985d
00c71e f100
00c71f b82b
00c720 935f
00c721 e158
00c722 b955
00c723 eb5f
00c724 b954
00c725 e050
00c726 bd5d
00c727 e550
00c728 bd5c
00c729 9859
00c72a 915f
00c72b 982c
00c72c 935f
00c72d 2f5f
00c72e 940e 005f
00c730 e054
00c731 955a
00c732 f7f1
00c733 2f5e
00c734 940e 005f
00c736 e054
00c737 955a
00c738 f7f1
00c739 915f
00c73a 940e 005f
00c73c bc5c
00c73d 9a59
00c73e b854
00c73f b82b      	STRAM	ZH, ZL, temp
00c740 95e3      	inc	ZL
00c741 f6a9      	brne	_cadr2e_l6
00c742 9508      	ret
                 
                 
                 ; clear EEPROM 64k bank
                 CAD_SET_EEPROM_G:
00c743 e010      	ldi	zzA, 0
00c744 c001      	rjmp	CAD_SET_EEPROM_CLR64
                 CAD_SET_EEPROM_H:
00c745 e011      	ldi	zzA, 1
                 CAD_SET_EEPROM_CLR64:
                 ;	push	zzA
                 ;	mov	zzA, temp
00c746 935f
00c747 e15c
00c748 b955
00c749 eb5f
00c74a b954
00c74b e050
00c74c bd5d
00c74d e550
00c74e bd5c
00c74f 9859
00c750 915f      	SPI_INIT SPI_SLAVE_ROM, SPI_FCK_DIV_4
                 
00c751 e0e0
00c752 e0f0      	ldiw	Z, 0
                 _cadeec_l0:
00c753 982c      	SPI_SELECT
00c754 e056
00c755 940e 005f 	iSPI	0b00000110		; WREN
00c757 9a2c      	SPI_DESELECT
                 
00c758 982c      	SPI_SELECT
00c759 e052
00c75a 940e 005f 	iSPI	0b00000010		; PAGE WRITE SEQUENCE
00c75c 2f51
00c75d 940e 005f 	rSPI	zzA
00c75f 2f5f
00c760 940e 005f 	rSPI	ZH
00c762 2f5e
00c763 940e 005f 	rSPI	ZL
                 _cadeec_l1:
00c765 e050
00c766 940e 005f 	iSPI	0
00c768 9631      	adiw	Z, 1
00c769 30e0      	cpi	ZL, 0
00c76a f7d1      	brne	_cadeec_l1
00c76b 9a2c      	SPI_DESELECT
00c76c 30f0      	cpi	ZH, 0
00c76d f729      	brne	_cadeec_l0
                 
00c76e bc5c
00c76f 9a59
00c770 b854          	SPI_STOP		    	; stop access
                 ;	pop	zzA
00c771 ced2      	rjmp	CAD_SET_EEPROM_DONE
                 
                 
                 
                 
                 .MACRO	CAD_PUT_MAC6
                 	STR_GOTOXY 12, @0
                 	ldiw	Z, @1
                 	call	CAD_PUT_MAC
                 .ENDM
                 
                 .MACRO	CAD_PUT_IP4
                 	STR_GOTOXY 12, @0
                 	ldiw	Z, @1
                 	call	CAD_PUT_IP
                 .ENDM
                 
                 .MACRO	CAD_PUT_BCD2
                 	lds	r19, @0
                 	rcall	CAD_PUTHEX
                 	adiw	Y, 1
                 ;	rcall	CAD_PUTBCD
                 .ENDM
                 
                 .MACRO	CAD_PUT_PORT5
                         adiw	Y, 2
                 	ldiw	Z, @0
                 	call	CAD_PUT_PORT
                 .ENDM
                 
                 ; ------------------------------------------------------------------------------------------
                 ; set CRISS RTC
                 CAD_SET_RTC:
                 ;        pushw	Z
00c772 d302      	rcall	CAD_CLRSCR
00c773 e9f6
00c774 e0e6
00c775 d279      	m_puts CAD_MSG_WC
                 
00c776 e032
00c777 e9fb
00c778 e5ea
00c779 d342      	m_puts_block CAD_MSG_C1, 2
                 
00c77a 9150 3f02 	lds	temp, HW_FOUND
00c77c ff55      	sbrs	temp, HW_FOUND_LAN	; check that LAN found
00c77d c004      	rjmp	_cad_set_rtc_l5	
                 	
                 ;	m_puts_block CAD_MSG_C3, 14	; LAN settings
00c77e e03a
00c77f e9fb
00c780 e7ea
00c781 d33a      	m_puts_block CAD_MSG_C3, 10	; LAN settings
                 
                 _cad_set_rtc_l5:
                 
00c782 e03d
00c783 e9fc
00c784 eaec
00c785 d336      	m_puts_block CAD_MSG_C12, 13	; hw disable
                 
00c786 e131
00c787 e9fd
00c788 e7e6
00c789 d332      	m_puts_block CAD_MSG_C27, 17	; irq vestors
                 
                 CAD_SET_RTC_CMD:
00c78a e050      	ldi	temp, 0
00c78b 940e b30f 	call	RTC_CMD			; reload date and time
00c78d e057      	ldi	temp, 7
00c78e 940e b30f 	call	RTC_CMD			; reload ROM
                 
00c790 efd9
00c791 e4cb      	STR_GOTOXY 12, 5
00c792 9130 3f43
00c794 d296
00c795 9621      	CAD_PUT_BCD2 RTC_HOURS
00c796 9130 3f42
00c798 d292
00c799 9621      	CAD_PUT_BCD2 RTC_MINS
00c79a 9130 3f41
00c79c d28e
00c79d 9621      	CAD_PUT_BCD2 RTC_SECS
                 	
00c79e efd9
00c79f e9cb      	STR_GOTOXY 12, 6
00c7a0 9130 3f45
00c7a2 d288
00c7a3 9621      	CAD_PUT_BCD2 RTC_DATE
00c7a4 9130 3f46
00c7a6 d284
00c7a7 9621      	CAD_PUT_BCD2 RTC_MONTH
00c7a8 9130 3f47
00c7aa d280
00c7ab 9621      	CAD_PUT_BCD2 RTC_YEAR
00c7ac 9622      	adiw	Y, 2
00c7ad 9130 3f44
00c7af d27b
00c7b0 9621      	CAD_PUT_BCD2 RTC_DAY
                 
00c7b1 9150 3f02 	lds	temp, HW_FOUND
00c7b3 ff55      	sbrs	temp, HW_FOUND_LAN	; check that LAN found
00c7b4 c03c      	rjmp	_cad_set_rtc_l7	
                 
00c7b5 efda
00c7b6 e3cb
00c7b7 e9e2
00c7b8 e3f6
00c7b9 940e c913 	CAD_PUT_MAC6 8, RTC_LAN_MY_MAC
00c7bb efda
00c7bc e8cb
00c7bd e9e8
00c7be e3f6
00c7bf 940e c91a 	CAD_PUT_IP4 9,  RTC_LAN_MY_IP
                 ;	CAD_PUT_IP4 10, RTC_LAN_GATE
                 ;	CAD_PUT_IP4 11, RTC_LAN_MASK
                 
00c7c1 efdb
00c7c2 eccb
00c7c3 eae6
00c7c4 e3f6
00c7c5 940e c913 	CAD_PUT_MAC6 13, RTC_SRV_MAC
00c7c7 efdc
00c7c8 e1cb
00c7c9 eaec
00c7ca e3f6
00c7cb 940e c91a 	CAD_PUT_IP4 14,  RTC_SRV_IP
00c7cd 9622
00c7ce ebe0
00c7cf e3f6
00c7d0 940e c8ed 	CAD_PUT_PORT5    RTC_SRV_PORT
                 
00c7d2 efdc
00c7d3 e7cb      	STR_GOTOXY 28,15
00c7d4 9622
00c7d5 eee5
00c7d6 e3f6
00c7d7 940e c8ed 	CAD_PUT_PORT5    RTC_PRN_PORT
00c7d9 efdc
00c7da eccb      	STR_GOTOXY 28,16
00c7db 9622
00c7dc eee7
00c7dd e3f6
00c7de 940e c8ed 	CAD_PUT_PORT5    RTC_SDC_PORT
                 
00c7e0 efdd
00c7e1 e5cb
00c7e2 ebe2
00c7e3 e3f6
00c7e4 940e c913 	CAD_PUT_MAC6 18, RTC_PNC_MAC
00c7e6 efdd
00c7e7 eacb
00c7e8 ebe8
00c7e9 e3f6
00c7ea 940e c91a 	CAD_PUT_IP4 19,  RTC_PNC_IP
00c7ec 9622
00c7ed ebec
00c7ee e3f6
00c7ef 940e c8ed 	CAD_PUT_PORT5    RTC_PNC_PORT
                 
                 ;	CAD_PUT_MAC6 21, RTC_TMS_MAC
                 ;	CAD_PUT_IP4 22,  RTC_TMS_IP
                 ;	CAD_PUT_PORT5    RTC_TMS_PORT
                 
                 _cad_set_rtc_l7:
                 
00c7f1 efdd
00c7f2 e3c3      	STR_GOTOXY RSC2Y+11, 17
00c7f3 9130 36be 	lds	r19, RTC_MODBUS_ID
00c7f5 d235      	rcall	CAD_PUTHEX
                 
00c7f6 efdd
00c7f7 e8c3      	STR_GOTOXY RSC2Y+11, 18
00c7f8 9130 36bf 	lds	r19, RTC_CAN_ID
00c7fa d230      	rcall	CAD_PUTHEX
                 
                 ;	STR_GOTOXY 12, 3
                 ;	lds	temp, RTC_AUTO
                 ;	ldi	r19, ' '
                 ;	sbrc	temp, AUTO_CLOCK
                 ;	ldi	r19, '*'
                 ;	rcall	CAD_PUTC
                 
                 	; HW_DISABLE
00c7fb 932f      	push	r18
00c7fc e028      	ldi	r18, 8				; bits to display
00c7fd efd9
00c7fe e6cb      	STR_GOTOXY RSC2Y+3, 5
00c7ff 9150 36c0 	lds	temp, RTC_HW_DISABLE
                 _cad_set_rtc_l1:
00c801 e230      	ldi	r19, ' '
00c802 fd50      	sbrc	temp, 0		
00c803 e23a      	ldi	r19, '*'
00c804 d20e      	rcall	CAD_PUTC
00c805 96a8      	adiw	Y, 40
00c806 96a7      	adiw	Y, 39				; next line
00c807 9556      	lsr	temp
00c808 952a      	dec 	r18
00c809 f7b9      	brne	_cad_set_rtc_l1
00c80a 912f      	pop	r18
                 
00c80b efdc
00c80c e4c7      	STR_GOTOXY RSC2Y+15, 14
00c80d eee0
00c80e e3f6      	ldiw	Z, RTC_SEC_PIN
00c80f 940e c8ed 	call	CAD_PUT_PORT	
                 
00c811 efdc
00c812 e9c7      	STR_GOTOXY RSC2Y+15, 15
00c813 eee2
00c814 e3f6      	ldiw	Z, RTC_CAD_PIN
00c815 940e c8ed 	call	CAD_PUT_PORT	
                 
00c817 efd9
00c818 e8ca      	STR_GOTOXY RSC3Y+10, 5 			; write IRQ vectors
00c819 e150      	ldi	temp, 16
00c81a ecef
00c81b e3f6      	ldiw	Z, RTC_IRQ_BASE
                 _cad_set_rtc_l6:
00c81c 9131      	ld	r19, Z+
00c81d 940e ca2b 	call	CAD_PUTHEX
00c81f 96a8      	adiw	Y, 40
00c820 96a6      	adiw	Y, 40-2
00c821 955a      	dec	temp
00c822 f7c9      	brne	_cad_set_rtc_l6
                 
00c823 e9fb
00c824 e2e4
00c825 d1c9      	m_puts CAD_MSG_RM
00c826 d236      	rcall	CAD_CONIN
                 
00c827 315b
00c828 f409
00c829 c041      	tcbe	27, CAD_SET_RTC_END
00c82a 3451
00c82b f409
00c82c c04e      	tcbe	'A', CAD_SET_RTC_A
00c82d 3452
00c82e f409
00c82f c05a      	tcbe	'B', CAD_SET_RTC_B
00c830 3453
00c831 f409
00c832 c06a      	tcbe	'C', CAD_SET_RTC_C
00c833 3454
00c834 f409
00c835 c06d      	tcbe	'D', CAD_SET_RTC_D
                 ;	tcbe	'E', CAD_SET_RTC_E
                 ;	tcbe	'F', CAD_SET_RTC_F
00c836 3457
00c837 f409
00c838 c070      	tcbe	'G', CAD_SET_RTC_G
00c839 3458
00c83a f409
00c83b c073      	tcbe	'H', CAD_SET_RTC_H
00c83c 3459
00c83d f409
00c83e c086      	tcbe	'I', CAD_SET_RTC_I
00c83f 345a
00c840 f409
00c841 c089      	tcbe	'J', CAD_SET_RTC_J
00c842 345b
00c843 f409
00c844 c090      	tcbe	'K', CAD_SET_RTC_K
00c845 345c
00c846 f409
00c847 c093      	tcbe	'L', CAD_SET_RTC_L
                 ;	tcbe	'W', CAD_SET_RTC_W
                 ;	tcbe	'X', CAD_SET_RTC_X
00c848 3555
00c849 f409
00c84a c096      	tcbe	'U', CAD_SET_RTC_PWD
00c84b 3559
00c84c f409
00c84d c099      	tcbe	'Y', CAD_SET_RTC_CAD_PWD
                 ;	tcbe	'V', CAD_SET_RTC_AUTOCLOCK
00c84e 3150
00c84f f409
00c850 c068      	tcbe	'P'-0x40, CAD_SET_RTC_CP
00c851 3153
00c852 f409
00c853 c06b      	tcbe	'S'-0x40, CAD_SET_RTC_CS
                 
00c854 3151      	cpi	temp, 17
00c855 f0b0      	brlo	CAD_SET_RTC_IRQ
                 
00c856 3555      	cpi	temp, 'U'
00c857 f470      	brsh	_cad_set_rtc_l4
00c858 345d      	cpi	temp, 'M'
00c859 f060      	brlo	_cad_set_rtc_l4
                 
00c85a e031      	ldi	r19, 1
00c85b 545d      	subi	temp, 'M'
00c85c f019      	breq	_cad_set_rtc_l2
                 _cad_set_rtc_l3:
00c85d 0f33      	lsl	r19
00c85e 955a      	dec	temp
00c85f f7e9      	brne	_cad_set_rtc_l3
                 _cad_set_rtc_l2:
00c860 9150 36c0 	lds	temp, RTC_HW_DISABLE
00c862 2753      	eor	temp, r19
00c863 9350 36c0 	sts	RTC_HW_DISABLE, temp
00c865 c001      	rjmp	CAD_SET_RTC_DONE3	; store RAM
                 
                 _cad_set_rtc_l4:
00c866 cf23      	rjmp	CAD_SET_RTC_CMD
                 
                 CAD_SET_RTC_DONE3:
00c867 e053      	ldi	temp, 3
                 CAD_SET_RTC_DONE:
00c868 940e b30f 	call	RTC_CMD			; update time
00c86a cf1f      	rjmp	CAD_SET_RTC_CMD
                 
                 CAD_SET_RTC_END:
00c86b cbb7      	rjmp	CAD_MAIN
                 
                 
                 
                 CAD_SET_RTC_IRQ:
00c86c efd9
00c86d e8ca      	STR_GOTOXY RSC3Y+10, 5 			; write IRQ vectors
00c86e ecef
00c86f e3f6      	ldiw	Z, RTC_IRQ_BASE
00c870 955a      	dec	temp
00c871 f029      	breq	_cad_set_rtc_irq_l1
                 _cad_set_rtc_irq_l5:
00c872 9631      	adiw	Z, 1
00c873 96a8      	adiw	Y, 40
00c874 96a8      	adiw	Y, 40
00c875 955a      	dec	temp
00c876 f7d9      	brne	_cad_set_rtc_irq_l5
                 _cad_set_rtc_irq_l1:
00c877 940e c9b3 	call	CAD_READ_HEX2
00c879 8350      	st	Z, temp
00c87a cfec      	rjmp	CAD_SET_RTC_DONE3
                 	
                 
                 
                 ;CAD_SET_RTC_AUTOCLOCK:
                 ;	lds	temp, RTC_AUTO
                 ;	ldi	r19, 1
                 ;	eor	temp, r19
                 ;	sts	RTC_AUTO, temp
                 ;	rjmp	CAD_SET_RTC_DONE3
                 	
                 
                 ; set time
                 CAD_SET_RTC_A:
00c87b efd9
00c87c e4cb      	STR_GOTOXY 12, 5
00c87d d13c      	rcall	CAD_READ_DEC2_BCD
00c87e 9350 3f43 	sts	RTC_HOURS, temp
00c880 9621      	adiw	Y, 1
00c881 d138      	rcall	CAD_READ_DEC2_BCD
00c882 9350 3f42 	sts	RTC_MINS, temp
00c884 9621      	adiw	Y, 1
00c885 d134      	rcall	CAD_READ_DEC2_BCD
00c886 9350 3f41 	sts	RTC_SECS, temp
00c888 e051      	ldi	temp, 1
00c889 cfde      	rjmp	CAD_SET_RTC_DONE
                 
                 
                 ; set date
                 CAD_SET_RTC_B:
00c88a efd9
00c88b e9cb      	STR_GOTOXY 12, 6
00c88c d12d      	rcall	CAD_READ_DEC2_BCD
00c88d 9350 3f45 	sts	RTC_DATE, temp
00c88f 9621      	adiw	Y, 1
00c890 d129      	rcall	CAD_READ_DEC2_BCD
00c891 9350 3f46 	sts	RTC_MONTH, temp
00c893 9621      	adiw	Y, 1
00c894 d125      	rcall	CAD_READ_DEC2_BCD
00c895 9350 3f47 	sts	RTC_YEAR, temp
00c897 9623      	adiw	Y, 3
00c898 d121      	rcall	CAD_READ_DEC2_BCD
00c899 9350 3f44 	sts	RTC_DAY, temp
00c89b e052      	ldi	temp, 2
00c89c cfcb      	rjmp	CAD_SET_RTC_DONE
                 
                 
                 ; set MAC
                 CAD_SET_RTC_C:
00c89d efda
00c89e e3cb      	STR_GOTOXY 12, 8
00c89f e9e2
00c8a0 e3f6      	ldiw	Z, RTC_LAN_MY_MAC
00c8a1 d0d0      	rcall	CAD_READ_MAC
00c8a2 cfc4      	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 ; set MAC
                 CAD_SET_RTC_D:
00c8a3 efda
00c8a4 e8cb      	STR_GOTOXY 12, 9
00c8a5 e9e8
00c8a6 e3f6      	ldiw	Z, RTC_LAN_MY_IP
00c8a7 d0d1      	rcall	CAD_READ_IP
00c8a8 cfbe      	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 ; set Gate
                 ;CAD_SET_RTC_E:
                 ;	STR_GOTOXY 12, 10
                 ;	ldiw	Z, RTC_LAN_GATE
                 ;	rcall	CAD_READ_IP
                 ;	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 ; set Mask
                 ;CAD_SET_RTC_F:
                 ;	STR_GOTOXY 12, 11
                 ;	ldiw	Z, RTC_LAN_MASK
                 ;	rcall	CAD_READ_IP
                 ;	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 CAD_SET_RTC_G:
00c8a9 efdb
00c8aa eccb      	STR_GOTOXY 12, 13
00c8ab eae6
00c8ac e3f6      	ldiw	Z, RTC_SRV_MAC
00c8ad d0c4      	rcall	CAD_READ_MAC
00c8ae cfb8      	rjmp	CAD_SET_RTC_DONE3
                 
                 ; set IP
                 CAD_SET_RTC_H:
00c8af efdc
00c8b0 e1cb      	STR_GOTOXY 12, 14
00c8b1 eaec
00c8b2 e3f6      	ldiw	Z, RTC_SRV_IP
00c8b3 d0c5      	rcall	CAD_READ_IP
00c8b4 9622      	adiw	Y, 2
00c8b5 ebe0
00c8b6 e3f6      	ldiw	Z, RTC_SRV_PORT
00c8b7 d07e      	rcall	CAD_READ_PORT
00c8b8 cfae      	rjmp	CAD_SET_RTC_DONE3
                 
                 ; PRN port	
                 CAD_SET_RTC_CP:
00c8b9 efdc
00c8ba e7cd      	STR_GOTOXY 30, 15
00c8bb eee5
00c8bc e3f6      	ldiw	Z, RTC_PRN_PORT
00c8bd d078      	rcall	CAD_READ_PORT
00c8be cfa8      	rjmp	CAD_SET_RTC_DONE3
                 
                 ; SDC port
                 CAD_SET_RTC_CS:
00c8bf efdc
00c8c0 eccd      	STR_GOTOXY 30, 16
00c8c1 eee7
00c8c2 e3f6      	ldiw	Z, RTC_SDC_PORT
00c8c3 d072      	rcall	CAD_READ_PORT
00c8c4 cfa2      	rjmp	CAD_SET_RTC_DONE3
                 
                 ; set P-MAC
                 CAD_SET_RTC_I:
00c8c5 efdd
00c8c6 e5cb      	STR_GOTOXY 12, 18
00c8c7 ebe2
00c8c8 e3f6      	ldiw	Z, RTC_PNC_MAC
00c8c9 d0a8      	rcall	CAD_READ_MAC
00c8ca cf9c      	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 ; set P-IP
                 CAD_SET_RTC_J:
00c8cb efdd
00c8cc eacb      	STR_GOTOXY 12, 19
00c8cd ebe8
00c8ce e3f6      	ldiw	Z, RTC_PNC_IP
00c8cf d0a9      	rcall	CAD_READ_IP
00c8d0 9622      	adiw	Y, 2
00c8d1 ebec
00c8d2 e3f6      	ldiw	Z, RTC_PNC_PORT
00c8d3 d062      	rcall	CAD_READ_PORT
00c8d4 cf92      	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 ;CAD_SET_RTC_W:
                 ;	STR_GOTOXY 12, 21
                 ;	ldiw	Z, RTC_TMS_MAC
                 ;	rcall	CAD_READ_MAC
                 ;	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 ; set IP
                 ;CAD_SET_RTC_X:
                 ;	STR_GOTOXY 12, 22
                 ;	ldiw	Z, RTC_TMS_IP
                 ;	rcall	CAD_READ_IP
                 ;	adiw	Y, 2
                 ;	ldiw	Z, RTC_TMS_PORT
                 ;	rcall	CAD_READ_PORT
                 ;	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 CAD_SET_RTC_K:
00c8d5 efdd
00c8d6 e3c3      	STR_GOTOXY RSC2Y+11, 17
00c8d7 d0db      	rcall	CAD_READ_HEX2
00c8d8 9350 36be 	sts	RTC_MODBUS_ID, temp
00c8da cf8c      	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 CAD_SET_RTC_L:
00c8db efdd
00c8dc e8c3      	STR_GOTOXY RSC2Y+11, 18
00c8dd d0d5      	rcall	CAD_READ_HEX2
00c8de 9350 36bf 	sts	RTC_CAN_ID, temp
00c8e0 cf86      	rjmp	CAD_SET_RTC_DONE3
                 
                 
                 CAD_SET_RTC_PWD:
00c8e1 efdc
00c8e2 e4c7      	STR_GOTOXY RSC2Y+15, 14
00c8e3 eee0
00c8e4 e3f6      	ldiw	Z, RTC_SEC_PIN
00c8e5 d050      	rcall	CAD_READ_PORT
00c8e6 cf80      	rjmp	CAD_SET_RTC_DONE3
                 
                 CAD_SET_RTC_CAD_PWD:
00c8e7 efdc
00c8e8 e9c7      	STR_GOTOXY RSC2Y+15, 15
00c8e9 eee2
00c8ea e3f6      	ldiw	Z, RTC_CAD_PIN
00c8eb d04a      	rcall	CAD_READ_PORT
00c8ec cf7a      	rjmp	CAD_SET_RTC_DONE3
                 
                 CAD_PUT_PORT:
00c8ed 93bf
00c8ee 93af              pushw	X
00c8ef 91a1      	ld	XL, Z+
00c8f0 81b0      	ld	XH, Z			; port number
00c8f1 e1e0
00c8f2 e2f7      	ldiw	Z, 10000
00c8f3 940e c907 	call	CAD_PUT_DEC_WORD
00c8f5 eee8
00c8f6 e0f3      	ldiw	Z, 1000
00c8f7 940e c907 	call	CAD_PUT_DEC_WORD
00c8f9 e6e4
00c8fa e0f0      	ldiw	Z, 100
00c8fb 940e c907 	call	CAD_PUT_DEC_WORD
00c8fd e0ea
00c8fe e0f0      	ldiw	Z, 10
00c8ff 940e c907 	call	CAD_PUT_DEC_WORD
00c901 2f3a      	mov	r19, XL
00c902 940e c90f 	call	_cad_put_dec_w_l0	; out r19+'0'
00c904 91af
00c905 91bf      	popw	X
00c906 9508      	ret
                 
                 
                 ; put X/r17:r18
                 CAD_PUT_DEC_WORD:
00c907 e030      	ldi	r19, 0
                 _cad_put_dec_w_l1:
00c908 17ae      	cp	XL, ZL
00c909 07bf      	cpc	XH, ZH
00c90a f020      	brlo	_cad_put_dec_w_l0
00c90b 9533      	inc	r19
00c90c 1bae      	sub	XL, ZL
00c90d 0bbf      	sbc	XH, ZH
00c90e cff9      	rjmp	_cad_put_dec_w_l1
                 _cad_put_dec_w_l0:
00c90f 5d30      	subi	r19, -'0'
00c910 940e ca13 	call	CAD_PUTC
00c912 9508      	ret
                 
                 
                 
                 CAD_PUT_MAC:
00c913 e076              ldi	FROMRAM0, 6
                 _cad_put_mac_l0:
00c914 9131      	ld	r19, Z+
00c915 d115      	rcall	CAD_PUTHEX
00c916 9621      	adiw	Y, 1
00c917 957a      	dec	FROMRAM0
00c918 f7d9      	brne	_cad_put_mac_l0
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUTHEX
                 ;	adiw	Y, 1
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUTHEX
                 ;	adiw	Y, 1
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUTHEX
                 ;	adiw	Y, 1
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUTHEX
                 ;	adiw	Y, 1
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUTHEX
00c919 9508      	ret
                 
                 
                 CAD_PUT_IP:
00c91a e074              ldi	FROMRAM0, 4
                 _cad_put_ip_l0:
00c91b 9131      	ld	r19, Z+
00c91c d004      	rcall	CAD_PUT_DEC3
00c91d 9621      	adiw	Y, 1
00c91e 957a      	dec	FROMRAM0
00c91f f7d9      	brne	_cad_put_ip_l0
                 
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUT_DEC3
                 ;	adiw	Y, 1
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUT_DEC3
                 ;	adiw	Y, 1
                 ;	ld	r19, Z+
                 ;	rcall	CAD_PUT_DEC3
00c920 9508      	ret
                 
                 
                 CAD_PUT_DEC3:
00c921 2f53      	mov	temp, r19
00c922 e030      	ldi	r19, 0
                 _cad_put_dec3_l1:
00c923 3654      	cpi	temp, 100
00c924 f018      	brlo	_cad_put_dec3_l0
00c925 5654      	subi	temp, 100
00c926 9533      	inc	r19	
00c927 cffb      	rjmp	_cad_put_dec3_l1
                 _cad_put_dec3_l0:
00c928 5d30      	subi	r19, -'0'
00c929 d0e9      	rcall	CAD_PUTC
00c92a e030      	ldi	r19, 0
                 _cad_put_dec3_l3:
00c92b 305a      	cpi	temp, 10
00c92c f018      	brlo	_cad_put_dec3_l2
00c92d 505a      	subi	temp, 10
00c92e 9533      	inc	r19	
00c92f cffb      	rjmp	_cad_put_dec3_l3
                 _cad_put_dec3_l2:
00c930 5d30      	subi	r19, -'0'
00c931 d0e1      	rcall	CAD_PUTC
00c932 2f35      	mov	r19, temp
00c933 5d30      	subi	r19, -'0'
00c934 d0de      	rcall	CAD_PUTC
00c935 9508      	ret
                 
                 
                 
                 CAD_READ_PORT:
00c936 920f              push	r0
00c937 921f              push	r1
00c938 932f              push	r18
00c939 93bf
00c93a 93af              pushw	X
                 
                 _cad_read_port_l1:
                 ;        ldi	FROMRAM0, 6
                 ;_cad_read_port_l4:
00c93b d085              rcall	CAD_READ_DEC1
00c93c 935f              push	temp
                 ;	dec	FROMRAM0
                 ;	brne	_cad_read_port_l4
00c93d d083              rcall	CAD_READ_DEC1
00c93e 935f              push	temp
00c93f d081              rcall	CAD_READ_DEC1
00c940 935f              push	temp
00c941 d07f              rcall	CAD_READ_DEC1
00c942 935f              push	temp
00c943 d07d              rcall	CAD_READ_DEC1
                 ; 	pop	temp
                 
00c944 2fa5              mov	XL, temp
00c945 e0b0              ldi	XH, 0			; value = r19
                 
00c946 915f              pop	temp			; dozens
00c947 e02a      	ldi	r18, 10
00c948 9f52      	mul	temp, r18		; r0:r1 = dozens
00c949 0da0      	add	XL, r0			; overflow impossible!
00c94a 1db1      	adc	XH, r1
                 
00c94b 915f              pop	temp			; dozens
00c94c e624      	ldi	r18, 100
00c94d 9f52      	mul	temp, r18		; r0:r1 = hundreds
00c94e 0da0      	add	XL, r0			; overflow impossible!
00c94f 1db1      	adc	XH, r1
                 
00c950 915f              pop	temp			; thousands
00c951 ef2a      	ldi	r18, 250
00c952 9f52      	mul	temp, r18		; r0:r1 = hundreds
00c953 0c00      	lsl	r0
00c954 1c11      	rol	r1
00c955 0c00      	lsl	r0
00c956 1c11      	rol	r1			; *4
00c957 0da0      	add	XL, r0			; overflow impossible!
00c958 1db1      	adc	XH, r1
                 
00c959 913f              pop	r19			; tens of thousands
00c95a 2722      	clr	r18
00c95b 3030      	cpi	r19, 0
00c95c f039      	breq	_cad_read_port_l2
                 _cad_read_port_l3:
00c95d e150      	ldi	temp, low(10000)
00c95e 0fa5      	add	XL, temp
00c95f e257      	ldi	temp, high(10000)
00c960 1fb5      	adc	XH, temp
00c961 1d25      	adc	r18, zero
00c962 953a      	dec	r19
00c963 f7c9      	brne	_cad_read_port_l3
                 
                 _cad_read_port_l2:
00c964 1525      	cp	r18, zero		
00c965 f441      	brne	_cad_read_port_l0	; result > maxint?
00c966 93a1      	st	Z+, XL
00c967 83b0      	st	Z, XH			; store result
00c968 91af
00c969 91bf      	popw	X
00c96a 912f              pop	r18
00c96b 901f              pop	r1
00c96c 900f              pop	r0
00c96d 9508      	ret
                 _cad_read_port_l0:
00c96e 940e 8960 	call	SYSTEM_BEEP
00c970 9725      	sbiw	Y, 5
00c971 cfc9      	rjmp	_cad_read_port_l1
                 
                 
                 
                 ; read 6 hex2 digits and store to Z
                 CAD_READ_MAC:
00c972 e076              ldi	FROMRAM0, 6
                 _cad_read_mac_l0:
00c973 d03f      	rcall	CAD_READ_HEX2
00c974 9351      	st	Z+, temp
00c975 9621      	adiw	Y, 1
00c976 957a      	dec	FROMRAM0
00c977 f7d9      	brne	_cad_read_mac_l0
                 ;	rcall	CAD_READ_HEX2
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
                 ;	rcall	CAD_READ_HEX2
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
                 ;	rcall	CAD_READ_HEX2
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
                 ;	rcall	CAD_READ_HEX2
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
                 ;	rcall	CAD_READ_HEX2
                 ;	st	Z+, temp
00c978 9508      	ret
                 
                 
                 CAD_READ_IP:
00c979 e074              ldi	FROMRAM0, 4
                 _cad_read_ip_l0:
00c97a d01b      	rcall	CAD_READ_DEC3
00c97b 9351      	st	Z+, temp
00c97c 9621      	adiw	Y, 1
00c97d 957a      	dec	FROMRAM0
00c97e f7d9      	brne	_cad_read_ip_l0
                 ;	rcall	CAD_READ_DEC3
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
                 ;	rcall	CAD_READ_DEC3
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
                 ;	rcall	CAD_READ_DEC3
                 ;	st	Z+, temp
                 ;	adiw	Y, 1
00c97f 9508      	ret
                 
                 
                 ; echo iobyte addr in Z
                 CAD_PUT_IOBYTE:
00c980 93df
00c981 93cf      	pushw	Y			; store start position
00c982 e051      	ldi	temp, 1<<0              ; bit to test
                 CAD_IO_0:
00c983 8130      	ld	r19, Z
00c984 2335      	and	r19, temp
00c985 e230      	ldi	r19, ' '
00c986 f009      	breq	CAD_IO_1
00c987 e23a      	ldi	r19, '*'
                 CAD_IO_1:
00c988 935f      	push	temp
00c989 d089      	rcall	CAD_PUTC		; set value mark
00c98a 915f      	pop	temp
00c98b 0f55      	lsl	temp
00c98c 962c      	adiw	Y,12			; go to next box
00c98d 3150      	cpi	temp, 1<<4		; next line??
00c98e f421      	brne	CAD_IO_2
00c98f 91cf
00c990 91df      	popw	Y
                 ;	adiw	Y,40
                 ;	adiw	Y,40			; next line
00c991 96a8      	adiw	Y,40
00c992 96a8      	adiw	Y,40			; next line
                 CAD_IO_2:
00c993 3050      	cpi	temp, 0
00c994 f771      	brne	CAD_IO_0
00c995 9508      	ret
                 
                 ; read and return 3-digit
                 CAD_READ_DEC3:
00c996 920f              push	r0
00c997 921f              push	r1
00c998 932f              push	r18
                 
                 _cad_read_dec3_l1:
00c999 d027              rcall	CAD_READ_DEC1
00c99a 935f              push	temp
00c99b d025              rcall	CAD_READ_DEC1
00c99c 935f              push	temp
00c99d d023              rcall	CAD_READ_DEC1
                 
00c99e 2f35              mov	r19, temp		; r19 = units
00c99f 915f              pop	temp			; dozens
00c9a0 e02a      	ldi	r18, 10
00c9a1 9f52      	mul	temp, r18		; r0:r1 = dozens
00c9a2 0d30      	add	r19, r0			; overflow impossible!
00c9a3 915f              pop	temp			; hunderds
00c9a4 e624      	ldi	r18, 100
00c9a5 9f52      	mul	temp, r18
00c9a6 0d30      	add	r19, r0
00c9a7 1c15      	adc	r1, zero
                 
00c9a8 1415      	cp	r1, zero		
00c9a9 f429      	brne	_cad_read_dec3_l0	; result > 255?
00c9aa 2f53      	mov	temp, r19		; value to return
00c9ab 912f              pop	r18
00c9ac 901f              pop	r1
00c9ad 900f              pop	r0
00c9ae 9508      	ret
                 _cad_read_dec3_l0:
00c9af 940e 8960 	call	SYSTEM_BEEP
00c9b1 9723      	sbiw	Y, 3
00c9b2 cfe6      	rjmp	_cad_read_dec3_l1
                 
                 
                 CAD_READ_HEX2:
00c9b3 d019              rcall	CAD_READ_HEX1
00c9b4 9552              swap	temp
00c9b5 935f              push	temp
00c9b6 d016              rcall	CAD_READ_HEX1
00c9b7 913f      	pop	r19
00c9b8 2b53      	or	temp, r19
00c9b9 9508      	ret
                 
                 
                 ; read and return 2-digit as BCD
                 CAD_READ_DEC2_BCD:
00c9ba d006              rcall	CAD_READ_DEC1
00c9bb 9552              swap	temp
00c9bc 935f              push	temp
00c9bd d003              rcall	CAD_READ_DEC1
00c9be 913f      	pop	r19
00c9bf 2b53      	or	temp, r19
00c9c0 9508      	ret
                 
                 
                 ; read decimal from input with echo
                 CAD_READ_DEC1:
                 ;	rcall	CAD_CURSOR
                 _cad_read_d1_l0:
00c9c1 d09b      	rcall	CAD_CONIN
00c9c2 3350      	cpi	temp, '0'
00c9c3 f030      	brlo	CAD_READ_DEC1_BAD
00c9c4 335a      	cpi	temp, '9'+1
00c9c5 f420      	brsh	CAD_READ_DEC1_BAD
00c9c6 2f35      	mov	r19, temp
00c9c7 d04b      	rcall	CAD_PUTC
00c9c8 5350              subi	temp, '0'
00c9c9 9508      	ret	
                 CAD_READ_DEC1_BAD:
00c9ca 940e 8960 	call	SYSTEM_BEEP
00c9cc cff4      	rjmp	_cad_read_d1_l0
                 
                 
                 
                 ; read decimal from input with echo
                 CAD_READ_HEX1:
                 ;	rcall	CAD_CURSOR
                 _cad_read_h1_l0:
00c9cd d08f      	rcall	CAD_CONIN
00c9ce 3350      	cpi	temp, '0'
00c9cf f070      	brlo	CAD_READ_HEX1_BAD
00c9d0 335a      	cpi	temp, '9'+1
00c9d1 f420      	brsh	_cad_read_h1_l1
00c9d2 2f35      	mov	r19, temp
00c9d3 d03f      	rcall	CAD_PUTC
00c9d4 5350              subi	temp, '0'
00c9d5 9508      	ret	
                 _cad_read_h1_l1:
00c9d6 3451      	cpi	temp, 'A'
00c9d7 f030      	brlo	CAD_READ_HEX1_BAD
00c9d8 3457      	cpi	temp, 'F'+1
00c9d9 f420      	brsh	CAD_READ_HEX1_BAD
00c9da 2f35      	mov	r19, temp
00c9db d037      	rcall	CAD_PUTC
00c9dc 5357              subi	temp, 'A'-10
00c9dd 9508      	ret	
                 CAD_READ_HEX1_BAD:
00c9de 940e 8960 	call	SYSTEM_BEEP
00c9e0 cfec      	rjmp	_cad_read_h1_l0
                 
                 /*
                 ; output bcd value from temp to screen position Y
                 CAD_PUTBCD:
                 	push	r19
                 	swap	r19
                 	andi	r19, 0x0f
                 	subi	r19, -'0'
                 	rcall	CAD_PUTC
                 	pop	r19
                 	andi	r19, 0x0f
                 	subi	r19, -'0'
                 	rcall	CAD_PUTC
                 	adiw	Y, 1
                 	ret	
                 */
                 ; ------------------------------------------------------------------------------------------
                 CAD_CURSOR:
00c9e1 93df      	push	YH
00c9e2 5fd7      	subi	YH, 0xf7
00c9e3 93d0 090f
00c9e5 e051
00c9e6 940e 720a 	nportout cpd_vcurh, YH
00c9e8 93c0 090f
00c9ea e052
00c9eb 940e 720a 	nportout cpd_vcurl, YL	
00c9ed 91df      	pop	YH
00c9ee 9508      	ret
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 CAD_PUTS_XY:
00c9ef 935f
00c9f0 e158
00c9f1 b955
00c9f2 eb5f
00c9f3 b954
00c9f4 e050
00c9f5 bd5d
00c9f6 e550
00c9f7 bd5c
00c9f8 9859
00c9f9 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00c9fa 982c      	SPI_SELECT
00c9fb 940e 88e3 	call	DO_PUTS
00c9fd bc5c
00c9fe 9a59
00c9ff b854      	SPI_STOP
00ca00 9508      	ret
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 CAD_PUTS:
00ca01 935f
00ca02 e158
00ca03 b955
00ca04 eb5f
00ca05 b954
00ca06 e050
00ca07 bd5d
00ca08 e550
00ca09 bd5c
00ca0a 9859
00ca0b 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00ca0c 982c      	SPI_SELECT
00ca0d 940e 88e5 	call	DPS_CHAR
00ca0f bc5c
00ca10 9a59
00ca11 b854      	SPI_STOP
00ca12 9508      	ret
                 
                 ; ------------------------------------------------------------------------------------------
                 ; echo char from r19
                 CAD_PUTC:
00ca13 935f              push	temp
00ca14 9150 09a5         lds	temp, CAD_CMD_FLAG
00ca16 1155              cpse	temp, zero
00ca17 e23a              ldi	r19, '*'
00ca18 935f
00ca19 e158
00ca1a b955
00ca1b eb5f
00ca1c b954
00ca1d e050
00ca1e bd5d
00ca1f e550
00ca20 bd5c
00ca21 9859
00ca22 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00ca23 982c      	SPI_SELECT
00ca24 940e 88ec 	call	DPS_CHAROUT
00ca26 bc5c
00ca27 9a59
00ca28 b854      	SPI_STOP
00ca29 915f      	pop	temp
00ca2a 9508      	ret
                 
                 ; ------------------------------------------------------------------------------------------
                 ; echo char from r19
                 CAD_PUTHEX:
00ca2b 935f              push	temp
00ca2c 932f              push	r18
00ca2d 2f23              mov	r18, r19
00ca2e 935f
00ca2f e158
00ca30 b955
00ca31 eb5f
00ca32 b954
00ca33 e050
00ca34 bd5d
00ca35 e550
00ca36 bd5c
00ca37 9859
00ca38 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00ca39 982c      	SPI_SELECT
00ca3a 940e 88f7 	call	STR_PUTHEX
00ca3c bc5c
00ca3d 9a59
00ca3e b854      	SPI_STOP
00ca3f 912f      	pop	r18
00ca40 915f      	pop	temp
00ca41 9508      	ret
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; output line from RAM (Z) to screen (Y) till 0
                 CAD_PUTS_RAM:
00ca42 933f      	push	r19
00ca43 935f
00ca44 e158
00ca45 b955
00ca46 eb5f
00ca47 b954
00ca48 e050
00ca49 bd5d
00ca4a e550
00ca4b bd5c
00ca4c 9859
00ca4d 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00ca4e 982c      	SPI_SELECT
                 CAD_PR_L1:
00ca4f 9131      	ld	r19, Z+
00ca50 3030      	cpi	r19, 0
00ca51 f031      	breq 	CAD_PR_END
00ca52 940e 88ec 	call	DPS_CHAROUT
00ca54 3fdf      	cpi	YH, 0xFF
00ca55 f7c9      	brne 	CAD_PR_L1
00ca56 3dc0      	cpi	YL, 0xd0
00ca57 f7b9      	brne 	CAD_PR_L1
                 ;	rjmp 	CAD_PR_L1
                 CAD_PR_END:
00ca58 bc5c
00ca59 9a59
00ca5a b854      	SPI_STOP
00ca5b 913f      	pop	r19
00ca5c 9508      	ret
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; get char from keyboard
                 CAD_CONIN:
00ca5d df83      	rcall	CAD_CURSOR
                 _cad_conin_l1:
00ca5e e055
00ca5f 940e 720c         nportin cpd_kchar
00ca61 3050      	cpi	temp, 0
00ca62 f3d9      	breq	_cad_conin_l1			; wait for char received
00ca63 935f      	push	temp
00ca64 9250 090f
00ca66 e055
00ca67 940e 720a 	nportout cpd_kchar, zero
00ca69 915f      	pop	temp
00ca6a 3850      	cpi	temp, 128
00ca6b f430      	brsh	_cad_conin_l0			; russian chars - not allowed
00ca6c 3651      	cpi	temp, 'a'
00ca6d f018      	brlo	_cad_conin_ret
00ca6e 375b      	cpi	temp, 'z'+1
00ca6f f408      	brsh	_cad_conin_ret
00ca70 5250      	subi	temp, 32			; uppercase
                 _cad_conin_ret:
00ca71 9508      	ret
                 _cad_conin_l0:
00ca72 940e 8960 	call	SYSTEM_BEEP
00ca74 cfe9      	rjmp	_cad_conin_l1
                 
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; clear screen
                 CAD_CLRSCR:
00ca75 93df
00ca76 93cf      	pushw	Y
00ca77 933f      	push	r19
00ca78 efd8      	ldi	YH, 0xF8
00ca79 e0c0      	ldi	YL, 0
00ca7a e230      	ldi	r19, ' '
                 
00ca7b 935f
00ca7c e158
00ca7d b955
00ca7e eb5f
00ca7f b954
00ca80 e050
00ca81 bd5d
00ca82 e550
00ca83 bd5c
00ca84 9859
00ca85 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00ca86 982c      	SPI_SELECT
                 
                 CAD_CLRSCR_L1:
00ca87 940e 88ec 	call	DPS_CHAROUT
00ca89 3fdf      	cpi	YH, 0xFF
00ca8a f7e1      	brne	CAD_CLRSCR_L1
00ca8b 3dc0      	cpi	YL, 0xd0
00ca8c f7d1      	brne	CAD_CLRSCR_L1
                 
00ca8d bc5c
00ca8e 9a59
00ca8f b854      	SPI_STOP
                 
00ca90 913f      	pop	r19
00ca91 91cf
00ca92 91df      	popw	Y
00ca93 9508      	ret
                 
                 
                 ; ------------------------------------------------------------------------------------------
                 ; restore screen from zRAM
                 CAD_RSTSCR:
00ca94 93df
00ca95 93cf      	pushw	Y
00ca96 933f      	push	r19
00ca97 efd8      	ldi	YH, 0xF8
00ca98 e0c0      	ldi	YL, 0
00ca99 e230      	ldi	r19, ' '
                 CAD_RSTSCR_L1:
00ca9a b9d8
00ca9b b9c2
00ca9c b854
00ca9d b83b
00ca9e 0000
00ca9f 0000
00caa0 b153
00caa1 b82b      	LDRAM   YH, YL, temp
00caa2 2f35      	mov	r19, temp
                 
00caa3 935f
00caa4 e158
00caa5 b955
00caa6 eb5f
00caa7 b954
00caa8 e050
00caa9 bd5d
00caaa e550
00caab bd5c
00caac 9859
00caad 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00caae 982c      	SPI_SELECT
00caaf 940e 88ec 	call	DPS_CHAROUT
00cab1 bc5c
00cab2 9a59
00cab3 b854      	SPI_STOP
                 
00cab4 3fdf      	cpi	YH, 0xFF
00cab5 f721      	brne	CAD_RSTSCR_L1
00cab6 3dc0      	cpi	YL, 0xd0
00cab7 f711      	brne	CAD_RSTSCR_L1
00cab8 913f      	pop	r19
00cab9 91cf
00caba 91df      	popw	Y
00cabb 9508      	ret
                 
                 
                 CAD_PUT_MSG_BLOCK:
00cabc 932f      	push	r18
00cabd 2f23      	mov	r18, r19
00cabe 935f
00cabf e158
00cac0 b955
00cac1 eb5f
00cac2 b954
00cac3 e050
00cac4 bd5d
00cac5 e550
00cac6 bd5c
00cac7 9859
00cac8 915f      	SPI_INIT SPI_SLAVE_CPD, SPI_FCK_DIV_4
00cac9 982c      	SPI_SELECT
                 _cad_pu_msgb_l2:
00caca 9156      	elpm	temp, Z        		; skip zeros
                 _cad_pu_msgb_l1:	
00cacb 3050      	cpi	temp, 0
00cacc f411      	brne	_cad_pu_msgb_l0
00cacd 9157      	elpm	temp, Z+
00cace cffc      	rjmp	_cad_pu_msgb_l1	
                 _cad_pu_msgb_l0:	
00cacf 940e 88e3 	call	DO_PUTS
00cad1 952a      	dec	r18
00cad2 f7b9      	brne	_cad_pu_msgb_l2
00cad3 bc5c
00cad4 9a59
00cad5 b854      	SPI_STOP
00cad6 912f      	pop	r18
00cad7 9508      	ret
                 
                 
                 ; ------------------------------------ special commands ------------------------------------
                 _CAD_CMD:
00cad8 93bf
00cad9 93af      	pushw	X
00cada 93df
00cadb 93cf      	pushw	Y
00cadc 93ff
00cadd 93ef      	pushw	Z
00cade 933f      	push	r19
00cadf 3051
00cae0 f409
00cae1 c00d              tcbe	1, _cad_cmd_pwd		; 1 = request password
                 _CAD_CMD_ret:
00cae2 913f              pop	r19
00cae3 91ef
00cae4 91ff              popw	Z
00cae5 91cf
00cae6 91df              popw	Y
00cae7 91af
00cae8 91bf              popw	X
00cae9 9250 090f
00caeb e055
00caec 940e 720a 	nportout cpd_kchar, zero	; clear char just for the case
00caee 9508      	ret
                 
                 _cad_cmd_pwd:
00caef 940e 8960 	call	SYSTEM_BEEP		; welcome beep
00caf1 9250 090f
00caf3 e055
00caf4 940e 720a 	nportout cpd_kchar, zero	; clear char just for the case
00caf6 df7e      	rcall	CAD_CLRSCR
00caf7 e9fb
00caf8 e2e4
00caf9 def5      	m_puts CAD_MSG_RM
00cafa 9290 09a5 	sts	CAD_CMD_FLAG, one
00cafc efdc
00cafd e8c8      	STR_GOTOXY 41, 15
00cafe eae6
00caff e0f9      	ldiw	Z, CAD_CMD_PIN
00cb00 de35      	rcall	CAD_READ_PORT
00cb01 df92      	rcall	CAD_RSTSCR
00cb02 cfdf      	rjmp	_CAD_CMD_ret
                 		
                 ; ------------------------------------------------------------------------------------------
                 ; ------------------------------------------------------------------------------------------
                 
00cb03 00f8
00cb04 5243
00cb05 5349
00cb06 2053
00cb07 5043
00cb08 4d2f
00cb09 5320
00cb0a 5359
00cb0b 4554
00cb0c 204d
00cb0d 4f43
00cb0e 534e
00cb0f 4c4f
00cb10 2045
00cb11 2e56
00cb12 3020
00cb13 312e
00cb14 6332
00cb15 003a      CAD_MSG_WC: MMSG 1,1, "CRISS CP/M SYSTEM CONSOLE V. 0.12c:"
                 
00cb16 a0f8
00cb17 2041
00cb18 203d
00cb19 5244
00cb1a 5649
00cb1b 2045
00cb1c 0041      CAD_MSG_M1: MMSG 1,3, "A = DRIVE A"
00cb1d f0f8
00cb1e 2042
00cb1f 203d
00cb20 5244
00cb21 5649
00cb22 2045
00cb23 0042      CAD_MSG_M2: MMSG 1,4, "B = DRIVE B"
00cb24 40f9
00cb25 2043
00cb26 203d
00cb27 5244
00cb28 5649
00cb29 2045
00cb2a 0043      CAD_MSG_M3: MMSG 1,5, "C = DRIVE C"
00cb2b 90f9
00cb2c 2044
00cb2d 203d
00cb2e 5244
00cb2f 5649
00cb30 2045
00cb31 0044      CAD_MSG_M4: MMSG 1,6, "D = DRIVE D"
00cb32 e0f9
00cb33 2053
00cb34 203d
00cb35 4552
00cb36 4e49
00cb37 5449
00cb38 5320
00cb39 0044      CAD_MSG_M5: MMSG 1,7, "S = REINIT SD"
00cb3a 30fa
00cb3b 2049
00cb3c 203d
00cb3d 4f49
00cb3e 5942
00cb3f 4554
00cb40 0020      CAD_MSG_M6: MMSG 1,8, "I = IOBYTE "
00cb41 80fa
00cb42 2055
00cb43 203d
00cb44 4544
00cb45 5542
00cb46 2047
00cb47 504f
00cb48 4954
00cb49 4e4f
00cb4a 0053      CAD_MSG_M7: MMSG 1,9, "U = DEBUG OPTIONS"
00cb4b d0fa
00cb4c 2048
00cb4d 203d
00cb4e 4148
00cb4f 4452
00cb50 4157
00cb51 4552
00cb52 5020
00cb53 414c
00cb54 4654
00cb55 524f
00cb56 004d      CAD_MSG_MA: MMSG 1,10,"H = HARDWARE PLATFORM"
00cb57 20fb
00cb58 2052
00cb59 203d
00cb5a 5452
00cb5b 2043
00cb5c 4e41
00cb5d 2044
00cb5e 2d53
00cb5f 4f52
00cb60 004d      CAD_MSG_M10:MMSG 1,11,"R = RTC AND S-ROM"
00cb61 70fb
00cb62 2045
00cb63 203d
00cb64 4545
00cb65 5250
00cb66 4d4f
00cb67 0020      CAD_MSG_M9: MMSG 1,12,"E = EEPROM "
00cb68 c0fb
00cb69 2056
00cb6a 203d
00cb6b 5256
00cb6c 4d41
00cb6d 0020      CAD_MSG_M13:MMSG 1,13,"V = VRAM "
00cb6e 10fc
00cb6f 205a
00cb70 203d
00cb71 4148
00cb72 544c
00cb73 5020
00cb74 4f52
00cb75 5247
00cb76 4d41
00cb77 0020      CAD_MSG_M14:MMSG 1,14,"Z = HALT PROGRAM "
                 
00cb78 a0f8
00cb79 4453
00cb7a 432d
00cb7b 5241
00cb7c 3a44
00cb7d 0020      CAD_MSG_SD: MMSG 1,3, "SD-CARD: "
00cb7e 30ff
00cb7f 4553
00cb80 454c
00cb81 5443
00cb82 4920
00cb83 414d
00cb84 4547
00cb85 4620
00cb86 524f
00cb87 4420
00cb88 4952
00cb89 4556
00cb8a 0020      CAD_MSG_SS: MMSG 1,24,"SELECT IMAGE FOR DRIVE "
00cb8b 203a
00cb8c 5345
00cb8d 2043
00cb8e 4f54
00cb8f 4520
00cb90 4958
00cb91 3a54
00cb92 0020      CAD_MSG_SE: .DB ": ESC TO EXIT: ",0
                 ;CAD_MSG_SS: MMSG 1,22,"PLEASE SELECT IMAGE, ESC TO EXIT:"
                 
00cb93 a0f8
00cb94 4f43
00cb95 534e
00cb96 4c4f
00cb97 3a45
00cb98 0020      CAD_MSG_I0: MMSG 1,3, "CONSOLE: "
00cb99 f0f8
00cb9a 554f
00cb9b 5054
00cb9c 5455
00cb9d 3a53
00cb9e 2020
00cb9f 2041
00cba0 205b
00cba1 205d
00cba2 4f43
00cba3 3a4e
00cba4 2020
00cba5 4220
00cba6 5b20
00cba7 5d20
00cba8 5420
00cba9 5954
00cbaa 203a
00cbab 2020
00cbac 2043
00cbad 205b
00cbae 205d
00cbaf 414c
00cbb0 3a4e
00cbb1 2020
00cbb2 4420
00cbb3 5b20
00cbb4 5d20
00cbb5 4c20
00cbb6 5453
00cbb7 003a      CAD_MSG_I1: MMSG 1,4, "OUTPUTS:  A [ ] CON:   B [ ] TTY:   C [ ] LAN:   D [ ] LST:"
00cbb8 40f9
00cbb9 4e49
00cbba 5550
00cbbb 5354
00cbbc 203a
00cbbd 2020
00cbbe 2045
00cbbf 205b
00cbc0 205d
00cbc1 4f43
00cbc2 3a4e
00cbc3 2020
00cbc4 4620
00cbc5 5b20
00cbc6 5d20
00cbc7 5420
00cbc8 5954
00cbc9 203a
00cbca 2020
00cbcb 2047
00cbcc 205b
00cbcd 205d
00cbce 414c
00cbcf 3a4e
00cbd0 2020
00cbd1 4820
00cbd2 5b20
00cbd3 5d20
00cbd4 4c20
00cbd5 5453
00cbd6 003a      CAD_MSG_I2: MMSG 1,5, "INPUTS:   E [ ] CON:   F [ ] TTY:   G [ ] LAN:   H [ ] LST:"
                 
00cbd7 e0f9
00cbd8 5550
00cbd9 434e
00cbda 2f48
00cbdb 4552
00cbdc 4441
00cbdd 5245
00cbde 003a      CAD_MSG_I3: MMSG 1,7, "PUNCH/READER:"
00cbdf 30fa
00cbe0 554f
00cbe1 5054
00cbe2 5455
00cbe3 3a53
00cbe4 2020
00cbe5 2049
00cbe6 205b
00cbe7 205d
00cbe8 5953
00cbe9 3a53
00cbea 2020
00cbeb 4a20
00cbec 5b20
00cbed 5d20
00cbee 5420
00cbef 5954
00cbf0 203a
00cbf1 2020
00cbf2 204b
00cbf3 205b
00cbf4 205d
00cbf5 414c
00cbf6 3a4e
00cbf7 2020
00cbf8 4c20
00cbf9 5b20
00cbfa 5d20
00cbfb 4c20
00cbfc 5453
00cbfd 003a      CAD_MSG_I4: MMSG 1,8, "OUTPUTS:  I [ ] SYS:   J [ ] TTY:   K [ ] LAN:   L [ ] LST:"
00cbfe 80fa
00cbff 4e49
00cc00 5550
00cc01 5354
00cc02 203a
00cc03 2020
00cc04 204d
00cc05 205b
00cc06 205d
00cc07 5953
00cc08 3a53
00cc09 2020
00cc0a 4e20
00cc0b 5b20
00cc0c 5d20
00cc0d 5420
00cc0e 5954
00cc0f 203a
00cc10 2020
00cc11 204f
00cc12 205b
00cc13 205d
00cc14 414c
00cc15 3a4e
00cc16 2020
00cc17 5020
00cc18 5b20
00cc19 5d20
00cc1a 4c20
00cc1b 5453
00cc1c 003a      CAD_MSG_I5: MMSG 1,9, "INPUTS:   M [ ] SYS:   N [ ] TTY:   O [ ] LAN:   P [ ] LST:"
                 
00cc1d 20fb
00cc1e 4544
00cc1f 4956
00cc20 4543
00cc21 3a53
00cc22 0020      CAD_MSG_I9: MMSG 1,11,"DEVICES: "
00cc23 70fb
00cc24 494c
00cc25 5453
00cc26 203a
00cc27 2020
00cc28 2020
00cc29 2051
00cc2a 205b
00cc2b 205d
00cc2c 504c
00cc2d 3a54
00cc2e 2020
00cc2f 5220
00cc30 5b20
00cc31 5d20
00cc32 5420
00cc33 5954
00cc34 203a
00cc35 2020
00cc36 2053
00cc37 205b
00cc38 205d
00cc39 414c
00cc3a 3a4e
00cc3b 2020
00cc3c 5420
00cc3d 5b20
00cc3e 5d20
00cc3f 4c20
00cc40 5453
00cc41 003a      CAD_MSG_I6: MMSG 1,12,"LIST:     Q [ ] LPT:   R [ ] TTY:   S [ ] LAN:   T [ ] LST:"
00cc42 c0fb
00cc43 4453
00cc44 203a
00cc45 2020
00cc46 2020
00cc47 2020
00cc48 2055
00cc49 205b
00cc4a 205d
00cc4b 4453
00cc4c 3a43
00cc4d 2020
00cc4e 5620
00cc4f 5b20
00cc50 5d20
00cc51 5420
00cc52 5954
00cc53 203a
00cc54 2020
00cc55 2057
00cc56 205b
00cc57 205d
00cc58 414c
00cc59 3a4e
00cc5a 2020
00cc5b 5820
00cc5c 5b20
00cc5d 5d20
00cc5e 4c20
00cc5f 5453
00cc60 003a      CAD_MSG_I7: MMSG 1,13,"SD:       U [ ] SDC:   V [ ] TTY:   W [ ] LAN:   X [ ] LST:"
                 
00cc61 60fc
00cc62 4f4d
00cc63 5355
00cc64 3a45
00cc65 2020
00cc66 2020
00cc67 2059
00cc68 205b
00cc69 205d
00cc6a 454b
00cc6b 4259
00cc6c 0020      CAD_MSG_I8: MMSG 1,15,"MOUSE:    Y [ ] KEYB "
                 
00cc6d 30ff
00cc6e 4553
00cc6f 454c
00cc70 5443
00cc71 4f20
00cc72 5450
00cc73 4f49
00cc74 204e
00cc75 4f54
00cc76 4320
00cc77 4148
00cc78 474e
00cc79 2c45
00cc7a 4520
00cc7b 4353
00cc7c 5420
00cc7d 204f
00cc7e 5845
00cc7f 5449
00cc80 003a      CAD_MSG_IM: MMSG 1,24,"SELECT OPTION TO CHANGE, ESC TO EXIT:"
                 
00cc81 a0f8
00cc82 4f4e
00cc83 4954
00cc84 5946
00cc85 5420
00cc86 204f
00cc87 5454
00cc88 3a59
00cc89 0020      CAD_MSG_D1: MMSG 1,3, "NOTIFY TO TTY: "
00cc8a 40f9
00cc8b 2041
00cc8c 205b
00cc8d 205d
00cc8e 4552
00cc8f 4553
00cc90 5652
00cc91 4445
00cc92 0020      CAD_MSG_D2: MMSG 1,5, "A [ ] RESERVED "
00cc93 90f9
00cc94 2042
00cc95 205b
00cc96 205d
00cc97 385a
00cc98 2030
00cc99 4f50
00cc9a 5452
00cc9b 4920
00cc9c 2f4e
00cc9d 554f
00cc9e 2054
00cc9f 4552
00cca0 5551
00cca1 5345
00cca2 0054      CAD_MSG_D3: MMSG 1,6, "B [ ] Z80 PORT IN/OUT REQUEST"
00cca3 e0f9
00cca4 2043
00cca5 205b
00cca6 205d
00cca7 4442
00cca8 534f
00cca9 4320
00ccaa 4c41
00ccab 004c      CAD_MSG_D4: MMSG 1,7, "C [ ] BDOS CALL"
00ccac 30fa
00ccad 2044
00ccae 205b
00ccaf 205d
00ccb0 4942
00ccb1 534f
00ccb2 4320
00ccb3 4c41
00ccb4 004c      CAD_MSG_D5: MMSG 1,8, "D [ ] BIOS CALL"
00ccb5 80fa
00ccb6 2045
00ccb7 205b
00ccb8 205d
00ccb9 4942
00ccba 534f
00ccbb 5320
00ccbc 2044
00ccbd 4341
00ccbe 4543
00ccbf 5353
00ccc0 0020      CAD_MSG_D6: MMSG 1,9, "E [ ] BIOS SD ACCESS "
00ccc1 d0fa
00ccc2 2046
00ccc3 205b
00ccc4 205d
00ccc5 4942
00ccc6 534f
00ccc7 4320
00ccc8 4e4f
00ccc9 4320
00ccca 4148
00cccb 2052
00cccc 4f43
00cccd 4544
00ccce 0053      CAD_MSG_D7: MMSG 1,10,"F [ ] BIOS CON CHAR CODES"
00cccf 20fb
00ccd0 2047
00ccd1 205b
00ccd2 205d
00ccd3 5249
00ccd4 0051      CAD_MSG_D8: MMSG 1,11,"G [ ] IRQ"
00ccd5 70fb
00ccd6 2048
00ccd7 205b
00ccd8 205d
00ccd9 385a
00ccda 2030
00ccdb 5254
00ccdc 4341
00ccdd 0045      CAD_MSG_D9: MMSG 1,12,"H [ ] Z80 TRACE"
                 
00ccde c2f8
00ccdf 385a
00cce0 2030
00cce1 4544
00cce2 5542
00cce3 3a47
00cce4 0020      CAD_MSG_Z1: MMSG 35,3, "Z80 DEBUG: "
00cce5 62f9
00cce6 2049
00cce7 205b
00cce8 205d
00cce9 4441
00ccea 5244
00cceb 5345
00ccec 0053      CAD_MSG_Z2: MMSG 35,5, "I [ ] ADDRESS"
00cced b2f9
00ccee 204a
00ccef 205b
00ccf0 205d
00ccf1 504f
00ccf2 4f43
00ccf3 4544
00ccf4 0020      CAD_MSG_Z3: MMSG 35,6, "J [ ] OPCODE "
00ccf5 02fa
00ccf6 204b
00ccf7 205b
00ccf8 205d
00ccf9 4641
00ccfa 0020      CAD_MSG_Z4: MMSG 35,7, "K [ ] AF "
00ccfb 52fa
00ccfc 204c
00ccfd 205b
00ccfe 205d
00ccff 4342
00cd00 4420
00cd01 2045
00cd02 4c48
00cd03 0020      CAD_MSG_Z5: MMSG 35,8, "L [ ] BC DE HL "
00cd04 a2fa
00cd05 204d
00cd06 205b
00cd07 205d
00cd08 5849
00cd09 4920
00cd0a 2059
00cd0b 5053
00cd0c 0020      CAD_MSG_Z6: MMSG 35,9, "M [ ] IX IY SP "
00cd0d f2fa
00cd0e 204e
00cd0f 205b
00cd10 205d
00cd11 4e4d
00cd12 4d45
00cd13 4e4f
00cd14 4349
00cd15 0020      CAD_MSG_Z7: MMSG 35,10,"N [ ] MNEMONIC "
00cd16 42fb
00cd17 204f
00cd18 205b
00cd19 205d
00cd1a 5242
00cd1b 4145
00cd1c 204b
00cd1d 5441
00cd1e 2020
00cd1f 5120
00cd20 3d20
00cd21 5b20
00cd22 2020
00cd23 2020
00cd24 005d      CAD_MSG_Z8: MMSG 35,11,"O [ ] BREAK AT   Q = [    ]"
00cd25 92fb
00cd26 2050
00cd27 205b
00cd28 205d
00cd29 5453
00cd2a 5045
00cd2b 0020      CAD_MSG_Z9: MMSG 35,12,"P [ ] STEP "
                 
00cd2c 30ff
00cd2d 4553
00cd2e 454c
00cd2f 5443
00cd30 4f20
00cd31 5450
00cd32 4f49
00cd33 2c4e
00cd34 4520
00cd35 4353
00cd36 5420
00cd37 204f
00cd38 5845
00cd39 5449
00cd3a 003a      CAD_MSG_DM: MMSG 1,24,"SELECT OPTION, ESC TO EXIT:"
                 
00cd3b a0f8
00cd3c 4545
00cd3d 5250
00cd3e 4d4f
00cd3f 003a      CAD_MSG_R1: MMSG 1,3, "EEPROM:"
00cd40 40f9
00cd41 2041
00cd42 203d
00cd43 4152
00cd44 204d
00cd45 3e2d
00cd46 5220
00cd47 4d4f
00cd48 2320
00cd49 0031      CAD_MSG_R2: MMSG 1,5, "A = RAM -> ROM #1"
00cd4a 90f9
00cd4b 2042
00cd4c 203d
00cd4d 4152
00cd4e 204d
00cd4f 2d3c
00cd50 5220
00cd51 4d4f
00cd52 2320
00cd53 0031      CAD_MSG_R3: MMSG 1,6, "B = RAM <- ROM #1" 
00cd54 e0f9
00cd55 2043
00cd56 203d
00cd57 4152
00cd58 204d
00cd59 2d3c
00cd5a 203e
00cd5b 4f52
00cd5c 204d
00cd5d 3123
00cd5e 0020      CAD_MSG_R4: MMSG 1,7, "C = RAM <-> ROM #1 "
00cd5f 30fa
00cd60 2044
00cd61 203d
00cd62 4152
00cd63 204d
00cd64 3e2d
00cd65 5220
00cd66 4d4f
00cd67 2320
00cd68 0032      CAD_MSG_R5: MMSG 1,8, "D = RAM -> ROM #2"
00cd69 80fa
00cd6a 2045
00cd6b 203d
00cd6c 4152
00cd6d 204d
00cd6e 2d3c
00cd6f 5220
00cd70 4d4f
00cd71 2320
00cd72 0032      CAD_MSG_R6: MMSG 1,9, "E = RAM <- ROM #2"
00cd73 d0fa
00cd74 2046
00cd75 203d
00cd76 4152
00cd77 204d
00cd78 2d3c
00cd79 203e
00cd7a 4f52
00cd7b 204d
00cd7c 3223
00cd7d 0020      CAD_MSG_R7: MMSG 1,10,"F = RAM <-> ROM #2 "
00cd7e 20fb
00cd7f 2047
00cd80 203d
00cd81 5245
00cd82 5341
00cd83 2045
00cd84 4f52
00cd85 204d
00cd86 3123
00cd87 0020      CAD_MSG_R8: MMSG 1,11,"G = ERASE ROM #1 "
00cd88 70fb
00cd89 2048
00cd8a 203d
00cd8b 5245
00cd8c 5341
00cd8d 2045
00cd8e 4f52
00cd8f 204d
00cd90 3223
00cd91 0020      CAD_MSG_R9: MMSG 1,12,"H = ERASE ROM #2 "
                 
00cd92 30ff
00cd93 4553
00cd94 454c
00cd95 5443
00cd96 4320
00cd97 4d4f
00cd98 414d
00cd99 444e
00cd9a 202c
00cd9b 5345
00cd9c 2043
00cd9d 4f54
00cd9e 4520
00cd9f 4958
00cda0 3a54
00cda1 0020      CAD_MSG_RM: MMSG 1,24,"SELECT COMMAND, ESC TO EXIT: "
                 
00cda2 a0f8
00cda3 4148
00cda4 4452
00cda5 4157
00cda6 4552
00cda7 5020
00cda8 414c
00cda9 4654
00cdaa 524f
00cdab 3a4d
00cdac 0020      CAD_MSG_H1: MMSG 1,3, "HARDWARE PLATFORM: "
                 
00cdad a0f8
00cdae 5452
00cdaf 3a43
00cdb0 0020      CAD_MSG_C1: MMSG 1,3, "RTC: "
00cdb1 40f9
00cdb2 2041
00cdb3 203d
00cdb4 4954
00cdb5 454d
00cdb6 203a
00cdb7 205b
00cdb8 3a20
00cdb9 2020
00cdba 203a
00cdbb 5d20
00cdbc 0020      CAD_MSG_C2: MMSG 1,5, "A = TIME: [  :  :  ] "
00cdbd 90f9
00cdbe 2042
00cdbf 203d
00cdc0 4144
00cdc1 4554
00cdc2 203a
00cdc3 205b
00cdc4 2e20
00cdc5 2020
00cdc6 202e
00cdc7 5d20
00cdc8 5b20
00cdc9 2020
00cdca 005d      CAD_MSG_C3: MMSG 1,6, "B = DATE: [  .  .  ] [  ]" 
                 
00cdcb 30fa
00cdcc 2043
00cdcd 203d
00cdce 414d
00cdcf 3a43
00cdd0 2020
00cdd1 205b
00cdd2 3a20
00cdd3 2020
00cdd4 203a
00cdd5 3a20
00cdd6 2020
00cdd7 203a
00cdd8 3a20
00cdd9 2020
00cdda 005d      CAD_MSG_C5: MMSG 1,8, "C = MAC:  [  :  :  :  :  :  ]"
00cddb 80fa
00cddc 2044
00cddd 203d
00cdde 5049
00cddf 203a
00cde0 2020
00cde1 205b
00cde2 2020
00cde3 202e
00cde4 2020
00cde5 202e
00cde6 2020
00cde7 202e
00cde8 2020
00cde9 005d      CAD_MSG_C4: MMSG 1,9, "D = IP:   [   .   .   .   ]" 
                 ;CAD_MSG_C6: MMSG 1,10,"E = GATE: [   .   .   .   ]"
                 ;CAD_MSG_C7: MMSG 1,11,"F = MASK: [   .   .   .   ]"
                 
00cdea c0fb
00cdeb 2047
00cdec 203d
00cded 4d53
00cdee 4341
00cdef 203a
00cdf0 205b
00cdf1 3a20
00cdf2 2020
00cdf3 203a
00cdf4 3a20
00cdf5 2020
00cdf6 203a
00cdf7 3a20
00cdf8 2020
00cdf9 005d      CAD_MSG_C8: MMSG 1,13,"G = SMAC: [  :  :  :  :  :  ]"
00cdfa 10fc
00cdfb 2048
00cdfc 203d
00cdfd 2d53
00cdfe 5049
00cdff 203a
00ce00 205b
00ce01 2020
00ce02 202e
00ce03 2020
00ce04 202e
00ce05 2020
00ce06 202e
00ce07 2020
00ce08 3a5d
00ce09 205b
00ce0a 2020
00ce0b 2020
00ce0c 005d      CAD_MSG_C9: MMSG 1,14,"H = S-IP: [   .   .   .   ]:[     ]"
00ce0d 60fc
00ce0e 505e
00ce0f 3d20
00ce10 2020
00ce11 2020
00ce12 2020
00ce13 2020
00ce14 2020
00ce15 2020
00ce16 2020
00ce17 2020
00ce18 2020
00ce19 2020
00ce1a 5250
00ce1b 3a4e
00ce1c 205b
00ce1d 2020
00ce1e 2020
00ce1f 005d      CAD_MSG_CA: MMSG 1,15,"^P =                    PRN:[     ]"
00ce20 b0fc
00ce21 535e
00ce22 3d20
00ce23 2020
00ce24 2020
00ce25 2020
00ce26 2020
00ce27 2020
00ce28 2020
00ce29 2020
00ce2a 2020
00ce2b 2020
00ce2c 2020
00ce2d 4453
00ce2e 3a43
00ce2f 205b
00ce30 2020
00ce31 2020
00ce32 005d      CAD_MSG_CB: MMSG 1,16,"^S =                    SDC:[     ]"
                 
00ce33 50fd
00ce34 2049
00ce35 203d
00ce36 4d50
00ce37 4341
00ce38 203a
00ce39 205b
00ce3a 3a20
00ce3b 2020
00ce3c 203a
00ce3d 3a20
00ce3e 2020
00ce3f 203a
00ce40 3a20
00ce41 2020
00ce42 005d      CAD_MSG_C10:MMSG 1,18,"I = PMAC: [  :  :  :  :  :  ]"
00ce43 a0fd
00ce44 204a
00ce45 203d
00ce46 2d50
00ce47 5049
00ce48 203a
00ce49 205b
00ce4a 2020
00ce4b 202e
00ce4c 2020
00ce4d 202e
00ce4e 2020
00ce4f 202e
00ce50 2020
00ce51 3a5d
00ce52 205b
00ce53 2020
00ce54 2020
00ce55 005d      CAD_MSG_C11:MMSG 1,19,"J = P-IP: [   .   .   .   ]:[     ]"
                 
                 ;CAD_MSG_C24:MMSG 1,21,"W = TMAC: [  :  :  :  :  :  ]"
                 ;CAD_MSG_C25:MMSG 1,22,"X = T-IP: [   .   .   .   ]:[     ]"
                 
                 	.EQU RSC2Y=41
00ce56 28fd
00ce57 204b
00ce58 203d
00ce59 424d
00ce5a 4449
00ce5b 203a
00ce5c 205b
00ce5d 5d20
00ce5e 0020      CAD_MSG_C12: MMSG RSC2Y,17,"K = MBID: [  ] "
00ce5f 78fd
00ce60 204c
00ce61 203d
00ce62 4e43
00ce63 4449
00ce64 203a
00ce65 205b
00ce66 5d20
00ce67 0020      CAD_MSG_C13: MMSG RSC2Y,18,"L = CNID: [  ] "
                 
00ce68 c8f8
00ce69 4944
00ce6a 4153
00ce6b 4c42
00ce6c 3a45
00ce6d 0020      CAD_MSG_C14: MMSG RSC2Y,3, "DISABLE: "
00ce6e 68f9
00ce6f 204d
00ce70 205b
00ce71 205d
00ce72 5542
00ce73 5a5a
00ce74 5245
00ce75 0020      CAD_MSG_C15: MMSG RSC2Y,5, "M [ ] BUZZER "
00ce76 b8f9
00ce77 204e
00ce78 205b
00ce79 205d
00ce7a 5454
00ce7b 0059      CAD_MSG_C16: MMSG RSC2Y,6, "N [ ] TTY"
00ce7c 08fa
00ce7d 204f
00ce7e 205b
00ce7f 205d
00ce80 534c
00ce81 0054      CAD_MSG_C17: MMSG RSC2Y,7, "O [ ] LST"
00ce82 58fa
00ce83 2050
00ce84 205b
00ce85 205d
00ce86 554d
00ce87 4953
00ce88 0043      CAD_MSG_C18: MMSG RSC2Y,8, "P [ ] MUSIC"
00ce89 a8fa
00ce8a 2051
00ce8b 205b
00ce8c 205d
00ce8d 4f52
00ce8e 004d      CAD_MSG_C19: MMSG RSC2Y,9, "Q [ ] ROM"
00ce8f f8fa
00ce90 2052
00ce91 205b
00ce92 205d
00ce93 414c
00ce94 004e      CAD_MSG_C20: MMSG RSC2Y,10,"R [ ] LAN"
00ce95 48fb
00ce96 2053
00ce97 205b
00ce98 205d
00ce99 4143
00ce9a 004e      CAD_MSG_C21: MMSG RSC2Y,11,"S [ ] CAN"
00ce9b 98fb
00ce9c 2054
00ce9d 205b
00ce9e 205d
00ce9f 4453
00cea0 432d
00cea1 5241
00cea2 0044      CAD_MSG_C22: MMSG RSC2Y,12,"T [ ] SD-CARD"
                 
00cea3 38fc
00cea4 2055
00cea5 203d
00cea6 4150
00cea7 5353
00cea8 4f57
00cea9 4452
00ceaa 203a
00ceab 205b
00ceac 2020
00cead 2020
00ceae 005d      CAD_MSG_C23: MMSG RSC2Y,14,"U = PASSWORD: [     ]"
00ceaf 88fc
00ceb0 2059
00ceb1 203d
00ceb2 4942
00ceb3 534f
00ceb4 5020
00ceb5 4457
00ceb6 203a
00ceb7 205b
00ceb8 2020
00ceb9 2020
00ceba 005d      CAD_MSG_C26: MMSG RSC2Y,15,"Y = BIOS PWD: [     ]"
                 
                 	.EQU RSC3Y=65
00cebb e0f8
00cebc 5249
00cebd 2051
00cebe 4556
00cebf 5443
00cec0 524f
00cec1 3a53
00cec2 0020      CAD_MSG_C27: MMSG RSC3Y,3,  "IRQ VECTORS: "
00cec3 80f9
00cec4 415e
00cec5 3d20
00cec6 4b20
00cec7 4442
00cec8 5b20
00cec9 2020
00ceca 005d      CAD_MSG_C43: MMSG RSC3Y,5,  "^A = KBD [  ]"
00cecb d0f9
00cecc 425e
00cecd 3d20
00cece 4720
00cecf 4f50
00ced0 5b20
00ced1 2020
00ced2 005d      CAD_MSG_C28: MMSG RSC3Y,6,  "^B = GPO [  ]"
00ced3 20fa
00ced4 435e
00ced5 3d20
00ced6 4320
00ced7 4354
00ced8 5b20
00ced9 2020
00ceda 005d      CAD_MSG_C29: MMSG RSC3Y,7,  "^C = CTC [  ]"
00cedb 70fa
00cedc 445e
00cedd 3d20
00cede 4d20
00cedf 5355
00cee0 5b20
00cee1 2020
00cee2 005d      CAD_MSG_C30: MMSG RSC3Y,8,  "^D = MUS [  ]"
00cee3 c0fa
00cee4 455e
00cee5 3d20
00cee6 5220
00cee7 3153
00cee8 5b20
00cee9 2020
00ceea 005d      CAD_MSG_C31: MMSG RSC3Y,9,  "^E = RS1 [  ]"
00ceeb 10fb
00ceec 465e
00ceed 3d20
00ceee 5220
00ceef 3253
00cef0 5b20
00cef1 2020
00cef2 005d      CAD_MSG_C32: MMSG RSC3Y,10, "^F = RS2 [  ]"
00cef3 60fb
00cef4 475e
00cef5 3d20
00cef6 4320
00cef7 5854
00cef8 5b20
00cef9 2020
00cefa 005d      CAD_MSG_C33: MMSG RSC3Y,11, "^G = CTX [  ]"
00cefb b0fb
00cefc 485e
00cefd 3d20
00cefe 4320
00ceff 5852
00cf00 5b20
00cf01 2020
00cf02 005d      CAD_MSG_C34: MMSG RSC3Y,12, "^H = CRX [  ]"
00cf03 00fc
00cf04 495e
00cf05 3d20
00cf06 4c20
00cf07 4e41
00cf08 5b20
00cf09 2020
00cf0a 005d      CAD_MSG_C35: MMSG RSC3Y,13, "^I = LAN [  ]"
00cf0b 50fc
00cf0c 4a5e
00cf0d 3d20
00cf0e 4320
00cf0f 4e41
00cf10 5b20
00cf11 2020
00cf12 005d      CAD_MSG_C36: MMSG RSC3Y,14, "^J = CAN [  ]"
00cf13 a0fc
00cf14 4b5e
00cf15 3d20
00cf16 5220
00cf17 4354
00cf18 5b20
00cf19 2020
00cf1a 005d      CAD_MSG_C37: MMSG RSC3Y,15, "^K = RTC [  ]"
00cf1b f0fc
00cf1c 4c5e
00cf1d 3d20
00cf1e 5220
00cf1f 3353
00cf20 5b20
00cf21 2020
00cf22 005d      CAD_MSG_C38: MMSG RSC3Y,16, "^L = RS3 [  ]"
00cf23 40fd
00cf24 4d5e
00cf25 3d20
00cf26 5220
00cf27 3453
00cf28 5b20
00cf29 2020
00cf2a 005d      CAD_MSG_C39: MMSG RSC3Y,17, "^M = RS4 [  ]"
00cf2b 90fd
00cf2c 4e5e
00cf2d 3d20
00cf2e 5220
00cf2f 3553
00cf30 5b20
00cf31 2020
00cf32 005d      CAD_MSG_C40: MMSG RSC3Y,18, "^N = RS5 [  ]"
00cf33 e0fd
00cf34 4f5e
00cf35 3d20
00cf36 5420
00cf37 5854
00cf38 5b20
00cf39 2020
00cf3a 005d      CAD_MSG_C41: MMSG RSC3Y,19, "^O = TTX [  ]"
00cf3b 30fe
00cf3c 505e
00cf3d 3d20
00cf3e 5420
00cf3f 5852
00cf40 5b20
00cf41 2020
00cf42 005d      CAD_MSG_C42: MMSG RSC3Y,20, "^P = TRX [  ]"
                 
00cf43 82fc
00cf44 4950
00cf45 3a4e
00cf46 5b20
00cf47 2020
00cf48 2020
00cf49 5d20
00cf4a 0020      CAD_MSG_PIN: MMSG 35,15,"PIN: [     ] "
                 CAD_END:
                 
                 
                 ; z80 data settings ----------------------------------------
                 ; DATA here MUST be aligned!!!
                 
                 .ORG 0x0d000		;1 a0-		; Data area
                 ROMDATA:
                 #include "z80/z80_asm_ecseg.asm"	; 14*256
                 
00d000 0200
00d001 3f14
00d002 4a43
00d003 5c52
00d004 7165
00d005 8479
00d006 8f88
00d007 a197
00d008 baaa
00d009 f7cc
00d00a 02fb
00d00b 140a
00d00c 2d1c
00d00d 4035
00d00e 4b44
00d00f 5d53
00d010 7665
00d011 ea88
00d012 f5ee
00d013 07fd
00d014 2817
00d015 5230
00d016 5d56
00d017 6f65
00d018 8574
00d019 d097
00d01a 0dd4
00d01b 7b47
00d01c 907f
00d01d b198
00d01e bcb5
00d01f cec4
00d020 d8d5
00d021 dedb
00d022 e4e1
00d023 f2e7
00d024 f8f5
00d025 fefb
00d026 0401
00d027 1207
00d028 1815
00d029 1e1b
00d02a 2421
00d02b 3227
00d02c 3835
00d02d 3e3b
00d02e 4441
00d02f 5247
00d030 5855
00d031 5e5b
00d032 6461
00d033 7267
00d034 7875
00d035 7e7b
00d036 8481
00d037 9287
00d038 c295
00d039 1cef
00d03a 7649
00d03b a7a3
00d03c d7d4
00d03d ddda
00d03e e3e0
00d03f f1e6
00d040 f9f4
00d041 03fe
00d042 0d08
00d043 1f12
00d044 2a24
00d045 3630
00d046 423c
00d047 5648
00d048 635c
00d049 716a
00d04a 7f78
00d04b 9586
00d04c a59c
00d04d b7ae
00d04e c9c0
00d04f e3d2
00d050 f7ec
00d051 0d02
00d052 2318
00d053 412e
00d054 554c
00d055 675e
00d056 7970
00d057 9382
00d058 a59c
00d059 b7ae
00d05a c9c0
00d05b e3d2
00d05c f3ec
00d05d 01fa
00d05e 0f08
00d05f 2516
00d060 452c
00d061 705b
00d062 ee85
00d063 5044
00d064 c1a8
00d065 efda
00d066 5df4
00d067 d3c6
00d068 442b
00d069 6f5a
00d06a e67d
00d06b 4a3c
00d06c bba2
00d06d f0db
00d06e 66fd
00d06f 7b6b
00d070 ecd3
00d071 1702
00d072 ec83
00d073 5442
00d074 c5ac
00d075 e1cc
00d076 52e9
00d077 6757
00d078 d8bf
00d079 06f1
00d07a 770e
00d07b e0d0
00d07c 5138
00d07d 6a55
00d07e db72
00d07f eee0      zOPCODE__LABELS_L: .DB low(zCMD_00),low(zCMD_01),low(zCMD_02),low(zCMD_03),low(zCMD_04),low(zCMD_05),low(zCMD_06),low(zCMD_07),low(zCMD_08),low(zCMD_09),low(zCMD_0a),low(zCMD_0b),low(zCMD_0c),low(zCMD_0d),low(zCMD_0e),low(zCMD_0f),low(zCMD_10),low(zCMD_1100d080 0303
00d081 0303
00d082 0303
00d083 0303
00d084 0303
00d085 0303
00d086 0303
00d087 0303
00d088 0303
00d089 0303
00d08a 0403
00d08b 0404
00d08c 0404
00d08d 0404
00d08e 0404
00d08f 0404
00d090 0404
00d091 0404
00d092 0404
00d093 0504
00d094 0505
00d095 0505
00d096 0505
00d097 0505
00d098 0505
00d099 0505
00d09a 0605
00d09b 0606
00d09c 0606
00d09d 0606
00d09e 0606
00d09f 0606
00d0a0 0606
00d0a1 0606
00d0a2 0606
00d0a3 0606
00d0a4 0606
00d0a5 0606
00d0a6 0707
00d0a7 0707
00d0a8 0707
00d0a9 0707
00d0aa 0707
00d0ab 0707
00d0ac 0707
00d0ad 0707
00d0ae 0707
00d0af 0707
00d0b0 0707
00d0b1 0707
00d0b2 0707
00d0b3 0707
00d0b4 0707
00d0b5 0707
00d0b6 0707
00d0b7 0707
00d0b8 0707
00d0b9 0807
00d0ba 0808
00d0bb 0808
00d0bc 0808
00d0bd 0808
00d0be 0808
00d0bf 0808
00d0c0 0808
00d0c1 0908
00d0c2 0909
00d0c3 0909
00d0c4 0909
00d0c5 0909
00d0c6 0909
00d0c7 0909
00d0c8 0909
00d0c9 0909
00d0ca 0909
00d0cb 0909
00d0cc 0909
00d0cd 0909
00d0ce 0909
00d0cf 0909
00d0d0 0909
00d0d1 0a0a
00d0d2 0a0a
00d0d3 0a0a
00d0d4 0a0a
00d0d5 0a0a
00d0d6 0a0a
00d0d7 0a0a
00d0d8 0a0a
00d0d9 0a0a
00d0da 0a0a
00d0db 0a0a
00d0dc 0a0a
00d0dd 0b0a
00d0de 0b0b
00d0df 0b0b
00d0e0 0b0b
00d0e1 0b0b
00d0e2 0b0b
00d0e3 0c0c
00d0e4 0c0c
00d0e5 0c0c
00d0e6 0d0c
00d0e7 0d0d
00d0e8 0e0e
00d0e9 0e0e
00d0ea 0e0e
00d0eb 0f0f
00d0ec 0f0f
00d0ed 0f0f
00d0ee 100f
00d0ef 1010
00d0f0 1010
00d0f1 1111
00d0f2 1111
00d0f3 1212
00d0f4 1212
00d0f5 1212
00d0f6 1312
00d0f7 1313
00d0f8 1313
00d0f9 1413
00d0fa 1414
00d0fb 1414
00d0fc 1515
00d0fd 1515
00d0fe 1515
00d0ff 1515      ),low(zCMD_12),low(zCMD_13),low(zCMD_14),low(zCMD_15),low(zCMD_16),low(zCMD_17),low(zCMD_18),low(zCMD_19),low(zCMD_1a),low(zCMD_1b),low(zCMD_1c),low(zCMD_1d),low(zCMD_1e),low(zCMD_1f),low(zCMD_20),low(zCMD_21),low(zCMD_22),low(zCMD_23),low(zCMD_24),low(zC                 MD_25),low(zCMD_26),low(zCMD_27),low(zCMD_28),low(zCMD_29),low(zCMD_2a),low(zCMD_2b),low(zCMD_2c),low(zCMD_2d),low(zCMD_2e),low(zCMD_2f),low(zCMD_30),low(zCMD_31),low(zCMD_32),low(zCMD_33),low(zCMD_34),low(zCMD_35),low(zCMD_36),low(zCMD_37),low(zCMD_38),l                 ow(zCMD_39),low(zCMD_3a),low(zCMD_3b),low(zCMD_3c),low(zCMD_3d),low(zCMD_3e),low(zCMD_3f),low(zCMD_40),low(zCMD_41),low(zCMD_42),low(zCMD_43),low(zCMD_44),low(zCMD_45),low(zCMD_46),low(zCMD_47),low(zCMD_48),low(zCMD_49),low(zCMD_4a),low(zCMD_4b),low(zCMD_00d100 5246
00d101 6a5e
00d102 8276
00d103 cc8e
00d104 e4d8
00d105 fcf0
00d106 1408
00d107 5e20
00d108 746a
00d109 887e
00d10a 9c92
00d10b e2a6
00d10c f6ec
00d10d 0a00
00d10e 1e14
00d10f 6428
00d110 776e
00d111 8980
00d112 9b92
00d113 dfa4
00d114 f4e8
00d115 0c00
00d116 2418
00d117 6e30
00d118 867a
00d119 9e92
00d11a b6aa
00d11b 00c2
00d11c 150c
00d11d 271e
00d11e 3930
00d11f 7d42
00d120 9386
00d121 ada0
00d122 c7ba
00d123 e9d4
00d124 03f6
00d125 1d10
00d126 372a
00d127 5944
00d128 7366
00d129 8d80
00d12a a79a
00d12b c9b4
00d12c e3d6
00d12d fdf0
00d12e 170a
00d12f 3924
00d130 5346
00d131 6d60
00d132 877a
00d133 a994
00d134 c3b6
00d135 ddd0
00d136 f7ea
00d137 1904
00d138 3326
00d139 4d40
00d13a 675a
00d13b 8974
00d13c a396
00d13d bdb0
00d13e d7ca
00d13f f9e4
00d140 0a06
00d141 120e
00d142 1a16
00d143 531e
00d144 5b57
00d145 635f
00d146 6b67
00d147 a46f
00d148 aca8
00d149 b4b0
00d14a bcb8
00d14b f5c0
00d14c fdf9
00d14d 0501
00d14e 0d09
00d14f 4611
00d150 4e4a
00d151 5652
00d152 5e5a
00d153 9762
00d154 9f9b
00d155 a7a3
00d156 afab
00d157 e8b3
00d158 f0ec
00d159 f8f4
00d15a 00fc
00d15b 3904
00d15c 413d
00d15d 4945
00d15e 514d
00d15f 8a55
00d160 928e
00d161 9a96
00d162 a29e
00d163 dba6
00d164 e3df
00d165 ebe7
00d166 f3ef
00d167 2cf7
00d168 3430
00d169 3c38
00d16a 4440
00d16b 7d48
00d16c 8581
00d16d 8d89
00d16e 9591
00d16f ce99
00d170 d6d2
00d171 deda
00d172 e6e2
00d173 1fea
00d174 2723
00d175 2f2b
00d176 3733
00d177 703b
00d178 7874
00d179 807c
00d17a 8884
00d17b c18c
00d17c c9c5
00d17d d1cd
00d17e d9d5
00d17f 12dd      4c),low(zCMD_4d),low(zCMD_4e),low(zCMD_4f),low(zCMD_50),low(zCMD_51),low(zCMD_52),low(zCMD_53),low(zCMD_54),low(zCMD_55),low(zCMD_56),low(zCMD_57),low(zCMD_58),low(zCMD_59),low(zCMD_5a),low(zCMD_5b),low(zCMD_5c),low(zCMD_5d),low(zCMD_5e),low(zCMD_5f),low(00d180 1616
00d181 1616
00d182 1616
00d183 1616
00d184 1616
00d185 1616
00d186 1717
00d187 1717
00d188 1717
00d189 1717
00d18a 1717
00d18b 1717
00d18c 1717
00d18d 1818
00d18e 1818
00d18f 1818
00d190 1818
00d191 1818
00d192 1818
00d193 1818
00d194 1818
00d195 1919
00d196 1919
00d197 1919
00d198 1919
00d199 1919
00d19a 1919
00d19b 1a19
00d19c 1a1a
00d19d 1a1a
00d19e 1a1a
00d19f 1a1a
00d1a0 1a1a
00d1a1 1a1a
00d1a2 1a1a
00d1a3 1a1a
00d1a4 1b1a
00d1a5 1b1b
00d1a6 1b1b
00d1a7 1b1b
00d1a8 1b1b
00d1a9 1b1b
00d1aa 1b1b
00d1ab 1b1b
00d1ac 1b1b
00d1ad 1b1b
00d1ae 1c1c
00d1af 1c1c
00d1b0 1c1c
00d1b1 1c1c
00d1b2 1c1c
00d1b3 1c1c
00d1b4 1c1c
00d1b5 1c1c
00d1b6 1c1c
00d1b7 1d1d
00d1b8 1d1d
00d1b9 1d1d
00d1ba 1d1d
00d1bb 1d1d
00d1bc 1d1d
00d1bd 1d1d
00d1be 1d1d
00d1bf 1d1d
00d1c0 1e1e
00d1c1 1e1e
00d1c2 1e1e
00d1c3 1e1e
00d1c4 1e1e
00d1c5 1e1e
00d1c6 1e1e
00d1c7 1e1e
00d1c8 1e1e
00d1c9 1e1e
00d1ca 1e1e
00d1cb 1e1e
00d1cc 1e1e
00d1cd 1f1f
00d1ce 1f1f
00d1cf 1f1f
00d1d0 1f1f
00d1d1 1f1f
00d1d2 1f1f
00d1d3 1f1f
00d1d4 1f1f
00d1d5 1f1f
00d1d6 1f1f
00d1d7 1f1f
00d1d8 1f1f
00d1d9 1f1f
00d1da 201f
00d1db 2020
00d1dc 2020
00d1dd 2020
00d1de 2020
00d1df 2020
00d1e0 2020
00d1e1 2020
00d1e2 2020
00d1e3 2020
00d1e4 2020
00d1e5 2020
00d1e6 2020
00d1e7 2120
00d1e8 2121
00d1e9 2121
00d1ea 2121
00d1eb 2121
00d1ec 2121
00d1ed 2121
00d1ee 2121
00d1ef 2121
00d1f0 2121
00d1f1 2121
00d1f2 2121
00d1f3 2221
00d1f4 2222
00d1f5 2222
00d1f6 2222
00d1f7 2222
00d1f8 2222
00d1f9 2222
00d1fa 2222
00d1fb 2222
00d1fc 2222
00d1fd 2222
00d1fe 2222
00d1ff 2322      zCMD_60),low(zCMD_61),low(zCMD_62),low(zCMD_63),low(zCMD_64),low(zCMD_65),low(zCMD_66),low(zCMD_67),low(zCMD_68),low(zCMD_69),low(zCMD_6a),low(zCMD_6b),low(zCMD_6c),low(zCMD_6d),low(zCMD_6e),low(zCMD_6f),low(zCMD_70),low(zCMD_71),low(zCMD_72),low(zCMD_73)                 ,low(zCMD_74),low(zCMD_75),low(zCMD_76),low(zCMD_77),low(zCMD_78),low(zCMD_79),low(zCMD_7a),low(zCMD_7b),low(zCMD_7c),low(zCMD_7d),low(zCMD_7e),low(zCMD_7f),low(zCMD_80),low(zCMD_81),low(zCMD_82),low(zCMD_83),low(zCMD_84),low(zCMD_85),low(zCMD_86),low(zCM                 D_87),low(zCMD_88),low(zCMD_89),low(zCMD_8a),low(zCMD_8b),low(zCMD_8c),low(zCMD_8d),low(zCMD_8e),low(zCMD_8f),low(zCMD_90),low(zCMD_91),low(zCMD_92),low(zCMD_93),low(zCMD_94),low(zCMD_95),low(zCMD_96),low(zCMD_97),low(zCMD_98),low(zCMD_99),low(zCMD_9a),lo00d200 1816
00d201 552a
00d202 6059
00d203 7268
00d204 877b
00d205 9a8f
00d206 a59e
00d207 b7ad
00d208 d0c0
00d209 0de2
00d20a 1811
00d20b 2a20
00d20c 4332
00d20d 564b
00d20e 615a
00d20f 7369
00d210 8c7b
00d211 009e
00d212 0b04
00d213 1d13
00d214 3e2d
00d215 6846
00d216 736c
00d217 857b
00d218 9b8a
00d219 e6ad
00d21a 31ea
00d21b bb79
00d21c d0bf
00d21d f1d8
00d21e fcf5
00d21f 0e04
00d220 1815
00d221 1e1b
00d222 2421
00d223 4027
00d224 4643
00d225 4c49
00d226 524f
00d227 6e55
00d228 7471
00d229 7a77
00d22a 807d
00d22b 9c83
00d22c a29f
00d22d a8a5
00d22e aeab
00d22f cab1
00d230 d0cd
00d231 d6d3
00d232 dcd9
00d233 f8df
00d234 fefb
00d235 0401
00d236 0a07
00d237 260d
00d238 6429
00d239 da9f
00d23a 5015
00d23b 8f8b
00d23c cdca
00d23d d3d0
00d23e d9d6
00d23f f5dc
00d240 fdf8
00d241 0702
00d242 110c
00d243 3116
00d244 3c36
00d245 4842
00d246 544e
00d247 765a
00d248 837c
00d249 918a
00d24a 9f98
00d24b c3a6
00d24c d3ca
00d24d e5dc
00d24e f7ee
00d24f 1f00
00d250 3328
00d251 493e
00d252 5f54
00d253 8b6a
00d254 9f96
00d255 b1a8
00d256 c3ba
00d257 ebcc
00d258 fdf4
00d259 0f06
00d25a 2118
00d25b 492a
00d25c 5952
00d25d 6760
00d25e 756e
00d25f 997c
00d260 b9a0
00d261 e4cf
00d262 62f9
00d263 c4b8
00d264 351c
00d265 634e
00d266 d86f
00d267 4e41
00d268 bfa6
00d269 ead5
00d26a 61f8
00d26b c5b7
00d26c 361d
00d26d 6b56
00d26e 0078
00d26f f1e1
00d270 6249
00d271 8d78
00d272 62f9
00d273 cab8
00d274 3b22
00d275 5742
00d276 005f
00d277 d8c8
00d278 4930
00d279 7762
00d27a e87f
00d27b 5141
00d27c c2a9
00d27d dbc6
00d27e 00e3
00d27f 5a4c      w(zCMD_9b),low(zCMD_9c),low(zCMD_9d),low(zCMD_9e),low(zCMD_9f),low(zCMD_a0),low(zCMD_a1),low(zCMD_a2),low(zCMD_a3),low(zCMD_a4),low(zCMD_a5),low(zCMD_a6),low(zCMD_a7),low(zCMD_a8),low(zCMD_a9),low(zCMD_aa),low(zCMD_ab),low(zCMD_ac),low(zCMD_ad),low(zCMD_a00d280 2323
00d281 2323
00d282 2323
00d283 2323
00d284 2323
00d285 2323
00d286 2323
00d287 2323
00d288 2323
00d289 2423
00d28a 2424
00d28b 2424
00d28c 2424
00d28d 2424
00d28e 2424
00d28f 2424
00d290 2424
00d291 2524
00d292 2525
00d293 2525
00d294 2525
00d295 2525
00d296 2525
00d297 2525
00d298 2525
00d299 2525
00d29a 2625
00d29b 2626
00d29c 2626
00d29d 2626
00d29e 2626
00d29f 2727
00d2a0 2727
00d2a1 2727
00d2a2 2727
00d2a3 2727
00d2a4 2727
00d2a5 2727
00d2a6 2727
00d2a7 2727
00d2a8 2727
00d2a9 2727
00d2aa 2727
00d2ab 2727
00d2ac 2727
00d2ad 2727
00d2ae 2727
00d2af 2727
00d2b0 2727
00d2b1 2727
00d2b2 2727
00d2b3 2727
00d2b4 2727
00d2b5 2828
00d2b6 2828
00d2b7 2828
00d2b8 2828
00d2b9 2828
00d2ba 2929
00d2bb 2929
00d2bc 2929
00d2bd 2929
00d2be 2929
00d2bf 2929
00d2c0 2929
00d2c1 2a2a
00d2c2 2a2a
00d2c3 2a2a
00d2c4 2a2a
00d2c5 2a2a
00d2c6 2a2a
00d2c7 2a2a
00d2c8 2a2a
00d2c9 2a2a
00d2ca 2a2a
00d2cb 2a2a
00d2cc 2a2a
00d2cd 2a2a
00d2ce 2a2a
00d2cf 2b2b
00d2d0 2b2b
00d2d1 2b2b
00d2d2 2b2b
00d2d3 2b2b
00d2d4 2b2b
00d2d5 2b2b
00d2d6 2b2b
00d2d7 2b2b
00d2d8 2b2b
00d2d9 2c2c
00d2da 2c2c
00d2db 2c2c
00d2dc 2c2c
00d2dd 2c2c
00d2de 2c2c
00d2df 2c2c
00d2e0 2c2c
00d2e1 2c2c
00d2e2 2d2c
00d2e3 2d2d
00d2e4 2e2e
00d2e5 2e2e
00d2e6 2e2e
00d2e7 2f2f
00d2e8 2f2f
00d2e9 2f2f
00d2ea 302f
00d2eb 3030
00d2ec 3131
00d2ed 3131
00d2ee 0231
00d2ef 3131
00d2f0 3232
00d2f1 3232
00d2f2 3332
00d2f3 3333
00d2f4 3434
00d2f5 3434
00d2f6 0234
00d2f7 3434
00d2f8 3535
00d2f9 3535
00d2fa 3535
00d2fb 3636
00d2fc 3636
00d2fd 3636
00d2fe 0236
00d2ff 3737      e),low(zCMD_af),low(zCMD_b0),low(zCMD_b1),low(zCMD_b2),low(zCMD_b3),low(zCMD_b4),low(zCMD_b5),low(zCMD_b6),low(zCMD_b7),low(zCMD_b8),low(zCMD_b9),low(zCMD_ba),low(zCMD_bb),low(zCMD_bc),low(zCMD_bd),low(zCMD_be),low(zCMD_bf),low(zCMD_c0),low(zCMD_c1),low(z                 CMD_c2),low(zCMD_c3),low(zCMD_c4),low(zCMD_c5),low(zCMD_c6),low(zCMD_c7),low(zCMD_c8),low(zCMD_c9),low(zCMD_ca),low(zCMD_cb),low(zCMD_cc),low(zCMD_cd),low(zCMD_ce),low(zCMD_cf),low(zCMD_d0),low(zCMD_d1),low(zCMD_d2),low(zCMD_d3),low(zCMD_d4),low(zCMD_d5),                 low(zCMD_d6),low(zCMD_d7),low(zCMD_d8),low(zCMD_d9),low(zCMD_da),low(zCMD_db),low(zCMD_dc),low(zCMD_dd),low(zCMD_de),low(zCMD_df),low(zCMD_e0),low(zCMD_e1),low(zCMD_e2),low(zCMD_e3),low(zCMD_e4),low(zCMD_e5),low(zCMD_e6),low(zCMD_e7),low(zCMD_e8),low(zCMD00d300 b7b2
00d301 c1bc
00d302 cbc6
00d303 d5d0
00d304 dfda
00d305 e9e4
00d306 f3ee
00d307 fdf8
00d308 0702
00d309 110c
00d30a 1b16
00d30b 2520
00d30c 2f2a
00d30d 3934
00d30e 433e
00d30f 4d48
00d310 5752
00d311 615c
00d312 6b66
00d313 7570
00d314 0000
00d315 0000
00d316 0000
00d317 0000
00d318 0000
00d319 0000
00d31a 0000
00d31b 0000
00d31c 0000
00d31d 0000
00d31e 0000
00d31f 0000
00d320 7f79
00d321 9786
00d322 00f9
00d323 211c
00d324 2c26
00d325 4233
00d326 6b64
00d327 8c87
00d328 9993
00d329 b1a0
00d32a 1a13
00d32b 3b36
00d32c 514b
00d32d 6758
00d32e 9089
00d32f b1ac
00d330 c7c1
00d331 dfce
00d332 4841
00d333 6964
00d334 b5af
00d335 cbbc
00d336 f4ed
00d337 1510
00d338 5b00
00d339 7463
00d33a ddd6
00d33b fef9
00d33c 1a14
00d33d 3021
00d33e 5952
00d33f 7a75
00d340 0000
00d341 0000
00d342 0000
00d343 0000
00d344 0000
00d345 0000
00d346 0000
00d347 0000
00d348 0000
00d349 0000
00d34a 0000
00d34b 0000
00d34c 0000
00d34d 0000
00d34e 0000
00d34f 0000
00d350 e4a5
00d351 32fd
00d352 4e49
00d353 5853
00d354 9c5d
00d355 eab5
00d356 0000
00d357 0000
00d358 4101
00d359 905d
00d35a 0000
00d35b 0000
00d35c e5a5
00d35d 3401
00d35e 0000
00d35f 0000
00d360 0000
00d361 0000
00d362 0000
00d363 0000
00d364 0000
00d365 0000
00d366 0000
00d367 0000
00d368 0000
00d369 0000
00d36a 0000
00d36b 0000
00d36c 0000
00d36d 0000
00d36e 0000
00d36f 0000
00d370 0000
00d371 0000
00d372 0000
00d373 0000
00d374 0000
00d375 0000
00d376 0000
00d377 0000
00d378 0000
00d379 0000
00d37a 0000
00d37b 0000
00d37c 0000
00d37d 0000
00d37e 0000
00d37f 0000      _e9),low(zCMD_ea),low(zCMD_eb),low(zCMD_ec),low(zCMD_ed),low(zCMD_ee),low(zCMD_ef),low(zCMD_f0),low(zCMD_f1),low(zCMD_f2),low(zCMD_f3),low(zCMD_f4),low(zCMD_f5),low(zCMD_f6),low(zCMD_f7),low(zCMD_f8),low(zCMD_f9),low(zCMD_fa),low(zCMD_fb),low(zCMD_fc),low00d380 3737
00d381 3737
00d382 3737
00d383 3737
00d384 3737
00d385 3737
00d386 3737
00d387 3737
00d388 3838
00d389 3838
00d38a 3838
00d38b 3838
00d38c 3838
00d38d 3838
00d38e 3838
00d38f 3838
00d390 3838
00d391 3838
00d392 3838
00d393 3838
00d394 0202
00d395 0202
00d396 0202
00d397 0202
00d398 0202
00d399 0202
00d39a 0202
00d39b 0202
00d39c 0202
00d39d 0202
00d39e 0202
00d39f 0202
00d3a0 3838
00d3a1 3838
00d3a2 3938
00d3a3 3939
00d3a4 3939
00d3a5 3939
00d3a6 3939
00d3a7 3939
00d3a8 3939
00d3a9 3939
00d3aa 3a3a
00d3ab 3a3a
00d3ac 3a3a
00d3ad 3a3a
00d3ae 3a3a
00d3af 3a3a
00d3b0 3a3a
00d3b1 3a3a
00d3b2 3b3b
00d3b3 3b3b
00d3b4 3b3b
00d3b5 3b3b
00d3b6 3b3b
00d3b7 3c3c
00d3b8 3c02
00d3b9 3c3c
00d3ba 3c3c
00d3bb 3c3c
00d3bc 3d3d
00d3bd 3d3d
00d3be 3d3d
00d3bf 3d3d
00d3c0 0202
00d3c1 0202
00d3c2 0202
00d3c3 0202
00d3c4 0202
00d3c5 0202
00d3c6 0202
00d3c7 0202
00d3c8 0202
00d3c9 0202
00d3ca 0202
00d3cb 0202
00d3cc 0202
00d3cd 0202
00d3ce 0202
00d3cf 0202
00d3d0 3d3d
00d3d1 3e3d
00d3d2 3e3e
00d3d3 3e3e
00d3d4 3e3e
00d3d5 3e3e
00d3d6 0202
00d3d7 0202
00d3d8 3f3f
00d3d9 3f3f
00d3da 0202
00d3db 0202
00d3dc 3f3f
00d3dd 4040
00d3de 0202
00d3df 0202
00d3e0 0202
00d3e1 0202
00d3e2 0202
00d3e3 0202
00d3e4 0202
00d3e5 0202
00d3e6 0202
00d3e7 0202
00d3e8 0202
00d3e9 0202
00d3ea 0202
00d3eb 0202
00d3ec 0202
00d3ed 0202
00d3ee 0202
00d3ef 0202
00d3f0 0202
00d3f1 0202
00d3f2 0202
00d3f3 0202
00d3f4 0202
00d3f5 0202
00d3f6 0202
00d3f7 0202
00d3f8 0202
00d3f9 0202
00d3fa 0202
00d3fb 0202
00d3fc 0202
00d3fd 0202
00d3fe 0202
00d3ff 0202      (zCMD_fd),low(zCMD_fe),low(zCMD_ff)
                 zOPCODE__LABELS_H: .DB high(zCMD_00),high(zCMD_01),high(zCMD_02),high(zCMD_03),high(zCMD_04),high(zCMD_05),high(zCMD_06),high(zCMD_07),high(zCMD_08),high(zCMD_09),high(zCMD_0a),high(zCMD_0b),high(zCMD_0c),high(zCMD_0d),high(zCMD_0e),high(zCMD_0f),high(zCM                 D_10),high(zCMD_11),high(zCMD_12),high(zCMD_13),high(zCMD_14),high(zCMD_15),high(zCMD_16),high(zCMD_17),high(zCMD_18),high(zCMD_19),high(zCMD_1a),high(zCMD_1b),high(zCMD_1c),high(zCMD_1d),high(zCMD_1e),high(zCMD_1f),high(zCMD_20),high(zCMD_21),high(zCMD_200d400 4b49
00d401 885d
00d402 938c
00d403 a59b
00d404 baae
00d405 cdc2
00d406 d8d1
00d407 eae0
00d408 03f3
00d409 4015
00d40a 4b44
00d40b 5d53
00d40c 7665
00d40d 897e
00d40e 948d
00d40f a69c
00d410 bfae
00d411 33d1
00d412 3e37
00d413 5046
00d414 7160
00d415 9b79
00d416 a69f
00d417 b8ae
00d418 cebd
00d419 19e0
00d41a 641d
00d41b eeac
00d41c 03f2
00d41d 240b
00d41e 2f28
00d41f 4137
00d420 4b48
00d421 514e
00d422 5754
00d423 735a
00d424 7976
00d425 7f7c
00d426 8582
00d427 a188
00d428 a7a4
00d429 adaa
00d42a b3b0
00d42b cfb6
00d42c d5d2
00d42d dbd8
00d42e e1de
00d42f fde4
00d430 0300
00d431 0906
00d432 0f0c
00d433 2b12
00d434 312e
00d435 3734
00d436 3d3a
00d437 5940
00d438 975c
00d439 0dd2
00d43a 8348
00d43b c2be
00d43c 00fd
00d43d 0603
00d43e 0c09
00d43f 280f
00d440 302b
00d441 3a35
00d442 443f
00d443 6449
00d444 6f69
00d445 7b75
00d446 8781
00d447 a98d
00d448 b6af
00d449 c4bd
00d44a d2cb
00d44b f6d9
00d44c 06fd
00d44d 180f
00d44e 2a21
00d44f 5233
00d450 665b
00d451 7c71
00d452 9287
00d453 be9d
00d454 d2c9
00d455 e4db
00d456 f6ed
00d457 1eff
00d458 3027
00d459 4239
00d45a 544b
00d45b 7c5d
00d45c 8c85
00d45d 9a93
00d45e a8a1
00d45f ccaf
00d460 ecd3
00d461 1702
00d462 952c
00d463 f7eb
00d464 684f
00d465 9681
00d466 0ba2
00d467 8174
00d468 f2d9
00d469 1d08
00d46a 942b
00d46b f8ea
00d46c 6950
00d46d 9e89
00d46e 00ab
00d46f 2414
00d470 957c
00d471 c0ab
00d472 952c
00d473 fdeb
00d474 6e55
00d475 8a75
00d476 0092
00d477 0bfb
00d478 7c63
00d479 aa95
00d47a 1bb2
00d47b 8474
00d47c f5dc
00d47d 0ef9
00d47e 0016
00d47f 8d7f      2),high(zCMD_23),high(zCMD_24),high(zCMD_25),high(zCMD_26),high(zCMD_27),high(zCMD_28),high(zCMD_29),high(zCMD_2a),high(zCMD_2b),high(zCMD_2c),high(zCMD_2d),high(zCMD_2e),high(zCMD_2f),high(zCMD_30),high(zCMD_31),high(zCMD_32),high(zCMD_33),high(zCMD_34),00d480 4040
00d481 4040
00d482 4040
00d483 4040
00d484 4040
00d485 4040
00d486 4040
00d487 4040
00d488 4140
00d489 4141
00d48a 4141
00d48b 4141
00d48c 4141
00d48d 4141
00d48e 4141
00d48f 4141
00d490 4141
00d491 4241
00d492 4242
00d493 4242
00d494 4242
00d495 4242
00d496 4242
00d497 4242
00d498 4242
00d499 4342
00d49a 4343
00d49b 4343
00d49c 4443
00d49d 4444
00d49e 4444
00d49f 4444
00d4a0 4444
00d4a1 4444
00d4a2 4444
00d4a3 4444
00d4a4 4444
00d4a5 4444
00d4a6 4444
00d4a7 4444
00d4a8 4444
00d4a9 4444
00d4aa 4444
00d4ab 4444
00d4ac 4444
00d4ad 4444
00d4ae 4444
00d4af 4444
00d4b0 4545
00d4b1 4545
00d4b2 4545
00d4b3 4545
00d4b4 4545
00d4b5 4545
00d4b6 4545
00d4b7 4545
00d4b8 4545
00d4b9 4645
00d4ba 4646
00d4bb 4646
00d4bc 4746
00d4bd 4747
00d4be 4747
00d4bf 4747
00d4c0 4747
00d4c1 4747
00d4c2 4747
00d4c3 4747
00d4c4 4747
00d4c5 4747
00d4c6 4747
00d4c7 4747
00d4c8 4747
00d4c9 4747
00d4ca 4747
00d4cb 4747
00d4cc 4847
00d4cd 4848
00d4ce 4848
00d4cf 4848
00d4d0 4848
00d4d1 4848
00d4d2 4848
00d4d3 4848
00d4d4 4848
00d4d5 4848
00d4d6 4848
00d4d7 4948
00d4d8 4949
00d4d9 4949
00d4da 4949
00d4db 4949
00d4dc 4949
00d4dd 4949
00d4de 4949
00d4df 4949
00d4e0 4949
00d4e1 4a4a
00d4e2 4a4a
00d4e3 4a4a
00d4e4 4b4b
00d4e5 4b4b
00d4e6 4c4b
00d4e7 4c4c
00d4e8 4c4c
00d4e9 4d4d
00d4ea 4d4d
00d4eb 4d4d
00d4ec 4e4e
00d4ed 4e4e
00d4ee 024e
00d4ef 4f4f
00d4f0 4f4f
00d4f1 4f4f
00d4f2 5050
00d4f3 5050
00d4f4 5151
00d4f5 5151
00d4f6 0251
00d4f7 5251
00d4f8 5252
00d4f9 5252
00d4fa 5352
00d4fb 5353
00d4fc 5353
00d4fd 5453
00d4fe 0254
00d4ff 5454      high(zCMD_35),high(zCMD_36),high(zCMD_37),high(zCMD_38),high(zCMD_39),high(zCMD_3a),high(zCMD_3b),high(zCMD_3c),high(zCMD_3d),high(zCMD_3e),high(zCMD_3f),high(zCMD_40),high(zCMD_41),high(zCMD_42),high(zCMD_43),high(zCMD_44),high(zCMD_45),high(zCMD_46),hig                 h(zCMD_47),high(zCMD_48),high(zCMD_49),high(zCMD_4a),high(zCMD_4b),high(zCMD_4c),high(zCMD_4d),high(zCMD_4e),high(zCMD_4f),high(zCMD_50),high(zCMD_51),high(zCMD_52),high(zCMD_53),high(zCMD_54),high(zCMD_55),high(zCMD_56),high(zCMD_57),high(zCMD_58),high(z                 CMD_59),high(zCMD_5a),high(zCMD_5b),high(zCMD_5c),high(zCMD_5d),high(zCMD_5e),high(zCMD_5f),high(zCMD_60),high(zCMD_61),high(zCMD_62),high(zCMD_63),high(zCMD_64),high(zCMD_65),high(zCMD_66),high(zCMD_67),high(zCMD_68),high(zCMD_69),high(zCMD_6a),high(zCMD00d500 0000
00d501 0000
00d502 0000
00d503 00e5
00d504 0000
00d505 0000
00d506 0000
00d507 002a
00d508 0000
00d509 0000
00d50a 0000
00d50b 006f
00d50c 0000
00d50d 0000
00d50e 0000
00d50f 00b2
00d510 0000
00d511 0000
00d512 0000
00d513 00f5
00d514 0000
00d515 0000
00d516 0000
00d517 0037
00d518 0000
00d519 0000
00d51a 0000
00d51b 007c
00d51c 0000
00d51d 0000
00d51e 0000
00d51f 00c1
00d520 0000
00d521 0000
00d522 0000
00d523 0003
00d524 0000
00d525 0000
00d526 0000
00d527 001f
00d528 0000
00d529 0000
00d52a 0000
00d52b 003b
00d52c 0000
00d52d 0000
00d52e 0000
00d52f 0057
00d530 0000
00d531 0000
00d532 0000
00d533 0073
00d534 0000
00d535 0000
00d536 0000
00d537 008f
00d538 0000
00d539 0000
00d53a 0000
00d53b 00ab
00d53c 0000
00d53d 0000
00d53e 0000
00d53f 00c7
00d540 0000
00d541 0000
00d542 0000
00d543 00e3
00d544 0000
00d545 0000
00d546 0000
00d547 0020
00d548 0000
00d549 0000
00d54a 0000
00d54b 005d
00d54c 0000
00d54d 0000
00d54e 0000
00d54f 009a
00d550 0000
00d551 0000
00d552 0000
00d553 00d7
00d554 0000
00d555 0000
00d556 0000
00d557 0014
00d558 0000
00d559 0000
00d55a 0000
00d55b 0051
00d55c 0000
00d55d 0000
00d55e 0000
00d55f 008e
00d560 0000
00d561 0000
00d562 0000
00d563 00cb
00d564 0000
00d565 0000
00d566 0000
00d567 0008
00d568 0000
00d569 0000
00d56a 0000
00d56b 0045
00d56c 0000
00d56d 0000
00d56e 0000
00d56f 0082
00d570 0000
00d571 0000
00d572 0000
00d573 00bf
00d574 0000
00d575 0000
00d576 0000
00d577 00fc
00d578 0000
00d579 0000
00d57a 0000
00d57b 0039
00d57c 0000
00d57d 0000
00d57e 0000
00d57f 0076      _6b),high(zCMD_6c),high(zCMD_6d),high(zCMD_6e),high(zCMD_6f),high(zCMD_70),high(zCMD_71),high(zCMD_72),high(zCMD_73),high(zCMD_74),high(zCMD_75),high(zCMD_76),high(zCMD_77),high(zCMD_78),high(zCMD_79),high(zCMD_7a),high(zCMD_7b),high(zCMD_7c),high(zCMD_7d00d580 0202
00d581 0202
00d582 0202
00d583 0254
00d584 0202
00d585 0202
00d586 0202
00d587 0255
00d588 0202
00d589 0202
00d58a 0202
00d58b 0255
00d58c 0202
00d58d 0202
00d58e 0202
00d58f 0255
00d590 0202
00d591 0202
00d592 0202
00d593 0255
00d594 0202
00d595 0202
00d596 0202
00d597 0256
00d598 0202
00d599 0202
00d59a 0202
00d59b 0256
00d59c 0202
00d59d 0202
00d59e 0202
00d59f 0256
00d5a0 0202
00d5a1 0202
00d5a2 0202
00d5a3 0257
00d5a4 0202
00d5a5 0202
00d5a6 0202
00d5a7 0257
00d5a8 0202
00d5a9 0202
00d5aa 0202
00d5ab 0257
00d5ac 0202
00d5ad 0202
00d5ae 0202
00d5af 0257
00d5b0 0202
00d5b1 0202
00d5b2 0202
00d5b3 0257
00d5b4 0202
00d5b5 0202
00d5b6 0202
00d5b7 0257
00d5b8 0202
00d5b9 0202
00d5ba 0202
00d5bb 0257
00d5bc 0202
00d5bd 0202
00d5be 0202
00d5bf 0257
00d5c0 0202
00d5c1 0202
00d5c2 0202
00d5c3 0257
00d5c4 0202
00d5c5 0202
00d5c6 0202
00d5c7 0258
00d5c8 0202
00d5c9 0202
00d5ca 0202
00d5cb 0258
00d5cc 0202
00d5cd 0202
00d5ce 0202
00d5cf 0258
00d5d0 0202
00d5d1 0202
00d5d2 0202
00d5d3 0258
00d5d4 0202
00d5d5 0202
00d5d6 0202
00d5d7 0259
00d5d8 0202
00d5d9 0202
00d5da 0202
00d5db 0259
00d5dc 0202
00d5dd 0202
00d5de 0202
00d5df 0259
00d5e0 0202
00d5e1 0202
00d5e2 0202
00d5e3 0259
00d5e4 0202
00d5e5 0202
00d5e6 0202
00d5e7 025a
00d5e8 0202
00d5e9 0202
00d5ea 0202
00d5eb 025a
00d5ec 0202
00d5ed 0202
00d5ee 0202
00d5ef 025a
00d5f0 0202
00d5f1 0202
00d5f2 0202
00d5f3 025a
00d5f4 0202
00d5f5 0202
00d5f6 0202
00d5f7 025a
00d5f8 0202
00d5f9 0202
00d5fa 0202
00d5fb 025b
00d5fc 0202
00d5fd 0202
00d5fe 0202
00d5ff 025b      ),high(zCMD_7e),high(zCMD_7f),high(zCMD_80),high(zCMD_81),high(zCMD_82),high(zCMD_83),high(zCMD_84),high(zCMD_85),high(zCMD_86),high(zCMD_87),high(zCMD_88),high(zCMD_89),high(zCMD_8a),high(zCMD_8b),high(zCMD_8c),high(zCMD_8d),high(zCMD_8e),high(zCMD_8f),h                 igh(zCMD_90),high(zCMD_91),high(zCMD_92),high(zCMD_93),high(zCMD_94),high(zCMD_95),high(zCMD_96),high(zCMD_97),high(zCMD_98),high(zCMD_99),high(zCMD_9a),high(zCMD_9b),high(zCMD_9c),high(zCMD_9d),high(zCMD_9e),high(zCMD_9f),high(zCMD_a0),high(zCMD_a1),high                 (zCMD_a2),high(zCMD_a3),high(zCMD_a4),high(zCMD_a5),high(zCMD_a6),high(zCMD_a7),high(zCMD_a8),high(zCMD_a9),high(zCMD_aa),high(zCMD_ab),high(zCMD_ac),high(zCMD_ad),high(zCMD_ae),high(zCMD_af),high(zCMD_b0),high(zCMD_b1),high(zCMD_b2),high(zCMD_b3),high(zC00d600 0000
00d601 0000
00d602 0000
00d603 00b3
00d604 0000
00d605 0000
00d606 0000
00d607 00f8
00d608 0000
00d609 0000
00d60a 0000
00d60b 003d
00d60c 0000
00d60d 0000
00d60e 0000
00d60f 0080
00d610 0000
00d611 0000
00d612 0000
00d613 00c3
00d614 0000
00d615 0000
00d616 0000
00d617 0005
00d618 0000
00d619 0000
00d61a 0000
00d61b 004a
00d61c 0000
00d61d 0000
00d61e 0000
00d61f 008f
00d620 0000
00d621 0000
00d622 0000
00d623 00d1
00d624 0000
00d625 0000
00d626 0000
00d627 00ed
00d628 0000
00d629 0000
00d62a 0000
00d62b 0009
00d62c 0000
00d62d 0000
00d62e 0000
00d62f 0025
00d630 0000
00d631 0000
00d632 0000
00d633 0041
00d634 0000
00d635 0000
00d636 0000
00d637 005d
00d638 0000
00d639 0000
00d63a 0000
00d63b 0079
00d63c 0000
00d63d 0000
00d63e 0000
00d63f 0095
00d640 0000
00d641 0000
00d642 0000
00d643 00b1
00d644 0000
00d645 0000
00d646 0000
00d647 00ee
00d648 0000
00d649 0000
00d64a 0000
00d64b 002b
00d64c 0000
00d64d 0000
00d64e 0000
00d64f 0068
00d650 0000
00d651 0000
00d652 0000
00d653 00a5
00d654 0000
00d655 0000
00d656 0000
00d657 00e2
00d658 0000
00d659 0000
00d65a 0000
00d65b 001f
00d65c 0000
00d65d 0000
00d65e 0000
00d65f 005c
00d660 0000
00d661 0000
00d662 0000
00d663 0099
00d664 0000
00d665 0000
00d666 0000
00d667 00d6
00d668 0000
00d669 0000
00d66a 0000
00d66b 0013
00d66c 0000
00d66d 0000
00d66e 0000
00d66f 0050
00d670 0000
00d671 0000
00d672 0000
00d673 008d
00d674 0000
00d675 0000
00d676 0000
00d677 00ca
00d678 0000
00d679 0000
00d67a 0000
00d67b 0007
00d67c 0000
00d67d 0000
00d67e 0000
00d67f 0044      MD_b4),high(zCMD_b5),high(zCMD_b6),high(zCMD_b7),high(zCMD_b8),high(zCMD_b9),high(zCMD_ba),high(zCMD_bb),high(zCMD_bc),high(zCMD_bd),high(zCMD_be),high(zCMD_bf),high(zCMD_c0),high(zCMD_c1),high(zCMD_c2),high(zCMD_c3),high(zCMD_c4),high(zCMD_c5),high(zCMD_00d680 0202
00d681 0202
00d682 0202
00d683 025b
00d684 0202
00d685 0202
00d686 0202
00d687 025b
00d688 0202
00d689 0202
00d68a 0202
00d68b 025c
00d68c 0202
00d68d 0202
00d68e 0202
00d68f 025c
00d690 0202
00d691 0202
00d692 0202
00d693 025c
00d694 0202
00d695 0202
00d696 0202
00d697 025d
00d698 0202
00d699 0202
00d69a 0202
00d69b 025d
00d69c 0202
00d69d 0202
00d69e 0202
00d69f 025d
00d6a0 0202
00d6a1 0202
00d6a2 0202
00d6a3 025d
00d6a4 0202
00d6a5 0202
00d6a6 0202
00d6a7 025d
00d6a8 0202
00d6a9 0202
00d6aa 0202
00d6ab 025e
00d6ac 0202
00d6ad 0202
00d6ae 0202
00d6af 025e
00d6b0 0202
00d6b1 0202
00d6b2 0202
00d6b3 025e
00d6b4 0202
00d6b5 0202
00d6b6 0202
00d6b7 025e
00d6b8 0202
00d6b9 0202
00d6ba 0202
00d6bb 025e
00d6bc 0202
00d6bd 0202
00d6be 0202
00d6bf 025e
00d6c0 0202
00d6c1 0202
00d6c2 0202
00d6c3 025e
00d6c4 0202
00d6c5 0202
00d6c6 0202
00d6c7 025e
00d6c8 0202
00d6c9 0202
00d6ca 0202
00d6cb 025f
00d6cc 0202
00d6cd 0202
00d6ce 0202
00d6cf 025f
00d6d0 0202
00d6d1 0202
00d6d2 0202
00d6d3 025f
00d6d4 0202
00d6d5 0202
00d6d6 0202
00d6d7 025f
00d6d8 0202
00d6d9 0202
00d6da 0202
00d6db 0260
00d6dc 0202
00d6dd 0202
00d6de 0202
00d6df 0260
00d6e0 0202
00d6e1 0202
00d6e2 0202
00d6e3 0260
00d6e4 0202
00d6e5 0202
00d6e6 0202
00d6e7 0260
00d6e8 0202
00d6e9 0202
00d6ea 0202
00d6eb 0261
00d6ec 0202
00d6ed 0202
00d6ee 0202
00d6ef 0261
00d6f0 0202
00d6f1 0202
00d6f2 0202
00d6f3 0261
00d6f4 0202
00d6f5 0202
00d6f6 0202
00d6f7 0261
00d6f8 0202
00d6f9 0202
00d6fa 0202
00d6fb 0262
00d6fc 0202
00d6fd 0202
00d6fe 0202
00d6ff 0262      c6),high(zCMD_c7),high(zCMD_c8),high(zCMD_c9),high(zCMD_ca),high(zCMD_cb),high(zCMD_cc),high(zCMD_cd),high(zCMD_ce),high(zCMD_cf),high(zCMD_d0),high(zCMD_d1),high(zCMD_d2),high(zCMD_d3),high(zCMD_d4),high(zCMD_d5),high(zCMD_d6),high(zCMD_d7),high(zCMD_d8)                 ,high(zCMD_d9),high(zCMD_da),high(zCMD_db),high(zCMD_dc),high(zCMD_dd),high(zCMD_de),high(zCMD_df),high(zCMD_e0),high(zCMD_e1),high(zCMD_e2),high(zCMD_e3),high(zCMD_e4),high(zCMD_e5),high(zCMD_e6),high(zCMD_e7),high(zCMD_e8),high(zCMD_e9),high(zCMD_ea),hi                 
                 ;iROMDATA:
                 ;#include "z80/z80_asm_iecseg.asm"
                 
                 #include "z80/z80_asm_pftdata.asm"      ; 256
                 
00d700 0008
00d701 0800
00d702 0800
00d703 0008
00d704 0800
00d705 0008
00d706 0008
00d707 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d708 0800
00d709 0008
00d70a 0008
00d70b 0800
00d70c 0008
00d70d 0800
00d70e 0800
00d70f 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d710 0800
00d711 0008
00d712 0008
00d713 0800
00d714 0008
00d715 0800
00d716 0800
00d717 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d718 0008
00d719 0800
00d71a 0800
00d71b 0008
00d71c 0800
00d71d 0008
00d71e 0008
00d71f 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d720 0800
00d721 0008
00d722 0008
00d723 0800
00d724 0008
00d725 0800
00d726 0800
00d727 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d728 0008
00d729 0800
00d72a 0800
00d72b 0008
00d72c 0800
00d72d 0008
00d72e 0008
00d72f 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d730 0008
00d731 0800
00d732 0800
00d733 0008
00d734 0800
00d735 0008
00d736 0008
00d737 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d738 0800
00d739 0008
00d73a 0008
00d73b 0800
00d73c 0008
00d73d 0800
00d73e 0800
00d73f 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d740 0800
00d741 0008
00d742 0008
00d743 0800
00d744 0008
00d745 0800
00d746 0800
00d747 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d748 0008
00d749 0800
00d74a 0800
00d74b 0008
00d74c 0800
00d74d 0008
00d74e 0008
00d74f 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d750 0008
00d751 0800
00d752 0800
00d753 0008
00d754 0800
00d755 0008
00d756 0008
00d757 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d758 0800
00d759 0008
00d75a 0008
00d75b 0800
00d75c 0008
00d75d 0800
00d75e 0800
00d75f 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d760 0008
00d761 0800
00d762 0800
00d763 0008
00d764 0800
00d765 0008
00d766 0008
00d767 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
00d768 0800
00d769 0008
00d76a 0008
00d76b 0800
00d76c 0008
00d76d 0800
00d76e 0800
00d76f 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d770 0800
00d771 0008
00d772 0008
00d773 0800
00d774 0008
00d775 0800
00d776 0800
00d777 0008      	.DB	___,_P_,_P_,___,_P_,___,___,_P_,_P_,___,___,_P_,___,_P_,_P_,___
00d778 0008
00d779 0800
00d77a 0800
00d77b 0008
00d77c 0800
00d77d 0008
00d77e 0008
00d77f 0800      	.DB	_P_,___,___,_P_,___,_P_,_P_,___,___,_P_,_P_,___,_P_,___,___,_P_
                 #include "z80/z80_flagtranslate.asm"    ; 2*256
00d780 0100
00d781 4140
00d782 8180
00d783 c1c0
00d784 0504
00d785 4544
00d786 8584
00d787 c5c4
00d788 0100
00d789 4140
00d78a 8180
00d78b c1c0
00d78c 0504
00d78d 4544
00d78e 8584
00d78f c5c4
00d790 1110
00d791 5150
00d792 9190
00d793 d1d0
00d794 1514
00d795 5554
00d796 9594
00d797 d5d4
00d798 1110
00d799 5150
00d79a 9190
00d79b d1d0
00d79c 1514
00d79d 5554
00d79e 9594
00d79f d5d4
00d7a0 0302
00d7a1 4342
00d7a2 8382
00d7a3 c3c2
00d7a4 0706
00d7a5 4746
00d7a6 8786
00d7a7 c7c6
00d7a8 0302
00d7a9 4342
00d7aa 8382
00d7ab c3c2
00d7ac 0706
00d7ad 4746
00d7ae 8786
00d7af c7c6
00d7b0 1312
00d7b1 5352
00d7b2 9392
00d7b3 d3d2
00d7b4 1716
00d7b5 5756
00d7b6 9796
00d7b7 d7d6
00d7b8 1312
00d7b9 5352
00d7ba 9392
00d7bb d3d2
00d7bc 1716
00d7bd 5756
00d7be 9796
00d7bf d7d6
00d7c0 0100
00d7c1 4140
00d7c2 8180
00d7c3 c1c0
00d7c4 0504
00d7c5 4544
00d7c6 8584
00d7c7 c5c4
00d7c8 0100
00d7c9 4140
00d7ca 8180
00d7cb c1c0
00d7cc 0504
00d7cd 4544
00d7ce 8584
00d7cf c5c4
00d7d0 1110
00d7d1 5150
00d7d2 9190
00d7d3 d1d0
00d7d4 1514
00d7d5 5554
00d7d6 9594
00d7d7 d5d4
00d7d8 1110
00d7d9 5150
00d7da 9190
00d7db d1d0
00d7dc 1514
00d7dd 5554
00d7de 9594
00d7df d5d4
00d7e0 0302
00d7e1 4342
00d7e2 8382
00d7e3 c3c2
00d7e4 0706
00d7e5 4746
00d7e6 8786
00d7e7 c7c6
00d7e8 0302
00d7e9 4342
00d7ea 8382
00d7eb c3c2
00d7ec 0706
00d7ed 4746
00d7ee 8786
00d7ef c7c6
00d7f0 1312
00d7f1 5352
00d7f2 9392
00d7f3 d3d2
00d7f4 1716
00d7f5 5756
00d7f6 9796
00d7f7 d7d6
00d7f8 1312
00d7f9 5352
00d7fa 9392
00d7fb d3d2
00d7fc 1716
00d7fd 5756
00d7fe 9796
00d7ff d7d6      
00d800 8180
00d801 c1c0
00d802 8988
00d803 c9c8
00d804 8180
00d805 c1c0
00d806 8988
00d807 c9c8
00d808 a1a0
00d809 e1e0
00d80a a9a8
00d80b e9e8
00d80c a1a0
00d80d e1e0
00d80e a9a8
00d80f e9e8
00d810 8180
00d811 c1c0
00d812 8988
00d813 c9c8
00d814 8180
00d815 c1c0
00d816 8988
00d817 c9c8
00d818 a1a0
00d819 e1e0
00d81a a9a8
00d81b e9e8
00d81c a1a0
00d81d e1e0
00d81e a9a8
00d81f e9e8
00d820 8382
00d821 c3c2
00d822 8b8a
00d823 cbca
00d824 8382
00d825 c3c2
00d826 8b8a
00d827 cbca
00d828 a3a2
00d829 e3e2
00d82a abaa
00d82b ebea
00d82c a3a2
00d82d e3e2
00d82e abaa
00d82f ebea
00d830 8382
00d831 c3c2
00d832 8b8a
00d833 cbca
00d834 8382
00d835 c3c2
00d836 8b8a
00d837 cbca
00d838 a3a2
00d839 e3e2
00d83a abaa
00d83b ebea
00d83c a3a2
00d83d e3e2
00d83e abaa
00d83f ebea
00d840 8584
00d841 c5c4
00d842 8d8c
00d843 cdcc
00d844 8584
00d845 c5c4
00d846 8d8c
00d847 cdcc
00d848 a5a4
00d849 e5e4
00d84a adac
00d84b edec
00d84c a5a4
00d84d e5e4
00d84e adac
00d84f edec
00d850 8584
00d851 c5c4
00d852 8d8c
00d853 cdcc
00d854 8584
00d855 c5c4
00d856 8d8c
00d857 cdcc
00d858 a5a4
00d859 e5e4
00d85a adac
00d85b edec
00d85c a5a4
00d85d e5e4
00d85e adac
00d85f edec
00d860 8786
00d861 c7c6
00d862 8f8e
00d863 cfce
00d864 8786
00d865 c7c6
00d866 8f8e
00d867 cfce
00d868 a7a6
00d869 e7e6
00d86a afae
00d86b efee
00d86c a7a6
00d86d e7e6
00d86e afae
00d86f efee
00d870 8786
00d871 c7c6
00d872 8f8e
00d873 cfce
00d874 8786
00d875 c7c6
00d876 8f8e
00d877 cfce
00d878 a7a6
00d879 e7e6
00d87a afae
00d87b efee
00d87c a7a6
00d87d e7e6
00d87e afae
00d87f efee      53,0x92,0x93,0xd2,0xd3,0x16,0x17,0x56,0x57,0x96,0x97,0xd6,0xd7,0x12,0x13,0x52,0x53,0x92,0x93,0xd2,0xd3,0x16,0x17,0x56,0x57,0x96,0x97,0xd6,0xd7,0x00,0x01,0x40,0x41,0x80,0x81,0xc0,0xc1,0x04,0x05,0x44,0x45,0x84,0x85,0xc4,0xc5,0x00,0x01,0x40,0x41,0x80,0x81,0x                 #include "z80/z80_daadata.asm"          ; 4096
                 
                 DAA_ACC:
00d880 0100
00d881 0302
00d882 0504
00d883 0706
00d884 0908
00d885 1110
00d886 1312
00d887 1514      	.DB	0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15
00d888 1110
00d889 1312
00d88a 1514
00d88b 1716
00d88c 1918
00d88d 2120
00d88e 2322
00d88f 2524      	.DB	0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x20,0x21,0x22,0x23,0x24,0x25
00d890 2120
00d891 2322
00d892 2524
00d893 2726
00d894 2928
00d895 3130
00d896 3332
00d897 3534      	.DB	0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x30,0x31,0x32,0x33,0x34,0x35
00d898 3130
00d899 3332
00d89a 3534
00d89b 3736
00d89c 3938
00d89d 4140
00d89e 4342
00d89f 4544      	.DB	0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x40,0x41,0x42,0x43,0x44,0x45
00d8a0 4140
00d8a1 4342
00d8a2 4544
00d8a3 4746
00d8a4 4948
00d8a5 5150
00d8a6 5352
00d8a7 5554      	.DB	0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x50,0x51,0x52,0x53,0x54,0x55
00d8a8 5150
00d8a9 5352
00d8aa 5554
00d8ab 5756
00d8ac 5958
00d8ad 6160
00d8ae 6362
00d8af 6564      	.DB	0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x60,0x61,0x62,0x63,0x64,0x65
00d8b0 6160
00d8b1 6362
00d8b2 6564
00d8b3 6766
00d8b4 6968
00d8b5 7170
00d8b6 7372
00d8b7 7574      	.DB	0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x70,0x71,0x72,0x73,0x74,0x75
00d8b8 7170
00d8b9 7372
00d8ba 7574
00d8bb 7776
00d8bc 7978
00d8bd 8180
00d8be 8382
00d8bf 8584      	.DB	0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x80,0x81,0x82,0x83,0x84,0x85
00d8c0 8180
00d8c1 8382
00d8c2 8584
00d8c3 8786
00d8c4 8988
00d8c5 9190
00d8c6 9392
00d8c7 9594      	.DB	0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x90,0x91,0x92,0x93,0x94,0x95
00d8c8 9190
00d8c9 9392
00d8ca 9594
00d8cb 9796
00d8cc 9998
00d8cd 0100
00d8ce 0302
00d8cf 0504      	.DB	0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x00,0x01,0x02,0x03,0x04,0x05
00d8d0 0100
00d8d1 0302
00d8d2 0504
00d8d3 0706
00d8d4 0908
00d8d5 1110
00d8d6 1312
00d8d7 1514      	.DB	0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15
00d8d8 1110
00d8d9 1312
00d8da 1514
00d8db 1716
00d8dc 1918
00d8dd 2120
00d8de 2322
00d8df 2524      	.DB	0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x20,0x21,0x22,0x23,0x24,0x25
00d8e0 2120
00d8e1 2322
00d8e2 2524
00d8e3 2726
00d8e4 2928
00d8e5 3130
00d8e6 3332
00d8e7 3534      	.DB	0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x30,0x31,0x32,0x33,0x34,0x35
00d8e8 3130
00d8e9 3332
00d8ea 3534
00d8eb 3736
00d8ec 3938
00d8ed 4140
00d8ee 4342
00d8ef 4544      	.DB	0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x40,0x41,0x42,0x43,0x44,0x45
00d8f0 4140
00d8f1 4342
00d8f2 4544
00d8f3 4746
00d8f4 4948
00d8f5 5150
00d8f6 5352
00d8f7 5554      	.DB	0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x50,0x51,0x52,0x53,0x54,0x55
00d8f8 5150
00d8f9 5352
00d8fa 5554
00d8fb 5756
00d8fc 5958
00d8fd 6160
00d8fe 6362
00d8ff 6564      	.DB	0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x60,0x61,0x62,0x63,0x64,0x65
00d900 0706
00d901 0908
00d902 0b0a
00d903 0d0c
00d904 0f0e
00d905 1110
00d906 1312
00d907 1514      	.DB	0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15
00d908 1716
00d909 1918
00d90a 1b1a
00d90b 1d1c
00d90c 1f1e
00d90d 2120
00d90e 2322
00d90f 2524      	.DB	0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20,0x21,0x22,0x23,0x24,0x25
00d910 2726
00d911 2928
00d912 2b2a
00d913 2d2c
00d914 2f2e
00d915 3130
00d916 3332
00d917 3534      	.DB	0x26,0x27,0x28,0x29,0x2a,0x2b,0x2c,0x2d,0x2e,0x2f,0x30,0x31,0x32,0x33,0x34,0x35
00d918 3736
00d919 3938
00d91a 3b3a
00d91b 3d3c
00d91c 3f3e
00d91d 4140
00d91e 4342
00d91f 4544      	.DB	0x36,0x37,0x38,0x39,0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,0x44,0x45
00d920 4746
00d921 4948
00d922 4b4a
00d923 4d4c
00d924 4f4e
00d925 5150
00d926 5352
00d927 5554      	.DB	0x46,0x47,0x48,0x49,0x4a,0x4b,0x4c,0x4d,0x4e,0x4f,0x50,0x51,0x52,0x53,0x54,0x55
00d928 5756
00d929 5958
00d92a 5b5a
00d92b 5d5c
00d92c 5f5e
00d92d 6160
00d92e 6362
00d92f 6564      	.DB	0x56,0x57,0x58,0x59,0x5a,0x5b,0x5c,0x5d,0x5e,0x5f,0x60,0x61,0x62,0x63,0x64,0x65
00d930 6766
00d931 6968
00d932 6b6a
00d933 6d6c
00d934 6f6e
00d935 7170
00d936 7372
00d937 7574      	.DB	0x66,0x67,0x68,0x69,0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x74,0x75
00d938 7776
00d939 7978
00d93a 7b7a
00d93b 7d7c
00d93c 7f7e
00d93d 8180
00d93e 8382
00d93f 8584      	.DB	0x76,0x77,0x78,0x79,0x7a,0x7b,0x7c,0x7d,0x7e,0x7f,0x80,0x81,0x82,0x83,0x84,0x85
00d940 8786
00d941 8988
00d942 8b8a
00d943 8d8c
00d944 8f8e
00d945 9190
00d946 9392
00d947 9594      	.DB	0x86,0x87,0x88,0x89,0x8a,0x8b,0x8c,0x8d,0x8e,0x8f,0x90,0x91,0x92,0x93,0x94,0x95
00d948 9796
00d949 9998
00d94a 9b9a
00d94b 9d9c
00d94c 9f9e
00d94d 0100
00d94e 0302
00d94f 0504      	.DB	0x96,0x97,0x98,0x99,0x9a,0x9b,0x9c,0x9d,0x9e,0x9f,0x00,0x01,0x02,0x03,0x04,0x05
00d950 0706
00d951 0908
00d952 0b0a
00d953 0d0c
00d954 0f0e
00d955 1110
00d956 1312
00d957 1514      	.DB	0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15
00d958 1716
00d959 1918
00d95a 1b1a
00d95b 1d1c
00d95c 1f1e
00d95d 2120
00d95e 2322
00d95f 2524      	.DB	0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20,0x21,0x22,0x23,0x24,0x25
00d960 2726
00d961 2928
00d962 2b2a
00d963 2d2c
00d964 2f2e
00d965 3130
00d966 3332
00d967 3534      	.DB	0x26,0x27,0x28,0x29,0x2a,0x2b,0x2c,0x2d,0x2e,0x2f,0x30,0x31,0x32,0x33,0x34,0x35
00d968 3736
00d969 3938
00d96a 3b3a
00d96b 3d3c
00d96c 3f3e
00d96d 4140
00d96e 4342
00d96f 4544      	.DB	0x36,0x37,0x38,0x39,0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,0x44,0x45
00d970 4746
00d971 4948
00d972 4b4a
00d973 4d4c
00d974 4f4e
00d975 5150
00d976 5352
00d977 5554      	.DB	0x46,0x47,0x48,0x49,0x4a,0x4b,0x4c,0x4d,0x4e,0x4f,0x50,0x51,0x52,0x53,0x54,0x55
00d978 5756
00d979 5958
00d97a 5b5a
00d97b 5d5c
00d97c 5f5e
00d97d 6160
00d97e 6362
00d97f 6564      	.DB	0x56,0x57,0x58,0x59,0x5a,0x5b,0x5c,0x5d,0x5e,0x5f,0x60,0x61,0x62,0x63,0x64,0x65
00d980 6160
00d981 6362
00d982 6564
00d983 6766
00d984 6968
00d985 7170
00d986 7372
00d987 7574      	.DB	0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x70,0x71,0x72,0x73,0x74,0x75
00d988 7170
00d989 7372
00d98a 7574
00d98b 7776
00d98c 7978
00d98d 8180
00d98e 8382
00d98f 8584      	.DB	0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x80,0x81,0x82,0x83,0x84,0x85
00d990 8180
00d991 8382
00d992 8584
00d993 8786
00d994 8988
00d995 9190
00d996 9392
00d997 9594      	.DB	0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x90,0x91,0x92,0x93,0x94,0x95
00d998 9190
00d999 9392
00d99a 9594
00d99b 9796
00d99c 9998
00d99d a1a0
00d99e a3a2
00d99f a5a4      	.DB	0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0xa0,0xa1,0xa2,0xa3,0xa4,0xa5
00d9a0 a1a0
00d9a1 a3a2
00d9a2 a5a4
00d9a3 a7a6
00d9a4 a9a8
00d9a5 b1b0
00d9a6 b3b2
00d9a7 b5b4      	.DB	0xa0,0xa1,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,0xa8,0xa9,0xb0,0xb1,0xb2,0xb3,0xb4,0xb5
00d9a8 b1b0
00d9a9 b3b2
00d9aa b5b4
00d9ab b7b6
00d9ac b9b8
00d9ad c1c0
00d9ae c3c2
00d9af c5c4      	.DB	0xb0,0xb1,0xb2,0xb3,0xb4,0xb5,0xb6,0xb7,0xb8,0xb9,0xc0,0xc1,0xc2,0xc3,0xc4,0xc5
00d9b0 c1c0
00d9b1 c3c2
00d9b2 c5c4
00d9b3 c7c6
00d9b4 c9c8
00d9b5 d1d0
00d9b6 d3d2
00d9b7 d5d4      	.DB	0xc0,0xc1,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xd0,0xd1,0xd2,0xd3,0xd4,0xd5
00d9b8 d1d0
00d9b9 d3d2
00d9ba d5d4
00d9bb d7d6
00d9bc d9d8
00d9bd e1e0
00d9be e3e2
00d9bf e5e4      	.DB	0xd0,0xd1,0xd2,0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xe0,0xe1,0xe2,0xe3,0xe4,0xe5
00d9c0 e1e0
00d9c1 e3e2
00d9c2 e5e4
00d9c3 e7e6
00d9c4 e9e8
00d9c5 f1f0
00d9c6 f3f2
00d9c7 f5f4      	.DB	0xe0,0xe1,0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xf0,0xf1,0xf2,0xf3,0xf4,0xf5
00d9c8 f1f0
00d9c9 f3f2
00d9ca f5f4
00d9cb f7f6
00d9cc f9f8
00d9cd 0100
00d9ce 0302
00d9cf 0504      	.DB	0xf0,0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9,0x00,0x01,0x02,0x03,0x04,0x05
00d9d0 0100
00d9d1 0302
00d9d2 0504
00d9d3 0706
00d9d4 0908
00d9d5 1110
00d9d6 1312
00d9d7 1514      	.DB	0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14,0x15
00d9d8 1110
00d9d9 1312
00d9da 1514
00d9db 1716
00d9dc 1918
00d9dd 2120
00d9de 2322
00d9df 2524      	.DB	0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x20,0x21,0x22,0x23,0x24,0x25
00d9e0 2120
00d9e1 2322
00d9e2 2524
00d9e3 2726
00d9e4 2928
00d9e5 3130
00d9e6 3332
00d9e7 3534      	.DB	0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x30,0x31,0x32,0x33,0x34,0x35
00d9e8 3130
00d9e9 3332
00d9ea 3534
00d9eb 3736
00d9ec 3938
00d9ed 4140
00d9ee 4342
00d9ef 4544      	.DB	0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x40,0x41,0x42,0x43,0x44,0x45
00d9f0 4140
00d9f1 4342
00d9f2 4544
00d9f3 4746
00d9f4 4948
00d9f5 5150
00d9f6 5352
00d9f7 5554      	.DB	0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x50,0x51,0x52,0x53,0x54,0x55
00d9f8 5150
00d9f9 5352
00d9fa 5554
00d9fb 5756
00d9fc 5958
00d9fd 6160
00d9fe 6362
00d9ff 6564      	.DB	0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x60,0x61,0x62,0x63,0x64,0x65
00da00 6766
00da01 6968
00da02 6b6a
00da03 6d6c
00da04 6f6e
00da05 7170
00da06 7372
00da07 7574      	.DB	0x66,0x67,0x68,0x69,0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x74,0x75
00da08 7776
00da09 7978
00da0a 7b7a
00da0b 7d7c
00da0c 7f7e
00da0d 8180
00da0e 8382
00da0f 8584      	.DB	0x76,0x77,0x78,0x79,0x7a,0x7b,0x7c,0x7d,0x7e,0x7f,0x80,0x81,0x82,0x83,0x84,0x85
00da10 8786
00da11 8988
00da12 8b8a
00da13 8d8c
00da14 8f8e
00da15 9190
00da16 9392
00da17 9594      	.DB	0x86,0x87,0x88,0x89,0x8a,0x8b,0x8c,0x8d,0x8e,0x8f,0x90,0x91,0x92,0x93,0x94,0x95
00da18 9796
00da19 9998
00da1a 9b9a
00da1b 9d9c
00da1c 9f9e
00da1d a1a0
00da1e a3a2
00da1f a5a4      	.DB	0x96,0x97,0x98,0x99,0x9a,0x9b,0x9c,0x9d,0x9e,0x9f,0xa0,0xa1,0xa2,0xa3,0xa4,0xa5
00da20 a7a6
00da21 a9a8
00da22 abaa
00da23 adac
00da24 afae
00da25 b1b0
00da26 b3b2
00da27 b5b4      	.DB	0xa6,0xa7,0xa8,0xa9,0xaa,0xab,0xac,0xad,0xae,0xaf,0xb0,0xb1,0xb2,0xb3,0xb4,0xb5
00da28 b7b6
00da29 b9b8
00da2a bbba
00da2b bdbc
00da2c bfbe
00da2d c1c0
00da2e c3c2
00da2f c5c4      	.DB	0xb6,0xb7,0xb8,0xb9,0xba,0xbb,0xbc,0xbd,0xbe,0xbf,0xc0,0xc1,0xc2,0xc3,0xc4,0xc5
00da30 c7c6
00da31 c9c8
00da32 cbca
00da33 cdcc
00da34 cfce
00da35 d1d0
00da36 d3d2
00da37 d5d4      	.DB	0xc6,0xc7,0xc8,0xc9,0xca,0xcb,0xcc,0xcd,0xce,0xcf,0xd0,0xd1,0xd2,0xd3,0xd4,0xd5
00da38 d7d6
00da39 d9d8
00da3a dbda
00da3b dddc
00da3c dfde
00da3d e1e0
00da3e e3e2
00da3f e5e4      	.DB	0xd6,0xd7,0xd8,0xd9,0xda,0xdb,0xdc,0xdd,0xde,0xdf,0xe0,0xe1,0xe2,0xe3,0xe4,0xe5
00da40 e7e6
00da41 e9e8
00da42 ebea
00da43 edec
00da44 efee
00da45 f1f0
00da46 f3f2
00da47 f5f4      	.DB	0xe6,0xe7,0xe8,0xe9,0xea,0xeb,0xec,0xed,0xee,0xef,0xf0,0xf1,0xf2,0xf3,0xf4,0xf5
00da48 f7f6
00da49 f9f8
00da4a fbfa
00da4b fdfc
00da4c fffe
00da4d 0100
00da4e 0302
00da4f 0504      	.DB	0xf6,0xf7,0xf8,0xf9,0xfa,0xfb,0xfc,0xfd,0xfe,0xff,0x00,0x01,0x02,0x03,0x04,0x05
00da50 0706
00da51 0908
00da52 0b0a
00da53 0d0c
00da54 0f0e
00da55 1110
00da56 1312
00da57 1514      	.DB	0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15
00da58 1716
00da59 1918
00da5a 1b1a
00da5b 1d1c
00da5c 1f1e
00da5d 2120
00da5e 2322
00da5f 2524      	.DB	0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20,0x21,0x22,0x23,0x24,0x25
00da60 2726
00da61 2928
00da62 2b2a
00da63 2d2c
00da64 2f2e
00da65 3130
00da66 3332
00da67 3534      	.DB	0x26,0x27,0x28,0x29,0x2a,0x2b,0x2c,0x2d,0x2e,0x2f,0x30,0x31,0x32,0x33,0x34,0x35
00da68 3736
00da69 3938
00da6a 3b3a
00da6b 3d3c
00da6c 3f3e
00da6d 4140
00da6e 4342
00da6f 4544      	.DB	0x36,0x37,0x38,0x39,0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,0x44,0x45
00da70 4746
00da71 4948
00da72 4b4a
00da73 4d4c
00da74 4f4e
00da75 5150
00da76 5352
00da77 5554      	.DB	0x46,0x47,0x48,0x49,0x4a,0x4b,0x4c,0x4d,0x4e,0x4f,0x50,0x51,0x52,0x53,0x54,0x55
00da78 5756
00da79 5958
00da7a 5b5a
00da7b 5d5c
00da7c 5f5e
00da7d 6160
00da7e 6362
00da7f 6564      	.DB	0x56,0x57,0x58,0x59,0x5a,0x5b,0x5c,0x5d,0x5e,0x5f,0x60,0x61,0x62,0x63,0x64,0x65
00da80 0100
00da81 0302
00da82 0504
00da83 0706
00da84 0908
00da85 0504
00da86 0706
00da87 0908      	.DB	0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x04,0x05,0x06,0x07,0x08,0x09
00da88 1110
00da89 1312
00da8a 1514
00da8b 1716
00da8c 1918
00da8d 1514
00da8e 1716
00da8f 1918      	.DB	0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x14,0x15,0x16,0x17,0x18,0x19
00da90 2120
00da91 2322
00da92 2524
00da93 2726
00da94 2928
00da95 2524
00da96 2726
00da97 2928      	.DB	0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x24,0x25,0x26,0x27,0x28,0x29
00da98 3130
00da99 3332
00da9a 3534
00da9b 3736
00da9c 3938
00da9d 3534
00da9e 3736
00da9f 3938      	.DB	0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x34,0x35,0x36,0x37,0x38,0x39
00daa0 4140
00daa1 4342
00daa2 4544
00daa3 4746
00daa4 4948
00daa5 4544
00daa6 4746
00daa7 4948      	.DB	0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x44,0x45,0x46,0x47,0x48,0x49
00daa8 5150
00daa9 5352
00daaa 5554
00daab 5756
00daac 5958
00daad 5554
00daae 5756
00daaf 5958      	.DB	0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x54,0x55,0x56,0x57,0x58,0x59
00dab0 6160
00dab1 6362
00dab2 6564
00dab3 6766
00dab4 6968
00dab5 6564
00dab6 6766
00dab7 6968      	.DB	0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x64,0x65,0x66,0x67,0x68,0x69
00dab8 7170
00dab9 7372
00daba 7574
00dabb 7776
00dabc 7978
00dabd 7574
00dabe 7776
00dabf 7978      	.DB	0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x74,0x75,0x76,0x77,0x78,0x79
00dac0 8180
00dac1 8382
00dac2 8584
00dac3 8786
00dac4 8988
00dac5 8584
00dac6 8786
00dac7 8988      	.DB	0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x84,0x85,0x86,0x87,0x88,0x89
00dac8 9190
00dac9 9392
00daca 9594
00dacb 9796
00dacc 9998
00dacd 3534
00dace 3736
00dacf 3938      	.DB	0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x34,0x35,0x36,0x37,0x38,0x39
00dad0 4140
00dad1 4342
00dad2 4544
00dad3 4746
00dad4 4948
00dad5 4544
00dad6 4746
00dad7 4948      	.DB	0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x44,0x45,0x46,0x47,0x48,0x49
00dad8 5150
00dad9 5352
00dada 5554
00dadb 5756
00dadc 5958
00dadd 5554
00dade 5756
00dadf 5958      	.DB	0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x54,0x55,0x56,0x57,0x58,0x59
00dae0 6160
00dae1 6362
00dae2 6564
00dae3 6766
00dae4 6968
00dae5 6564
00dae6 6766
00dae7 6968      	.DB	0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x64,0x65,0x66,0x67,0x68,0x69
00dae8 7170
00dae9 7372
00daea 7574
00daeb 7776
00daec 7978
00daed 7574
00daee 7776
00daef 7978      	.DB	0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x74,0x75,0x76,0x77,0x78,0x79
00daf0 8180
00daf1 8382
00daf2 8584
00daf3 8786
00daf4 8988
00daf5 8584
00daf6 8786
00daf7 8988      	.DB	0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x84,0x85,0x86,0x87,0x88,0x89
00daf8 9190
00daf9 9392
00dafa 9594
00dafb 9796
00dafc 9998
00dafd 9594
00dafe 9796
00daff 9998      	.DB	0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x94,0x95,0x96,0x97,0x98,0x99
00db00 fbfa
00db01 fdfc
00db02 fffe
00db03 0100
00db04 0302
00db05 0504
00db06 0706
00db07 0908      	.DB	0xfa,0xfb,0xfc,0xfd,0xfe,0xff,0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09
00db08 0b0a
00db09 0d0c
00db0a 0f0e
00db0b 1110
00db0c 1312
00db0d 1514
00db0e 1716
00db0f 1918      	.DB	0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19
00db10 1b1a
00db11 1d1c
00db12 1f1e
00db13 2120
00db14 2322
00db15 2524
00db16 2726
00db17 2928      	.DB	0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29
00db18 2b2a
00db19 2d2c
00db1a 2f2e
00db1b 3130
00db1c 3332
00db1d 3534
00db1e 3736
00db1f 3938      	.DB	0x2a,0x2b,0x2c,0x2d,0x2e,0x2f,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39
00db20 3b3a
00db21 3d3c
00db22 3f3e
00db23 4140
00db24 4342
00db25 4544
00db26 4746
00db27 4948      	.DB	0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49
00db28 4b4a
00db29 4d4c
00db2a 4f4e
00db2b 5150
00db2c 5352
00db2d 5554
00db2e 5756
00db2f 5958      	.DB	0x4a,0x4b,0x4c,0x4d,0x4e,0x4f,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59
00db30 5b5a
00db31 5d5c
00db32 5f5e
00db33 6160
00db34 6362
00db35 6564
00db36 6766
00db37 6968      	.DB	0x5a,0x5b,0x5c,0x5d,0x5e,0x5f,0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69
00db38 6b6a
00db39 6d6c
00db3a 6f6e
00db3b 7170
00db3c 7372
00db3d 7574
00db3e 7776
00db3f 7978      	.DB	0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79
00db40 7b7a
00db41 7d7c
00db42 7f7e
00db43 8180
00db44 8382
00db45 8584
00db46 8786
00db47 8988      	.DB	0x7a,0x7b,0x7c,0x7d,0x7e,0x7f,0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89
00db48 8b8a
00db49 8d8c
00db4a 8f8e
00db4b 9190
00db4c 9392
00db4d 3534
00db4e 3736
00db4f 3938      	.DB	0x8a,0x8b,0x8c,0x8d,0x8e,0x8f,0x90,0x91,0x92,0x93,0x34,0x35,0x36,0x37,0x38,0x39
00db50 3b3a
00db51 3d3c
00db52 3f3e
00db53 4140
00db54 4342
00db55 4544
00db56 4746
00db57 4948      	.DB	0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49
00db58 4b4a
00db59 4d4c
00db5a 4f4e
00db5b 5150
00db5c 5352
00db5d 5554
00db5e 5756
00db5f 5958      	.DB	0x4a,0x4b,0x4c,0x4d,0x4e,0x4f,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59
00db60 5b5a
00db61 5d5c
00db62 5f5e
00db63 6160
00db64 6362
00db65 6564
00db66 6766
00db67 6968      	.DB	0x5a,0x5b,0x5c,0x5d,0x5e,0x5f,0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69
00db68 6b6a
00db69 6d6c
00db6a 6f6e
00db6b 7170
00db6c 7372
00db6d 7574
00db6e 7776
00db6f 7978      	.DB	0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79
00db70 7b7a
00db71 7d7c
00db72 7f7e
00db73 8180
00db74 8382
00db75 8584
00db76 8786
00db77 8988      	.DB	0x7a,0x7b,0x7c,0x7d,0x7e,0x7f,0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89
00db78 8b8a
00db79 8d8c
00db7a 8f8e
00db7b 9190
00db7c 9392
00db7d 9594
00db7e 9796
00db7f 9998      	.DB	0x8a,0x8b,0x8c,0x8d,0x8e,0x8f,0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99
00db80 a1a0
00db81 a3a2
00db82 a5a4
00db83 a7a6
00db84 a9a8
00db85 a5a4
00db86 a7a6
00db87 a9a8      	.DB	0xa0,0xa1,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,0xa8,0xa9,0xa4,0xa5,0xa6,0xa7,0xa8,0xa9
00db88 b1b0
00db89 b3b2
00db8a b5b4
00db8b b7b6
00db8c b9b8
00db8d b5b4
00db8e b7b6
00db8f b9b8      	.DB	0xb0,0xb1,0xb2,0xb3,0xb4,0xb5,0xb6,0xb7,0xb8,0xb9,0xb4,0xb5,0xb6,0xb7,0xb8,0xb9
00db90 c1c0
00db91 c3c2
00db92 c5c4
00db93 c7c6
00db94 c9c8
00db95 c5c4
00db96 c7c6
00db97 c9c8      	.DB	0xc0,0xc1,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xc4,0xc5,0xc6,0xc7,0xc8,0xc9
00db98 d1d0
00db99 d3d2
00db9a d5d4
00db9b d7d6
00db9c d9d8
00db9d d5d4
00db9e d7d6
00db9f d9d8      	.DB	0xd0,0xd1,0xd2,0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9
00dba0 e1e0
00dba1 e3e2
00dba2 e5e4
00dba3 e7e6
00dba4 e9e8
00dba5 e5e4
00dba6 e7e6
00dba7 e9e8      	.DB	0xe0,0xe1,0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9
00dba8 f1f0
00dba9 f3f2
00dbaa f5f4
00dbab f7f6
00dbac f9f8
00dbad f5f4
00dbae f7f6
00dbaf f9f8      	.DB	0xf0,0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9
00dbb0 0100
00dbb1 0302
00dbb2 0504
00dbb3 0706
00dbb4 0908
00dbb5 0504
00dbb6 0706
00dbb7 0908      	.DB	0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x04,0x05,0x06,0x07,0x08,0x09
00dbb8 1110
00dbb9 1312
00dbba 1514
00dbbb 1716
00dbbc 1918
00dbbd 1514
00dbbe 1716
00dbbf 1918      	.DB	0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x14,0x15,0x16,0x17,0x18,0x19
00dbc0 2120
00dbc1 2322
00dbc2 2524
00dbc3 2726
00dbc4 2928
00dbc5 2524
00dbc6 2726
00dbc7 2928      	.DB	0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x24,0x25,0x26,0x27,0x28,0x29
00dbc8 3130
00dbc9 3332
00dbca 3534
00dbcb 3736
00dbcc 3938
00dbcd 3534
00dbce 3736
00dbcf 3938      	.DB	0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x34,0x35,0x36,0x37,0x38,0x39
00dbd0 4140
00dbd1 4342
00dbd2 4544
00dbd3 4746
00dbd4 4948
00dbd5 4544
00dbd6 4746
00dbd7 4948      	.DB	0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x44,0x45,0x46,0x47,0x48,0x49
00dbd8 5150
00dbd9 5352
00dbda 5554
00dbdb 5756
00dbdc 5958
00dbdd 5554
00dbde 5756
00dbdf 5958      	.DB	0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x54,0x55,0x56,0x57,0x58,0x59
00dbe0 6160
00dbe1 6362
00dbe2 6564
00dbe3 6766
00dbe4 6968
00dbe5 6564
00dbe6 6766
00dbe7 6968      	.DB	0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x64,0x65,0x66,0x67,0x68,0x69
00dbe8 7170
00dbe9 7372
00dbea 7574
00dbeb 7776
00dbec 7978
00dbed 7574
00dbee 7776
00dbef 7978      	.DB	0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x74,0x75,0x76,0x77,0x78,0x79
00dbf0 8180
00dbf1 8382
00dbf2 8584
00dbf3 8786
00dbf4 8988
00dbf5 8584
00dbf6 8786
00dbf7 8988      	.DB	0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x84,0x85,0x86,0x87,0x88,0x89
00dbf8 9190
00dbf9 9392
00dbfa 9594
00dbfb 9796
00dbfc 9998
00dbfd 9594
00dbfe 9796
00dbff 9998      	.DB	0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x94,0x95,0x96,0x97,0x98,0x99
00dc00 9b9a
00dc01 9d9c
00dc02 9f9e
00dc03 a1a0
00dc04 a3a2
00dc05 a5a4
00dc06 a7a6
00dc07 a9a8      	.DB	0x9a,0x9b,0x9c,0x9d,0x9e,0x9f,0xa0,0xa1,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,0xa8,0xa9
00dc08 abaa
00dc09 adac
00dc0a afae
00dc0b b1b0
00dc0c b3b2
00dc0d b5b4
00dc0e b7b6
00dc0f b9b8      	.DB	0xaa,0xab,0xac,0xad,0xae,0xaf,0xb0,0xb1,0xb2,0xb3,0xb4,0xb5,0xb6,0xb7,0xb8,0xb9
00dc10 bbba
00dc11 bdbc
00dc12 bfbe
00dc13 c1c0
00dc14 c3c2
00dc15 c5c4
00dc16 c7c6
00dc17 c9c8      	.DB	0xba,0xbb,0xbc,0xbd,0xbe,0xbf,0xc0,0xc1,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7,0xc8,0xc9
00dc18 cbca
00dc19 cdcc
00dc1a cfce
00dc1b d1d0
00dc1c d3d2
00dc1d d5d4
00dc1e d7d6
00dc1f d9d8      	.DB	0xca,0xcb,0xcc,0xcd,0xce,0xcf,0xd0,0xd1,0xd2,0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9
00dc20 dbda
00dc21 dddc
00dc22 dfde
00dc23 e1e0
00dc24 e3e2
00dc25 e5e4
00dc26 e7e6
00dc27 e9e8      	.DB	0xda,0xdb,0xdc,0xdd,0xde,0xdf,0xe0,0xe1,0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9
00dc28 ebea
00dc29 edec
00dc2a efee
00dc2b f1f0
00dc2c f3f2
00dc2d f5f4
00dc2e f7f6
00dc2f f9f8      	.DB	0xea,0xeb,0xec,0xed,0xee,0xef,0xf0,0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,0xf9
00dc30 fbfa
00dc31 fdfc
00dc32 fffe
00dc33 0100
00dc34 0302
00dc35 0504
00dc36 0706
00dc37 0908      	.DB	0xfa,0xfb,0xfc,0xfd,0xfe,0xff,0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09
00dc38 0b0a
00dc39 0d0c
00dc3a 0f0e
00dc3b 1110
00dc3c 1312
00dc3d 1514
00dc3e 1716
00dc3f 1918      	.DB	0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19
00dc40 1b1a
00dc41 1d1c
00dc42 1f1e
00dc43 2120
00dc44 2322
00dc45 2524
00dc46 2726
00dc47 2928      	.DB	0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29
00dc48 2b2a
00dc49 2d2c
00dc4a 2f2e
00dc4b 3130
00dc4c 3332
00dc4d 3534
00dc4e 3736
00dc4f 3938      	.DB	0x2a,0x2b,0x2c,0x2d,0x2e,0x2f,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39
00dc50 3b3a
00dc51 3d3c
00dc52 3f3e
00dc53 4140
00dc54 4342
00dc55 4544
00dc56 4746
00dc57 4948      	.DB	0x3a,0x3b,0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49
00dc58 4b4a
00dc59 4d4c
00dc5a 4f4e
00dc5b 5150
00dc5c 5352
00dc5d 5554
00dc5e 5756
00dc5f 5958      	.DB	0x4a,0x4b,0x4c,0x4d,0x4e,0x4f,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59
00dc60 5b5a
00dc61 5d5c
00dc62 5f5e
00dc63 6160
00dc64 6362
00dc65 6564
00dc66 6766
00dc67 6968      	.DB	0x5a,0x5b,0x5c,0x5d,0x5e,0x5f,0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69
00dc68 6b6a
00dc69 6d6c
00dc6a 6f6e
00dc6b 7170
00dc6c 7372
00dc6d 7574
00dc6e 7776
00dc6f 7978      	.DB	0x6a,0x6b,0x6c,0x6d,0x6e,0x6f,0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79
00dc70 7b7a
00dc71 7d7c
00dc72 7f7e
00dc73 8180
00dc74 8382
00dc75 8584
00dc76 8786
00dc77 8988      	.DB	0x7a,0x7b,0x7c,0x7d,0x7e,0x7f,0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89
00dc78 8b8a
00dc79 8d8c
00dc7a 8f8e
00dc7b 9190
00dc7c 9392
00dc7d 9594
00dc7e 9796
00dc7f 9998      	.DB	0x8a,0x8b,0x8c,0x8d,0x8e,0x8f,0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99
                 DAA_FLAGS:
00dc80 808a
00dc81 8880
00dc82 8880
00dc83 8088
00dc84 8880
00dc85 a8a0
00dc86 a0a8
00dc87 a0a8      	.DB	0x8a,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0x80,0x88,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dc88 8880
00dc89 8088
00dc8a 8088
00dc8b 8880
00dc8c 8088
00dc8d a8a0
00dc8e a0a8
00dc8f a0a8      	.DB	0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0x88,0x80,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dc90 8880
00dc91 8088
00dc92 8088
00dc93 8880
00dc94 8088
00dc95 a0a8
00dc96 a8a0
00dc97 a8a0      	.DB	0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0x88,0x80,0xa8,0xa0,0xa0,0xa8,0xa0,0xa8
00dc98 8088
00dc99 8880
00dc9a 8880
00dc9b 8088
00dc9c 8880
00dc9d a8a0
00dc9e a0a8
00dc9f a0a8      	.DB	0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0x80,0x88,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dca0 8880
00dca1 8088
00dca2 8088
00dca3 8880
00dca4 8088
00dca5 a0a8
00dca6 a8a0
00dca7 a8a0      	.DB	0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0x88,0x80,0xa8,0xa0,0xa0,0xa8,0xa0,0xa8
00dca8 8088
00dca9 8880
00dcaa 8880
00dcab 8088
00dcac 8880
00dcad a0a8
00dcae a8a0
00dcaf a8a0      	.DB	0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0x80,0x88,0xa8,0xa0,0xa0,0xa8,0xa0,0xa8
00dcb0 8088
00dcb1 8880
00dcb2 8880
00dcb3 8088
00dcb4 8880
00dcb5 a8a0
00dcb6 a0a8
00dcb7 a0a8      	.DB	0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0x80,0x88,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dcb8 8880
00dcb9 8088
00dcba 8088
00dcbb 8880
00dcbc 8088
00dcbd aca4
00dcbe a4ac
00dcbf a4ac      	.DB	0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0x88,0x80,0xa4,0xac,0xac,0xa4,0xac,0xa4
00dcc0 8c84
00dcc1 848c
00dcc2 848c
00dcc3 8c84
00dcc4 848c
00dcc5 a4ac
00dcc6 aca4
00dcc7 aca4      	.DB	0x84,0x8c,0x8c,0x84,0x8c,0x84,0x84,0x8c,0x8c,0x84,0xac,0xa4,0xa4,0xac,0xa4,0xac
00dcc8 848c
00dcc9 8c84
00dcca 8c84
00dccb 848c
00dccc 8c84
00dccd a1ab
00dcce a9a1
00dccf a9a1      	.DB	0x8c,0x84,0x84,0x8c,0x84,0x8c,0x8c,0x84,0x84,0x8c,0xab,0xa1,0xa1,0xa9,0xa1,0xa9
00dcd0 818b
00dcd1 8981
00dcd2 8981
00dcd3 8189
00dcd4 8981
00dcd5 a9a1
00dcd6 a1a9
00dcd7 a1a9      	.DB	0x8b,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dcd8 8981
00dcd9 8189
00dcda 8189
00dcdb 8981
00dcdc 8189
00dcdd a9a1
00dcde a1a9
00dcdf a1a9      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dce0 8981
00dce1 8189
00dce2 8189
00dce3 8981
00dce4 8189
00dce5 a1a9
00dce6 a9a1
00dce7 a9a1      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dce8 8189
00dce9 8981
00dcea 8981
00dceb 8189
00dcec 8981
00dced a9a1
00dcee a1a9
00dcef a1a9      	.DB	0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dcf0 8981
00dcf1 8189
00dcf2 8189
00dcf3 8981
00dcf4 8189
00dcf5 a1a9
00dcf6 a9a1
00dcf7 a9a1      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dcf8 8189
00dcf9 8981
00dcfa 8981
00dcfb 8189
00dcfc 8981
00dcfd a1a9
00dcfe a9a1
00dcff a9a1      	.DB	0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dd00 8088
00dd01 8880
00dd02 8088
00dd03 8088
00dd04 8880
00dd05 a8a0
00dd06 a0a8
00dd07 a0a8      	.DB	0x88,0x80,0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dd08 8880
00dd09 8088
00dd0a 8880
00dd0b 8880
00dd0c 8088
00dd0d a8a0
00dd0e a0a8
00dd0f a0a8      	.DB	0x80,0x88,0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dd10 8880
00dd11 8088
00dd12 8880
00dd13 8880
00dd14 8088
00dd15 a0a8
00dd16 a8a0
00dd17 a8a0      	.DB	0x80,0x88,0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0xa8,0xa0,0xa0,0xa8,0xa0,0xa8
00dd18 8088
00dd19 8880
00dd1a 8088
00dd1b 8088
00dd1c 8880
00dd1d a8a0
00dd1e a0a8
00dd1f a0a8      	.DB	0x88,0x80,0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dd20 8880
00dd21 8088
00dd22 8880
00dd23 8880
00dd24 8088
00dd25 a0a8
00dd26 a8a0
00dd27 a8a0      	.DB	0x80,0x88,0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0xa8,0xa0,0xa0,0xa8,0xa0,0xa8
00dd28 8088
00dd29 8880
00dd2a 8088
00dd2b 8088
00dd2c 8880
00dd2d a0a8
00dd2e a8a0
00dd2f a8a0      	.DB	0x88,0x80,0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0xa8,0xa0,0xa0,0xa8,0xa0,0xa8
00dd30 8088
00dd31 8880
00dd32 8088
00dd33 8088
00dd34 8880
00dd35 a8a0
00dd36 a0a8
00dd37 a0a8      	.DB	0x88,0x80,0x80,0x88,0x88,0x80,0x88,0x80,0x80,0x88,0xa0,0xa8,0xa8,0xa0,0xa8,0xa0
00dd38 8880
00dd39 8088
00dd3a 8880
00dd3b 8880
00dd3c 8088
00dd3d aca4
00dd3e a4ac
00dd3f a4ac      	.DB	0x80,0x88,0x88,0x80,0x80,0x88,0x80,0x88,0x88,0x80,0xa4,0xac,0xac,0xa4,0xac,0xa4
00dd40 8c84
00dd41 848c
00dd42 8c84
00dd43 8c84
00dd44 848c
00dd45 a4ac
00dd46 aca4
00dd47 aca4      	.DB	0x84,0x8c,0x8c,0x84,0x84,0x8c,0x84,0x8c,0x8c,0x84,0xac,0xa4,0xa4,0xac,0xa4,0xac
00dd48 848c
00dd49 8c84
00dd4a 848c
00dd4b 848c
00dd4c 8c84
00dd4d a1ab
00dd4e a9a1
00dd4f a9a1      	.DB	0x8c,0x84,0x84,0x8c,0x8c,0x84,0x8c,0x84,0x84,0x8c,0xab,0xa1,0xa1,0xa9,0xa1,0xa9
00dd50 8189
00dd51 8981
00dd52 8189
00dd53 8189
00dd54 8981
00dd55 a9a1
00dd56 a1a9
00dd57 a1a9      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dd58 8981
00dd59 8189
00dd5a 8981
00dd5b 8981
00dd5c 8189
00dd5d a9a1
00dd5e a1a9
00dd5f a1a9      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dd60 8981
00dd61 8189
00dd62 8981
00dd63 8981
00dd64 8189
00dd65 a1a9
00dd66 a9a1
00dd67 a9a1      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dd68 8189
00dd69 8981
00dd6a 8189
00dd6b 8189
00dd6c 8981
00dd6d a9a1
00dd6e a1a9
00dd6f a1a9      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dd70 8981
00dd71 8189
00dd72 8981
00dd73 8981
00dd74 8189
00dd75 a1a9
00dd76 a9a1
00dd77 a9a1      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dd78 8189
00dd79 8981
00dd7a 8189
00dd7b 8189
00dd7c 8981
00dd7d a1a9
00dd7e a9a1
00dd7f a9a1      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dd80 8189
00dd81 8981
00dd82 8981
00dd83 8189
00dd84 8981
00dd85 a9a1
00dd86 a1a9
00dd87 a1a9      	.DB	0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dd88 8981
00dd89 8189
00dd8a 8189
00dd8b 8981
00dd8c 8189
00dd8d ada5
00dd8e a5ad
00dd8f a5ad      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa5,0xad,0xad,0xa5,0xad,0xa5
00dd90 8d85
00dd91 858d
00dd92 858d
00dd93 8d85
00dd94 858d
00dd95 a5ad
00dd96 ada5
00dd97 ada5      	.DB	0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0x8d,0x85,0xad,0xa5,0xa5,0xad,0xa5,0xad
00dd98 858d
00dd99 8d85
00dd9a 8d85
00dd9b 858d
00dd9c 8d85
00dd9d a5ad
00dd9e ada5
00dd9f ada5      	.DB	0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0x85,0x8d,0xad,0xa5,0xa5,0xad,0xa5,0xad
00dda0 858d
00dda1 8d85
00dda2 8d85
00dda3 858d
00dda4 8d85
00dda5 ada5
00dda6 a5ad
00dda7 a5ad      	.DB	0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0x85,0x8d,0xa5,0xad,0xad,0xa5,0xad,0xa5
00dda8 8d85
00dda9 858d
00ddaa 858d
00ddab 8d85
00ddac 858d
00ddad a5ad
00ddae ada5
00ddaf ada5      	.DB	0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0x8d,0x85,0xad,0xa5,0xa5,0xad,0xa5,0xad
00ddb0 858d
00ddb1 8d85
00ddb2 8d85
00ddb3 858d
00ddb4 8d85
00ddb5 ada5
00ddb6 a5ad
00ddb7 a5ad      	.DB	0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0x85,0x8d,0xa5,0xad,0xad,0xa5,0xad,0xa5
00ddb8 8d85
00ddb9 858d
00ddba 858d
00ddbb 8d85
00ddbc 858d
00ddbd ada5
00ddbe a5ad
00ddbf a5ad      	.DB	0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0x8d,0x85,0xa5,0xad,0xad,0xa5,0xad,0xa5
00ddc0 8d85
00ddc1 858d
00ddc2 858d
00ddc3 8d85
00ddc4 858d
00ddc5 a5ad
00ddc6 ada5
00ddc7 ada5      	.DB	0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0x8d,0x85,0xad,0xa5,0xa5,0xad,0xa5,0xad
00ddc8 858d
00ddc9 8d85
00ddca 8d85
00ddcb 858d
00ddcc 8d85
00ddcd a1ab
00ddce a9a1
00ddcf a9a1      	.DB	0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0x85,0x8d,0xab,0xa1,0xa1,0xa9,0xa1,0xa9
00ddd0 818b
00ddd1 8981
00ddd2 8981
00ddd3 8189
00ddd4 8981
00ddd5 a9a1
00ddd6 a1a9
00ddd7 a1a9      	.DB	0x8b,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00ddd8 8981
00ddd9 8189
00ddda 8189
00dddb 8981
00dddc 8189
00dddd a9a1
00ddde a1a9
00dddf a1a9      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00dde0 8981
00dde1 8189
00dde2 8189
00dde3 8981
00dde4 8189
00dde5 a1a9
00dde6 a9a1
00dde7 a9a1      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00dde8 8189
00dde9 8981
00ddea 8981
00ddeb 8189
00ddec 8981
00dded a9a1
00ddee a1a9
00ddef a1a9      	.DB	0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00ddf0 8981
00ddf1 8189
00ddf2 8189
00ddf3 8981
00ddf4 8189
00ddf5 a1a9
00ddf6 a9a1
00ddf7 a9a1      	.DB	0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00ddf8 8189
00ddf9 8981
00ddfa 8981
00ddfb 8189
00ddfc 8981
00ddfd a1a9
00ddfe a9a1
00ddff a9a1      	.DB	0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0x81,0x89,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00de00 8189
00de01 8981
00de02 8189
00de03 8189
00de04 8981
00de05 a9a1
00de06 a1a9
00de07 a1a9      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00de08 8981
00de09 8189
00de0a 8981
00de0b 8981
00de0c 8189
00de0d ada5
00de0e a5ad
00de0f a5ad      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa5,0xad,0xad,0xa5,0xad,0xa5
00de10 8d85
00de11 858d
00de12 8d85
00de13 8d85
00de14 858d
00de15 a5ad
00de16 ada5
00de17 ada5      	.DB	0x85,0x8d,0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0xad,0xa5,0xa5,0xad,0xa5,0xad
00de18 858d
00de19 8d85
00de1a 858d
00de1b 858d
00de1c 8d85
00de1d a5ad
00de1e ada5
00de1f ada5      	.DB	0x8d,0x85,0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0xad,0xa5,0xa5,0xad,0xa5,0xad
00de20 858d
00de21 8d85
00de22 858d
00de23 858d
00de24 8d85
00de25 ada5
00de26 a5ad
00de27 a5ad      	.DB	0x8d,0x85,0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0xa5,0xad,0xad,0xa5,0xad,0xa5
00de28 8d85
00de29 858d
00de2a 8d85
00de2b 8d85
00de2c 858d
00de2d a5ad
00de2e ada5
00de2f ada5      	.DB	0x85,0x8d,0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0xad,0xa5,0xa5,0xad,0xa5,0xad
00de30 858d
00de31 8d85
00de32 858d
00de33 858d
00de34 8d85
00de35 ada5
00de36 a5ad
00de37 a5ad      	.DB	0x8d,0x85,0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0xa5,0xad,0xad,0xa5,0xad,0xa5
00de38 8d85
00de39 858d
00de3a 8d85
00de3b 8d85
00de3c 858d
00de3d ada5
00de3e a5ad
00de3f a5ad      	.DB	0x85,0x8d,0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0xa5,0xad,0xad,0xa5,0xad,0xa5
00de40 8d85
00de41 858d
00de42 8d85
00de43 8d85
00de44 858d
00de45 a5ad
00de46 ada5
00de47 ada5      	.DB	0x85,0x8d,0x8d,0x85,0x85,0x8d,0x85,0x8d,0x8d,0x85,0xad,0xa5,0xa5,0xad,0xa5,0xad
00de48 858d
00de49 8d85
00de4a 858d
00de4b 858d
00de4c 8d85
00de4d a1ab
00de4e a9a1
00de4f a9a1      	.DB	0x8d,0x85,0x85,0x8d,0x8d,0x85,0x8d,0x85,0x85,0x8d,0xab,0xa1,0xa1,0xa9,0xa1,0xa9
00de50 8189
00de51 8981
00de52 8189
00de53 8189
00de54 8981
00de55 a9a1
00de56 a1a9
00de57 a1a9      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00de58 8981
00de59 8189
00de5a 8981
00de5b 8981
00de5c 8189
00de5d a9a1
00de5e a1a9
00de5f a1a9      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00de60 8981
00de61 8189
00de62 8981
00de63 8981
00de64 8189
00de65 a1a9
00de66 a9a1
00de67 a9a1      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00de68 8189
00de69 8981
00de6a 8189
00de6b 8189
00de6c 8981
00de6d a9a1
00de6e a1a9
00de6f a1a9      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa1,0xa9,0xa9,0xa1,0xa9,0xa1
00de70 8981
00de71 8189
00de72 8981
00de73 8981
00de74 8189
00de75 a1a9
00de76 a9a1
00de77 a9a1      	.DB	0x81,0x89,0x89,0x81,0x81,0x89,0x81,0x89,0x89,0x81,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00de78 8189
00de79 8981
00de7a 8189
00de7b 8189
00de7c 8981
00de7d a1a9
00de7e a9a1
00de7f a9a1      	.DB	0x89,0x81,0x81,0x89,0x89,0x81,0x89,0x81,0x81,0x89,0xa9,0xa1,0xa1,0xa9,0xa1,0xa9
00de80 c0ca
00de81 c8c0
00de82 c8c0
00de83 c0c8
00de84 c8c0
00de85 c8c0
00de86 c0c8
00de87 c8c0      	.DB	0xca,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00de88 c8c0
00de89 c0c8
00de8a c0c8
00de8b c8c0
00de8c c0c8
00de8d c0c8
00de8e c8c0
00de8f c0c8      	.DB	0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00de90 c8c0
00de91 c0c8
00de92 c0c8
00de93 c8c0
00de94 c0c8
00de95 c0c8
00de96 c8c0
00de97 c0c8      	.DB	0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00de98 c0c8
00de99 c8c0
00de9a c8c0
00de9b c0c8
00de9c c8c0
00de9d c8c0
00de9e c0c8
00de9f c8c0      	.DB	0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00dea0 c8c0
00dea1 c0c8
00dea2 c0c8
00dea3 c8c0
00dea4 c0c8
00dea5 c0c8
00dea6 c8c0
00dea7 c0c8      	.DB	0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00dea8 c0c8
00dea9 c8c0
00deaa c8c0
00deab c0c8
00deac c8c0
00dead c8c0
00deae c0c8
00deaf c8c0      	.DB	0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00deb0 c0c8
00deb1 c8c0
00deb2 c8c0
00deb3 c0c8
00deb4 c8c0
00deb5 c8c0
00deb6 c0c8
00deb7 c8c0      	.DB	0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00deb8 c8c0
00deb9 c0c8
00deba c0c8
00debb c8c0
00debc c0c8
00debd c0c8
00debe c8c0
00debf c0c8      	.DB	0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00dec0 ccc4
00dec1 c4cc
00dec2 c4cc
00dec3 ccc4
00dec4 c4cc
00dec5 c4cc
00dec6 ccc4
00dec7 c4cc      	.DB	0xc4,0xcc,0xcc,0xc4,0xcc,0xc4,0xc4,0xcc,0xcc,0xc4,0xcc,0xc4,0xc4,0xcc,0xcc,0xc4
00dec8 c4cc
00dec9 ccc4
00deca ccc4
00decb c4cc
00decc ccc4
00decd c9c1
00dece c1c9
00decf c9c1      	.DB	0xcc,0xc4,0xc4,0xcc,0xc4,0xcc,0xcc,0xc4,0xc4,0xcc,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00ded0 c9c1
00ded1 c1c9
00ded2 c1c9
00ded3 c9c1
00ded4 c1c9
00ded5 c1c9
00ded6 c9c1
00ded7 c1c9      	.DB	0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00ded8 c1c9
00ded9 c9c1
00deda c9c1
00dedb c1c9
00dedc c9c1
00dedd c9c1
00dede c1c9
00dedf c9c1      	.DB	0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00dee0 c1c9
00dee1 c9c1
00dee2 c9c1
00dee3 c1c9
00dee4 c9c1
00dee5 c9c1
00dee6 c1c9
00dee7 c9c1      	.DB	0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00dee8 c9c1
00dee9 c1c9
00deea c1c9
00deeb c9c1
00deec c1c9
00deed c1c9
00deee c9c1
00deef c1c9      	.DB	0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00def0 cdc5
00def1 c5cd
00def2 c5cd
00def3 cdc5
00def4 c5cd
00def5 c5cd
00def6 cdc5
00def7 c5cd      	.DB	0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00def8 c5cd
00def9 cdc5
00defa cdc5
00defb c5cd
00defc cdc5
00defd cdc5
00defe c5cd
00deff cdc5      	.DB	0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00df00 e4ec
00df01 e4ec
00df02 ece4
00df03 c0ca
00df04 c8c0
00df05 c8c0
00df06 c0c8
00df07 c8c0      	.DB	0xec,0xe4,0xec,0xe4,0xe4,0xec,0xca,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00df08 e0e8
00df09 e0e8
00df0a e8e0
00df0b c8c0
00df0c c0c8
00df0d c0c8
00df0e c8c0
00df0f c0c8      	.DB	0xe8,0xe0,0xe8,0xe0,0xe0,0xe8,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00df10 e8e0
00df11 e8e0
00df12 e0e8
00df13 c8c0
00df14 c0c8
00df15 c0c8
00df16 c8c0
00df17 c0c8      	.DB	0xe0,0xe8,0xe0,0xe8,0xe8,0xe0,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00df18 e8e0
00df19 e8e0
00df1a e0e8
00df1b c0c8
00df1c c8c0
00df1d c8c0
00df1e c0c8
00df1f c8c0      	.DB	0xe0,0xe8,0xe0,0xe8,0xe8,0xe0,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00df20 e0e8
00df21 e0e8
00df22 e8e0
00df23 c8c0
00df24 c0c8
00df25 c0c8
00df26 c8c0
00df27 c0c8      	.DB	0xe8,0xe0,0xe8,0xe0,0xe0,0xe8,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00df28 e8e0
00df29 e8e0
00df2a e0e8
00df2b c0c8
00df2c c8c0
00df2d c8c0
00df2e c0c8
00df2f c8c0      	.DB	0xe0,0xe8,0xe0,0xe8,0xe8,0xe0,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00df30 e0e8
00df31 e0e8
00df32 e8e0
00df33 c0c8
00df34 c8c0
00df35 c8c0
00df36 c0c8
00df37 c8c0      	.DB	0xe8,0xe0,0xe8,0xe0,0xe0,0xe8,0xc8,0xc0,0xc0,0xc8,0xc0,0xc8,0xc8,0xc0,0xc0,0xc8
00df38 e0e8
00df39 e0e8
00df3a e8e0
00df3b c8c0
00df3c c0c8
00df3d c0c8
00df3e c8c0
00df3f c0c8      	.DB	0xe8,0xe0,0xe8,0xe0,0xe0,0xe8,0xc0,0xc8,0xc8,0xc0,0xc8,0xc0,0xc0,0xc8,0xc8,0xc0
00df40 e8e0
00df41 e8e0
00df42 e0e8
00df43 ccc4
00df44 c4cc
00df45 c4cc
00df46 ccc4
00df47 c4cc      	.DB	0xe0,0xe8,0xe0,0xe8,0xe8,0xe0,0xc4,0xcc,0xcc,0xc4,0xcc,0xc4,0xc4,0xcc,0xcc,0xc4
00df48 ece4
00df49 ece4
00df4a e4ec
00df4b c4cc
00df4c ccc4
00df4d c9c1
00df4e c1c9
00df4f c9c1      	.DB	0xe4,0xec,0xe4,0xec,0xec,0xe4,0xcc,0xc4,0xc4,0xcc,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00df50 e1e9
00df51 e1e9
00df52 e9e1
00df53 c9c1
00df54 c1c9
00df55 c1c9
00df56 c9c1
00df57 c1c9      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00df58 e9e1
00df59 e9e1
00df5a e1e9
00df5b c1c9
00df5c c9c1
00df5d c9c1
00df5e c1c9
00df5f c9c1      	.DB	0xe1,0xe9,0xe1,0xe9,0xe9,0xe1,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00df60 e1e9
00df61 e1e9
00df62 e9e1
00df63 c1c9
00df64 c9c1
00df65 c9c1
00df66 c1c9
00df67 c9c1      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00df68 e1e9
00df69 e1e9
00df6a e9e1
00df6b c9c1
00df6c c1c9
00df6d c1c9
00df6e c9c1
00df6f c1c9      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00df70 e9e1
00df71 e9e1
00df72 e1e9
00df73 cdc5
00df74 c5cd
00df75 c5cd
00df76 cdc5
00df77 c5cd      	.DB	0xe1,0xe9,0xe1,0xe9,0xe9,0xe1,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00df78 ede5
00df79 ede5
00df7a e5ed
00df7b c5cd
00df7c cdc5
00df7d cdc5
00df7e c5cd
00df7f cdc5      	.DB	0xe5,0xed,0xe5,0xed,0xed,0xe5,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00df80 c5cd
00df81 cdc5
00df82 cdc5
00df83 c5cd
00df84 cdc5
00df85 cdc5
00df86 c5cd
00df87 cdc5      	.DB	0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00df88 cdc5
00df89 c5cd
00df8a c5cd
00df8b cdc5
00df8c c5cd
00df8d c5cd
00df8e cdc5
00df8f c5cd      	.DB	0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00df90 c5cd
00df91 cdc5
00df92 cdc5
00df93 c5cd
00df94 cdc5
00df95 cdc5
00df96 c5cd
00df97 cdc5      	.DB	0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00df98 cdc5
00df99 c5cd
00df9a c5cd
00df9b cdc5
00df9c c5cd
00df9d c5cd
00df9e cdc5
00df9f c5cd      	.DB	0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00dfa0 cdc5
00dfa1 c5cd
00dfa2 c5cd
00dfa3 cdc5
00dfa4 c5cd
00dfa5 c5cd
00dfa6 cdc5
00dfa7 c5cd      	.DB	0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00dfa8 c5cd
00dfa9 cdc5
00dfaa cdc5
00dfab c5cd
00dfac cdc5
00dfad cdc5
00dfae c5cd
00dfaf cdc5      	.DB	0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00dfb0 c1cb
00dfb1 c9c1
00dfb2 c9c1
00dfb3 c1c9
00dfb4 c9c1
00dfb5 c9c1
00dfb6 c1c9
00dfb7 c9c1      	.DB	0xcb,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00dfb8 c9c1
00dfb9 c1c9
00dfba c1c9
00dfbb c9c1
00dfbc c1c9
00dfbd c1c9
00dfbe c9c1
00dfbf c1c9      	.DB	0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00dfc0 c9c1
00dfc1 c1c9
00dfc2 c1c9
00dfc3 c9c1
00dfc4 c1c9
00dfc5 c1c9
00dfc6 c9c1
00dfc7 c1c9      	.DB	0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00dfc8 c1c9
00dfc9 c9c1
00dfca c9c1
00dfcb c1c9
00dfcc c9c1
00dfcd c9c1
00dfce c1c9
00dfcf c9c1      	.DB	0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00dfd0 c9c1
00dfd1 c1c9
00dfd2 c1c9
00dfd3 c9c1
00dfd4 c1c9
00dfd5 c1c9
00dfd6 c9c1
00dfd7 c1c9      	.DB	0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00dfd8 c1c9
00dfd9 c9c1
00dfda c9c1
00dfdb c1c9
00dfdc c9c1
00dfdd c9c1
00dfde c1c9
00dfdf c9c1      	.DB	0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00dfe0 c1c9
00dfe1 c9c1
00dfe2 c9c1
00dfe3 c1c9
00dfe4 c9c1
00dfe5 c9c1
00dfe6 c1c9
00dfe7 c9c1      	.DB	0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00dfe8 c9c1
00dfe9 c1c9
00dfea c1c9
00dfeb c9c1
00dfec c1c9
00dfed c1c9
00dfee c9c1
00dfef c1c9      	.DB	0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00dff0 cdc5
00dff1 c5cd
00dff2 c5cd
00dff3 cdc5
00dff4 c5cd
00dff5 c5cd
00dff6 cdc5
00dff7 c5cd      	.DB	0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00dff8 c5cd
00dff9 cdc5
00dffa cdc5
00dffb c5cd
00dffc cdc5
00dffd cdc5
00dffe c5cd
00dfff cdc5      	.DB	0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00e000 e5ed
00e001 e5ed
00e002 ede5
00e003 c5cd
00e004 cdc5
00e005 cdc5
00e006 c5cd
00e007 cdc5      	.DB	0xed,0xe5,0xed,0xe5,0xe5,0xed,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00e008 e5ed
00e009 e5ed
00e00a ede5
00e00b cdc5
00e00c c5cd
00e00d c5cd
00e00e cdc5
00e00f c5cd      	.DB	0xed,0xe5,0xed,0xe5,0xe5,0xed,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00e010 ede5
00e011 ede5
00e012 e5ed
00e013 c5cd
00e014 cdc5
00e015 cdc5
00e016 c5cd
00e017 cdc5      	.DB	0xe5,0xed,0xe5,0xed,0xed,0xe5,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00e018 e5ed
00e019 e5ed
00e01a ede5
00e01b cdc5
00e01c c5cd
00e01d c5cd
00e01e cdc5
00e01f c5cd      	.DB	0xed,0xe5,0xed,0xe5,0xe5,0xed,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00e020 ede5
00e021 ede5
00e022 e5ed
00e023 cdc5
00e024 c5cd
00e025 c5cd
00e026 cdc5
00e027 c5cd      	.DB	0xe5,0xed,0xe5,0xed,0xed,0xe5,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00e028 ede5
00e029 ede5
00e02a e5ed
00e02b c5cd
00e02c cdc5
00e02d cdc5
00e02e c5cd
00e02f cdc5      	.DB	0xe5,0xed,0xe5,0xed,0xed,0xe5,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
00e030 e5ed
00e031 e5ed
00e032 ede5
00e033 c1cb
00e034 c9c1
00e035 c9c1
00e036 c1c9
00e037 c9c1      	.DB	0xed,0xe5,0xed,0xe5,0xe5,0xed,0xcb,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00e038 e1e9
00e039 e1e9
00e03a e9e1
00e03b c9c1
00e03c c1c9
00e03d c1c9
00e03e c9c1
00e03f c1c9      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00e040 e9e1
00e041 e9e1
00e042 e1e9
00e043 c9c1
00e044 c1c9
00e045 c1c9
00e046 c9c1
00e047 c1c9      	.DB	0xe1,0xe9,0xe1,0xe9,0xe9,0xe1,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00e048 e9e1
00e049 e9e1
00e04a e1e9
00e04b c1c9
00e04c c9c1
00e04d c9c1
00e04e c1c9
00e04f c9c1      	.DB	0xe1,0xe9,0xe1,0xe9,0xe9,0xe1,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00e050 e1e9
00e051 e1e9
00e052 e9e1
00e053 c9c1
00e054 c1c9
00e055 c1c9
00e056 c9c1
00e057 c1c9      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00e058 e9e1
00e059 e9e1
00e05a e1e9
00e05b c1c9
00e05c c9c1
00e05d c9c1
00e05e c1c9
00e05f c9c1      	.DB	0xe1,0xe9,0xe1,0xe9,0xe9,0xe1,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00e060 e1e9
00e061 e1e9
00e062 e9e1
00e063 c1c9
00e064 c9c1
00e065 c9c1
00e066 c1c9
00e067 c9c1      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc9,0xc1,0xc1,0xc9,0xc1,0xc9,0xc9,0xc1,0xc1,0xc9
00e068 e1e9
00e069 e1e9
00e06a e9e1
00e06b c9c1
00e06c c1c9
00e06d c1c9
00e06e c9c1
00e06f c1c9      	.DB	0xe9,0xe1,0xe9,0xe1,0xe1,0xe9,0xc1,0xc9,0xc9,0xc1,0xc9,0xc1,0xc1,0xc9,0xc9,0xc1
00e070 e9e1
00e071 e9e1
00e072 e1e9
00e073 cdc5
00e074 c5cd
00e075 c5cd
00e076 cdc5
00e077 c5cd      	.DB	0xe1,0xe9,0xe1,0xe9,0xe9,0xe1,0xc5,0xcd,0xcd,0xc5,0xcd,0xc5,0xc5,0xcd,0xcd,0xc5
00e078 ede5
00e079 ede5
00e07a e5ed
00e07b c5cd
00e07c cdc5
00e07d cdc5
00e07e c5cd
00e07f cdc5      	.DB	0xe5,0xed,0xe5,0xed,0xed,0xe5,0xcd,0xc5,0xc5,0xcd,0xc5,0xcd,0xcd,0xc5,0xc5,0xcd
                 
                 ; -------------------------- RAM ---------------------------
                 
                 .DSEG
                 
                 #include "ram.def"
                 
                 
                 .ORG	0x0100	
                 ; -------------------------------- VIDEOBUF ----------------------------
                 
000100           VIDEOBUF:	.BYTE	0x7d0
                 		; Ports processing vars
                 .EQU		VIDEOBUF_END = VIDEOBUF + 25*80
                 
                 .ORG	0x08d0	
0008d0           CPDPORTSMAP:	.BYTE	0x8f4-0x8d0	; reserved for future
                 
                 ; -------------------------------- PORTS ----------------------------
                 
                 .ORG	0x08f4
                 PORTS_DATABLOCK:		; data for system port processinf
                 
0008f4           PSVR_RQ:	.BYTE	1
0008f5           PSVR_AA:	.BYTE	1	; ports.inc - VIDEO module access ports block
                 
0008f6           PVAR_RQ:	.BYTE	1
0008f7           PVAR_AA:	.BYTE	1	; ports.inc - sharable vars access
                 
0008f8           PCAN_RQ:	.BYTE	1
0008f9           PCAN_AA:	.BYTE	1	; ports.inc - CAN module access ports block
                 
0008fa           PLAN_RQ:	.BYTE	1
0008fb           PLAN_AA:	.BYTE	1	; ports.inc - LAN module access ports block
                 
0008fc           PSPI_RQ:	.BYTE	1
0008fd           PSPI_AA:	.BYTE	1	; ports.inc - SPI module access ports block
                 
0008fe           PCMD_FE:	.BYTE	1
0008ff           PCMD_FF:	.BYTE	1	; commands port
                 
                 ; -------------------------------- Z80 REGISTERS ----------------------------
                 
                 .ORG	0x0900	
000900           zzI:	  	.BYTE 	1
000901           zzAe:	  	.BYTE 	1
000902           zzFe:	  	.BYTE 	1
000903           zzBe:	  	.BYTE 	1
000904           zzCe:	  	.BYTE 	1
000905           zzDe:	  	.BYTE 	1
000906           zzEe:		.BYTE 	1
000907           zzHe:		.BYTE 	1
000908           zzLe:		.BYTE 	1
000909           zzIFF1:		.BYTE 	1
00090a           zzIFF2:		.BYTE 	1
00090b           zzIM:		.BYTE 	1
                 
00090c           zzRhb:		.BYTE	1		; high bit of zzR
00090d           zzRES:		.BYTE	1
                 
                 ;15
00090e           CDATA:		.BYTE	14		; parameters for BIOS, BDOS, PORTOUT calls
                 
                 ; -------------------------------- BIOS VARS ----------------------------
                 
                 
                 ;CURSOR_X:	.BYTE	1               ; cursor X position, 1-80                  - moved to sharable
                 ;CURSOR_Y:	.BYTE	1               ; cursor Y position, 1-25                  - moved to sharable
                 ;CURSOR_STATUS:	.BYTE	1               ; =0 if cursor is on, 0x80 if is off       - moved to sharable
                 
                 ;CRT_LINES:	.BYTE	1                                                          - moved to sharable
                 ;CRT_CODEPAGE:	.BYTE	1                                                          - moved to sharable
                 
                 ;VIDEO_END:	.BYTE	2		; end of video ram starting from 0x100	   - moved to sharable
                 ;VIDEO_CURSOR:	.BYTE	2		; cursor position in videoram              - moved to sharable
                 
                 ;BIOS_DISK:	.BYTE	1                                                          - moved to sharable
                 ;BIOS_TRACK:	.BYTE	2                                                          - moved to sharable
                 ;BIOS_SECTOR:	.BYTE	1                                                          - moved to sharable
                 ;BIOS_DMA:	.BYTE	2                                                          - moved to sharable
                 
00091c           CON_ESC:	.BYTE	1		; count chars in ESC-sequence
00091d           CON_ESC_CHARS:	.BYTE	8		; esc-seq characters
                 .EQU	CON_ESC_C1 = CON_ESC_CHARS
                 .EQU	CON_ESC_C2 = CON_ESC_CHARS+1
                 .EQU	CON_ESC_C3 = CON_ESC_CHARS+2
                 .EQU	CON_ESC_C4 = CON_ESC_CHARS+3
                 .EQU	CON_ESC_C5 = CON_ESC_CHARS+4
                 .EQU	CON_ESC_C6 = CON_ESC_CHARS+5
                 .EQU	CON_ESC_C7 = CON_ESC_CHARS+6
                 .EQU	CON_ESC_C8 = CON_ESC_CHARS+7
                 .EQU	CON_ESC_PAR = CON_ESC_C8	; parameter for aux use
000925           CON_CPPOS_X:	.BYTE	1		; previous cursor position
000926           CON_CPPOS_Y:	.BYTE	1		; previous cursor position
                 
000927           CON_ATTR_XOR:	.BYTE	1		; attributes for xor
000928           CON_ATTR_OR:	.BYTE	1		; attributes for or
                 
000929           VSTAT_SAVED:	.BYTE	1		; saved vstat at sleep mode
                 
                 ;CON_WIN_X0:	.BYTE	1		; window to output - left 
                 ;CON_WIN_Y0:	.BYTE	1		; top
                 ;CON_WIN_X1:	.BYTE	1		; right
                 ;CON_WIN_Y1:	.BYTE	1		; bottom
                 
                 ;CON_ESC_C1:	.BYTE	1		; count chars in ESC-sequence
                 ;CON_ESC_Cx:	.BYTE	1		; count chars in ESC-sequence
                 
                 ;CON_IOBYTE:	.BYTE	1		; internal IOBYTE			- moved to sharable
                 ;INT_MASK:	.BYTE	1		; interrupt mask        		- moved to sharable
                 
00092a           SD_ADDRESS:	.BYTE	4               ; 512 bytes sectror address
                 ;SD_TYPE:	.BYTE	1 		; inseted SD-card type  		- moved to sharable
00092e           SD_RSP:		.BYTE 	4		; sd card command response
000932           SD_LASTADDRESS:	.BYTE	4               ; 512 bytes sectror last accessed address
                 
                 ;HW_DATA:	.BYTE	32		; misc data for hw compatibility layer  - moved to buffers
                 					; decoding table are located in EPROM
                 
                 		; SVRAM control vars
                 SV_DATABLOCK:
000936           SV_PTR:		.BYTE	2		; main datablock ram pointer
000938           SV_X1:		.BYTE	1               ; screen rect
000939           SV_Y1:		.BYTE	1
00093a           SV_X2:		.BYTE	1
00093b           SV_Y2:		.BYTE	1
00093c           SV_DATA:	.BYTE	1               ; data
00093d           SV_RES:		.BYTE	1
                 SV_S_DATABLOCK:
00093e           SV_S_PTR:	.BYTE	2		; secondary data block - ram pointer
000940           SV_S_X1:	.BYTE	1               ; screen rect
000941           SV_S_Y1:	.BYTE	1
000942           SV_S_X2:	.BYTE	1
000943           SV_S_Y2:	.BYTE	1
000944           SV_S_DATA:	.BYTE	1               ; data
000945           SV_S_RES:	.BYTE	1
000946           SV_DATA_PTR:	.BYTE	2		; data buffer ptr
                 SV_DATABLOCK_END:
                 
                 		; Ethernet controller vars
                 LAN_DATABLOCK:
000948           LAN_PAR:	.BYTE	2		; 0  settings
00094a           LAN_MBUF_IN:	.BYTE	2		; 2  ram address to read from: address
00094c           LAN_MBUF_IN_L:	.BYTE	2		; 4  ram address to read from: length
00094e           LAN_MBUF_OUT:	.BYTE	2		; 6  ram address to write out: address
000950           LAN_MBUF_OUT_L:	.BYTE	2		; 8  ram address to write out: length
000952           LAN_IP_MY:	.BYTE	4		; 10
000956           LAN_IP_REMOTE:	.BYTE	4		; 14
00095a           LAN_MAC_MY:	.BYTE	6		; 18
000960           LAN_MAC_REMOTE:	.BYTE	6		; 24
000966           LAN_BANK:	.BYTE	1		; 30 currently selected bank
000967           LAN_RXDPT:	.BYTE	2 		; 31 receive buffer current pointer
000969           LAN_RXSTATUS:	.BYTE	2		; 33 status from receive buffer
00096b           LAN_UPD_DATA:	.BYTE	2		; 35 data to update registers	
00096d           LAN_PORT_MY:	.BYTE	2		; 37 local port
00096f           LAN_PORT_REMOTE:.BYTE	2		; 39 remote port
000971           LAN_PROTOCOL:	.BYTE	1		; 41 Protocol: 17=UDP, 6=TCP, ...
000972           LAN_MAIN_RQST:	.BYTE	1		; 42 flag that main server data is ready - must be cleared by program
000973           LAN_IP_ID:	.BYTE	2		; 43 IP fragment ID (autoincremented in BUILD_IP_FRAME)
000975           LAN_ECHO_CNTR:	.BYTE	1		; 45 echo counterfor ping responces
000976           LAN_MISC:	.BYTE	2		; 46 just reserved	
000978           LAN_USR_TCP_SN:	.BYTE	4		; 48 Sequence Number (SN)
00097c           LAN_USR_TCP_ACK:.BYTE	4		; 52 Acknowledgment Number (ACK SN)
                 		.EQU	LAN_USR_TCP_FLAGS = LAN_PAR ; TCP Flags
                 		.EQU	LAN_USR_TCP_WINDOW = LAN_MISC ; TCP Window Size
                 LAN_DATABLOCK_END:
                 
                 		; CAN controller vars
                 CAN_DATABLOCK:
000980           CAN_MBUF_PAR:	.BYTE	2		; settings
000982           CAN_MBUF_IN:	.BYTE	2		; ram address to read from: address+length
000984           CAN_MBUF_IN_L:	.BYTE	1		; 
000985           CAN_MBUF_OUT:	.BYTE	2		; ram address to write out: address+length
000987           CAN_MBUF_OUT_L:	.BYTE	1		; 
000988           CAN_ID_MY:	.BYTE	4		; id_my: id10-3, <7-5>=id2-0 <3>=EID <1-0>=eid17-16, eid15-8, eid7-0
00098c           CAN_ID_REMOTE:	.BYTE	4		; id_srv: id10-3, <7-5>=id2-0 <3>=EID <1-0>=eid17-16, eid15-8, eid7-0
000990           CAN_MODE:	.BYTE	1		; currently selected mode: standard, extended
000991           CAN_BT_SSEG:	.BYTE	1		; timing: sysncseg, propseg, phaseseg1, phaseseg2
000992           CAN_BT_PSEG:	.BYTE	1
000993           CAN_BT_PS1:	.BYTE	1
000994           CAN_BT_PS2:	.BYTE	1
000995           CAN_BT_SJW:	.BYTE	1		; sync jump width
000996           CAN_BT_BRP:	.BYTE	1		; bitrate prescaler
000997           CAN_DATA_BUF:	.BYTE	8		; received, data for send
00099f           CAN_MSG_HDR:	.BYTE	4		; received message header	
                 CAN_DATABLOCK_END:
                 
0009a3           _DUMMY:		.BYTE	1		; just for correct END
                 
                 ;IRQ_CPD_FLAG:	.BYTE	1		; IRQ_CPD_FLAG stored afer reading
                 
0009a4           PORT_FF_CCMD:	.BYTE	1		; port ff control command
                 
0009a5           CAD_CMD_FLAG:	.BYTE	1		; CAD command
0009a6           CAD_CMD_PIN:	.BYTE	2		; pin from input
                 
0009a8           IRQ_CMD:	.BYTE	1		; IRQ handler internal var
                 
                 ;GLAN_BUF:	.BYTE	2		; address of BUF
                 ;GLAN_LEN:	.BYTE	2		; len for send/receive operations
                 ;GLAN_REMOTE:	.BYTE	2		; address of remote server parameters
                 ;GLAN_MYPORT:	.BYTE	2		; my port value
                 
                 ; -------------------------------- PRELOAD DATA ------------------------------
                 
                 .ORG	0x0a00	
                 
                 ; z80 emulator technical data
                 RAMOPCODES:
                 #include "z80/z80_asm_dseg.asm"		; 7*2*256	; OPCODES jumps
                 
000a00           zOPCODE__LBLS_L: .BYTE 256
000b00           zOPCODE__LBLS_H: .BYTE 256
000c00           zOPCODE_CB_LBLS_L: .BYTE 256
000d00           zOPCODE_CB_LBLS_H: .BYTE 256
000e00           zOPCODE_DD_LBLS_L: .BYTE 256
000f00           zOPCODE_DD_LBLS_H: .BYTE 256
001000           zOPCODE_ED_LBLS_L: .BYTE 256
001100           zOPCODE_ED_LBLS_H: .BYTE 256
001200           zOPCODE_FD_LBLS_L: .BYTE 256
001300           zOPCODE_FD_LBLS_H: .BYTE 256
001400           zOPCODE_DDCB_LBLS_L: .BYTE 256
001500           zOPCODE_DDCB_LBLS_H: .BYTE 256
001600           zOPCODE_FDCB_LBLS_L: .BYTE 256
001700
001800           PFTABLE: 	.BYTE 	256             ; P flag
001900           FA2ZTABLE: 	.BYTE 	256             ; E to Z80 flag translation
001a00           FZ2ATABLE: 	.BYTE 	256             ; Z80 to E flag translation
001b00           DAATABLE:	.BYTE 	4096		; DAA 4096 bytes table
                 RAMOPCODESEND:
                 
                 IRQOPCODES:	
002b00           IRQOPCODES_L:	.BYTE	256		; IRQ proc address table
002c00           IRQOPCODES_H:	.BYTE	256		; IRQ proc address table
                 IRQOPCODESEND:
                 
002d00           		.BYTE	256		; reserved
                 
                 ; -------------------------------- BUFFERS -------------------------------------
                 .ORG 0x3000
                 
003000           SD_BUF:		.BYTE 	512		; SD-card rw buffer
                 SD_BUF_END:
                 
                 .EQU		LAN_BUF_SIZE = 512+256	; LAN access buffer 512 bytes max packet size
003200           LAN_BUF:	.BYTE 	LAN_BUF_SIZE
                 .EQU		LAN_ETH_FRAME = LAN_BUF
                 .EQU		LAN_ETH_DSTMAC = LAN_ETH_FRAME
                 .EQU		LAN_ETH_SRCMAC = LAN_ETH_FRAME+6
                 .EQU		LAN_ETH_TYPE = LAN_ETH_FRAME+12
                 .EQU		LAN_ETH_DATA = LAN_ETH_FRAME+14
                 
                 .EQU		LAN_IP_FRAME = LAN_ETH_DATA
                 .EQU		LAN_IP_VERS = LAN_IP_FRAME
                 .EQU		LAN_IP_TOS = LAN_IP_FRAME+1
                 .EQU		LAN_IP_LEN = LAN_IP_FRAME+2
                 .EQU		LAN_IP_FRAG = LAN_IP_FRAME+4
                 .EQU		LAN_IP_FLAGS = LAN_IP_FRAME+6
                 .EQU		LAN_IP_LIFE = LAN_IP_FRAME+8
                 .EQU		LAN_IP_PROTOCOL = LAN_IP_FRAME+9
                 .EQU		LAN_IP_CS = LAN_IP_FRAME+10
                 .EQU		LAN_IP_SRCIP = LAN_IP_FRAME+12
                 .EQU		LAN_IP_DSTIP = LAN_IP_FRAME+16
                 .EQU		LAN_IP_DATA = LAN_IP_FRAME+20
                 
                 .EQU		LAN_UDP_FRAME = LAN_IP_DATA
                 .EQU		LAN_UDP_SRCPORT = LAN_IP_DATA
                 .EQU		LAN_UDP_DSTPORT = LAN_IP_DATA+2
                 .EQU		LAN_UDP_LEN = LAN_IP_DATA+4
                 .EQU		LAN_UDP_CS = LAN_IP_DATA+6
                 .EQU		LAN_UDP_DATA = LAN_IP_DATA+8
                 
                 .EQU		LAN_UDP_PH_LEN = LAN_UDP_FRAME-2
                 .EQU		LAN_UDP_PH_PROTOCOL = LAN_UDP_FRAME-3
                 .EQU		LAN_UDP_PH_Z = LAN_UDP_FRAME-4
                 .EQU		LAN_UDP_PH_DSTIP = LAN_UDP_FRAME-8
                 .EQU		LAN_UDP_PH_SRCIP = LAN_UDP_FRAME-12
                 .EQU		LAN_UDP_PH_START = LAN_UDP_FRAME-12
                 
                 .EQU		LAN_ARP_FRAME = LAN_ETH_DATA
                 .EQU		LAN_ARP_HWTYPE = LAN_ARP_FRAME
                 .EQU		LAN_ARP_PROTOTYPE = LAN_ARP_FRAME+2
                 .EQU		LAN_ARP_MACLEN = LAN_ARP_FRAME+4
                 .EQU		LAN_ARP_IPLEN = LAN_ARP_FRAME+5
                 .EQU		LAN_ARP_MSGTYPE = LAN_ARP_FRAME+6
                 .EQU		LAN_ARP_SRCMAC = LAN_ARP_FRAME+8
                 .EQU		LAN_ARP_SRCIP = LAN_ARP_FRAME+14
                 .EQU		LAN_ARP_DSTMAC = LAN_ARP_FRAME+18
                 .EQU		LAN_ARP_DSTIP = LAN_ARP_FRAME+24
                 
                 .EQU		LAN_ICMP_FRAME = LAN_IP_DATA
                 .EQU		LAN_ICMP_TYPE = LAN_ICMP_FRAME
                 .EQU		LAN_ICMP_CODE = LAN_ICMP_FRAME+1
                 .EQU		LAN_ICMP_CS = LAN_ICMP_FRAME+2
                 .EQU		LAN_ICMP_ROH = LAN_ICMP_FRAME+4
                 .EQU		LAN_ICMP_DATA = LAN_ICMP_FRAME+8
                 
                 .EQU		LAN_TCP_FRAME = LAN_IP_DATA
                 .EQU		LAN_TCP_SRCPORT = LAN_TCP_FRAME
                 .EQU		LAN_TCP_DSTPORT = LAN_TCP_FRAME+2
                 .EQU		LAN_TCP_SN = LAN_TCP_FRAME+4
                 .EQU		LAN_TCP_ACK = LAN_TCP_FRAME+8
                 .EQU		LAN_TCP_OFFSET = LAN_TCP_FRAME+12
                 .EQU		LAN_TCP_FLAGS = LAN_TCP_FRAME+13
                 .EQU		LAN_TCP_WSIZE = LAN_TCP_FRAME+14
                 .EQU		LAN_TCP_CS = LAN_TCP_FRAME+16
                 .EQU		LAN_TCP_URG = LAN_TCP_FRAME+18
                 .EQU		LAN_TCP_DATA = LAN_TCP_FRAME+20
                 
                 .EQU		LAN_TCP_PH_LEN = LAN_TCP_FRAME-2
                 .EQU		LAN_TCPP_PH_PROTOCOL = LAN_TCP_FRAME-3
                 .EQU		LAN_TCP_PH_Z = LAN_TCP_FRAME-4
                 .EQU		LAN_TCP_PH_DSTIP = LAN_TCP_FRAME-8
                 .EQU		LAN_TCP_PH_SRCIP = LAN_TCP_FRAME-12
                 .EQU		LAN_TCP_PH_START = LAN_TCP_FRAME-12
                 
                 LAN_BUF_END:
                 
                 
                 .EQU		LAN2_BUF_SIZE = 256
003500           LAN2_BUF:	.BYTE	LAN2_BUF_SIZE			; reserve for internal LAN operations <128b data
                 LAN2_BUF_END:
                 
                 
                 .EQU		LAN3_BUF_SIZE = 64
                 LAN3_BUF:
003600           LAN3_BUF_HDR:	.BYTE	LAN3_BUF_SIZE			; SYSTEM BUFFER: getting HEADER data
                 
                 
003640           LAN_OP_HDR:	.BYTE	48				; settings for the current operation
                 .EQU		LAN_OP_SRC_MAC  = LAN_OP_HDR
                 .EQU		LAN_OP_SRC_IP   = LAN_OP_HDR+6
                 .EQU		LAN_OP_SRC_PORT = LAN_OP_HDR+10
                 .EQU		LAN_OP_DST_MAC  = LAN_OP_HDR+12
                 .EQU		LAN_OP_DST_IP   = LAN_OP_HDR+18
                 .EQU		LAN_OP_DST_PORT = LAN_OP_HDR+22
                 .EQU		LAN_OP_BUF      = LAN_OP_HDR+24
                 .EQU		LAN_OP_BUF_LEN  = LAN_OP_HDR+26
                 .EQU		LAN_OP_BUF_SIZE = LAN_OP_HDR+28		; Buffer size
                 .EQU		LAN_OP_PROTOCOL = LAN_OP_HDR+30		; PROTOCOL
                 .EQU		LAN_OP_RXDPT    = LAN_OP_HDR+21		; RXDPT after OP
                 .EQU		LAN_OP_TYPE     = LAN_OP_HDR+23		; message type (used in ICMP)
                 .EQU		LAN_OP_ETHTYPE  = LAN_OP_HDR+24		; EtherType
                 .EQU		LAN_OP_RESERVE  = LAN_OP_HDR+25		; 16 bytes reserve
                 
                 
003670           _RTC_BUF:	.BYTE	32				; RTC data
                 
003690           RTC_RAM:	.BYTE	96				; RTC RAM data
                 
                 ;+0
                 .EQU		RTC_HW = RTC_RAM			; default hw setting
                 .EQU		RTC_IOBYTE = RTC_RAM+1			; default CRISS iobyte
                 
                 ;+2
                 .EQU		RTC_LAN_BASE = RTC_RAM+2
                 .EQU		RTC_LAN_MY_MAC = RTC_LAN_BASE
                 .EQU		RTC_LAN_MY_IP = RTC_LAN_BASE+6
                 .EQU		RTC_LAN_GATE = RTC_LAN_BASE+10
                 .EQU		RTC_LAN_MASK = RTC_LAN_BASE+14
                 .EQU		RTC_LAN_MTU = RTC_LAN_BASE+18
                 
                 ;+22
                 .EQU		RTC_SRV_BASE = RTC_RAM+22
                 .EQU		RTC_SRV_MAC = RTC_SRV_BASE
                 .EQU		RTC_SRV_IP = RTC_SRV_BASE+6
                 .EQU		RTC_SRV_PORT = RTC_SRV_BASE+10
                 
                 ;+34
                 .EQU		RTC_PNC_BASE = RTC_RAM+34
                 .EQU		RTC_PNC_MAC = RTC_PNC_BASE
                 .EQU		RTC_PNC_IP = RTC_PNC_BASE+6
                 .EQU		RTC_PNC_PORT = RTC_PNC_BASE+10
                 
                 ;+46
                 .EQU		RTC_COMM_BASE = RTC_RAM+46
                 .EQU		RTC_MODBUS_ID = RTC_COMM_BASE
                 .EQU		RTC_CAN_ID = RTC_COMM_BASE+1
                 
                 ;+48
                 .EQU		RTC_HW_DISABLE = RTC_RAM+48		; hardware disabled
                 
                 ;+49
                 .EQU		RTC_AUTO = RTC_RAM+49			; auto options: clock on the screeen etc
                 
                 ;+50
                 .EQU		RTC_PR_IOBYTE = RTC_RAM+50		; default PUNCH device: TTY, LAN, CAN, ...
                 
                 ;+51
                 .EQU		RTC_TMS_BASE = RTC_RAM+51		; time server
                 .EQU		RTC_TMS_MAC = RTC_TMS_BASE
                 .EQU		RTC_TMS_IP = RTC_TMS_BASE+6
                 .EQU		RTC_TMS_PORT = RTC_TMS_BASE+10
                 
                 ;+63
                 .EQU		RTC_IRQ_BASE = RTC_RAM+63
                 .EQU		RTC_IRQ_V_KBD = RTC_IRQ_BASE
                 .EQU		RTC_IRQ_V_GPO = RTC_IRQ_BASE+1
                 .EQU		RTC_IRQ_V_CTC = RTC_IRQ_BASE+2
                 .EQU		RTC_IRQ_V_MUS = RTC_IRQ_BASE+3
                 .EQU		RTC_IRQ_V_R1  = RTC_IRQ_BASE+4
                 .EQU		RTC_IRQ_V_R2  = RTC_IRQ_BASE+5
                 .EQU		RTC_IRQ_V_CTX = RTC_IRQ_BASE+6
                 .EQU		RTC_IRQ_V_CRX = RTC_IRQ_BASE+7
                 
                 .EQU		RTC_IRQ_V_LAN = RTC_IRQ_BASE+8
                 .EQU		RTC_IRQ_V_CAN = RTC_IRQ_BASE+9
                 .EQU		RTC_IRQ_V_RTC = RTC_IRQ_BASE+10
                 .EQU		RTC_IRQ_V_R3  = RTC_IRQ_BASE+11
                 .EQU		RTC_IRQ_V_R4  = RTC_IRQ_BASE+12
                 .EQU		RTC_IRQ_V_R5  = RTC_IRQ_BASE+13
                 .EQU		RTC_IRQ_V_TTX = RTC_IRQ_BASE+14
                 .EQU		RTC_IRQ_V_TRX = RTC_IRQ_BASE+15
                 
                 ;+79
                 
                 ;+80
                 .EQU		RTC_SEC_BASE = RTC_RAM+80
                 .EQU		RTC_SEC_PIN = RTC_SEC_BASE		; 2 bytes (5 digit) pin-code
                 .EQU		RTC_CAD_PIN = RTC_SEC_BASE+2		; 2 bytes (5 digit) pin-code
                 
                 ;+84
                 .EQU		RTC_DEV_IOBYTE = RTC_RAM+84		; default LST device: TTY, LAN, CAN, ...
                 
                 ;+85
                 .EQU		RTC_PRN_PORT = RTC_RAM+85		; port for the printer server
                 .EQU		RTC_SDC_PORT = RTC_RAM+87		; port for the SDC server
                 
                 ;+89
                 
                 ;+90
                 .EQU		RTC_DEVID = RTC_RAM+90			; 6 byte device id
                 
                 		; SPI direct access buffer
                 .EQU		PSPI_BUF_MAXLEN	= 134
0036f0           PSPI_BUF:	.BYTE	PSPI_BUF_MAXLEN	; SPI buffer data
                 .EQU		PSPI_ADDR = PSPI_BUF
                 .EQU		PSPI_SPEED = PSPI_BUF+1
                 .EQU		PSPI_BUF_DATA = PSPI_BUF+2
                 
                 		; EEPROM access shares SPI buffer
                 .EQU		ROM_BUF_ADDR_ROM = PSPI_BUF
                 .EQU		ROM_BUF_ADDR_RAM = PSPI_BUF+2
                 .EQU		ROM_BUF_ADDR_LENGTH = PSPI_BUF+2
                 
                 
003776           HW_DATA:	.BYTE	32		; misc data for hw compatibility layer
                 					; decoding table are located in EPROM
                 
                 .EQU 		PR_BUF_LEN = 32
003796           PR_BUF_CNT:	.BYTE	1		; input buffer for punch/reder channel
003797           PR_BUF:		.BYTE	PR_BUF_LEN
                 
                 .EQU 		CON_BUF_LEN = 32
0037b7           CON_BUF_CNT:	.BYTE	1		; input buffer for CON channel
0037b8           CON_BUF:	.BYTE	CON_BUF_LEN
                 
                 
                 ; -------------------------------- SHARABLE VARS -------------------------------------
                 
                 .ORG 0x3F00
                 
                 		; sharable vars
                 .EQU		SHARABLE_MAXLEN	= 254
                 SHARABLE:
                 
                 ;0
003f00           HW_FLAG:	.BYTE	1 		; settings for HW compat layer
                 ;1
003f01           CON_IOBYTE:	.BYTE	1		; internal IOBYTE
                 ;2
003f02           HW_FOUND:	.BYTE	1		; installed hardware
                 ;3
003f03           INT_MASK:	.BYTE	2		; interrupt mask
                 
                 ;5
003f05           CRT_SETTINGS:	.BYTE	1		; srolling (bit 7)
                 					; use attr (bit 6) 
                 					;!!!! todo wrap (bit 5)
                 					; use colors (bit 4)
                 					;!!! todo  windowed mode (bit 3)
                 					; codepage (bits 0-2)
                 
                 ;6
003f06           CURSOR_X:	.BYTE	1               ; cursor X position, 1-80
003f07           CURSOR_Y:	.BYTE	1               ; cursor Y position, 1-25
003f08           CURSOR_STATUS:	.BYTE	1               ; =0 if cursor is on, 0x80 if is off
                 
                 ;9
003f09           CRT_LINES:	.BYTE	1		; lines on the screen
003f0a           CRT_CHARS:	.BYTE	1		; chars per line
                 
                 ;11
003f0b           VIDEO_END:	.BYTE	2		; end of video ram starting from 0x100	
003f0d           VIDEO_CURSOR:	.BYTE	2		; cursor position in videoram
                 
                 ;15
003f0f           BIOS_DISK:	.BYTE	1
003f10           BIOS_TRACK:	.BYTE	2
003f12           BIOS_SECTOR:	.BYTE	1
003f13           BIOS_DMA:	.BYTE	2
                 
                 ;21
003f15           SD_TYPE:	.BYTE	1 		; inseted SD-card type
                 
                 ;22
003f16           CON_LAST_CHAR:	.BYTE	1		; last read char
003f17           CON_LAST_MODK:	.BYTE	1		; last read char
003f18           CON_LAST_KACT:	.BYTE	1		; last read char
                 
                 ;25
003f19           LST_LAST_CHAR:	.BYTE	1		; last received char from LST
                 
                 ;26
003f1a           SD_FDD_BASE:	.BYTE	16		; base for the selected discs image on SD: A,B,...,P
                 
                 ;42
003f2a           SYS_NOTIFY:	.BYTE	1		; debug options
003f2b           DBG_OPTIONS:	.BYTE	1		; debug options
003f2c           DBG_BREAK:	.BYTE	2		; debug options
                 
                 ;46
003f2e           BIOS_LAST_CALL:	.BYTE	1		; last bios call
                 
                 ;47
003f2f           SD_CCS:		.BYTE	1		; for CCS flag from CMD58 response
003f30           SD_ERROR:	.BYTE	1		; result of the last operation
                 
                 ;49
003f31           DBG_CODE:	.BYTE	1		; data to output
003f32           DBG_DATA:	.BYTE	1		; data to output
                 
                 ;51
003f33           FLIB_CMD:	.BYTE	1		; float operation command
003f34           FLIB_DATA:	.BYTE	4*3		; float operation 3 4-byte values
                 		.EQU	FLOATDATA1 = FLIB_DATA+0
                 		.EQU	FLOATDATA2 = FLIB_DATA+4
                 		.EQU	FLOATDATA3 = FLIB_DATA+8
                 
                 ;64
003f40           BDOS_LAST_CALL:	.BYTE	1		; last bdos call
                 
                 ;65
003f41           RTC_SECS:	.BYTE	1		; RTC data buffer
003f42           RTC_MINS:	.BYTE	1
003f43           RTC_HOURS:	.BYTE	1
003f44           RTC_DAY:	.BYTE	1
003f45           RTC_DATE:	.BYTE	1
003f46           RTC_MONTH:	.BYTE	1
003f47           RTC_YEAR:	.BYTE	1
                 		.EQU	RTC_SBUF = RTC_SECS
                 
                 ;72
003f48           PR_IOBYTE:	.BYTE	1		; iobyte for punch/reader bios command
                 
                 ;73
003f49           HW_DISABLE:	.BYTE	1		; hardware disabled
                 
                 ;74
003f4a           PR_SRV_MAC:	.BYTE	6
003f50           PR_SRV_IP:	.BYTE	4
003f54           PR_SRV_PORT:	.BYTE	2		; settings for punch/reader server
                 
                 ;86
003f56           TMR_10MS:	.BYTE	1		; 10 ms timer ticks
                 
                 ;87
                 ;SD_IOBYTE:	.BYTE	1		; SD channel no
003f57           RES_IOBYTE:	.BYTE	1		; SD channel no
                 ;88
                 ;LST_IOBYTE:	.BYTE	1		; LST channel no
003f58           DEV_IOBYTE:	.BYTE	1		; LST channel no
                 
                 ;89
                 MOUSE_SETTINGS:
003f59           MS_MODE:	.BYTE	1		; Mouse settings for auto mode
003f5a           MS_STEP_X:	.BYTE	1
003f5b           MS_STEP_Y:	.BYTE	1
003f5c           MS_MOVE_UP:	.BYTE	1		; shift up returns this character
003f5d           MS_MOVE_DOWN:	.BYTE	1
003f5e           MS_MOVE_RIGHT:	.BYTE	1
003f5f           MS_MOVE_LEFT:	.BYTE	1
003f60           MS_BTN_LEFT_P:	.BYTE	1		; left button returns character
003f61           MS_BTN_LEFT_U:	.BYTE	1		; left button returns character
003f62           MS_BTN_MID_P:	.BYTE	1		; mid button returns character
003f63           MS_BTN_MID_U:	.BYTE	1		; mid button returns character
003f64           MS_BTN_RIGHT_P:	.BYTE	1		; right button returns character
003f65           MS_BTN_RIGHT_U:	.BYTE	1		; right button returns character
                 
                 ;102
003f66           CON_WIN_X0:	.BYTE	1		; window to output - left 
003f67           CON_WIN_Y0:	.BYTE	1		; top
003f68           CON_WIN_X1:	.BYTE	1		; right
003f69           CON_WIN_Y1:	.BYTE	1		; bottom
003f6a           CON_WIN_CUR_X:	.BYTE	1		; cursor X
003f6b           CON_WIN_CUR_Y:	.BYTE	1		; cursor Y
                 
                 ;108
                 ;CRT_WIN_X0:	.BYTE	1		; windowed output - left 
                 ;CRT_WIN_Y0:	.BYTE	1		; top
                 ;CRT_WIN_X1:	.BYTE	1		; right
                 ;CRT_WIN_Y1:	.BYTE	1		; bottom
                 
                 ;106
                 
                 ;128	- USERS area
                 
                 
                 ;254
003f6c           SHARABLE_END:	.BYTE	SHARABLE_MAXLEN	- (SHARABLE_END-SHARABLE)
                 
                 .ORG 0x4000
004000           FLOATSPH:	.BYTE	1
004001           FLOATSPL:	.BYTE	1
004002           FLOATSREG:	.BYTE	1
004003           FLOATDATA:	.BYTE	125
                 FLOATSTACK:
                 
                 ; stack data - reserved! --------------------------------------------------------
                 .ORG 0x4080
                 
004080           STACK:		.BYTE 	128
                 


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

ATmega1284 register use summary:
r0 :  58 r1 : 925 r2 :1526 r3 : 621 r4 :  11 r5 :1862 r6 : 311 r7 : 185 
r8 : 122 r9 : 407 r10: 247 r11: 126 r12: 236 r13: 232 r14: 451 r15: 404 
r16: 163 r17: 881 r18:1084 r19: 471 r20:1646 r21:10799 r22: 645 r23:1396 
r24:1042 r25: 672 r26: 490 r27: 468 r28: 884 r29: 988 r30: 528 r31: 522 
x  : 406 y  : 216 z  : 257 
Registers used: 35 out of 35 (100.0%)

ATmega1284 instruction use summary:
.lds  :   0 .sts  :   0 adc   : 435 add   : 467 adiw  : 477 and   : 127 
andi  : 824 asr   :   0 bclr  :   0 bld   :  49 brbc  :   0 brbs  :   0 
brcc  :   7 brcs  :  10 break :   0 breq  : 176 brge  :   2 brhc  :   0 
brhs  :   0 brid  :   0 brie  :   0 brlo  : 381 brlt  :   4 brmi  :   1 
brne  :1189 brpl  :   6 brsh  :  68 brtc  :   0 brts  :   0 brvc  :   0 
brvs  :   0 bset  :   0 bst   :  39 call  :1721 cbi   :1044 cbr   :  38 
clc   :   2 clh   :   0 cli   :   4 cln   :   0 clr   : 215 cls   :   0 
clt   :   0 clv   :  80 clz   :   6 com   : 143 cp    : 408 cpc   :  89 
cpi   : 692 cpse  :  36 dec   : 709 elpm  :  36 eor   :  61 fmul  :   0 
fmuls :   0 fmulsu:   0 icall :   0 ijmp  :   2 in    :1279 inc   :  47 
jmp   :1510 ld    : 291 ldd   :  89 ldi   :4180 lds   : 710 lpm   :   0 
lsl   :  60 lsr   :  68 mov   :1862 movw  : 107 mul   :  12 muls  :   0 
mulsu :   0 neg   :  20 nop   : 625 or    : 663 ori   : 141 out   :6989 
pop   :1170 push  :1194 rcall : 459 ret   : 401 reti  :   2 rjmp  : 675 
rol   :  20 ror   :  54 sbc   : 226 sbci  :  36 sbi   : 443 sbic  :  15 
sbis  :   2 sbiw  :  38 sbr   :  53 sbrc  : 362 sbrs  :  93 sec   :   1 
seh   :   0 sei   :   1 sen   :   0 ser   :   0 ses   :   0 set   :  10 
sev   :  80 sez   :  29 sleep :   0 spm   :   0 st    : 193 std   :  94 
sts   : 614 sub   : 246 subi  :  76 swap  :   8 tst   :   0 wdr   :   0 

Instructions used: 79 out of 114 (69.3%)

ATmega1284 memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x01c100  78702  12202  90904  131072  69.4%
[.dseg] 0x000100 0x004100      0  13951  13951   16384  85.2%
[.eseg] 0x000000 0x000000      0      0      0    4096   0.0%

Assembly complete, 0 errors, 5 warnings
